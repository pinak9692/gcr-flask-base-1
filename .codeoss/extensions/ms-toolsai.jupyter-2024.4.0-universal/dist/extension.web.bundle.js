"use strict";var Are=Object.create;var AE=Object.defineProperty;var H9=Object.getOwnPropertyDescriptor;var Mre=Object.getOwnPropertyNames;var Ore=Object.getPrototypeOf,Lre=Object.prototype.hasOwnProperty;var te=(r,e)=>()=>(r&&(e=r(r=0)),e);var Q=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Um=(r,e)=>{for(var t in e)AE(r,t,{get:e[t],enumerable:!0})},J9=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Mre(e))!Lre.call(r,i)&&i!==t&&AE(r,i,{get:()=>e[i],enumerable:!(n=H9(e,i))||n.enumerable});return r};var z=(r,e,t)=>(t=r!=null?Are(Ore(r)):{},J9(e||!r||!r.__esModule?AE(t,"default",{value:r,enumerable:!0}):t,r)),iP=r=>J9(AE({},"__esModule",{value:!0}),r),E=(r,e,t,n)=>{for(var i=n>1?void 0:n?H9(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&AE(e,t,i),i},b=(r,e)=>(t,n)=>e(t,n,r);var process,d=te(()=>{"use strict";process={platform:"web",cwd:()=>"",env:{NODE_ENV:"production"}}});var G9=Q(()=>{d();var q9;(function(r){(function(e){var t=typeof this=="object"?this:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=i(t.Reflect,n),e(n);function i(o,s){return function(a,l){typeof o[a]!="function"&&Object.defineProperty(o,a,{configurable:!0,writable:!0,value:l}),s&&s(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",o=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!s&&!a,c={create:s?function(){return pe(Object.create(null))}:a?function(){return pe({__proto__:null})}:function(){return pe({})},has:l?function(T,M){return t.call(T,M)}:function(T,M){return M in T},get:l?function(T,M){return t.call(T,M)?T[M]:void 0}:function(T,M){return T[M]}},u=Object.getPrototypeOf(Function),p=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",f=!p&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ut(),m=!p&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Ar(),h=!p&&typeof WeakMap=="function"?WeakMap:F(),g=new h;function v(T,M,Z,de){if(fe(Z)){if(!it(T))throw new TypeError;if(!W(M))throw new TypeError;return N(T,M)}else{if(!it(T))throw new TypeError;if(!Te(M))throw new TypeError;if(!Te(de)&&!fe(de)&&!Ae(de))throw new TypeError;return Ae(de)&&(de=void 0),Z=We(Z),ee(T,M,Z,de)}}e("decorate",v);function I(T,M){function Z(de,be){if(!Te(de))throw new TypeError;if(!fe(be)&&!me(be))throw new TypeError;Ye(T,M,de,be)}return Z}e("metadata",I);function S(T,M,Z,de){if(!Te(Z))throw new TypeError;return fe(de)||(de=We(de)),Ye(T,M,Z,de)}e("defineMetadata",S);function x(T,M,Z){if(!Te(M))throw new TypeError;return fe(Z)||(Z=We(Z)),Ve(T,M,Z)}e("hasMetadata",x);function D(T,M,Z){if(!Te(M))throw new TypeError;return fe(Z)||(Z=We(Z)),Pe(T,M,Z)}e("hasOwnMetadata",D);function A(T,M,Z){if(!Te(M))throw new TypeError;return fe(Z)||(Z=We(Z)),le(T,M,Z)}e("getMetadata",A);function w(T,M,Z){if(!Te(M))throw new TypeError;return fe(Z)||(Z=We(Z)),At(T,M,Z)}e("getOwnMetadata",w);function R(T,M){if(!Te(T))throw new TypeError;return fe(M)||(M=We(M)),Ir(T,M)}e("getMetadataKeys",R);function j(T,M){if(!Te(T))throw new TypeError;return fe(M)||(M=We(M)),en(T,M)}e("getOwnMetadataKeys",j);function ne(T,M,Z){if(!Te(M))throw new TypeError;fe(Z)||(Z=We(Z));var de=ye(M,Z,!1);if(fe(de)||!de.delete(T))return!1;if(de.size>0)return!0;var be=g.get(M);return be.delete(Z),be.size>0||g.delete(M),!0}e("deleteMetadata",ne);function N(T,M){for(var Z=T.length-1;Z>=0;--Z){var de=T[Z],be=de(M);if(!fe(be)&&!Ae(be)){if(!W(be))throw new TypeError;M=be}}return M}function ee(T,M,Z,de){for(var be=T.length-1;be>=0;--be){var V=T[be],Y=V(M,Z,de);if(!fe(Y)&&!Ae(Y)){if(!Te(Y))throw new TypeError;de=Y}}return de}function ye(T,M,Z){var de=g.get(T);if(fe(de)){if(!Z)return;de=new f,g.set(T,de)}var be=de.get(M);if(fe(be)){if(!Z)return;be=new f,de.set(M,be)}return be}function Ve(T,M,Z){var de=Pe(T,M,Z);if(de)return!0;var be=rr(M);return Ae(be)?!1:Ve(T,be,Z)}function Pe(T,M,Z){var de=ye(M,Z,!1);return fe(de)?!1:ve(de.has(T))}function le(T,M,Z){var de=Pe(T,M,Z);if(de)return At(T,M,Z);var be=rr(M);if(!Ae(be))return le(T,be,Z)}function At(T,M,Z){var de=ye(M,Z,!1);if(!fe(de))return de.get(T)}function Ye(T,M,Z,de){var be=ye(Z,de,!0);be.set(T,M)}function Ir(T,M){var Z=en(T,M),de=rr(T);if(de===null)return Z;var be=Ir(de,M);if(be.length<=0)return Z;if(Z.length<=0)return be;for(var V=new m,Y=[],$=0,se=Z;$<se.length;$++){var Ee=se[$],G=V.has(Ee);G||(V.add(Ee),Y.push(Ee))}for(var ae=0,K=be;ae<K.length;ae++){var Ee=K[ae],G=V.has(Ee);G||(V.add(Ee),Y.push(Ee))}return Y}function en(T,M){var Z=[],de=ye(T,M,!1);if(fe(de))return Z;for(var be=de.keys(),V=Fe(be),Y=0;;){var $=et(V);if(!$)return Z.length=Y,Z;var se=Xt($);try{Z[Y]=se}catch(Ee){try{Et(V)}finally{throw Ee}}Y++}}function H(T){if(T===null)return 1;switch(typeof T){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return T===null?1:6;default:return 6}}function fe(T){return T===void 0}function Ae(T){return T===null}function _e(T){return typeof T=="symbol"}function Te(T){return typeof T=="object"?T!==null:typeof T=="function"}function L(T,M){switch(H(T)){case 0:return T;case 1:return T;case 2:return T;case 3:return T;case 4:return T;case 5:return T}var Z=M===3?"string":M===5?"number":"default",de=we(T,i);if(de!==void 0){var be=de.call(T,Z);if(Te(be))throw new TypeError;return be}return ce(T,Z==="default"?"number":Z)}function ce(T,M){if(M==="string"){var Z=T.toString;if(k(Z)){var de=Z.call(T);if(!Te(de))return de}var be=T.valueOf;if(k(be)){var de=be.call(T);if(!Te(de))return de}}else{var be=T.valueOf;if(k(be)){var de=be.call(T);if(!Te(de))return de}var V=T.toString;if(k(V)){var de=V.call(T);if(!Te(de))return de}}throw new TypeError}function ve(T){return!!T}function ke(T){return""+T}function We(T){var M=L(T,3);return _e(M)?M:ke(M)}function it(T){return Array.isArray?Array.isArray(T):T instanceof Object?T instanceof Array:Object.prototype.toString.call(T)==="[object Array]"}function k(T){return typeof T=="function"}function W(T){return typeof T=="function"}function me(T){switch(H(T)){case 3:return!0;case 4:return!0;default:return!1}}function we(T,M){var Z=T[M];if(Z!=null){if(!k(Z))throw new TypeError;return Z}}function Fe(T){var M=we(T,o);if(!k(M))throw new TypeError;var Z=M.call(T);if(!Te(Z))throw new TypeError;return Z}function Xt(T){return T.value}function et(T){var M=T.next();return M.done?!1:M}function Et(T){var M=T.return;M&&M.call(T)}function rr(T){var M=Object.getPrototypeOf(T);if(typeof T!="function"||T===u||M!==u)return M;var Z=T.prototype,de=Z&&Object.getPrototypeOf(Z);if(de==null||de===Object.prototype)return M;var be=de.constructor;return typeof be!="function"||be===T?M:be}function Ut(){var T={},M=[],Z=function(){function Y($,se,Ee){this._index=0,this._keys=$,this._values=se,this._selector=Ee}return Y.prototype["@@iterator"]=function(){return this},Y.prototype[o]=function(){return this},Y.prototype.next=function(){var $=this._index;if($>=0&&$<this._keys.length){var se=this._selector(this._keys[$],this._values[$]);return $+1>=this._keys.length?(this._index=-1,this._keys=M,this._values=M):this._index++,{value:se,done:!1}}return{value:void 0,done:!0}},Y.prototype.throw=function($){throw this._index>=0&&(this._index=-1,this._keys=M,this._values=M),$},Y.prototype.return=function($){return this._index>=0&&(this._index=-1,this._keys=M,this._values=M),{value:$,done:!0}},Y}();return function(){function Y(){this._keys=[],this._values=[],this._cacheKey=T,this._cacheIndex=-2}return Object.defineProperty(Y.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Y.prototype.has=function($){return this._find($,!1)>=0},Y.prototype.get=function($){var se=this._find($,!1);return se>=0?this._values[se]:void 0},Y.prototype.set=function($,se){var Ee=this._find($,!0);return this._values[Ee]=se,this},Y.prototype.delete=function($){var se=this._find($,!1);if(se>=0){for(var Ee=this._keys.length,G=se+1;G<Ee;G++)this._keys[G-1]=this._keys[G],this._values[G-1]=this._values[G];return this._keys.length--,this._values.length--,$===this._cacheKey&&(this._cacheKey=T,this._cacheIndex=-2),!0}return!1},Y.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=T,this._cacheIndex=-2},Y.prototype.keys=function(){return new Z(this._keys,this._values,de)},Y.prototype.values=function(){return new Z(this._keys,this._values,be)},Y.prototype.entries=function(){return new Z(this._keys,this._values,V)},Y.prototype["@@iterator"]=function(){return this.entries()},Y.prototype[o]=function(){return this.entries()},Y.prototype._find=function($,se){return this._cacheKey!==$&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=$)),this._cacheIndex<0&&se&&(this._cacheIndex=this._keys.length,this._keys.push($),this._values.push(void 0)),this._cacheIndex},Y}();function de(Y,$){return Y}function be(Y,$){return $}function V(Y,$){return[Y,$]}}function Ar(){return function(){function T(){this._map=new f}return Object.defineProperty(T.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),T.prototype.has=function(M){return this._map.has(M)},T.prototype.add=function(M){return this._map.set(M,M),this},T.prototype.delete=function(M){return this._map.delete(M)},T.prototype.clear=function(){this._map.clear()},T.prototype.keys=function(){return this._map.keys()},T.prototype.values=function(){return this._map.values()},T.prototype.entries=function(){return this._map.entries()},T.prototype["@@iterator"]=function(){return this.keys()},T.prototype[o]=function(){return this.keys()},T}()}function F(){var T=16,M=c.create(),Z=de();return function(){function se(){this._key=de()}return se.prototype.has=function(Ee){var G=be(Ee,!1);return G!==void 0?c.has(G,this._key):!1},se.prototype.get=function(Ee){var G=be(Ee,!1);return G!==void 0?c.get(G,this._key):void 0},se.prototype.set=function(Ee,G){var ae=be(Ee,!0);return ae[this._key]=G,this},se.prototype.delete=function(Ee){var G=be(Ee,!1);return G!==void 0?delete G[this._key]:!1},se.prototype.clear=function(){this._key=de()},se}();function de(){var se;do se="@@WeakMap@@"+$();while(c.has(M,se));return M[se]=!0,se}function be(se,Ee){if(!t.call(se,Z)){if(!Ee)return;Object.defineProperty(se,Z,{value:c.create()})}return se[Z]}function V(se,Ee){for(var G=0;G<Ee;++G)se[G]=Math.random()*255|0;return se}function Y(se){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(se)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(se)):V(new Uint8Array(se),se):V(new Array(se),se)}function $(){var se=Y(T);se[6]=se[6]&79|64,se[8]=se[8]&191|128;for(var Ee="",G=0;G<T;++G){var ae=se[G];(G===4||G===6||G===8)&&(Ee+="-"),ae<16&&(Ee+="0"),Ee+=ae.toString(16).toLowerCase()}return Ee}}function pe(T){return T.__=void 0,delete T.__,T}})})(q9||(q9={}))});var Y9={};Um(Y9,{isPreRelesVersionOfJupyterExtension:()=>Kre});var Kre,$9=te(()=>{"use strict";d();Kre=!1});var XB=Q(($ke,dL)=>{"use strict";d();var ry=typeof Reflect=="object"?Reflect:null,jB=ry&&typeof ry.apply=="function"?ry.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},TP;ry&&typeof ry.ownKeys=="function"?TP=ry.ownKeys:Object.getOwnPropertySymbols?TP=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:TP=function(e){return Object.getOwnPropertyNames(e)};function yne(r){console&&console.warn&&console.warn(r)}var HB=Number.isNaN||function(e){return e!==e};function Mr(){Mr.init.call(this)}dL.exports=Mr;dL.exports.once=_ne;Mr.EventEmitter=Mr;Mr.prototype._events=void 0;Mr.prototype._eventsCount=0;Mr.prototype._maxListeners=void 0;var BB=10;function kP(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Mr,"defaultMaxListeners",{enumerable:!0,get:function(){return BB},set:function(r){if(typeof r!="number"||r<0||HB(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");BB=r}});Mr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Mr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||HB(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function JB(r){return r._maxListeners===void 0?Mr.defaultMaxListeners:r._maxListeners}Mr.prototype.getMaxListeners=function(){return JB(this)};Mr.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")jB(l,this,t);else for(var c=l.length,u=zB(l,c),n=0;n<c;++n)jB(u[n],this,t);return!0};function qB(r,e,t,n){var i,o,s;if(kP(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=JB(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,yne(a)}return r}Mr.prototype.addListener=function(e,t){return qB(this,e,t,!1)};Mr.prototype.on=Mr.prototype.addListener;Mr.prototype.prependListener=function(e,t){return qB(this,e,t,!0)};function bne(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function GB(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=bne.bind(n);return i.listener=t,n.wrapFn=i,i}Mr.prototype.once=function(e,t){return kP(t),this.on(e,GB(this,e,t)),this};Mr.prototype.prependOnceListener=function(e,t){return kP(t),this.prependListener(e,GB(this,e,t)),this};Mr.prototype.removeListener=function(e,t){var n,i,o,s,a;if(kP(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():Ine(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Mr.prototype.off=Mr.prototype.removeListener;Mr.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function YB(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Sne(i):zB(i,i.length)}Mr.prototype.listeners=function(e){return YB(this,e,!0)};Mr.prototype.rawListeners=function(e){return YB(this,e,!1)};Mr.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):$B.call(r,e)};Mr.prototype.listenerCount=$B;function $B(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Mr.prototype.eventNames=function(){return this._eventsCount>0?TP(this._events):[]};function zB(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Ine(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Sne(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function _ne(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}QB(r,e,o,{once:!0}),e!=="error"&&Ene(r,i,{once:!0})})}function Ene(r,e,t){typeof r.on=="function"&&QB(r,"error",e,t)}function QB(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var Bn=Q(ar=>{"use strict";d();Object.defineProperty(ar,"__esModule",{value:!0});ar.NON_CUSTOM_TAG_KEYS=ar.PRE_DESTROY=ar.POST_CONSTRUCT=ar.DESIGN_PARAM_TYPES=ar.PARAM_TYPES=ar.TAGGED_PROP=ar.TAGGED=ar.MULTI_INJECT_TAG=ar.INJECT_TAG=ar.OPTIONAL_TAG=ar.UNMANAGED_TAG=ar.NAME_TAG=ar.NAMED_TAG=void 0;ar.NAMED_TAG="named";ar.NAME_TAG="name";ar.UNMANAGED_TAG="unmanaged";ar.OPTIONAL_TAG="optional";ar.INJECT_TAG="inject";ar.MULTI_INJECT_TAG="multi_inject";ar.TAGGED="inversify:tagged";ar.TAGGED_PROP="inversify:tagged_props";ar.PARAM_TYPES="inversify:paramtypes";ar.DESIGN_PARAM_TYPES="design:paramtypes";ar.POST_CONSTRUCT="post_construct";ar.PRE_DESTROY="pre_destroy";function Cne(){return[ar.INJECT_TAG,ar.MULTI_INJECT_TAG,ar.NAME_TAG,ar.UNMANAGED_TAG,ar.NAMED_TAG,ar.OPTIONAL_TAG]}ar.NON_CUSTOM_TAG_KEYS=Cne()});var rl=Q(Rp=>{"use strict";d();Object.defineProperty(Rp,"__esModule",{value:!0});Rp.TargetTypeEnum=Rp.BindingTypeEnum=Rp.BindingScopeEnum=void 0;var wne={Request:"Request",Singleton:"Singleton",Transient:"Transient"};Rp.BindingScopeEnum=wne;var xne={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};Rp.BindingTypeEnum=xne;var Dne={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};Rp.TargetTypeEnum=Dne});var Ap=Q(NP=>{"use strict";d();Object.defineProperty(NP,"__esModule",{value:!0});NP.id=void 0;var Pne=0;function Tne(){return Pne++}NP.id=Tne});var eH=Q(RP=>{"use strict";d();Object.defineProperty(RP,"__esModule",{value:!0});RP.Binding=void 0;var ZB=rl(),kne=Ap(),Nne=function(){function r(e,t){this.id=(0,kne.id)(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=ZB.BindingTypeEnum.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return r.prototype.clone=function(){var e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===ZB.BindingScopeEnum.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},r}();RP.Binding=Nne});var Qi=Q(Je=>{"use strict";d();Object.defineProperty(Je,"__esModule",{value:!0});Je.STACK_OVERFLOW=Je.CIRCULAR_DEPENDENCY_IN_FACTORY=Je.ON_DEACTIVATION_ERROR=Je.PRE_DESTROY_ERROR=Je.POST_CONSTRUCT_ERROR=Je.ASYNC_UNBIND_REQUIRED=Je.MULTIPLE_POST_CONSTRUCT_METHODS=Je.MULTIPLE_PRE_DESTROY_METHODS=Je.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Je.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Je.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Je.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Je.ARGUMENTS_LENGTH_MISMATCH=Je.INVALID_DECORATOR_OPERATION=Je.INVALID_TO_SELF_VALUE=Je.LAZY_IN_SYNC=Je.INVALID_FUNCTION_BINDING=Je.INVALID_MIDDLEWARE_RETURN=Je.NO_MORE_SNAPSHOTS_AVAILABLE=Je.INVALID_BINDING_TYPE=Je.NOT_IMPLEMENTED=Je.CIRCULAR_DEPENDENCY=Je.UNDEFINED_INJECT_ANNOTATION=Je.MISSING_INJECT_ANNOTATION=Je.MISSING_INJECTABLE_ANNOTATION=Je.NOT_REGISTERED=Je.CANNOT_UNBIND=Je.AMBIGUOUS_MATCH=Je.KEY_NOT_FOUND=Je.NULL_ARGUMENT=Je.DUPLICATED_METADATA=Je.DUPLICATED_INJECTABLE_DECORATOR=void 0;Je.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.";Je.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:";Je.NULL_ARGUMENT="NULL argument";Je.KEY_NOT_FOUND="Key Not Found";Je.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:";Je.CANNOT_UNBIND="Could not unbind serviceIdentifier:";Je.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";Je.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:";Je.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var Rne=function(r){return"@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};Je.UNDEFINED_INJECT_ANNOTATION=Rne;Je.CIRCULAR_DEPENDENCY="Circular dependency found:";Je.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.";Je.INVALID_BINDING_TYPE="Invalid binding type:";Je.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.";Je.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!";Je.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";var Ane=function(r){return"You are attempting to construct '"+r+`' in a synchronous way
 but it has asynchronous dependencies.`};Je.LAZY_IN_SYNC=Ane;Je.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier";Je.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var Mne=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"The number of constructor arguments in the derived class "+(r[0]+" must be >= than the number of constructor arguments of its base class.")};Je.ARGUMENTS_LENGTH_MISMATCH=Mne;Je.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.";Je.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').";Je.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean";Je.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean";Je.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class";Je.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";Je.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";var One=function(r,e){return"@postConstruct error in class "+r+": "+e};Je.POST_CONSTRUCT_ERROR=One;var Lne=function(r,e){return"@preDestroy error in class "+r+": "+e};Je.PRE_DESTROY_ERROR=Lne;var Kne=function(r,e){return"onDeactivation() error in class "+r+": "+e};Je.ON_DEACTIVATION_ERROR=Kne;var Fne=function(r,e){return"It looks like there is a circular dependency in one of the '"+r+"' bindings. Please investigate bindings with"+("service identifier '"+e+"'.")};Je.CIRCULAR_DEPENDENCY_IN_FACTORY=Fne;Je.STACK_OVERFLOW="Maximum call stack size exceeded"});var fL=Q(vc=>{"use strict";d();var Une=vc&&vc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Wne=vc&&vc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Vne=vc&&vc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Une(e,r,t);return Wne(e,r),e};Object.defineProperty(vc,"__esModule",{value:!0});vc.MetadataReader=void 0;var pL=Vne(Bn()),jne=function(){function r(){}return r.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(pL.PARAM_TYPES,e),n=Reflect.getMetadata(pL.TAGGED,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},r.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(pL.TAGGED_PROP,e)||[];return t},r}();vc.MetadataReader=jne});var tH=Q(AP=>{"use strict";d();Object.defineProperty(AP,"__esModule",{value:!0});AP.BindingCount=void 0;var Bne={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};AP.BindingCount=Bne});var mL=Q(ua=>{"use strict";d();var Hne=ua&&ua.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Jne=ua&&ua.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),qne=ua&&ua.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hne(e,r,t);return Jne(e,r),e};Object.defineProperty(ua,"__esModule",{value:!0});ua.tryAndThrowErrorIfStackOverflow=ua.isStackOverflowExeption=void 0;var Gne=qne(Qi());function rH(r){return r instanceof RangeError||r.message===Gne.STACK_OVERFLOW}ua.isStackOverflowExeption=rH;var Yne=function(r,e){try{return r()}catch(t){throw rH(t)&&(t=e()),t}};ua.tryAndThrowErrorIfStackOverflow=Yne});var ny=Q(Hn=>{"use strict";d();var $ne=Hn&&Hn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),zne=Hn&&Hn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Qne=Hn&&Hn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$ne(e,r,t);return zne(e,r),e};Object.defineProperty(Hn,"__esModule",{value:!0});Hn.getSymbolDescription=Hn.circularDependencyToException=Hn.listMetadataForTarget=Hn.listRegisteredBindingsForServiceIdentifier=Hn.getServiceIdentifierAsString=Hn.getFunctionName=void 0;var Xne=Qne(Qi());function nH(r){if(typeof r=="function"){var e=r;return e.name}else{if(typeof r=="symbol")return r.toString();var e=r;return e}}Hn.getServiceIdentifierAsString=nH;function Zne(r,e,t){var n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(o){var s="Object";o.implementationType!==null&&(s=sH(o.implementationType)),n=n+`
 `+s,o.constraint.metaData&&(n=n+" - "+o.constraint.metaData)})),n}Hn.listRegisteredBindingsForServiceIdentifier=Zne;function iH(r,e){return r.parentRequest===null?!1:r.parentRequest.serviceIdentifier===e?!0:iH(r.parentRequest,e)}function eie(r){function e(n,i){i===void 0&&(i=[]);var o=nH(n.serviceIdentifier);return i.push(o),n.parentRequest!==null?e(n.parentRequest,i):i}var t=e(r);return t.reverse().join(" --> ")}function oH(r){r.childRequests.forEach(function(e){if(iH(e,e.serviceIdentifier)){var t=eie(e);throw new Error(Xne.CIRCULAR_DEPENDENCY+" "+t)}else oH(e)})}Hn.circularDependencyToException=oH;function tie(r,e){if(e.isTagged()||e.isNamed()){var t="",n=e.getNamedTag(),i=e.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(o){t+=o.toString()+`
`})," "+r+`
 `+r+" - "+t}else return" "+r}Hn.listMetadataForTarget=tie;function sH(r){if(r.name)return r.name;var e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}Hn.getFunctionName=sH;function rie(r){return r.toString().slice(7,-1)}Hn.getSymbolDescription=rie});var aH=Q(MP=>{"use strict";d();Object.defineProperty(MP,"__esModule",{value:!0});MP.Context=void 0;var nie=Ap(),iie=function(){function r(e){this.id=(0,nie.id)(),this.container=e}return r.prototype.addPlan=function(e){this.plan=e},r.prototype.setCurrentRequest=function(e){this.currentRequest=e},r}();MP.Context=iie});var nl=Q(yc=>{"use strict";d();var oie=yc&&yc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),sie=yc&&yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),aie=yc&&yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&oie(e,r,t);return sie(e,r),e};Object.defineProperty(yc,"__esModule",{value:!0});yc.Metadata=void 0;var lie=aie(Bn()),cie=function(){function r(e,t){this.key=e,this.value=t}return r.prototype.toString=function(){return this.key===lie.NAMED_TAG?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},r}();yc.Metadata=cie});var lH=Q(OP=>{"use strict";d();Object.defineProperty(OP,"__esModule",{value:!0});OP.Plan=void 0;var uie=function(){function r(e,t){this.parentContext=e,this.rootRequest=t}return r}();OP.Plan=uie});var hL=Q(LP=>{"use strict";d();Object.defineProperty(LP,"__esModule",{value:!0});LP.LazyServiceIdentifer=void 0;var die=function(){function r(e){this._cb=e}return r.prototype.unwrap=function(){return this._cb()},r}();LP.LazyServiceIdentifer=die});var cH=Q(KP=>{"use strict";d();Object.defineProperty(KP,"__esModule",{value:!0});KP.QueryableString=void 0;var pie=function(){function r(e){this.str=e}return r.prototype.startsWith=function(e){return this.str.indexOf(e)===0},r.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},r.prototype.contains=function(e){return this.str.indexOf(e)!==-1},r.prototype.equals=function(e){return this.str===e},r.prototype.value=function(){return this.str},r}();KP.QueryableString=pie});var gL=Q(bc=>{"use strict";d();var fie=bc&&bc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),mie=bc&&bc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),hie=bc&&bc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&fie(e,r,t);return mie(e,r),e};Object.defineProperty(bc,"__esModule",{value:!0});bc.Target=void 0;var Gu=hie(Bn()),gie=Ap(),vie=ny(),uH=nl(),yie=cH(),bie=function(){function r(e,t,n,i){this.id=(0,gie.id)(),this.type=e,this.serviceIdentifier=n;var o=typeof t=="symbol"?(0,vie.getSymbolDescription)(t):t;this.name=new yie.QueryableString(o||""),this.identifier=t,this.metadata=new Array;var s=null;typeof i=="string"?s=new uH.Metadata(Gu.NAMED_TAG,i):i instanceof uH.Metadata&&(s=i),s!==null&&this.metadata.push(s)}return r.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===e)return!0}return!1},r.prototype.isArray=function(){return this.hasTag(Gu.MULTI_INJECT_TAG)},r.prototype.matchesArray=function(e){return this.matchesTag(Gu.MULTI_INJECT_TAG)(e)},r.prototype.isNamed=function(){return this.hasTag(Gu.NAMED_TAG)},r.prototype.isTagged=function(){return this.metadata.some(function(e){return Gu.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})})},r.prototype.isOptional=function(){return this.matchesTag(Gu.OPTIONAL_TAG)(!0)},r.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===Gu.NAMED_TAG})[0]:null},r.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return Gu.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})}):null},r.prototype.matchesNamedTag=function(e){return this.matchesTag(Gu.NAMED_TAG)(e)},r.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var s=o[i];if(s.key===e&&s.value===n)return!0}return!1}},r}();bc.Target=bie});var yH=Q(Xi=>{"use strict";d();var Iie=Xi&&Xi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Sie=Xi&&Xi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),dH=Xi&&Xi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Iie(e,r,t);return Sie(e,r),e},FP=Xi&&Xi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(Xi,"__esModule",{value:!0});Xi.getFunctionName=Xi.getBaseClassDependencyCount=Xi.getDependencies=void 0;var _ie=hL(),vL=dH(Qi()),pH=rl(),$E=dH(Bn()),yL=ny();Object.defineProperty(Xi,"getFunctionName",{enumerable:!0,get:function(){return yL.getFunctionName}});var fH=gL();function Eie(r,e){var t=(0,yL.getFunctionName)(e);return mH(r,t,e,!1)}Xi.getDependencies=Eie;function mH(r,e,t,n){var i=r.getConstructorMetadata(t),o=i.compilerGeneratedMetadata;if(o===void 0){var s=vL.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(s)}var a=i.userGeneratedMetadata,l=Object.keys(a),c=t.length===0&&l.length>0,u=l.length>t.length,p=c||u?l.length:t.length,f=wie(n,e,o,a,p),m=hH(r,t,e),h=FP(FP([],f,!0),m,!0);return h}function Cie(r,e,t,n,i){var o=i[r.toString()]||[],s=vH(o),a=s.unmanaged!==!0,l=n[r],c=s.inject||s.multiInject;if(l=c||l,l instanceof _ie.LazyServiceIdentifer&&(l=l.unwrap()),a){var u=l===Object,p=l===Function,f=l===void 0,m=u||p||f;if(!e&&m){var h=vL.MISSING_INJECT_ANNOTATION+" argument "+r+" in class "+t+".";throw new Error(h)}var g=new fH.Target(pH.TargetTypeEnum.ConstructorArgument,s.targetName,l);return g.metadata=o,g}return null}function wie(r,e,t,n,i){for(var o=[],s=0;s<i;s++){var a=s,l=Cie(a,r,e,t,n);l!==null&&o.push(l)}return o}function xie(r,e,t,n){var i=r||e;if(i===void 0){var o=vL.MISSING_INJECTABLE_ANNOTATION+" for property "+String(t)+" in class "+n+".";throw new Error(o)}return i}function hH(r,e,t){for(var n=r.getPropertiesMetadata(e),i=[],o=Object.getOwnPropertySymbols(n),s=Object.keys(n),a=s.concat(o),l=0,c=a;l<c.length;l++){var u=c[l],p=n[u],f=vH(p),m=f.targetName||u,h=xie(f.inject,f.multiInject,u,t),g=new fH.Target(pH.TargetTypeEnum.ClassProperty,m,h);g.metadata=p,i.push(g)}var v=Object.getPrototypeOf(e.prototype).constructor;if(v!==Object){var I=hH(r,v,t);i=FP(FP([],i,!0),I,!0)}return i}function gH(r,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var n=(0,yL.getFunctionName)(t),i=mH(r,n,t,!0),o=i.map(function(l){return l.metadata.filter(function(c){return c.key===$E.UNMANAGED_TAG})}),s=[].concat.apply([],o).length,a=i.length-s;return a>0?a:gH(r,t)}else return 0}Xi.getBaseClassDependencyCount=gH;function vH(r){var e={};return r.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[$E.INJECT_TAG],multiInject:e[$E.MULTI_INJECT_TAG],targetName:e[$E.NAME_TAG],unmanaged:e[$E.UNMANAGED_TAG]}}});var bH=Q(UP=>{"use strict";d();Object.defineProperty(UP,"__esModule",{value:!0});UP.Request=void 0;var Die=Ap(),Pie=function(){function r(e,t,n,i,o){this.id=(0,Die.id)(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return r.prototype.addChildRequest=function(e,t,n){var i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i},r}();UP.Request=Pie});var EL=Q($o=>{"use strict";d();var Tie=$o&&$o.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kie=$o&&$o.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),_H=$o&&$o.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Tie(e,r,t);return kie(e,r),e};Object.defineProperty($o,"__esModule",{value:!0});$o.getBindingDictionary=$o.createMockRequest=$o.plan=void 0;var WP=tH(),IL=_H(Qi()),EH=rl(),IH=_H(Bn()),Nie=mL(),iy=ny(),CH=aH(),SL=nl(),Rie=lH(),bL=yH(),_L=bH(),wH=gL();function xH(r){return r._bindingDictionary}$o.getBindingDictionary=xH;function Aie(r,e,t,n,i,o){var s=r?IH.MULTI_INJECT_TAG:IH.INJECT_TAG,a=new SL.Metadata(s,t),l=new wH.Target(e,n,t,a);if(i!==void 0){var c=new SL.Metadata(i,o);l.metadata.push(c)}return l}function SH(r,e,t,n,i){var o=zE(t.container,i.serviceIdentifier),s=[];return o.length===WP.BindingCount.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),o=zE(t.container,i.serviceIdentifier)),e?s=o:s=o.filter(function(a){var l=new _L.Request(a.serviceIdentifier,t,n,a,i);return a.constraint(l)}),Mie(i.serviceIdentifier,s,i,t.container),s}function Mie(r,e,t,n){switch(e.length){case WP.BindingCount.NoBindingsAvailable:if(t.isOptional())return e;var i=(0,iy.getServiceIdentifierAsString)(r),o=IL.NOT_REGISTERED;throw o+=(0,iy.listMetadataForTarget)(i,t),o+=(0,iy.listRegisteredBindingsForServiceIdentifier)(n,i,zE),new Error(o);case WP.BindingCount.OnlyOneBindingAvailable:return e;case WP.BindingCount.MultipleBindingsAvailable:default:if(t.isArray())return e;var i=(0,iy.getServiceIdentifierAsString)(r),o=IL.AMBIGUOUS_MATCH+" "+i;throw o+=(0,iy.listRegisteredBindingsForServiceIdentifier)(n,i,zE),new Error(o)}}function DH(r,e,t,n,i,o){var s,a;if(i===null){s=SH(r,e,n,null,o),a=new _L.Request(t,n,null,s,o);var l=new Rie.Plan(n,a);n.addPlan(l)}else s=SH(r,e,n,i,o),a=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach(function(c){var u=null;if(o.isArray())u=a.addChildRequest(c.serviceIdentifier,c,o);else{if(c.cache)return;u=a}if(c.type===EH.BindingTypeEnum.Instance&&c.implementationType!==null){var p=(0,bL.getDependencies)(r,c.implementationType);if(!n.container.options.skipBaseClassChecks){var f=(0,bL.getBaseClassDependencyCount)(r,c.implementationType);if(p.length<f){var m=IL.ARGUMENTS_LENGTH_MISMATCH((0,bL.getFunctionName)(c.implementationType));throw new Error(m)}}p.forEach(function(h){DH(r,!1,h.serviceIdentifier,n,u,h)})}})}function zE(r,e){var t=[],n=xH(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=zE(r.parent,e)),t}function Oie(r,e,t,n,i,o,s,a){a===void 0&&(a=!1);var l=new CH.Context(e),c=Aie(t,n,i,"",o,s);try{return DH(r,a,i,l,null,c),l}catch(u){throw(0,Nie.isStackOverflowExeption)(u)&&(0,iy.circularDependencyToException)(l.plan.rootRequest),u}}$o.plan=Oie;function Lie(r,e,t,n){var i=new wH.Target(EH.TargetTypeEnum.Variable,"",e,new SL.Metadata(t,n)),o=new CH.Context(r),s=new _L.Request(e,o,null,[],i);return s}$o.createMockRequest=Lie});var QE=Q(oy=>{"use strict";d();Object.defineProperty(oy,"__esModule",{value:!0});oy.isPromiseOrContainsPromise=oy.isPromise=void 0;function CL(r){var e=typeof r=="object"&&r!==null||typeof r=="function";return e&&typeof r.then=="function"}oy.isPromise=CL;function Kie(r){return CL(r)?!0:Array.isArray(r)&&r.some(CL)}oy.isPromiseOrContainsPromise=Kie});var PH=Q(Ic=>{"use strict";d();var Fie=Ic&&Ic.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(p){s(p)}}function l(u){try{c(n.throw(u))}catch(p){s(p)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},Uie=Ic&&Ic.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.saveToScope=Ic.tryGetFromScope=void 0;var VP=re(),Wie=QE(),Vie=function(r,e){return e.scope===VP.BindingScopeEnum.Singleton&&e.activated?e.cache:e.scope===VP.BindingScopeEnum.Request&&r.has(e.id)?r.get(e.id):null};Ic.tryGetFromScope=Vie;var jie=function(r,e,t){e.scope===VP.BindingScopeEnum.Singleton&&Hie(e,t),e.scope===VP.BindingScopeEnum.Request&&Bie(r,e,t)};Ic.saveToScope=jie;var Bie=function(r,e,t){r.has(e.id)||r.set(e.id,t)},Hie=function(r,e){r.cache=e,r.activated=!0,(0,Wie.isPromise)(e)&&Jie(r,e)},Jie=function(r,e){return Fie(void 0,void 0,void 0,function(){var t,n;return Uie(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return t=i.sent(),r.cache=t,[3,3];case 2:throw n=i.sent(),r.cache=null,r.activated=!1,n;case 3:return[2]}})})}});var TH=Q(XE=>{"use strict";d();Object.defineProperty(XE,"__esModule",{value:!0});XE.FactoryType=void 0;var qie;(function(r){r.DynamicValue="toDynamicValue",r.Factory="toFactory",r.Provider="toProvider"})(qie=XE.FactoryType||(XE.FactoryType={}))});var xL=Q(zo=>{"use strict";d();var Gie=zo&&zo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yie=zo&&zo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$ie=zo&&zo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Gie(e,r,t);return Yie(e,r),e};Object.defineProperty(zo,"__esModule",{value:!0});zo.getFactoryDetails=zo.ensureFullyBound=zo.multiBindToService=void 0;var zie=re(),Qie=$ie(Qi()),Sc=rl(),wL=TH(),Xie=function(r){return function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(i){return r.bind(i).toService(e)})}}};zo.multiBindToService=Xie;var Zie=function(r){var e=null;switch(r.type){case Sc.BindingTypeEnum.ConstantValue:case Sc.BindingTypeEnum.Function:e=r.cache;break;case Sc.BindingTypeEnum.Constructor:case Sc.BindingTypeEnum.Instance:e=r.implementationType;break;case Sc.BindingTypeEnum.DynamicValue:e=r.dynamicValue;break;case Sc.BindingTypeEnum.Provider:e=r.provider;break;case Sc.BindingTypeEnum.Factory:e=r.factory;break}if(e===null){var t=(0,zie.getServiceIdentifierAsString)(r.serviceIdentifier);throw new Error(Qie.INVALID_BINDING_TYPE+" "+t)}};zo.ensureFullyBound=Zie;var eoe=function(r){switch(r.type){case Sc.BindingTypeEnum.Factory:return{factory:r.factory,factoryType:wL.FactoryType.Factory};case Sc.BindingTypeEnum.Provider:return{factory:r.provider,factoryType:wL.FactoryType.Provider};case Sc.BindingTypeEnum.DynamicValue:return{factory:r.dynamicValue,factoryType:wL.FactoryType.DynamicValue};default:throw new Error("Unexpected factory type "+r.type)}};zo.getFactoryDetails=eoe});var OH=Q(bi=>{"use strict";d();var sy=bi&&bi.__assign||function(){return sy=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},sy.apply(this,arguments)},toe=bi&&bi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),roe=bi&&bi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),noe=bi&&bi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&toe(e,r,t);return roe(e,r),e},RH=bi&&bi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(p){s(p)}}function l(u){try{c(n.throw(u))}catch(p){s(p)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},AH=bi&&bi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},ioe=bi&&bi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(bi,"__esModule",{value:!0});bi.resolveInstance=void 0;var DL=Qi(),TL=rl(),PL=noe(Bn()),kL=QE();function ooe(r,e){return r.reduce(function(t,n){var i=e(n),o=n.target.type;return o===TL.TargetTypeEnum.ConstructorArgument?t.constructorInjections.push(i):(t.propertyRequests.push(n),t.propertyInjections.push(i)),t.isAsync||(t.isAsync=(0,kL.isPromiseOrContainsPromise)(i)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function soe(r,e,t){var n;if(e.length>0){var i=ooe(e,t),o=sy(sy({},i),{constr:r});i.isAsync?n=aoe(o):n=MH(o)}else n=new r;return n}function MH(r){var e,t=new((e=r.constr).bind.apply(e,ioe([void 0],r.constructorInjections,!1)));return r.propertyRequests.forEach(function(n,i){var o=n.target.identifier,s=r.propertyInjections[i];t[o]=s}),t}function aoe(r){return RH(this,void 0,void 0,function(){var e,t;return AH(this,function(n){switch(n.label){case 0:return[4,kH(r.constructorInjections)];case 1:return e=n.sent(),[4,kH(r.propertyInjections)];case 2:return t=n.sent(),[2,MH(sy(sy({},r),{constructorInjections:e,propertyInjections:t}))]}})})}function kH(r){return RH(this,void 0,void 0,function(){var e,t,n,i;return AH(this,function(o){for(e=[],t=0,n=r;t<n.length;t++)i=n[t],Array.isArray(i)?e.push(Promise.all(i)):e.push(i);return[2,Promise.all(e)]})})}function NH(r,e){var t=loe(r,e);return(0,kL.isPromise)(t)?t.then(function(){return e}):e}function loe(r,e){var t,n;if(Reflect.hasMetadata(PL.POST_CONSTRUCT,r)){var i=Reflect.getMetadata(PL.POST_CONSTRUCT,r);try{return(n=(t=e)[i.value])===null||n===void 0?void 0:n.call(t)}catch(o){throw new Error((0,DL.POST_CONSTRUCT_ERROR)(r.name,o.message))}}}function coe(r,e){r.scope!==TL.BindingScopeEnum.Singleton&&uoe(r,e)}function uoe(r,e){var t="Class cannot be instantiated in "+(r.scope===TL.BindingScopeEnum.Request?"request":"transient")+" scope.";if(typeof r.onDeactivation=="function")throw new Error((0,DL.ON_DEACTIVATION_ERROR)(e.name,t));if(Reflect.hasMetadata(PL.PRE_DESTROY,e))throw new Error((0,DL.PRE_DESTROY_ERROR)(e.name,t))}function doe(r,e,t,n){coe(r,e);var i=soe(e,t,n);return(0,kL.isPromise)(i)?i.then(function(o){return NH(e,o)}):NH(e,i)}bi.resolveInstance=doe});var WH=Q(Qo=>{"use strict";d();var poe=Qo&&Qo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),foe=Qo&&Qo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),moe=Qo&&Qo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&poe(e,r,t);return foe(e,r),e},hoe=Qo&&Qo.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(p){s(p)}}function l(u){try{c(n.throw(u))}catch(p){s(p)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},goe=Qo&&Qo.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(Qo,"__esModule",{value:!0});Qo.resolve=void 0;var voe=moe(Qi()),jP=rl(),yoe=EL(),LH=PH(),NL=QE(),FH=xL(),boe=mL(),Ioe=OH(),RL=function(r){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),o=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(i&&o)return n.map(function(a){var l=RL(r);return l(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return Coe(r,e,s)}},Soe=function(r,e){var t=(0,FH.getFactoryDetails)(r);return(0,boe.tryAndThrowErrorIfStackOverflow)(function(){return t.factory.bind(r)(e)},function(){return new Error(voe.CIRCULAR_DEPENDENCY_IN_FACTORY(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},_oe=function(r,e,t){var n,i=e.childRequests;switch((0,FH.ensureFullyBound)(t),t.type){case jP.BindingTypeEnum.ConstantValue:case jP.BindingTypeEnum.Function:n=t.cache;break;case jP.BindingTypeEnum.Constructor:n=t.implementationType;break;case jP.BindingTypeEnum.Instance:n=(0,Ioe.resolveInstance)(t,t.implementationType,i,RL(r));break;default:n=Soe(t,e.parentContext)}return n},Eoe=function(r,e,t){var n=(0,LH.tryGetFromScope)(r,e);return n!==null||(n=t(),(0,LH.saveToScope)(r,e,n)),n},Coe=function(r,e,t){return Eoe(r,t,function(){var n=_oe(r,e,t);return(0,NL.isPromise)(n)?n=n.then(function(i){return KH(e,t,i)}):n=KH(e,t,n),n})};function KH(r,e,t){var n=woe(r.parentContext,e,t),i=Poe(r.parentContext.container),o,s=i.next();do{o=s.value;var a=r.parentContext,l=r.serviceIdentifier,c=Doe(o,l);(0,NL.isPromise)(n)?n=UH(c,a,n):n=xoe(c,a,n),s=i.next()}while(s.done!==!0&&!(0,yoe.getBindingDictionary)(o).hasKey(r.serviceIdentifier));return n}var woe=function(r,e,t){var n;return typeof e.onActivation=="function"?n=e.onActivation(r,t):n=t,n},xoe=function(r,e,t){for(var n=r.next();!n.done;){if(t=n.value(e,t),(0,NL.isPromise)(t))return UH(r,e,t);n=r.next()}return t},UH=function(r,e,t){return hoe(void 0,void 0,void 0,function(){var n,i;return goe(this,function(o){switch(o.label){case 0:return[4,t];case 1:n=o.sent(),i=r.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(e,n)];case 3:return n=o.sent(),i=r.next(),[3,2];case 4:return[2,n]}})})},Doe=function(r,e){var t=r._activations;return t.hasKey(e)?t.get(e).values():[].values()},Poe=function(r){for(var e=[r],t=r.parent;t!==null;)e.push(t),t=t.parent;var n=function(){var o=e.pop();return o!==void 0?{done:!1,value:o}:{done:!0,value:void 0}},i={next:n};return i};function Toe(r){var e=RL(r.plan.rootRequest.requestScope);return e(r.plan.rootRequest)}Qo.resolve=Toe});var AL=Q(Zi=>{"use strict";d();var koe=Zi&&Zi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Noe=Zi&&Zi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Roe=Zi&&Zi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&koe(e,r,t);return Noe(e,r),e};Object.defineProperty(Zi,"__esModule",{value:!0});Zi.typeConstraint=Zi.namedConstraint=Zi.taggedConstraint=Zi.traverseAncerstors=void 0;var Aoe=Roe(Bn()),Moe=nl(),VH=function(r,e){var t=r.parentRequest;return t!==null?e(t)?!0:VH(t,e):!1};Zi.traverseAncerstors=VH;var jH=function(r){return function(e){var t=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(r)(e)};return t.metaData=new Moe.Metadata(r,e),t}};Zi.taggedConstraint=jH;var Ooe=jH(Aoe.NAMED_TAG);Zi.namedConstraint=Ooe;var Loe=function(r){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof r=="string"){var n=t.serviceIdentifier;return n===r}else{var i=e.bindings[0].implementationType;return r===i}return!1}};Zi.typeConstraint=Loe});var HP=Q(BP=>{"use strict";d();Object.defineProperty(BP,"__esModule",{value:!0});BP.BindingWhenSyntax=void 0;var Eo=JP(),ti=AL(),Koe=function(){function r(e){this._binding=e}return r.prototype.when=function(e){return this._binding.constraint=e,new Eo.BindingOnSyntax(this._binding)},r.prototype.whenTargetNamed=function(e){return this._binding.constraint=(0,ti.namedConstraint)(e),new Eo.BindingOnSyntax(this._binding)},r.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return!1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=(0,ti.taggedConstraint)(e)(t),new Eo.BindingOnSyntax(this._binding)},r.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ti.typeConstraint)(e)(t.parentRequest)},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ti.namedConstraint)(e)(t.parentRequest)},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,ti.taggedConstraint)(e)(t)(n.parentRequest)},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ti.traverseAncerstors)(t,(0,ti.typeConstraint)(e))},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,ti.traverseAncerstors)(t,(0,ti.typeConstraint)(e))},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ti.traverseAncerstors)(t,(0,ti.namedConstraint)(e))},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,ti.traverseAncerstors)(t,(0,ti.namedConstraint)(e))},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,ti.traverseAncerstors)(n,(0,ti.taggedConstraint)(e)(t))},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&!(0,ti.traverseAncerstors)(n,(0,ti.taggedConstraint)(e)(t))},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ti.traverseAncerstors)(t,e)},new Eo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,ti.traverseAncerstors)(t,e)},new Eo.BindingOnSyntax(this._binding)},r}();BP.BindingWhenSyntax=Koe});var JP=Q(qP=>{"use strict";d();Object.defineProperty(qP,"__esModule",{value:!0});qP.BindingOnSyntax=void 0;var BH=HP(),Foe=function(){function r(e){this._binding=e}return r.prototype.onActivation=function(e){return this._binding.onActivation=e,new BH.BindingWhenSyntax(this._binding)},r.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new BH.BindingWhenSyntax(this._binding)},r}();qP.BindingOnSyntax=Foe});var ML=Q(GP=>{"use strict";d();Object.defineProperty(GP,"__esModule",{value:!0});GP.BindingWhenOnSyntax=void 0;var Uoe=JP(),Woe=HP(),Voe=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Woe.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Uoe.BindingOnSyntax(this._binding)}return r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();GP.BindingWhenOnSyntax=Voe});var HH=Q(YP=>{"use strict";d();Object.defineProperty(YP,"__esModule",{value:!0});YP.BindingInSyntax=void 0;var OL=rl(),LL=ML(),joe=function(){function r(e){this._binding=e}return r.prototype.inRequestScope=function(){return this._binding.scope=OL.BindingScopeEnum.Request,new LL.BindingWhenOnSyntax(this._binding)},r.prototype.inSingletonScope=function(){return this._binding.scope=OL.BindingScopeEnum.Singleton,new LL.BindingWhenOnSyntax(this._binding)},r.prototype.inTransientScope=function(){return this._binding.scope=OL.BindingScopeEnum.Transient,new LL.BindingWhenOnSyntax(this._binding)},r}();YP.BindingInSyntax=joe});var JH=Q($P=>{"use strict";d();Object.defineProperty($P,"__esModule",{value:!0});$P.BindingInWhenOnSyntax=void 0;var Boe=HH(),Hoe=JP(),Joe=HP(),qoe=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Joe.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Hoe.BindingOnSyntax(this._binding),this._bindingInSyntax=new Boe.BindingInSyntax(e)}return r.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},r.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},r.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();$P.BindingInWhenOnSyntax=qoe});var YH=Q(_c=>{"use strict";d();var Goe=_c&&_c.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yoe=_c&&_c.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$oe=_c&&_c.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Goe(e,r,t);return Yoe(e,r),e};Object.defineProperty(_c,"__esModule",{value:!0});_c.BindingToSyntax=void 0;var qH=$oe(Qi()),Co=rl(),GH=JH(),ay=ML(),zoe=function(){function r(e){this._binding=e}return r.prototype.to=function(e){return this._binding.type=Co.BindingTypeEnum.Instance,this._binding.implementationType=e,new GH.BindingInWhenOnSyntax(this._binding)},r.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+qH.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},r.prototype.toConstantValue=function(e){return this._binding.type=Co.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Co.BindingScopeEnum.Singleton,new ay.BindingWhenOnSyntax(this._binding)},r.prototype.toDynamicValue=function(e){return this._binding.type=Co.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new GH.BindingInWhenOnSyntax(this._binding)},r.prototype.toConstructor=function(e){return this._binding.type=Co.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=Co.BindingScopeEnum.Singleton,new ay.BindingWhenOnSyntax(this._binding)},r.prototype.toFactory=function(e){return this._binding.type=Co.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=Co.BindingScopeEnum.Singleton,new ay.BindingWhenOnSyntax(this._binding)},r.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(qH.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=Co.BindingTypeEnum.Function,this._binding.scope=Co.BindingScopeEnum.Singleton,t},r.prototype.toAutoFactory=function(e){return this._binding.type=Co.BindingTypeEnum.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(e)};return n},this._binding.scope=Co.BindingScopeEnum.Singleton,new ay.BindingWhenOnSyntax(this._binding)},r.prototype.toAutoNamedFactory=function(e){return this._binding.type=Co.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new ay.BindingWhenOnSyntax(this._binding)},r.prototype.toProvider=function(e){return this._binding.type=Co.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=Co.BindingScopeEnum.Singleton,new ay.BindingWhenOnSyntax(this._binding)},r.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},r}();_c.BindingToSyntax=zoe});var $H=Q(zP=>{"use strict";d();Object.defineProperty(zP,"__esModule",{value:!0});zP.ContainerSnapshot=void 0;var Qoe=function(){function r(){}return r.of=function(e,t,n,i,o){var s=new r;return s.bindings=e,s.middleware=t,s.deactivations=i,s.activations=n,s.moduleActivationStore=o,s},r}();zP.ContainerSnapshot=Qoe});var zH=Q(QP=>{"use strict";d();Object.defineProperty(QP,"__esModule",{value:!0});QP.isClonable=void 0;function Xoe(r){return typeof r=="object"&&r!==null&&"clone"in r&&typeof r.clone=="function"}QP.isClonable=Xoe});var KL=Q(Ec=>{"use strict";d();var Zoe=Ec&&Ec.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ese=Ec&&Ec.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),tse=Ec&&Ec.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Zoe(e,r,t);return ese(e,r),e};Object.defineProperty(Ec,"__esModule",{value:!0});Ec.Lookup=void 0;var Bm=tse(Qi()),rse=zH(),nse=function(){function r(){this._map=new Map}return r.prototype.getMap=function(){return this._map},r.prototype.add=function(e,t){if(e==null)throw new Error(Bm.NULL_ARGUMENT);if(t==null)throw new Error(Bm.NULL_ARGUMENT);var n=this._map.get(e);n!==void 0?n.push(t):this._map.set(e,[t])},r.prototype.get=function(e){if(e==null)throw new Error(Bm.NULL_ARGUMENT);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(Bm.KEY_NOT_FOUND)},r.prototype.remove=function(e){if(e==null)throw new Error(Bm.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(Bm.KEY_NOT_FOUND)},r.prototype.removeIntersection=function(e){var t=this;this.traverse(function(n,i){var o=e.hasKey(n)?e.get(n):void 0;if(o!==void 0){var s=i.filter(function(a){return!o.some(function(l){return a===l})});t._setValue(n,s)}})},r.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach(function(i,o){for(var s=[],a=0,l=i;a<l.length;a++){var c=l[a],u=e(c);u?n.push(c):s.push(c)}t._setValue(o,s)}),n},r.prototype.hasKey=function(e){if(e==null)throw new Error(Bm.NULL_ARGUMENT);return this._map.has(e)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){t.forEach(function(i){return e.add(n,(0,rse.isClonable)(i)?i.clone():i)})}),e},r.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t)})},r.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},r}();Ec.Lookup=nse});var XH=Q(XP=>{"use strict";d();Object.defineProperty(XP,"__esModule",{value:!0});XP.ModuleActivationStore=void 0;var QH=KL(),ise=function(){function r(){this._map=new Map}return r.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},r.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},r.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e},r.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},r.prototype._getEmptyHandlersStore=function(){var e={onActivations:new QH.Lookup,onDeactivations:new QH.Lookup};return e},r}();XP.ModuleActivationStore=ise});var FL=Q(Ii=>{"use strict";d();var eT=Ii&&Ii.__assign||function(){return eT=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},eT.apply(this,arguments)},ose=Ii&&Ii.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),sse=Ii&&Ii.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ZH=Ii&&Ii.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&ose(e,r,t);return sse(e,r),e},da=Ii&&Ii.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(p){s(p)}}function l(u){try{c(n.throw(u))}catch(p){s(p)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},pa=Ii&&Ii.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},ase=Ii&&Ii.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(Ii,"__esModule",{value:!0});Ii.Container=void 0;var lse=eH(),il=ZH(Qi()),ly=rl(),Hm=ZH(Bn()),cse=fL(),ZP=EL(),use=WH(),dse=YH(),Jm=QE(),pse=Ap(),fse=ny(),mse=$H(),ZE=KL(),hse=XH(),gse=function(){function r(e){var t=e||{};if(typeof t!="object")throw new Error(""+il.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(t.defaultScope===void 0)t.defaultScope=ly.BindingScopeEnum.Transient;else if(t.defaultScope!==ly.BindingScopeEnum.Singleton&&t.defaultScope!==ly.BindingScopeEnum.Transient&&t.defaultScope!==ly.BindingScopeEnum.Request)throw new Error(""+il.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+il.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+il.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=(0,pse.id)(),this._bindingDictionary=new ZE.Lookup,this._snapshots=[],this._middleware=null,this._activations=new ZE.Lookup,this._deactivations=new ZE.Lookup,this.parent=null,this._metadataReader=new cse.MetadataReader,this._moduleActivationStore=new hse.ModuleActivationStore}return r.merge=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new r,s=ase([e,t],n,!0).map(function(c){return(0,ZP.getBindingDictionary)(c)}),a=(0,ZP.getBindingDictionary)(o);function l(c,u){c.traverse(function(p,f){f.forEach(function(m){u.add(m.serviceIdentifier,m.clone())})})}return s.forEach(function(c){l(c,a)}),o},r.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var s=o[i],a=n(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},r.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return da(this,void 0,void 0,function(){var n,i,o,s,a;return pa(this,function(l){switch(l.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,o=e,l.label=1;case 1:return i<o.length?(s=o[i],a=n(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:l.sent(),l.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},r.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach(function(i){var o=e._removeModuleBindings(i.id);e._deactivateSingletons(o),e._removeModuleHandlers(i.id)})},r.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return da(this,void 0,void 0,function(){var n,i,o,s;return pa(this,function(a){switch(a.label){case 0:n=0,i=e,a.label=1;case 1:return n<i.length?(o=i[n],s=this._removeModuleBindings(o.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(o.id),a.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.bind=function(e){var t=this.options.defaultScope||ly.BindingScopeEnum.Transient,n=new lse.Binding(e,t);return this._bindingDictionary.add(e,n),new dse.BindingToSyntax(n)},r.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},r.prototype.rebindAsync=function(e){return da(this,void 0,void 0,function(){return pa(this,function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},r.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},r.prototype.unbindAsync=function(e){return da(this,void 0,void 0,function(){var t;return pa(this,function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},r.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,n){e._deactivateSingletons(n)}),this._bindingDictionary=new ZE.Lookup},r.prototype.unbindAllAsync=function(){return da(this,void 0,void 0,function(){var e,t=this;return pa(this,function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse(function(i,o){e.push(t._deactivateSingletonsAsync(o))}),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new ZE.Lookup,[2]}})})},r.prototype.onActivation=function(e,t){this._activations.add(e,t)},r.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},r.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},r.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},r.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,Hm.NAMED_TAG,t)},r.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),s=(0,ZP.createMockRequest)(this,e,t,n);i=o.some(function(a){return a.constraint(s)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},r.prototype.snapshot=function(){this._snapshots.push(mse.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},r.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(il.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},r.prototype.createChild=function(e){var t=new r(e||this.options);return t.parent=this,t},r.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(i,o){return o(i)},n)},r.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},r.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},r.prototype.getAsync=function(e){return da(this,void 0,void 0,function(){var t;return pa(this,function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},r.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},r.prototype.getTaggedAsync=function(e,t,n){return da(this,void 0,void 0,function(){var i;return pa(this,function(o){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]})})},r.prototype.getNamed=function(e,t){return this.getTagged(e,Hm.NAMED_TAG,t)},r.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,Hm.NAMED_TAG,t)},r.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},r.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},r.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},r.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},r.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,Hm.NAMED_TAG,t)},r.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,Hm.NAMED_TAG,t)},r.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},r.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(Hm.PRE_DESTROY,e)){var n=Reflect.getMetadata(Hm.PRE_DESTROY,e);return t[n.value]()}},r.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},r.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},r.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var o=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if((0,Jm.isPromise)(o))return this._handleDeactivationError(o.then(function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)}),i)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if((0,Jm.isPromise)(s))return this._handleDeactivationError(s,i)}catch(a){throw new Error(il.ON_DEACTIVATION_ERROR(i.name,a.message))}},r.prototype._handleDeactivationError=function(e,t){return da(this,void 0,void 0,function(){var n;return pa(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:throw n=i.sent(),new Error(il.ON_DEACTIVATION_ERROR(t.name,n.message));case 3:return[2]}})})},r.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var o=i.value(e);if((0,Jm.isPromise)(o))return o.then(function(){return n._deactivateContainerAsync(e,t)});i=t.next()}},r.prototype._deactivateContainerAsync=function(e,t){return da(this,void 0,void 0,function(){var n;return pa(this,function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}})})},r.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(u,p){u._binding.moduleId=p},n=function(u){return function(p){var f=e.bind(p);return t(f,u),f}},i=function(){return function(u){return e.unbind(u)}},o=function(){return function(u){return e.unbindAsync(u)}},s=function(){return function(u){return e.isBound(u)}},a=function(u){return function(p){var f=e.rebind(p);return t(f,u),f}},l=function(u){return function(p,f){e._moduleActivationStore.addActivation(u,p,f),e.onActivation(p,f)}},c=function(u){return function(p,f){e._moduleActivationStore.addDeactivation(u,p,f),e.onDeactivation(p,f)}};return function(u){return{bindFunction:n(u),isboundFunction:s(),onActivationFunction:l(u),onDeactivationFunction:c(u),rebindFunction:a(u),unbindFunction:i(),unbindAsyncFunction:o()}}},r.prototype._getAll=function(e){return Promise.all(this._get(e))},r.prototype._get=function(e){var t=eT(eT({},e),{contextInterceptor:function(i){return i},targetType:ly.TargetTypeEnum.Variable});if(this._middleware){var n=this._middleware(t);if(n==null)throw new Error(il.INVALID_MIDDLEWARE_RETURN);return n}return this._planAndResolve()(t)},r.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if((0,Jm.isPromiseOrContainsPromise)(t))throw new Error(il.LAZY_IN_SYNC(e.serviceIdentifier));return t},r.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},r.prototype._getNotAllArgs=function(e,t,n,i){var o={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i};return o},r.prototype._planAndResolve=function(){var e=this;return function(t){var n=(0,ZP.plan)(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=(0,use.resolve)(n);return i}},r.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return(0,Jm.isPromise)(e.cache)?e.cache.then(function(n){return t._deactivate(e,n)}):this._deactivate(e,e.cache)},r.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],o=this._deactivateIfSingleton(i);if((0,Jm.isPromise)(o))throw new Error(il.ASYNC_UNBIND_REQUIRED)}},r.prototype._deactivateSingletonsAsync=function(e){return da(this,void 0,void 0,function(){var t=this;return pa(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(i){return t._deactivateIfSingleton(i)}))];case 1:return n.sent(),[2]}})})},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return da(this,void 0,void 0,function(){return pa(this,function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},r.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(il.CANNOT_UNBIND+" "+(0,fse.getServiceIdentifierAsString)(e))}},r.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if(typeof e.onDeactivation=="function"){var o=e.onDeactivation(t);if((0,Jm.isPromise)(o))return o.then(function(){return i._preDestroy(n,t)})}return this._preDestroy(n,t)},r.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return da(this,void 0,void 0,function(){return pa(this,function(i){switch(i.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}})})},r}();Ii.Container=gse});var t7=Q(cy=>{"use strict";d();Object.defineProperty(cy,"__esModule",{value:!0});cy.AsyncContainerModule=cy.ContainerModule=void 0;var e7=Ap(),vse=function(){function r(e){this.id=(0,e7.id)(),this.registry=e}return r}();cy.ContainerModule=vse;var yse=function(){function r(e){this.id=(0,e7.id)(),this.registry=e}return r}();cy.AsyncContainerModule=yse});var r7=Q(tT=>{"use strict";d();Object.defineProperty(tT,"__esModule",{value:!0});tT.getFirstArrayDuplicate=void 0;function bse(r){for(var e=new Set,t=0,n=r;t<n.length;t++){var i=n[t];if(e.has(i))return i;e.add(i)}}tT.getFirstArrayDuplicate=bse});var Yu=Q(eo=>{"use strict";d();var Ise=eo&&eo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Sse=eo&&eo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),i7=eo&&eo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ise(e,r,t);return Sse(e,r),e};Object.defineProperty(eo,"__esModule",{value:!0});eo.createTaggedDecorator=eo.tagProperty=eo.tagParameter=eo.decorate=void 0;var rT=i7(Qi()),o7=i7(Bn()),_se=r7();function Ese(r){return r.prototype!==void 0}function Cse(r){if(r!==void 0)throw new Error(rT.INVALID_DECORATOR_OPERATION)}function s7(r,e,t,n){Cse(e),l7(o7.TAGGED,r,t.toString(),n)}eo.tagParameter=s7;function a7(r,e,t){if(Ese(r))throw new Error(rT.INVALID_DECORATOR_OPERATION);l7(o7.TAGGED_PROP,r.constructor,e,t)}eo.tagProperty=a7;function wse(r){var e=[];if(Array.isArray(r)){e=r;var t=(0,_se.getFirstArrayDuplicate)(e.map(function(n){return n.key}));if(t!==void 0)throw new Error(rT.DUPLICATED_METADATA+" "+t.toString())}else e=[r];return e}function l7(r,e,t,n){var i=wse(n),o={};Reflect.hasOwnMetadata(r,e)&&(o=Reflect.getMetadata(r,e));var s=o[t];if(s===void 0)s=[];else for(var a=function(p){if(i.some(function(f){return f.key===p.key}))throw new Error(rT.DUPLICATED_METADATA+" "+p.key.toString())},l=0,c=s;l<c.length;l++){var u=c[l];a(u)}s.push.apply(s,i),o[t]=s,Reflect.defineMetadata(r,o,e)}function xse(r){return function(e,t,n){typeof n=="number"?s7(e,t,n,r):a7(e,t,r)}}eo.createTaggedDecorator=xse;function n7(r,e){Reflect.decorate(r,e)}function Dse(r,e){return function(t,n){e(t,n,r)}}function Pse(r,e,t){typeof t=="number"?n7([Dse(t,r)],e):typeof t=="string"?Reflect.decorate([r],e,t):n7([r],e)}eo.decorate=Pse});var u7=Q(Cc=>{"use strict";d();var Tse=Cc&&Cc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kse=Cc&&Cc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),c7=Cc&&Cc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Tse(e,r,t);return kse(e,r),e};Object.defineProperty(Cc,"__esModule",{value:!0});Cc.injectable=void 0;var Nse=c7(Qi()),UL=c7(Bn());function Rse(){return function(r){if(Reflect.hasOwnMetadata(UL.PARAM_TYPES,r))throw new Error(Nse.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(UL.DESIGN_PARAM_TYPES,r)||[];return Reflect.defineMetadata(UL.PARAM_TYPES,e,r),r}}Cc.injectable=Rse});var d7=Q(nT=>{"use strict";d();Object.defineProperty(nT,"__esModule",{value:!0});nT.tagged=void 0;var Ase=nl(),Mse=Yu();function Ose(r,e){return(0,Mse.createTaggedDecorator)(new Ase.Metadata(r,e))}nT.tagged=Ose});var p7=Q(wc=>{"use strict";d();var Lse=wc&&wc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Kse=wc&&wc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Fse=wc&&wc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Lse(e,r,t);return Kse(e,r),e};Object.defineProperty(wc,"__esModule",{value:!0});wc.named=void 0;var Use=Fse(Bn()),Wse=nl(),Vse=Yu();function jse(r){return(0,Vse.createTaggedDecorator)(new Wse.Metadata(Use.NAMED_TAG,r))}wc.named=jse});var WL=Q(iT=>{"use strict";d();Object.defineProperty(iT,"__esModule",{value:!0});iT.injectBase=void 0;var Bse=Qi(),Hse=nl(),Jse=Yu();function qse(r){return function(e){return function(t,n,i){if(e===void 0){var o=typeof t=="function"?t.name:t.constructor.name;throw new Error((0,Bse.UNDEFINED_INJECT_ANNOTATION)(o))}return(0,Jse.createTaggedDecorator)(new Hse.Metadata(r,e))(t,n,i)}}}iT.injectBase=qse});var f7=Q(xc=>{"use strict";d();var Gse=xc&&xc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yse=xc&&xc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$se=xc&&xc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Gse(e,r,t);return Yse(e,r),e};Object.defineProperty(xc,"__esModule",{value:!0});xc.inject=void 0;var zse=$se(Bn()),Qse=WL(),Xse=(0,Qse.injectBase)(zse.INJECT_TAG);xc.inject=Xse});var m7=Q(Dc=>{"use strict";d();var Zse=Dc&&Dc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),eae=Dc&&Dc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),tae=Dc&&Dc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Zse(e,r,t);return eae(e,r),e};Object.defineProperty(Dc,"__esModule",{value:!0});Dc.optional=void 0;var rae=tae(Bn()),nae=nl(),iae=Yu();function oae(){return(0,iae.createTaggedDecorator)(new nae.Metadata(rae.OPTIONAL_TAG,!0))}Dc.optional=oae});var h7=Q(Pc=>{"use strict";d();var sae=Pc&&Pc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),aae=Pc&&Pc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),lae=Pc&&Pc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&sae(e,r,t);return aae(e,r),e};Object.defineProperty(Pc,"__esModule",{value:!0});Pc.unmanaged=void 0;var cae=lae(Bn()),uae=nl(),dae=Yu();function pae(){return function(r,e,t){var n=new uae.Metadata(cae.UNMANAGED_TAG,!0);(0,dae.tagParameter)(r,e,t,n)}}Pc.unmanaged=pae});var g7=Q(Tc=>{"use strict";d();var fae=Tc&&Tc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),mae=Tc&&Tc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),hae=Tc&&Tc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&fae(e,r,t);return mae(e,r),e};Object.defineProperty(Tc,"__esModule",{value:!0});Tc.multiInject=void 0;var gae=hae(Bn()),vae=WL(),yae=(0,vae.injectBase)(gae.MULTI_INJECT_TAG);Tc.multiInject=yae});var v7=Q(kc=>{"use strict";d();var bae=kc&&kc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Iae=kc&&kc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Sae=kc&&kc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&bae(e,r,t);return Iae(e,r),e};Object.defineProperty(kc,"__esModule",{value:!0});kc.targetName=void 0;var _ae=Sae(Bn()),Eae=nl(),Cae=Yu();function wae(r){return function(e,t,n){var i=new Eae.Metadata(_ae.NAME_TAG,r);(0,Cae.tagParameter)(e,t,n,i)}}kc.targetName=wae});var VL=Q(oT=>{"use strict";d();Object.defineProperty(oT,"__esModule",{value:!0});oT.propertyEventDecorator=void 0;var xae=nl();function Dae(r,e){return function(){return function(t,n){var i=new xae.Metadata(r,n);if(Reflect.hasOwnMetadata(r,t.constructor))throw new Error(e);Reflect.defineMetadata(r,i,t.constructor)}}}oT.propertyEventDecorator=Dae});var b7=Q(Nc=>{"use strict";d();var Pae=Nc&&Nc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Tae=Nc&&Nc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),y7=Nc&&Nc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Pae(e,r,t);return Tae(e,r),e};Object.defineProperty(Nc,"__esModule",{value:!0});Nc.postConstruct=void 0;var kae=y7(Qi()),Nae=y7(Bn()),Rae=VL(),Aae=(0,Rae.propertyEventDecorator)(Nae.POST_CONSTRUCT,kae.MULTIPLE_POST_CONSTRUCT_METHODS);Nc.postConstruct=Aae});var S7=Q(Rc=>{"use strict";d();var Mae=Rc&&Rc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Oae=Rc&&Rc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),I7=Rc&&Rc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Mae(e,r,t);return Oae(e,r),e};Object.defineProperty(Rc,"__esModule",{value:!0});Rc.preDestroy=void 0;var Lae=I7(Qi()),Kae=I7(Bn()),Fae=VL(),Uae=(0,Fae.propertyEventDecorator)(Kae.PRE_DESTROY,Lae.MULTIPLE_PRE_DESTROY_METHODS);Rc.preDestroy=Uae});var _7=Q(sT=>{"use strict";d();Object.defineProperty(sT,"__esModule",{value:!0});sT.interfaces=void 0;var jL;jL||(jL={});sT.interfaces=jL});var re=Q(qe=>{"use strict";d();var Wae=qe&&qe.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Vae=qe&&qe.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jae=qe&&qe.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Wae(e,r,t);return Vae(e,r),e};Object.defineProperty(qe,"__esModule",{value:!0});qe.multiBindToService=qe.getServiceIdentifierAsString=qe.typeConstraint=qe.namedConstraint=qe.taggedConstraint=qe.traverseAncerstors=qe.decorate=qe.interfaces=qe.id=qe.MetadataReader=qe.preDestroy=qe.postConstruct=qe.targetName=qe.multiInject=qe.unmanaged=qe.optional=qe.LazyServiceIdentifer=qe.inject=qe.named=qe.tagged=qe.injectable=qe.createTaggedDecorator=qe.ContainerModule=qe.AsyncContainerModule=qe.TargetTypeEnum=qe.BindingTypeEnum=qe.BindingScopeEnum=qe.Container=qe.METADATA_KEY=void 0;var Bae=jae(Bn());qe.METADATA_KEY=Bae;var Hae=FL();Object.defineProperty(qe,"Container",{enumerable:!0,get:function(){return Hae.Container}});var BL=rl();Object.defineProperty(qe,"BindingScopeEnum",{enumerable:!0,get:function(){return BL.BindingScopeEnum}});Object.defineProperty(qe,"BindingTypeEnum",{enumerable:!0,get:function(){return BL.BindingTypeEnum}});Object.defineProperty(qe,"TargetTypeEnum",{enumerable:!0,get:function(){return BL.TargetTypeEnum}});var E7=t7();Object.defineProperty(qe,"AsyncContainerModule",{enumerable:!0,get:function(){return E7.AsyncContainerModule}});Object.defineProperty(qe,"ContainerModule",{enumerable:!0,get:function(){return E7.ContainerModule}});var Jae=Yu();Object.defineProperty(qe,"createTaggedDecorator",{enumerable:!0,get:function(){return Jae.createTaggedDecorator}});var qae=u7();Object.defineProperty(qe,"injectable",{enumerable:!0,get:function(){return qae.injectable}});var Gae=d7();Object.defineProperty(qe,"tagged",{enumerable:!0,get:function(){return Gae.tagged}});var Yae=p7();Object.defineProperty(qe,"named",{enumerable:!0,get:function(){return Yae.named}});var $ae=f7();Object.defineProperty(qe,"inject",{enumerable:!0,get:function(){return $ae.inject}});var zae=hL();Object.defineProperty(qe,"LazyServiceIdentifer",{enumerable:!0,get:function(){return zae.LazyServiceIdentifer}});var Qae=m7();Object.defineProperty(qe,"optional",{enumerable:!0,get:function(){return Qae.optional}});var Xae=h7();Object.defineProperty(qe,"unmanaged",{enumerable:!0,get:function(){return Xae.unmanaged}});var Zae=g7();Object.defineProperty(qe,"multiInject",{enumerable:!0,get:function(){return Zae.multiInject}});var ele=v7();Object.defineProperty(qe,"targetName",{enumerable:!0,get:function(){return ele.targetName}});var tle=b7();Object.defineProperty(qe,"postConstruct",{enumerable:!0,get:function(){return tle.postConstruct}});var rle=S7();Object.defineProperty(qe,"preDestroy",{enumerable:!0,get:function(){return rle.preDestroy}});var nle=fL();Object.defineProperty(qe,"MetadataReader",{enumerable:!0,get:function(){return nle.MetadataReader}});var ile=Ap();Object.defineProperty(qe,"id",{enumerable:!0,get:function(){return ile.id}});var ole=_7();Object.defineProperty(qe,"interfaces",{enumerable:!0,get:function(){return ole.interfaces}});var sle=Yu();Object.defineProperty(qe,"decorate",{enumerable:!0,get:function(){return sle.decorate}});var aT=AL();Object.defineProperty(qe,"traverseAncerstors",{enumerable:!0,get:function(){return aT.traverseAncerstors}});Object.defineProperty(qe,"taggedConstraint",{enumerable:!0,get:function(){return aT.taggedConstraint}});Object.defineProperty(qe,"namedConstraint",{enumerable:!0,get:function(){return aT.namedConstraint}});Object.defineProperty(qe,"typeConstraint",{enumerable:!0,get:function(){return aT.typeConstraint}});var ale=ny();Object.defineProperty(qe,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return ale.getServiceIdentifierAsString}});var lle=xL();Object.defineProperty(qe,"multiBindToService",{enumerable:!0,get:function(){return lle.multiBindToService}})});var k7=Q(Mp=>{"use strict";d();Object.defineProperty(Mp,"__esModule",{value:!0});Mp.PythonExtension=Mp.PVSC_EXTENSION_ID=void 0;var ule=require("vscode");Mp.PVSC_EXTENSION_ID="ms-python.python";var dle;(function(r){async function e(){let t=ule.extensions.getExtension(Mp.PVSC_EXTENSION_ID);if(t===void 0)throw new Error("Python extension is not installed or is disabled");return t.isActive||await t.activate(),t.exports}r.api=e})(dle=Mp.PythonExtension||(Mp.PythonExtension={}))});var V7=Q((gy,W7)=>{"use strict";d();var hle=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof zu!="undefined")return zu;throw new Error("unable to locate global object")},zu=hle();W7.exports=gy=zu.fetch;zu.fetch&&(gy.default=zu.fetch.bind(zu));gy.Headers=zu.Headers;gy.Request=zu.Request;gy.Response=zu.Response});var j7=Q(iC=>{d();iC.get=function(r){var e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;var t={},n=Error.prepareStackTrace;Error.prepareStackTrace=function(o,s){return s},Error.captureStackTrace(t,r||iC.get);var i=t.stack;return Error.prepareStackTrace=n,Error.stackTraceLimit=e,i};iC.parse=function(r){if(!r.stack)return[];var e=this,t=r.stack.split(`
`).slice(1);return t.map(function(n){if(n.match(/^\s*[-]{4,}$/))return e._createParsedCallSite({fileName:n,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null});var i=n.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(i){var o=null,s=null,a=null,l=null,c=null,u=i[5]==="native";if(i[1]){a=i[1];var p=a.lastIndexOf(".");if(a[p-1]=="."&&p--,p>0){o=a.substr(0,p),s=a.substr(p+1);var f=o.indexOf(".Module");f>0&&(a=a.substr(f+1),o=o.substr(0,f))}l=null}s&&(l=o,c=s),s==="<anonymous>"&&(c=null,a=null);var m={fileName:i[2]||null,lineNumber:parseInt(i[3],10)||null,functionName:a,typeName:l,methodName:c,columnNumber:parseInt(i[4],10)||null,native:u};return e._createParsedCallSite(m)}}).filter(function(n){return!!n})};function nC(r){for(var e in r)this[e]=r[e]}var gle=["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"],vle=["topLevel","eval","native","constructor"];gle.forEach(function(r){nC.prototype[r]=null,nC.prototype["get"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});vle.forEach(function(r){nC.prototype[r]=!1,nC.prototype["is"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});iC._createParsedCallSite=function(r){return new nC(r)}});var an,ht,nr,Vt,sC,Pr,ma,al,fT,Do,dr,mT=te(()=>{d();an="function",ht="object",nr="undefined",Vt="prototype",sC="hasOwnProperty",Pr=Object,ma=Pr[Vt],al=Pr.assign,fT=Pr.create,Do=Pr.defineProperty,dr=ma[sC]});function Jn(r){r===void 0&&(r=!0);var e=r===!1?null:z7;return e||(typeof globalThis!==nr&&(e=globalThis),!e&&typeof self!==nr&&(e=self),!e&&typeof window!==nr&&(e=window),!e&&typeof this!==nr&&(e=this),z7=e),e}function ha(r){throw new TypeError(r)}function Po(r){var e=fT;if(e)return e(r);if(r==null)return{};var t=typeof r;t!==ht&&t!==an&&ha("Object prototype may only be an Object:"+r);function n(){}return n[Vt]=r,new n}var z7,XL=te(()=>{d();mT();z7=null});function Cn(r,e){typeof e!==an&&e!==null&&ha("Class extends value "+String(e)+" is not a constructor or null"),ZL(r,e);function t(){this.constructor=r}r[Vt]=e===null?Po(e):(t[Vt]=e[Vt],new t)}function Gm(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r}var S1e,_1e,xle,To,ZL,Q7=te(()=>{d();mT();XL();S1e=(Jn()||{}).Symbol,_1e=(Jn()||{}).Reflect,xle=function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)ma[sC].call(e,i)&&(r[i]=e[i])}return r},To=al||xle,ZL=function(r,e){return ZL=Pr.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n[sC](i)&&(t[i]=n[i])},ZL(r,e)}});var X7=te(()=>{d()});var pr=te(()=>{d();mT();XL();Q7();X7()});var eK,Z7=te(()=>{"use strict";d();eK=100});var ll,Mi,aC,cl,jt,Ns,Ac,hT,Zo,ot,Ym,Hr,gT,$m,zm,tK,lC,Qm,by,cC,Qu,Rs,Iy,Fp,ul,Sy,Xm,As,ga,Up,Xu,vT,Wp,dl,_y,Vp,uC,jp,yT,Ey,pl,rK,nK,bT,qn,es,dC,Zm,pC,eh,fl,IT,th,Cy,Bp,fC,Nn=te(()=>{d();ll="initialize",Mi="name",aC="getNotifyMgr",cl="identifier",jt="push",Ns="isInitialized",Ac="config",hT="instrumentationKey",Zo="logger",ot="length",Ym="time",Hr="processNext",gT="getProcessTelContext",$m="addNotificationListener",zm="removeNotificationListener",tK="stopPollingInternalLogs",lC="onComplete",Qm="getPlugin",by="flush",cC="_extensions",Qu="splice",Rs="teardown",Iy="messageId",Fp="message",ul="isAsync",Sy="_doTeardown",Xm="update",As="getNext",ga="diagLog",Up="setNextPlugin",Xu="createNew",vT="cookieCfg",Wp="indexOf",dl="substring",_y="userAgent",Vp="split",uC="setEnabled",jp="substr",yT="nodeType",Ey="apply",pl="replace",rK="enableDebugExceptions",nK="logInternalMessage",bT="toLowerCase",qn="call",es="type",dC="handler",Zm="listeners",pC="isChildEvt",eh="getCtx",fl="setCtx",IT="complete",th="traceId",Cy="spanId",Bp="traceFlags",fC="version"});var gt,iK,mn,oK,mC,wy,e5,ts,va,xy,Hp,Dy,Jp,ST,hC,rh,Si=te(()=>{d();gt="",iK="channels",mn="core",oK="createPerfMgr",mC="disabled",wy="extensionConfig",e5="extensions",ts="processTelemetry",va="priority",xy="eventsSent",Hp="eventsDiscarded",Dy="eventsSendRequest",Jp="perfEvent",ST="errorToConsole",hC="warnToConsole",rh="getPerfMgr"});function Ule(r){if(r){if(ET)return ET(r);var e=r[Dle]||r[Vt]||r[_T];if(e)return e}return null}function Py(r,e){return typeof r===e}function gr(r){return r===void 0||typeof r===nr}function xt(r){return r===null||gr(r)}function dK(r){return!xt(r)}function Zu(r,e){return!!(r&&dr[qn](r,e))}function Oi(r){return!!(r&&typeof r===ht)}function Zt(r){return!!(r&&typeof r===an)}function nh(r){var e=r;return e&&hn(e)&&(e=e[pl](Lle,function(t,n){return n.toUpperCase()}),e=e[pl](Kle,"_"),e=e[pl](Fle,function(t,n){return"_"+n})),e}function Jr(r,e){if(r)for(var t in r)dr[qn](r,t)&&e[qn](r,t,r[t])}function ih(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=kle?r[c5](e):Wle(r,e)),t}function Wle(r,e){var t=!1,n=e?e[ot]:0,i=r?r[ot]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Ty(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=Nle?r[u5](e):Vle(r,e)),t}function Vle(r,e){var t=!1,n=e?e[ot]:0;if(r&&n&&r[ot]>=n&&!(t=r===e)){for(var i=0;i<n;i++)if(r[i]!==e[i])return!1;t=!0}return t}function Rn(r,e){return r&&e?r[Wp](e)!==-1:!1}function ky(r){return!!(r&&uK[qn](r)==="[object Date]")}function jle(r){return!!(r&&uK[qn](r)==="[object Array]")}function oh(r){return!!(r&&uK[qn](r)==="[object Error]")}function hn(r){return typeof r=="string"}function rs(r){return typeof r=="number"}function ed(r){return typeof r=="boolean"}function s5(r){var e=!1;if(r&&typeof r=="object"){var t=ET?ET(r):Ule(r);t?(t[_T]&&dr[qn](t,_T)&&(t=t[_T]),e=typeof t===an&&p5[qn](t)===Ole):e=!0}return e}function ya(r){if(r)return Ale?r[l5]():Ble(r)}function Ble(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[ot]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function je(r,e,t){var n=r[ot];try{for(var i=0;i<n&&!(i in r&&e[qn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function ni(r,e,t){if(r){if(r[t5])return r[t5](e,t);var n=r[ot],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function sh(r,e,t){var n;if(r){if(r[r5])return r[r5](e,t);var i=r[ot],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[qn](o,r[s],r))}catch(a){}}return n}function ah(r,e,t){var n;if(r){if(r[n5])return r[n5](e,t);var i=r[ot],o=0;if(arguments[ot]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function qr(r){return r&&(r=Tle&&r[aK]?r[aK]():r[pl]?r[pl](/^\s+|(?=\s)\s+$/g,gt):r),r}function ko(r){var e=typeof r;if(e!==an&&(e!==ht||r===null)&&ha("objKeys called on non-object"),!a5&&o5)return o5(r);var t=[];for(var n in r)r&&dr[qn](r,n)&&t[jt](n);if(a5)for(var i=sK[ot],o=0;o<i;o++)r&&dr[qn](r,sK[o])&&t[jt](sK[o]);return t}function Ms(r,e,t,n){if(i5)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),i5(r,e,i),!0}catch(o){}return!1}function f5(r){return r}function pK(r){return lK&&Jr(r,function(e,t){(bt(t)||Oi(t))&&lK(t)}),ns(r)}function ii(){var r=Date;return r.now?r.now():new r().getTime()}function lh(r){return oh(r)?r[Mi]:gt}function is(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function qp(r,e,t){var n;return r?(n=r[e],!n&&xt(n)&&(n=gr(t)?{}:t,r[e]=n)):n=gr(t)?{}:t,n}function ba(r,e){return xt(r)?e:r}function mK(r){return!r}function Ny(r){return!!r}function oi(r){throw new Error(r)}function m5(r,e){var t=null,n=null;return Zt(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][Ey](n,i)}}function hK(r,e,t){if(r&&e&&Oi(r)&&Oi(e)){var n=function(o){if(hn(o)){var s=e[o];Zt(s)?(!t||t(o,!0,e,r))&&(r[o]=m5(e,o)):(!t||t(o,!1,e,r))&&(Zu(r,o)&&delete r[o],Ms(r,o,function(){return e[o]},function(a){e[o]=a})||(r[o]=s))}};for(var i in e)n(i)}return r}function Gp(r,e,t,n,i){r&&e&&t&&(i!==!1||gr(r[e]))&&(r[e]=m5(t,n))}function ch(r,e,t,n){return r&&e&&Oi(r)&&bt(t)&&je(t,function(i){hn(i)&&Gp(r,i,e,i,n)}),r}function td(r){return r&&al&&(r=Pr(al({},r))),r}function Ry(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[ot],c=!1,u=1;for(l>0&&ed(a)&&(c=a,a=s[u]||{},u++),Oi(a)||(a={});u<l;u++){var p=s[u],f=bt(p),m=Oi(p);for(var h in p){var g=f&&h in p||m&&dr[qn](p,h);if(g){var v=p[h],I=void 0;if(c&&v&&((I=bt(v))||s5(v))){var S=a[h];I?bt(S)||(S=[]):s5(S)||(S={}),v=Ry(c,S,v)}v!==void 0&&(a[h]=v)}}}return a}var l5,c5,u5,t5,r5,n5,aK,d5,Dle,_T,i5,lK,Ple,o5,cK,Tle,kle,Nle,Rle,Ale,Mle,uK,p5,Ole,Lle,Kle,Fle,ET,bt,a5,sK,ns,fK,An=te(()=>{d();pr();Nn();Si();l5="toISOString",c5="endsWith",u5="startsWith",t5="indexOf",r5="map",n5="reduce",aK="trim",d5="toString",Dle="__proto__",_T="constructor",i5=Do,lK=Pr.freeze,Ple=Pr.seal,o5=Pr.keys,cK=String[Vt],Tle=cK[aK],kle=cK[c5],Nle=cK[u5],Rle=Date[Vt],Ale=Rle[l5],Mle=Array.isArray,uK=ma[d5],p5=dr[d5],Ole=p5[qn](Pr),Lle=/-([a-z])/g,Kle=/([^\w\d_$])/g,Fle=/^(\d+[\w\d_$])/,ET=Object.getPrototypeOf;bt=Mle||jle;a5=!{toString:null}.propertyIsEnumerable("toString"),sK=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];ns=lK||f5,fK=Ple||f5});function No(r){var e={};return Jr(r,function(t,n){e[t]=n,e[n]=t}),pK(e)}var CT=te(()=>{d();An()});var ml,h5=te(()=>{d();CT();ml=No({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5})});function Jle(){var r;return typeof globalThis!==xT&&(r=globalThis),!r&&typeof self!==xT&&(r=self),!r&&typeof window!==xT&&(r=window),!r&&typeof this!==xT&&(r=this),r||{}}function nd(r,e){return r&&MT[rd].hasOwnProperty.call(r,e)}function _5(r){return r&&(r===MT[rd]||r===Array[rd])}function _K(r){return _5(r)||r===Function[rd]}function uh(r){var e;if(r){if(vC)return vC(r);var t=r[S5]||r[rd]||(r[TT]?r[TT][rd]:null);e=r[DT]||t,nd(r,DT)||(delete r[gK],e=r[DT]=r[gK]||r[DT],r[gK]=t)}return e}function RT(r,e){var t=[];if(y5)t=y5(r);else for(var n in r)typeof n=="string"&&nd(r,n)&&t.push(n);if(t&&t.length>0)for(var i=0;i<t.length;i++)e(t[i])}function EK(r,e,t){return e!==TT&&typeof r[e]===kT&&(t||nd(r,e))}function AT(r){throw new TypeError("DynamicProto: "+r)}function qle(r){var e={};return RT(r,function(t){!e[t]&&EK(r,t,!1)&&(e[t]=r[t])}),e}function CK(r,e){for(var t=r.length-1;t>=0;t--)if(r[t]===e)return!0;return!1}function Gle(r,e,t,n){function i(l,c,u){var p=c[u];if(p[yK]&&n){var f=l[NT]||{};f[gC]!==!1&&(p=(f[c[Ay]]||{})[u]||p)}return function(){return p.apply(l,arguments)}}var o={};RT(t,function(l){o[l]=i(e,t,l)});for(var s=uh(r),a=[];s&&!_K(s)&&!CK(a,s);)RT(s,function(l){!o[l]&&EK(s,l,!vC)&&(o[l]=i(e,s,l))}),a.push(s),s=uh(s);return o}function Yle(r,e,t,n){var i=null;if(r&&nd(t,Ay)){var o=r[NT]||{};if(i=(o[t[Ay]]||{})[e],i||AT("Missing ["+e+"] "+kT),!i[bK]&&o[gC]!==!1){for(var s=!nd(r,e),a=uh(r),l=[];s&&a&&!_K(a)&&!CK(l,a);){var c=a[e];if(c){s=c===n;break}l.push(a),a=uh(a)}try{s&&(r[e]=i),i[bK]=1}catch(u){o[gC]=!1}}}return i}function $le(r,e,t){var n=e[r];return n===t&&(n=uh(e)[r]),typeof n!==kT&&AT("["+r+"] is not a "+kT),n}function zle(r,e,t,n,i){function o(l,c){var u=function(){var p=Yle(this,c,l,u)||$le(c,l,u);return p.apply(this,arguments)};return u[yK]=1,u}if(!_5(r)){var s=t[NT]=t[NT]||{},a=s[e]=s[e]||{};s[gC]!==!1&&(s[gC]=!!i),RT(t,function(l){EK(t,l,!1)&&t[l]!==n[l]&&(a[l]=t[l],delete t[l],(!nd(r,l)||r[l]&&!r[l][yK])&&(r[l]=o(r,l)))})}}function Qle(r,e){if(vC){for(var t=[],n=uh(e);n&&!_K(n)&&!CK(t,n);){if(n===r)return!0;t.push(n),n=uh(n)}return!1}return!0}function vK(r,e){return nd(r,rd)?r.name||e||g5:((r||{})[TT]||{}).name||e||g5}function Ge(r,e,t,n){nd(r,rd)||AT("theClass is an invalid class definition.");var i=r[rd];Qle(i,e)||AT("["+vK(r)+"] not in hierarchy of ["+vK(e)+"]");var o=null;nd(i,Ay)?o=i[Ay]:(o=Hle+vK(r,"_")+"$"+SK.n,SK.n++,i[Ay]=o);var s=Ge[I5],a=!!s[PT];a&&n&&n[PT]!==void 0&&(a=!!n[PT]);var l=qle(e),c=Gle(i,e,l,a);t(e,c);var u=!!vC&&!!s[IK];u&&n&&(u=!!n[IK]),zle(i,o,e,l,u!==!1)}var wT,xT,TT,rd,kT,NT,yK,Ay,Hle,bK,gC,I5,g5,S5,DT,v5,gK,PT,IK,MT,vC,y5,b5,SK,vr=te(()=>{d();xT="undefined",TT="constructor",rd="prototype",kT="function",NT="_dynInstFuncs",yK="_isDynProxy",Ay="_dynClass",Hle="_dynCls$",bK="_dynInstChk",gC=bK,I5="_dfOpts",g5="_unknown_",S5="__proto__",DT="_dyn"+S5,v5="__dynProto$Gbl",gK="_dynInstProto",PT="useBaseInst",IK="setInstFuncs",MT=Object,vC=MT.getPrototypeOf,y5=MT.getOwnPropertyNames;b5=Jle(),SK=b5[v5]||(b5[v5]={o:(wT={},wT[IK]=!0,wT[PT]=!0,wT),n:1e3});Ge[I5]=SK.o});function D5(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Vt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!gr(i[e])}catch(o){}}return t}function kK(r){x5=r}function gn(r){var e=Jn();return e&&e[r]?e[r]:r===E5&&yC()?window:null}function yC(){return!!(typeof window===ht&&window)}function Mc(){return yC()?window:gn(E5)}function OT(){return!!(typeof document===ht&&document)}function os(){return OT()?document:gn(Xle)}function bC(){return!!(typeof navigator===ht&&navigator)}function Os(){return bC()?navigator:gn(ece)}function LT(){return!!(typeof history===ht&&history)}function NK(){return LT()?history:gn(tce)}function dh(r){if(r&&x5){var e=gn("__mockLocation");if(e)return e}return typeof location===ht&&location?location:gn(rce)}function IC(){return typeof console!==nr?console:gn(nce)}function Oy(){return gn(ice)}function ph(){return!!(typeof JSON===ht&&JSON||gn(C5)!==null)}function Ly(){return ph()?JSON||gn(C5):null}function SC(){return gn(oce)}function _C(){return gn(sce)}function id(){var r=Os();return r&&r.product?r.product===ace:!1}function hl(){var r=Os();if(r&&(r[_y]!==xK||wK===null)){xK=r[_y];var e=(xK||gt)[bT]();wK=Rn(e,PK)||Rn(e,TK)}return wK}function RK(r){if(r===void 0&&(r=null),!r){var e=Os()||{};r=e?(e[_y]||gt)[bT]():gt}var t=(r||gt)[bT]();if(Rn(t,PK)){var n=os()||{};return Math.max(parseInt(t[Vp](PK)[1]),n[Zle]||0)}else if(Rn(t,TK)){var i=parseInt(t[Vp](TK)[1]);if(i)return i+4}return null}function ln(r){var e=Object[Vt].toString[qn](r),t=gt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Mi]+"'":ph()&&(t=Ly().stringify(r)),e+t}function Yp(){return DK===null&&(DK=bC()&&!!Os().sendBeacon),DK}function Ky(r){var e=!1;try{e=!!gn("fetch");var t=gn("Request");e&&r&&t&&(e=D5(t,"keepalive"))}catch(n){}return e}function fh(){return My===null&&(My=typeof XDomainRequest!==nr,My&&Fy()&&(My=My&&!D5(gn(w5),"withCredentials"))),My}function Fy(){var r=!1;try{var e=gn(w5);r=!!e}catch(t){}return r}function P5(r,e){if(r)for(var t=0;t<r[ot];t++){var n=r[t];if(n[Mi]&&n[Mi]===e)return n}return{}}function AK(r){var e=os();return e&&r?P5(e.querySelectorAll("meta"),r).content:null}function MK(r){var e,t=Oy();if(t){var n=t.getEntriesByType("navigation")||[];e=P5((n[ot]>0?n[0]:{}).serverTiming,r).description}return e}var E5,Xle,Zle,ece,tce,rce,nce,ice,C5,oce,sce,ace,PK,TK,w5,wK,xK,x5,My,DK,Ia=te(()=>{"use strict";d();pr();Nn();An();Si();E5="window",Xle="document",Zle="documentMode",ece="navigator",tce="history",rce="location",nce="console",ice="performance",C5="JSON",oce="crypto",sce="msCrypto",ace="ReactNative",PK="msie",TK="trident/",w5="XMLHttpRequest",wK=null,xK=null,x5=!1,My=null,DK=null});function lce(r,e){return function(){var t=arguments,n=LK(e);if(n){var i=n.listener;i&&i[r]&&i[r][Ey](i,t)}}}function cce(){var r=gn("Microsoft");return r&&(FT=r.ApplicationInsights),FT}function LK(r){var e=FT;return!e&&r.disableDbgExt!==!0&&(e=FT||cce()),e?e.ChromeDbgExt:null}function T5(r){if(!KT){KT={};for(var e=0;e<OK[ot];e++)KT[OK[e]]=lce(OK[e],r)}return KT}var OK,FT,KT,KK=te(()=>{d();Nn();Ia();OK=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],FT=null});function k5(r){return r?'"'+r[pl](/\"/g,gt)+'"':gt}function N5(r,e){var t=IC();if(t){var n="log";t[r]&&(n=r),Zt(t[n])&&t[n](e)}}function EC(r,e){return(r||{})[Zo]||new gl(e)}function FK(r){return r||new gl}function tn(r,e,t,n,i,o){o===void 0&&(o=!1),FK(r).throwInternal(e,t,n,i,o)}function vl(r,e){FK(r)[hC](e)}function UK(r,e,t){FK(r)[nK](e,t)}var uce,dce,pce,mh,gl,$p=te(()=>{"use strict";d();vr();Nn();KK();Ia();An();Si();uce="AI (Internal): ",dce="AI: ",pce="AITR_";mh=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Iy]=e,o[Fp]=(n?dce:uce)+e;var s=gt;ph()&&(s=Ly().stringify(i));var a=(t?" message:"+k5(t):gt)+(i?" props:"+k5(s):gt);o[Fp]+=a}return r.dataType="MessageData",r}();gl=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Ge(r,this,function(l){u(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[rK]=function(){return a},l.throwInternal=function(m,h,g,v,I){I===void 0&&(I=!1);var S=new mh(h,g,I,v);if(a)throw ln(S);var x=m===1?ST:hC;if(gr(S[Fp]))f("throw"+(m===1?"Critical":"Warning"),S);else{if(I){var D=+S[Iy];!n[D]&&i>=m&&(l[x](S[Fp]),n[D]=!0)}else i>=m&&l[x](S[Fp]);c(m,S)}},l[hC]=function(m){N5("warn",m),f("warning",m)},l[ST]=function(m){N5("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[nK]=c;function c(m,h){if(!p()){var g=!0,v=pce+h[Iy];if(n[v]?g=!1:n[v]=!0,g&&(m<=o&&(l.queue[jt](h),t++,f(m===1?"error":"warn",h)),t===s)){var I="Internal events throttle limit per PageView reached for this app.",S=new mh(23,I,!1);l.queue[jt](S),m===1?l[ST](I):l[hC](I)}}}function u(m){i=ba(m.loggingLevelConsole,0),o=ba(m.loggingLevelTelemetry,1),s=ba(m.maxMessageLimit,25),a=ba(m[rK],!1)}function p(){return t>=s}function f(m,h){var g=LK(e||{});g&&g[ga]&&g[ga](m,h)}})}return r.__ieDyn=1,r}()});function wn(r,e,t,n,i){if(r){var o=r;if(o[rh]&&(o=o[rh]()),o){var s=void 0,a=o[eh](WK);try{if(s=o.create(e(),n,i),s){if(a&&s[fl]&&(s[fl](hh[VK],a),a[eh]&&a[fl])){var l=a[eh](hh[CC]);l||(l=[],a[fl](hh[CC],l)),l[jt](s)}return o[fl](WK,s),t(s)}}catch(c){s&&s[fl]&&s[fl]("exception",c)}finally{s&&o.fire(s),o[fl](WK,a)}}}return t()}function jK(){return fce}var Uy,VK,CC,fce,hh,wC,WK,xC=te(()=>{d();vr();Nn();An();Si();Uy="ctx",VK="ParentContextKey",CC="ChildrenContextKey",fce=null,hh=function(){function r(e,t,n){var i=this,o=!1;if(i.start=ii(),i[Mi]=e,i[ul]=n,i[pC]=function(){return!1},Zt(t)){var s;o=Ms(i,"payload",function(){return!s&&Zt(t)&&(s=t(),t=null),s})}i[eh]=function(a){return a?a===r[VK]||a===r[CC]?i[a]:(i[Uy]||{})[a]:null},i[fl]=function(a,l){if(a)if(a===r[VK])i[a]||(i[pC]=function(){return!0}),i[a]=l;else if(a===r[CC])i[a]=l;else{var c=i[Uy]=i[Uy]||{};c[a]=l}},i[IT]=function(){var a=0,l=i[eh](r[CC]);if(bt(l))for(var c=0;c<l[ot];c++){var u=l[c];u&&(a+=u[Ym])}i[Ym]=ii()-i.start,i.exTime=i[Ym]-a,i[IT]=function(){},!o&&Zt(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),wC=function(){function r(e){this.ctx={},Ge(r,this,function(t){t.create=function(n,i,o){return new hh(n,i,o)},t.fire=function(n){n&&(n[IT](),e&&Zt(e[Jp])&&e[Jp](n))},t[fl]=function(n,i){if(n){var o=t[Uy]=t[Uy]||{};o[n]=i}},t[eh]=function(n){return(t[Uy]||{})[n]}})}return r.__ieDyn=1,r}(),WK="CoreUtils.doPerf"});function M5(r){r<0&&(r>>>=0),DC=123456789+r&zp,PC=987654321-r&zp,A5=!0}function O5(){try{var r=ii()&2147483647;M5((Math.random()*R5^r)+r)}catch(e){}}function Wy(r){return r>0?Math.floor(yl()/zp*(r+1))>>>0:0}function yl(r){var e=0,t=SC()||_C();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&zp),e===0&&hl()&&(A5||O5(),e=TC()&zp),e===0&&(e=Math.floor(R5*Math.random()|0)),r||(e>>>=0),e}function UT(r){r?M5(r):O5()}function TC(r){PC=36969*(PC&65535)+(PC>>16)&zp,DC=18e3*(DC&65535)+(DC>>16)&zp;var e=(PC<<16)+(DC&65535)>>>0&zp|0;return r||(e>>>=0),e}function Qp(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=yl()>>>0,n=0,i=gt;i[ot]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(yl()<<2&4294967295|t&3)>>>0,n=0);return i}var R5,zp,A5,DC,PC,WT=te(()=>{d();Nn();Ia();An();Si();R5=4294967296,zp=4294967295,A5=!1,DC=123456789,PC=987654321});function gce(r,e,t){if(L5)try{return L5(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function F5(r){return r[yT]===1||r[yT]===9||!+r[yT]}function vce(r,e){var t=e[r.id];if(!t){t={};try{F5(e)&&(gce(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function bl(r,e){return e===void 0&&(e=!1),nh(r+hce+++(e?"."+K5:gt)+mce)}function VT(r){var e={id:bl("_aiData-"+(r||gt)+"."+K5),accept:function(t){return F5(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[nh(n)]:(o&&(s=vce(e,t),s[nh(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var L5,K5,mce,hce,kC=te(()=>{d();pr();Nn();An();Si();WT();L5=Do,K5="2.8.10",mce="."+Qp(6),hce=0});function yce(r,e){var t=od[Xp]||HT[Xp];return t||(t=od[Xp]=od(r,e),HT[Xp]=t),t}function BT(r){return r?r.isEnabled():!0}function bce(r){var e=r[vT]=r[vT]||{};if(is(e,"domain",r.cookieDomain,dK,xt),is(e,"path",r.cookiePath||"/",null,xt),xt(e[JK])){var t=void 0;gr(r[V5])||(t=!r[V5]),gr(r[j5])||(t=!r[j5]),e[JK]=t}return e}function Y5(r,e){return e&&r&&bt(r.ignoreCookies)?r.ignoreCookies[Wp](e)!==-1:!1}function Ice(r,e){return e&&r&&bt(r.blockedCookies)&&r.blockedCookies[Wp](e)!==-1?!0:Y5(r,e)}function Zp(r,e){var t;if(r)t=r.getCookieMgr();else if(e){var n=e[vT];n[Xp]?t=n[Xp]:t=od(e)}return t||(t=yce(e,(r||{})[Zo])),t}function od(r,e){var t,n=bce(r||HT),i=n.path||"/",o=n.domain,s=n[JK]!==!1,a=(t={isEnabled:function(){var l=s&&Il(e),c=HT[Xp];return l&&c&&a!==c&&(l=BT(c)),l}},t[uC]=function(l){s=l!==!1},t.set=function(l,c,u,p,f){var m=!1;if(BT(a)&&!Ice(n,l)){var h={},g=qr(c||gt),v=g[Wp](";");if(v!==-1&&(g=qr(c[dl](0,v)),h=$5(c[dl](v+1))),is(h,"domain",p||o,Ny,gr),!xt(u)){var I=hl();if(gr(h[BK])){var S=ii(),x=S+u*1e3;if(x>0){var D=new Date;D.setTime(x),is(h,BK,J5(D,I?U5:W5)||J5(D,I?U5:W5)||gt,Ny)}}I||is(h,"max-age",gt+u,null,gr)}var A=dh();A&&A.protocol==="https:"&&(is(h,"secure",null,null,gr),HK===null&&(HK=!Vy((Os()||{})[_y])),HK&&is(h,"SameSite","None",null,gr)),is(h,"path",f||i,null,gr);var w=n.setCookie||G5;w(l,q5(g,h)),m=!0}return m},t.get=function(l){var c=gt;return BT(a)&&!Y5(n,l)&&(c=(n.getCookie||Sce)(l)),c},t.del=function(l,c){var u=!1;return BT(a)&&(u=a.purge(l,c)),u},t.purge=function(l,c){var u,p=!1;if(Il(e)){var f=(u={},u.path=c||"/",u[BK]="Thu, 01 Jan 1970 00:00:01 GMT",u);hl()||(f["max-age"]="0");var m=n.delCookie||G5;m(l,q5(gt,f)),p=!0}return p},t);return a[Xp]=a,a}function Il(r){if(jT===null){jT=!1;try{var e=NC||{};jT=e[qK]!==void 0}catch(t){tn(r,2,68,"Cannot access document.cookie - "+lh(t),{exception:ln(t)})}}return jT}function $5(r){var e={};if(r&&r[ot]){var t=qr(r)[Vp](";");je(t,function(n){if(n=qr(n||gt),n){var i=n[Wp]("=");i===-1?e[n]=null:e[qr(n[dl](0,i))]=qr(n[dl](i+1))}})}return e}function J5(r,e){return Zt(r[e])?r[e]():null}function q5(r,e){var t=r||gt;return Jr(e,function(n,i){t+="; "+n+(xt(i)?gt:"="+i)}),t}function Sce(r){var e=gt;if(NC){var t=NC[qK]||gt;B5!==t&&(H5=$5(t),B5=t),e=qr(H5[r]||gt)}return e}function G5(r,e){NC&&(NC[qK]=r+"="+e)}function Vy(r){return hn(r)?!!(Rn(r,"CPU iPhone OS 12")||Rn(r,"iPad; CPU OS 12")||Rn(r,"Macintosh; Intel Mac OS X 10_14")&&Rn(r,"Version/")&&Rn(r,"Safari")||Rn(r,"Macintosh; Intel Mac OS X 10_14")&&ih(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Rn(r,"Chrome/5")||Rn(r,"Chrome/6")||Rn(r,"UnrealEngine")&&!Rn(r,"Chrome")||Rn(r,"UCBrowser/12")||Rn(r,"UCBrowser/11")):!1}var U5,W5,qK,BK,JK,V5,j5,Xp,jT,HK,B5,NC,H5,HT,GK=te(()=>{d();Nn();$p();Ia();An();Si();U5="toGMTString",W5="toUTCString",qK="cookie",BK="expires",JK="enabled",V5="isCookieUseDisabled",j5="disableCookiesUsage",Xp="_ckMgr",jT=null,HK=null,B5=null,NC=os(),H5={},HT={}});function e8(r){return r&&r[pl]?r[pl](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,gt):r}function GT(r,e){var t;if(e){var n=gt;bt(e)?(n=gt,je(e,function(o){o=e8(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=e8(e),n&&(n[0]!=="."&&(n="."+n),r=(r||gt)+n)}var i=wce.exec(r||gt)||[];return t={},t[es]=i[1],t.ns=(i[2]||gt).replace(_ce,".").replace(Ece,gt)[Vp](".").sort().join("."),t}function YK(r,e,t){var n=[],i=AC.get(r,JT,{},!1),o=GT(e,t);return Jr(i,function(s,a){je(a,function(l){var c;(!o[es]||o[es]===l.evtName[es])&&(!o.ns||o.ns===o.ns)&&n[jt]((c={},c[Mi]=l.evtName[es]+(l.evtName.ns?"."+l.evtName.ns:gt),c.handler=l[dC],c))})}),n}function l8(r,e,t){t===void 0&&(t=!0);var n=AC.get(r,JT,{},t),i=n[e];return i||(i=n[e]=[]),i}function c8(r,e,t,n){r&&e&&e[es]&&(r[Z5]?r[Z5](e[es],t,n):r[X5]&&r[X5](r8+e[es],t))}function xce(r,e,t,n){var i=!1;return r&&e&&e[es]&&t&&(r[Q5]?(r[Q5](e[es],t,n),i=!0):r[z5]&&(r[z5](r8+e[es],t),i=!0)),i}function t8(r,e,t,n){for(var i=e[ot];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(c8(r,o.evtName,o[dC],o.capture),e[Qu](i,1))}}function Dce(r,e,t){if(e[es])t8(r,l8(r,e[es]),e,t);else{var n=AC.get(r,JT,{});Jr(n,function(i,o){t8(r,o,e,t)}),ko(n)[ot]===0&&AC.kill(r,JT)}}function sd(r,e){var t;return e?(bt(e)?t=[r].concat(e):t=[r,e],t=GT("xx",t).ns[Vp](".")):t=r,t}function gh(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=GT(e,n);if(s=xce(r,a,t,i),s&&AC.accept(r)){var l=(o={guid:Cce++,evtName:a},o[dC]=t,o.capture=i,o);l8(r,a.type)[jt](l)}}catch(c){}return s}function vh(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=GT(e,n),s=!1;Dce(r,o,function(a){return o.ns&&!t||a[dC]===t?(s=!0,!0):!1}),s||c8(r,o,t,i)}catch(a){}}function By(r,e,t,n){return n===void 0&&(n=!1),gh(r,e,t,null,n)}function Hy(r,e,t,n){n===void 0&&(n=!1),vh(r,e,t,null,n)}function tf(r,e,t){var n=!1,i=Mc();i&&(n=gh(i,r,e,t),n=gh(i.body,r,e,t)||n);var o=os();return o&&(n=gh(o,r,e,t)||n),n}function YT(r,e,t){var n=Mc();n&&(vh(n,r,e,t),vh(n.body,r,e,t));var i=os();i&&vh(i,r,e,t)}function jy(r,e,t,n){var i=!1;return e&&r&&r[ot]>0&&je(r,function(o){o&&(!t||ni(t,o)===-1)&&(i=tf(o,e,n)||i)}),i}function $T(r,e,t,n){var i=!1;return e&&r&&bt(r)&&(i=jy(r,e,t,n),!i&&t&&t[ot]>0&&(i=jy(r,e,null,n))),i}function ef(r,e,t){r&&bt(r)&&je(r,function(n){n&&YT(n,e,t)})}function yh(r,e,t){return $T([o8,i8,qT],r,e,t)}function MC(r,e){ef([o8,i8,qT],r,e)}function Jy(r,e,t){function n(s){var a=os();r&&a&&a.visibilityState==="hidden"&&r(s)}var i=sd(s8,t),o=jy([qT],r,e,i);return(!e||ni(e,RC)===-1)&&(o=jy([RC],n,e,i)||o),!o&&e&&(o=Jy(r,null,t)),o}function OC(r,e){var t=sd(s8,e);ef([qT],r,t),ef([RC],null,t)}function qy(r,e,t){function n(s){var a=os();r&&a&&a.visibilityState==="visible"&&r(s)}var i=sd(a8,t),o=jy([n8],r,e,i);return o=jy([RC],n,e,i)||o,!o&&e&&(o=qy(r,null,t)),o}function LC(r,e){var t=sd(a8,e);ef([n8],r,t),ef([RC],null,t)}var r8,z5,Q5,X5,Z5,JT,RC,qT,n8,i8,o8,s8,a8,_ce,Ece,Cce,AC,wce,$K=te(()=>{d();Nn();kC();Ia();An();Si();r8="on",z5="attachEvent",Q5="addEventListener",X5="detachEvent",Z5="removeEventListener",JT="events",RC="visibilitychange",qT="pagehide",n8="pageshow",i8="unload",o8="beforeunload",s8=bl("aiEvtPageHide"),a8=bl("aiEvtPageShow"),_ce=/\.[\.]+/g,Ece=/[\.]+$/,Cce=1,AC=VT("events"),wce=/^([^.]*)(?:\.(.+)|)/});function Gy(){var r=ad();return r[dl](0,8)+"-"+r[dl](8,12)+"-"+r[dl](12,16)+"-"+r[dl](16,20)+"-"+r[dl](20)}function Yy(){var r=Oy();return r&&r.now?r.now():ii()}function ad(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=gt,t,n=0;n<4;n++)t=yl(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(yl()&3)|0];return e[jp](0,8)+e[jp](9,4)+"4"+e[jp](13,3)+i+e[jp](16,3)+e[jp](19,12)}var zK,QK=te(()=>{"use strict";d();Nn();Ia();$K();An();Si();WT();zK={Attach:By,AttachEvent:By,Detach:Hy,DetachEvent:Hy}});function ld(r,e,t){return r&&r[ot]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function d8(r,e,t){return ld(r,e)?r:t}function p8(r){(isNaN(r)||r<0||r>255)&&(r=1);for(var e=r.toString(16);e[ot]<2;)e="0"+e;return e}function eF(r,e,t,n){var i;return i={},i[fC]=ld(n,2,ZK)?n:XK,i[th]=$y(r)?r:ad(),i.spanId=zy(e)?e:ad()[jp](0,16),i.traceFlags=t>=0&&t<=255?t:1,i}function KC(r){var e;if(!r||(bt(r)&&(r=r[0]||""),!r||!hn(r)||r[ot]>8192))return null;var t=Pce.exec(qr(r));return!t||t[1]===ZK||t[2]===zT||t[3]===QT?null:(e={},e[fC]=t[1],e[th]=t[2],e[Cy]=t[3],e[Bp]=parseInt(t[4],16),e)}function $y(r){return ld(r,32,zT)}function zy(r){return ld(r,16,QT)}function XT(r){return!(!r||!ld(r[fC],2,ZK)||!ld(r[th],32,zT)||!ld(r[Cy],16,QT)||!ld(p8(r[Bp]),2))}function tF(r){return XT(r)?(r[Bp]&u8)===u8:!1}function rF(r){if(r){var e=p8(r[Bp]);ld(e,2)||(e="01");var t=r[fC]||XK;return t!=="00"&&t!=="ff"&&(t=XK),"".concat(t,"-").concat(d8(r.traceId,32,zT),"-").concat(d8(r.spanId,16,QT),"-").concat(e)}return""}function nF(){var r="traceparent",e=KC(AK(r));return e||(e=KC(MK(r))),e}var Pce,XK,ZK,zT,QT,u8,iF=te(()=>{d();Nn();QK();Ia();An();Pce=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]*)?$/,XK="00",ZK="ff",zT="00000000000000000000000000000000",QT="0000000000000000",u8=1});function cd(r){return Tce.get(r,"state",{},!0)}function ZT(r,e){for(var t=[],n=null,i=r[As](),o;i;){var s=i[Qm]();if(s){n&&Zt(n[Up])&&Zt(s[ts])&&n[Up](s);var a=!1;Zt(s[Ns])?a=s[Ns]():(o=cd(s),a=o[Ns]),a||t[jt](s),n=s,i=i[As]()}}je(t,function(l){var c=r[mn]();l[ll](r.getCfg(),c,e,r[As]()),o=cd(l),!l[mn]&&!o[mn]&&(o[mn]=c),o[Ns]=!0,delete o[Rs]})}function ek(r){return r.sort(function(e,t){var n=0;if(t){var i=Zt(t[ts]);Zt(e[ts])?n=i?e[va]-t[va]:1:i&&(n=-1)}else n=e?1:-1;return n})}function f8(r){var e={};return{getName:function(){return e[Mi]},setName:function(t){r&&r.setName(t),e[Mi]=t},getTraceId:function(){return e[th]},setTraceId:function(t){r&&r.setTraceId(t),$y(t)&&(e[th]=t)},getSpanId:function(){return e[Cy]},setSpanId:function(t){r&&r.setSpanId(t),zy(t)&&(e[Cy]=t)},getTraceFlags:function(){return e[Bp]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[Bp]=t}}}var Tce,tk=te(()=>{"use strict";d();Nn();kC();An();Si();iF();Tce=VT("plugin")});function Nce(r,e,t){for(;r;){if(r[Qm]()===t)return r;r=r[As]()}return Oc([t],e[Ac]||{},e)}function oF(r,e,t,n){var i=null,o=[];n!==null&&(i=n?Nce(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return EC(t,e)},getCfg:function(){return e},getExtCfg:c,getConfig:u,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:p,onComplete:a}};function a(f,m){for(var h=[],g=2;g<arguments.length;g++)h[g-2]=arguments[g];f&&o[jt]({func:f,self:gr(m)?s.ctx:m,args:h})}function l(){var f=i;if(i=f?f[As]():null,!f){var m=o;m&&m[ot]>0&&(je(m,function(h){try{h.func[qn](h.self,h.args)}catch(g){tn(t[Zo],2,73,"Unexpected Exception during onComplete - "+ln(g))}}),o=[])}return f}function c(f,m,h){m===void 0&&(m={}),h===void 0&&(h=0);var g;if(e){var v=e[wy];v&&f&&(g=v[f])}if(!g)g=m;else if(Oi(m)&&h!==0){var I=Ry(!0,m,g);e&&h===2&&Jr(m,function(S){if(xt(I[S])){var x=e[S];xt(x)||(I[S]=x)}}),g=I}return g}function u(f,m,h){h===void 0&&(h=!1);var g,v=c(f,null);return v&&!xt(v[m])?g=v[m]:e&&!xt(e[m])&&(g=e[m]),xt(g)?h:g}function p(f){for(var m;m=s._next();){var h=m[Qm]();h&&f(h)}}return s}function ss(r,e,t,n){var i=oF(r,e,t,n),o=i.ctx;function s(l){var c=i._next();return c&&c[ts](l,o),!c}function a(l,c){return l===void 0&&(l=null),bt(l)&&(l=Oc(l,e,t,c)),ss(l||o[As](),e,t,c)}return o[Hr]=s,o[Xu]=a,o}function Qy(r,e,t){var n=e[Ac]||{},i=oF(r,n,e,t),o=i.ctx;function s(l){var c=i._next();return c&&c.unload(o,l),!c}function a(l,c){return l===void 0&&(l=null),bt(l)&&(l=Oc(l,n,e,c)),Qy(l||o[As](),e,c)}return o[Hr]=s,o[Xu]=a,o}function FC(r,e,t){var n=e[Ac]||{},i=oF(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(c){Zt(c[Xm])&&c[Xm](o,l)})}function a(l,c){return l===void 0&&(l=null),bt(l)&&(l=Oc(l,n,e,c)),FC(l||o[As](),e,c)}return o[Hr]=s,o[Xu]=a,o}function Oc(r,e,t,n){var i=null,o=!n;if(bt(r)&&r[ot]>0){var s=null;je(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&Zt(a[ts])){var l=Rce(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Oc([n],e,t):i}function Rce(r,e,t){var n=null,i=Zt(r[ts]),o=Zt(r[Up]),s;r?s=r[cl]+"-"+r[va]+"-"+g8++:s="Unknown-0-"+g8++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:u,unload:p,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&Zt(r[h8])&&(m=r[h8]()),m||(m=ss(a,e,t)),m}function c(m,h,g,v,I){var S=!1,x=r?r[cl]:kce,D=m[m8];return D||(D=m[m8]={}),m.setNext(n),r&&wn(m[mn](),function(){return x+":"+g},function(){D[s]=!0;try{var A=n?n._id:gt;A&&(D[A]=!1),S=h(m)}catch(R){var w=n?D[n._id]:!0;w&&(S=!0),(!n||!w)&&tn(m[ga](),1,73,"Plugin ["+x+"] failed during "+g+" - "+ln(R)+", run flags: "+ln(D))}},v,I),S}function u(m,h){h=h||l();function g(v){if(!r||!i)return!1;var I=cd(r);return I[Rs]||I[mC]?!1:(o&&r[Up](n),r[ts](m,v),!0)}c(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[Hr](m)}function p(m,h){function g(){var v=!1;if(r){var I=cd(r),S=r[mn]||I[mn];r&&(!S||S===m.core())&&!I[Rs]&&(I[mn]=null,I[Rs]=!0,I[Ns]=!1,r[Rs]&&r[Rs](m,h)===!0&&(v=!0))}return v}c(m,g,"unload",function(){},h[ul])||m[Hr](h)}function f(m,h){function g(){var v=!1;if(r){var I=cd(r),S=r[mn]||I[mn];r&&(!S||S===m.core())&&!I[Rs]&&r[Xm]&&r[Xm](m,h)===!0&&(v=!0)}return v}c(m,g,"update",function(){},!1)||m[Hr](h)}return ns(a)}var kce,m8,h8,g8,sF,UC=te(()=>{"use strict";d();Nn();$p();Ia();An();Si();xC();tk();kce="TelemetryPluginChain",m8="_hasRun",h8="_getTelCtx",g8=0;sF=function(){function r(e,t,n,i){var o=this,s=ss(e,t,n,i);ch(o,s,ko(s))}return r}()});function v8(r,e,t){e&&bt(e)&&e[ot]>0&&(e=e.sort(function(n,i){return n[va]-i[va]}),je(e,function(n){n[va]<WC&&oi(Ace+n[cl])}),r[jt]({queue:ns(e),chain:Oc(e,t[Ac],t)}))}function y8(r,e){function t(){return ss(null,e[Ac],e,null)}function n(c,u,p,f){var m=c?c[ot]+1:1;function h(){m--,m===0&&(f&&f(),f=null)}m>0&&je(c,function(g){if(g&&g.queue[ot]>0){var v=g.chain,I=u[Xu](v);I[lC](h),p(I)}else m--}),h()}function i(c,u){var p=u||{reason:0};return n(r,c,function(f){f[Hr](p)},function(){c[Hr](p)}),!0}function o(c,u){var p=u||{reason:0,isAsync:!1};return n(r,c,function(f){f[Hr](p)},function(){c[Hr](p),a=!1}),!0}function s(c){var u=null;return r&&r[ot]>0&&je(r,function(p){if(p&&p.queue[ot]>0&&(je(p.queue,function(f){if(f[cl]===c)return u=f,-1}),u))return-1}),u}var a=!1,l={identifier:"ChannelControllerPlugin",priority:WC,initialize:function(c,u,p,f){a=!0,je(r,function(m){m&&m.queue[ot]>0&&ZT(ss(m.chain,c,u),p)})},isInitialized:function(){return a},processTelemetry:function(c,u){n(r,u||t(),function(p){p[Hr](c)},function(){u[Hr](c)})},update:i,pause:function(){n(r,t(),function(c){c.iterate(function(u){u.pause&&u.pause()})},null)},resume:function(){n(r,t(),function(c){c.iterate(function(u){u.resume&&u.resume()})},null)},teardown:o,getChannel:s,flush:function(c,u,p,f){var m=1,h=!1,g=null;f=f||5e3;function v(){m--,h&&m===0&&(g&&(clearTimeout(g),g=null),u&&u(h),u=null)}return n(r,t(),function(I){I.iterate(function(S){if(S[by]){m++;var x=!1;S[by](c,function(){x=!0,v()},p)||x||(c&&g==null?g=setTimeout(function(){g=null,v()},f):v())}})},function(){h=!0,v()}),!0},_setQueue:function(c){r=c}};return l}function b8(r,e,t){var n=[];if(r&&je(r,function(o){return v8(n,o,t)}),e){var i=[];je(e,function(o){o[va]>WC&&i[jt](o)}),v8(n,i,t)}return n}var WC,Ace,I8=te(()=>{d();Nn();An();Si();UC();tk();WC=500,Ace="Channel has invalid priority - "});function bh(){var r=[];function e(n){n&&r[jt](n)}function t(n,i){je(r,function(o){try{o(n,i)}catch(s){tn(n[ga](),2,73,"Unexpected error calling unload handler - "+ln(s))}}),r=[]}return{add:e,run:t}}var rk=te(()=>{d();Nn();$p();Ia();An()});var rf,Ih,aF=te(()=>{"use strict";d();vr();Nn();An();Si();UC();rk();rf="getPlugin",Ih=function(){function r(){var e=this,t,n,i,o,s;c(),Ge(r,e,function(u){u[ll]=function(p,f,m,h){l(p,f,h),t=!0},u[Rs]=function(p,f){var m,h=u[mn];if(!h||p&&h!==p[mn]())return;var g,v=!1,I=p||Qy(null,h,i&&i[rf]?i[rf]():i),S=f||(m={reason:0},m[ul]=!1,m);function x(){if(!v){v=!0,o.run(I,f);var D=s;s=[],je(D,function(A){A.rm()}),g===!0&&I[Hr](S),c()}}return!u[Sy]||u[Sy](I,S,x)!==!0?x():g=!0,g},u[Xm]=function(p,f){var m=u[mn];if(!m||p&&m!==p[mn]())return;var h,g=!1,v=p||FC(null,m,i&&i[rf]?i[rf]():i),I=f||{reason:0};function S(){g||(g=!0,l(v.getCfg(),v.core(),v[As]()))}return!u._doUpdate||u._doUpdate(v,I,S)!==!0?S():h=!0,h},u._addHook=function(p){p&&(bt(p)?s=s.concat(p):s[jt](p))},Gp(u,"_addUnloadCb",function(){return o},"add")}),e[ga]=function(u){return a(u)[ga]()},e[Ns]=function(){return t},e.setInitialized=function(u){t=u},e[Up]=function(u){i=u},e[Hr]=function(u,p){p?p[Hr](u):i&&Zt(i[ts])&&i[ts](u,null)},e._getTelCtx=a;function a(u){u===void 0&&(u=null);var p=u;if(!p){var f=n||ss(null,{},e[mn]);i&&i[rf]?p=f[Xu](null,i[rf]):p=f[Xu](null,i)}return p}function l(u,p,f){u&&is(u,wy,[],null,xt),!f&&p&&(f=p[gT]()[As]());var m=i;i&&i[rf]&&(m=i[rf]()),e[mn]=p,n=ss(f,u,p,m)}function c(){t=!1,e[mn]=null,n=null,i=null,s=[],o=bh()}}return r.__ieDyn=1,r}()});var S8,_8=te(()=>{d();pr();vr();Nn();aF();$p();Ia();An();Si();S8=function(r){Cn(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),Ge(e,t,function(s,a){s.addTelemetryInitializer=function(l){var c={id:n++,fn:l};i[jt](c);var u={remove:function(){je(i,function(p,f){if(p.id===c.id)return i[Qu](f,1),-1})}};return u},s[ts]=function(l,c){for(var u=!1,p=i[ot],f=0;f<p;++f){var m=i[f];if(m)try{if(m.fn[Ey](null,[l])===!1){u=!0;break}}catch(h){tn(c[ga](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+lh(h),{exception:ln(h)},!0)}}u||s[Hr](l,c)},s[Sy]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(Ih)});function Lce(r,e){return new wC(e)}function Kce(r,e,t){var n,i=[],o={};return je(t,function(s){(xt(s)||xt(s[ll]))&&oi(x8);var a=s[va],l=s[cl];s&&a&&(xt(o[a])?o[a]=l:vl(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[jt](s)}),n={all:t},n[mn]=i,n}function w8(r,e){var t=!1;return je(e,function(n){if(n===r)return t=!0,-1}),t}function Fce(){var r;return Po((r={},r[$m]=function(e){},r[zm]=function(e){},r[xy]=function(e){},r[Hp]=function(e,t){},r[Dy]=function(e,t){},r))}var x8,E8,C8,Mce,Oce,Sh,lF=te(()=>{"use strict";d();pr();vr();pr();Nn();I8();GK();kC();KK();$p();An();Si();xC();UC();tk();_8();rk();x8="Plugins must provide initialize method",E8="_notificationManager",C8="SDK is still unloading...",Mce="SDK is not initialized",Oce={loggingLevelConsole:1};Sh=function(){function r(){var e,t,n,i,o,s,a,l,c,u,p,f,m,h,g,v,I,S,x,D,A=0;Ge(r,this,function(w){R(),w[Ns]=function(){return t},w[ll]=function(H,fe,Ae,_e){h&&oi(C8),w[Ns]()&&oi("Core should not be initialized more than once"),e=H||{},w[Ac]=e,xt(H[hT])&&oi("Please provide instrumentation key"),i=_e,w[E8]=_e,le(),At(),Ye(),Ae&&(w[Zo]=Ae);var Te=qp(e,e5,[]);c=[],c[jt].apply(c,Gm(Gm([],fe,!1),Te,!1)),f=qp(e,iK,[]),ne(null),(!m||m[ot]===0)&&oi("No "+iK+" available"),t=!0,w.releaseQueue()},w.getTransmissionControls=function(){var H=[];return m&&je(m,function(fe){H[jt](fe.queue)}),ns(H)},w.track=function(H){H.iKey=H.iKey||e[hT],H[Ym]=H[Ym]||ya(new Date),H.ver=H.ver||"4.0",!h&&w[Ns]()?j()[Hr](H):n[jt](H)},w[gT]=j,w[aC]=function(){return i||(i=Fce(),w[E8]=i),i},w[$m]=function(H){i&&i[$m](H)},w[zm]=function(H){i&&i[zm](H)},w.getCookieMgr=function(){return a||(a=od(e,w[Zo])),a},w.setCookieMgr=function(H){a=H},w[rh]=function(){if(!o&&!s&&ba(e.enablePerfMgr)){var H=ba(e[oK]);Zt(H)&&(s=H(w,w[aC]()))}return o||s||jK()},w.setPerfMgr=function(H){o=H},w.eventCnt=function(){return n[ot]},w.releaseQueue=function(){if(t&&n[ot]>0){var H=n;n=[],je(H,function(fe){j()[Hr](fe)})}},w.pollInternalLogs=function(H){v=H||null;var fe=ba(e.diagnosticLogInterval);return(!fe||!(fe>0))&&(fe=1e4),A&&clearInterval(A),A=setInterval(function(){Ve()},fe),A},w[tK]=function(){A&&(clearInterval(A),A=0,Ve())},ch(w,function(){return g},["addTelemetryInitializer"]),w.unload=function(H,fe,Ae){var _e;H===void 0&&(H=!0),t||oi(Mce),h&&oi(C8);var Te=(_e={reason:50},_e[ul]=H,_e.flushComplete=!1,_e),L=Qy(ee(),w);L[lC](function(){R(),fe&&fe(Te)},w);function ce(ve){Te.flushComplete=ve,h=!0,S.run(L,Te),w[tK](),L[Hr](Te)}Pe(H,ce,6,Ae)||ce(!1)},w[Qm]=N,w.addPlugin=function(H,fe,Ae,_e){if(!H){_e&&_e(!1),en(x8);return}var Te=N(H[cl]);if(Te&&!fe){_e&&_e(!1),en("Plugin ["+H[cl]+"] is already loaded!");return}var L={reason:16};function ce(We){c[jt](H),L.added=[H],ne(L),_e&&_e(!0)}if(Te){var ve=[Te.plugin],ke={reason:2,isAsync:!!Ae};ye(ve,ke,function(We){We?(L.removed=ve,L.reason|=32,ce(!0)):_e&&_e(!1)})}else ce(!1)},w.evtNamespace=function(){return I},w[by]=Pe,w.getTraceCtx=function(H){return D||(D=f8()),D},w.setTraceCtx=function(H){D=H||null},Gp(w,"addUnloadCb",function(){return S},"add");function R(){t=!1,e=Ry(!0,{},Oce),w[Ac]=e,w[Zo]=new gl(e),w[cC]=[],g=new S8,n=[],i=null,o=null,s=null,a=null,l=null,u=null,c=[],p=null,f=null,m=null,h=!1,v=null,I=bl("AIBaseCore",!0),S=bh(),D=null}function j(){return ss(ee(),e,w)}function ne(H){var fe=Kce(w[Zo],WC,c);u=fe[mn],l=null;var Ae=fe.all;if(m=ns(b8(f,Ae,w)),p){var _e=ni(Ae,p);_e!==-1&&Ae[Qu](_e,1),_e=ni(u,p),_e!==-1&&u[Qu](_e,1),p._setQueue(m)}else p=y8(m,w);Ae[jt](p),u[jt](p),w[cC]=ek(Ae),p[ll](e,w,Ae),ZT(j(),Ae),w[cC]=ns(ek(u||[])).slice(),H&&Ir(H)}function N(H){var fe,Ae=null,_e=null;return je(w[cC],function(Te){if(Te[cl]===H&&Te!==p&&Te!==g)return _e=Te,-1}),!_e&&p&&(_e=p.getChannel(H)),_e&&(Ae=(fe={plugin:_e},fe[uC]=function(Te){cd(_e)[mC]=!Te},fe.isEnabled=function(){var Te=cd(_e);return!Te[Rs]&&!Te[mC]},fe.remove=function(Te,L){var ce;Te===void 0&&(Te=!0);var ve=[_e],ke=(ce={reason:1},ce[ul]=Te,ce);ye(ve,ke,function(We){We&&ne({reason:32,removed:ve}),L&&L(We)})},fe)),Ae}function ee(){if(!l){var H=(u||[]).slice();ni(H,g)===-1&&H[jt](g),l=Oc(ek(H),e,w)}return l}function ye(H,fe,Ae){if(H&&H[ot]>0){var _e=Oc(H,e,w),Te=Qy(_e,w);Te[lC](function(){var L=!1,ce=[];je(c,function(ke,We){w8(ke,H)?L=!0:ce[jt](ke)}),c=ce;var ve=[];f&&(je(f,function(ke,We){var it=[];je(ke,function(k){w8(k,H)?L=!0:it[jt](k)}),ve[jt](it)}),f=ve),Ae&&Ae(L)}),Te[Hr](fe)}else Ae(!1)}function Ve(){var H=w[Zo]?w[Zo].queue:[];H&&(je(H,function(fe){var Ae,_e=(Ae={},Ae[Mi]=v||"InternalMessageId: "+fe[Iy],Ae.iKey=ba(e[hT]),Ae.time=ya(new Date),Ae.baseType=mh.dataType,Ae.baseData={message:fe[Fp]},Ae);w.track(_e)}),H[ot]=0)}function Pe(H,fe,Ae,_e){return p?p[by](H,fe,Ae||6,_e):(fe&&fe(!1),!0)}function le(){var H=ba(e.disableDbgExt);H===!0&&x&&(i[zm](x),x=null),i&&!x&&H!==!0&&(x=T5(e),i[$m](x))}function At(){var H=ba(e.enablePerfMgr);!H&&s&&(s=null),H&&qp(e,oK,Lce)}function Ye(){var H=qp(e,wy,{});H.NotificationManager=i}function Ir(H){var fe=FC(ee(),w);(!w._updateHook||w._updateHook(fe,H)!==!0)&&fe[Hr](H)}function en(H){var fe=w[Zo];fe?tn(fe,2,73,H):oi(H)}})}return r.__ieDyn=1,r}()});function nk(r,e,t,n){je(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var VC,cF=te(()=>{d();vr();Nn();An();Si();VC=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;Ge(r,this,function(n){n[$m]=function(i){n.listeners[jt](i)},n[zm]=function(i){for(var o=ni(n[Zm],i);o>-1;)n.listeners[Qu](o,1),o=ni(n[Zm],i)},n[xy]=function(i){nk(n[Zm],xy,!0,function(o){o[xy](i)})},n[Hp]=function(i,o){nk(n[Zm],Hp,!0,function(s){s[Hp](i,o)})},n[Dy]=function(i,o){nk(n[Zm],Dy,o,function(s){s[Dy](i,o)})},n[Jp]=function(i){i&&(t||!i[pC]())&&nk(n[Zm],Jp,!1,function(o){i[ul]?setTimeout(function(){return o[Jp](i)},0):o[Jp](i)})}})}return r.__ieDyn=1,r}()});var jC,D8=te(()=>{d();pr();vr();Nn();lF();$p();An();Si();cF();xC();jC=function(r){Cn(e,r);function e(){var t=r.call(this)||this;return Ge(e,t,function(n,i){n[ll]=function(a,l,c,u){i[ll](a,l,c||new gl(a),u||new VC(a))},n.track=function(a){wn(n[rh](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),oi("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){xt(a[Mi])&&(s(a),oi("telemetry name required"))}function s(a){var l=n[aC]();l&&l[Hp]([a],2)}}),t}return e.__ieDyn=1,e}(Sh)});var Ne,Lr,_h,Sl,P8,T8,ik,uF,BC,ok,Xy,_l,nf,ud,HC,k8,dF,JC,N8=te(()=>{d();CT();Lr="Failed",_h=Lr+"MonitorAjax",Sl="Track",P8="Start",T8="Stop",ik="Event",uF="AuthContext",BC="Exception",ok="Local",Xy="Session",_l="Storage",nf="Browser",ud="Cannot",HC="Buffer",k8="InstrumentationKey",dF=No({CRITICAL:1,WARNING:2}),JC=No((Ne={},Ne[nf+"DoesNotSupport"+ok+_l]=0,Ne[nf+ud+"Read"+ok+_l]=1,Ne[nf+ud+"Read"+Xy+_l]=2,Ne[nf+ud+"Write"+ok+_l]=3,Ne[nf+ud+"Write"+Xy+_l]=4,Ne[nf+Lr+"RemovalFrom"+ok+_l]=5,Ne[nf+Lr+"RemovalFrom"+Xy+_l]=6,Ne[ud+"SendEmptyTelemetry"]=7,Ne.ClientPerformanceMathError=8,Ne["ErrorParsingAI"+Xy+"Cookie"]=9,Ne.ErrorPVCalc=10,Ne[BC+"WhileLoggingError"]=11,Ne[Lr+"AddingTelemetryTo"+HC]=12,Ne[_h+"Abort"]=13,Ne[_h+"Dur"]=14,Ne[_h+"Open"]=15,Ne[_h+"RSC"]=16,Ne[_h+"Send"]=17,Ne[_h+"GetCorrelationHeader"]=18,Ne[Lr+"ToAddHandlerForOnBeforeUnload"]=19,Ne[Lr+"ToSendQueuedTelemetry"]=20,Ne[Lr+"ToReportDataLoss"]=21,Ne["Flush"+Lr]=22,Ne.MessageLimitPerPVExceeded=23,Ne.MissingRequiredFieldSpecification=24,Ne.NavigationTimingNotSupported=25,Ne.OnError=26,Ne[Xy+"RenewalDateIsZero"]=27,Ne.SenderNotInitialized=28,Ne[P8+Sl+ik+Lr]=29,Ne[T8+Sl+ik+Lr]=30,Ne[P8+Sl+Lr]=31,Ne[T8+Sl+Lr]=32,Ne.TelemetrySampledAndNotSent=33,Ne[Sl+ik+Lr]=34,Ne[Sl+BC+Lr]=35,Ne[Sl+"Metric"+Lr]=36,Ne[Sl+"PV"+Lr]=37,Ne[Sl+"PV"+Lr+"Calc"]=38,Ne[Sl+"Trace"+Lr]=39,Ne["Transmission"+Lr]=40,Ne[Lr+"ToSet"+_l+HC]=41,Ne[Lr+"ToRestore"+_l+HC]=42,Ne.InvalidBackendResponse=43,Ne[Lr+"ToFixDepricatedValues"]=44,Ne.InvalidDurationValue=45,Ne.TelemetryEnvelopeInvalid=46,Ne.CreateEnvelopeError=47,Ne[ud+"SerializeObject"]=48,Ne[ud+"SerializeObjectNonSerializable"]=49,Ne.CircularReferenceDetected=50,Ne["Clear"+uF+Lr]=51,Ne[BC+"Truncated"]=52,Ne.IllegalCharsInName=53,Ne.ItemNotInArray=54,Ne.MaxAjaxPerPVExceeded=55,Ne.MessageTruncated=56,Ne.NameTooLong=57,Ne.SampleRateOutOfRange=58,Ne["Set"+uF+Lr]=59,Ne["Set"+uF+Lr+"AccountName"]=60,Ne.StringValueTooLong=61,Ne.StartCalledMoreThanOnce=62,Ne.StopCalledWithoutStart=63,Ne["TelemetryInitializer"+Lr]=64,Ne.TrackArgumentsNotSpecified=65,Ne.UrlTooLong=66,Ne[Xy+_l+HC+"Full"]=67,Ne[ud+"AccessCookie"]=68,Ne.IdTooLong=69,Ne.InvalidEvent=70,Ne[_h+"SetRequestHeader"]=71,Ne["Send"+nf+"InfoOnUserInit"]=72,Ne["Plugin"+BC]=73,Ne["Notification"+BC]=74,Ne.SnippetScriptLoadFailure=99,Ne["Invalid"+k8]=100,Ne[ud+"ParseAiBlobValue"]=101,Ne.InvalidContentBlob=102,Ne[Sl+"PageAction"+ik+Lr]=103,Ne[Lr+"AddingCustomDefinedRequestContext"]=104,Ne["InMemory"+_l+HC+"Full"]=105,Ne[k8+"Deprecation"]=106,Ne))});var dd=te(()=>{d();Z7();h5();D8();lF();aF();WT();QK();An();CT();$K();Ia();pr();cF();xC();$p();UC();N8();GK();kC();rk();iF()});var R8,A8,M8,O8,L8,K8,F8=te(()=>{d();pr();dd();R8=No({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),A8=No({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),M8=No({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),O8=No({Normal:1,Critical:2}),L8=No({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),K8=ns(To(To({},JC),No({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520})))});var El,sk,Uce,jLe,pF,ak,qC=te(()=>{d();El="",sk="https://browser.events.data.microsoft.com/OneCollector/1.0/",Uce="pluginVersionString",jLe=Uce+"Arr",pF="version",ak="properties"});function Gn(r){return!(r===El||xt(r))}function YC(r){if(r){var e=r.indexOf("-");if(e>-1)return r.substring(0,e)}return El}function hF(){return fF===null&&(fF=!gr(Uint8Array)&&!Hce()&&!id()),fF}function $C(r){return!!(r&&rs(r)&&r>=1&&r<=4)}function zC(r,e,t){if(!e&&!Gn(e)||typeof r!="string")return null;var n=typeof e;if(n==="string"||n==="number"||n==="boolean"||bt(e))e={value:e};else if(n==="object"&&!dr.call(e,"value"))e={value:t?JSON.stringify(e):e};else if(xt(e.value)||e.value===El||!hn(e.value)&&!rs(e.value)&&!ed(e.value)&&!bt(e.value))return null;if(bt(e.value)&&!ck(e.value))return null;if(!xt(e.kind)){if(bt(e.value)||!Zy(e.kind))return null;e.value=e.value.toString()}return e}function QC(r,e,t){var n=-1;if(!gr(r))if(e>0&&(e===32?n=8192:e<=13&&(n=e<<5)),Bce(t))n===-1&&(n=0),n|=t;else{var i=jce[Cl(r)]||-1;n!==-1&&i!==-1?n|=i:i===6&&(n=i)}return n}function gF(){Zp(null).setEnabled(!1)}function vF(r,e,t){Il(null)&&Zp(null).set(r,e,t*86400,null,"/")}function yF(r){Il(null)&&Zp(null).del(r)}function bF(r){return Il(null)?IF(Zp(null),r):El}function IF(r,e,t){t===void 0&&(t=!0);var n;return r&&(n=r.get(e),t&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||El}function SF(r){r===void 0&&(r="D");var e=Gy();return r==="B"?e="{"+e+"}":r==="P"?e="("+e+")":r==="N"&&(e=e.replace(/-/g,El)),e}function of(r,e,t,n,i){var o={},s=!1,a=0,l=arguments.length,c=Object[Vt],u=arguments;for(c.toString.call(u[0])==="[object Boolean]"&&(s=u[0],a++);a<l;a++){var r=u[a];Jr(r,function(f,m){s&&m&&Oi(m)?bt(m)?(o[f]=o[f]||[],je(m,function(h,g){h&&Oi(h)?o[f][g]=of(!0,o[f][g],h):o[f][g]=h})):o[f]=of(!0,o[f],m):o[f]=m})}return o}function Zy(r){return r===0||r>0&&r<=13||r===32}function Bce(r){return r>=0&&r<=9}function Hce(){var r=Os();if(!gr(r)&&r.userAgent){var e=r.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}function ck(r){return r.length>0}function Eh(r,e){var t=r;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[e]=Ro()}function Cl(r){var e=0;if(r!=null){var t=typeof r;t==="string"?e=1:t==="number"?e=2:t==="boolean"?e=3:t===ht&&(e=4,bt(r)?(e=4096,r.length>0&&(e|=Cl(r[0]))):dr.call(r,"value")&&(e=8192|Cl(r.value)))}return e}function uk(){return!!gn("chrome")}function dk(r,e,t,n,i,o){n===void 0&&(n=!1),i===void 0&&(i=!1);function s(l,c,u){try{l[c]=u}catch(p){}}var a=new XMLHttpRequest;return n&&s(a,Wce,n),t&&s(a,U8,t),a.open(r,e,!i),t&&s(a,U8,t),!i&&o&&s(a,Vce,o),a}var pd,lk,fd,Wce,U8,Vce,jce,fF,GC,mF,Ro,W8,V8,XC=te(()=>{d();dd();pr();qC();lk="3.2.9",fd="1DS-Web-JS-"+lk,Wce="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",U8="withCredentials",Vce="timeout",jce=(pd={},pd[0]=0,pd[2]=6,pd[1]=1,pd[3]=7,pd[4098]=6,pd[4097]=1,pd[4099]=7,pd),fF=null,GC=!!os(),mF=!!Mc();Ro=Yy;W8={Version:lk,FullVersionString:fd,strUndefined:nr,strObject:ht,Undefined:nr,arrForEach:je,arrIndexOf:ni,arrMap:sh,arrReduce:ah,objKeys:ko,toISOString:ya,isReactNative:id,isString:hn,isNumber:rs,isBoolean:ed,isFunction:Zt,isArray:bt,isObject:Oi,strTrim:qr,isDocumentObjectAvailable:GC,isWindowObjectAvailable:mF,isValueAssigned:Gn,getTenantId:YC,isBeaconsSupported:Yp,isUint8ArrayAvailable:hF,isLatency:$C,sanitizeProperty:zC,getISOString:ya,useXDomainRequest:fh,getCommonSchemaMetaData:QC,cookieAvailable:Il,disallowsSameSiteNone:Vy,setCookie:vF,deleteCookie:yF,getCookie:bF,createGuid:SF,extend:of,getTime:Ro,isValueKind:Zy,isArrayValid:ck,objDefineAccessors:Ms,addPageUnloadEventListener:yh,setProcessTelemetryTimings:Eh,addEventHandler:tf,getFieldValueType:Cl,strEndsWith:ih,objForEachKey:Jr},V8={_canUseCookies:void 0,isTypeof:Py,isUndefined:gr,isNullOrUndefined:xt,hasOwnProperty:Zu,isFunction:Zt,isObject:Oi,isDate:ky,isArray:bt,isError:oh,isString:hn,isNumber:rs,isBoolean:ed,toISOString:ya,arrForEach:je,arrIndexOf:ni,arrMap:sh,arrReduce:ah,strTrim:qr,objCreate:Po,objKeys:ko,objDefineAccessors:Ms,addEventHandler:tf,dateNow:ii,isIE:hl,disableCookies:gF,newGuid:Gy,perfNow:Yy,newId:Qp,randomValue:Wy,random32:yl,mwcRandomSeed:UT,mwcRandom32:TC,generateW3CId:ad}});var Jce,j8,B8=te(()=>{d();pr();vr();dd();qC();XC();Jce=function(r){Cn(e,r);function e(){var t=r.call(this)||this;return t.pluginVersionStringArr=[],Ge(e,t,function(n,i){(!n.logger||!n.logger.queue)&&(n.logger=new gl({loggingLevelConsole:1})),n.initialize=function(o,s,a,l){wn(n,function(){return"AppInsightsCore.initialize"},function(){var c=n.pluginVersionStringArr;if(o){o.endpointUrl||(o.endpointUrl=sk);var u=o.propertyStorageOverride;u&&(!u.getProperty||!u.setProperty)&&oi("Invalid property storage override passed."),o.channels&&je(o.channels,function(m){m&&je(m,function(h){if(h.identifier&&h.version){var g=h.identifier+"="+h.version;c.push(g)}})})}n.getWParam=function(){return typeof document!="undefined"||o.enableWParam?0:-1},s&&je(s,function(m){if(m&&m.identifier&&m.version){var h=m.identifier+"="+m.version;c.push(h)}}),n.pluginVersionString=c.join(";"),n.pluginVersionStringArr=c;try{i.initialize(o,s,a,l),n.pollInternalLogs("InternalLog")}catch(m){var p=n.logger,f=ln(m);f.indexOf("channels")!==-1&&(f+=`
 - Channels must be provided through config.channels only!`),tn(p,1,514,"SDK Initialization Failed - no telemetry will be sent: "+f)}},function(){return{config:o,extensions:s,logger:a,notificationManager:l}})},n.track=function(o){wn(n,function(){return"AppInsightsCore.track"},function(){var s=o;if(s){s.timings=s.timings||{},s.timings.trackStart=Ro(),$C(s.latency)||(s.latency=1);var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=fd;var l=s.baseData=s.baseData||{};l[ak]=l[ak]||{};var c=l[ak];c[pF]=c[pF]||n.pluginVersionString||El}i.track(s)},function(){return{item:o}},!o.sync)}}),t}return e.__ieDyn=1,e}(jC),j8=Jce});var qce,H8,J8=te(()=>{d();pr();vr();dd();qC();XC();qce=function(r){Cn(e,r);function e(){var t=r.call(this)||this;return Ge(e,t,function(n,i){n.initialize=function(o,s,a,l){o&&!o.endpointUrl&&(o.endpointUrl=sk),n.getWParam=function(){return GC||o.enableWParam?0:-1};try{i.initialize(o,s,a,l)}catch(c){tn(n.logger,1,514,"Initialization Failed: "+ln(c)+`
 - Note: Channels must be provided through config.channels only`)}},n.track=function(o){var s=o;if(s){var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=fd}i.track(s)}}),t}return e.__ieDyn=1,e}(Sh),H8=qce});function Gce(r,e,t){return function(n){r[e]=n,t()}}var Ch,Yce,sf,_F=te(()=>{d();vr();dd();Ch=Zt;Yce=function(){function r(e){var t=0,n=null,i=[];Ge(r,this,function(c){c.then=function(u,p){return new r(function(f,m){o(u,p,f,m)})},c.catch=function(u){return c.then(null,u)}});function o(c,u,p,f){i.push(function(){var m;try{t===1?m=Ch(c)?c(n):n:m=Ch(u)?u(n):n,m instanceof r?m.then(p,f):t===2&&!Ch(u)?f(m):p(m)}catch(h){f(h);return}}),t!==0&&s()}function s(){if(i.length>0){var c=i.slice();i=[],setTimeout(function(){for(var u=0,p=c.length;u<p;++u)try{c[u]()}catch(f){}},0)}}function a(c){t===0&&(n=c,t=1,s())}function l(c){t===0&&(n=c,t=2,s())}(function(){if(!Ch(e))throw new TypeError("ESPromise: resolvedFunc argument is not a Function");try{e(a,l)}catch(u){l(u)}})()}return r.resolve=function(e){return e instanceof r?e:e&&Ch(e.then)?new r(function(t,n){try{e.then(t,n)}catch(i){n(i)}}):new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.all=function(e){if(!(!e||!e.length))return new r(function(t,n){try{for(var i=[],o=0,s=0;s<e.length;s++){var a=e[s];a&&Ch(a.then)?(o++,a.then(Gce(i,s,function(){--o===0&&t(i)}),n)):i[s]=a}o===0&&setTimeout(function(){t(i)},0)}catch(l){n(l)}})},r.race=function(e){return new r(function(t,n){if(!(!e||!e.length))try{for(var i=function(s){var a=e[s];a&&Ch(a.then)?a.then(t,n):setTimeout(function(){t(a)},0)},o=0;o<e.length;o++)i(o)}catch(s){n(s)}})},r}(),sf=Yce});function eb(){return new Date().getTime()}var $ce,q8,ZC,wh,EF,zce,G8,Y8=te(()=>{d();vr();_F();dd();$ce=6e5,q8=0,ZC=[],wh=[],EF=[];zce=function(){function r(e,t){var n=0,i=(e||"<unnamed>")+"."+q8;q8++,Ge(r,this,function(a){var l=null,c=0;a.scheduleEvent=function(p,f,m){var h=i+"."+c;c++,f&&(h+="-("+f+")");var g=h+"{"+n+"}";n++;var v={evt:null,tm:eb(),id:g,isRunning:!1,isAborted:!1};return l?v.evt=R(v,l):v.evt=w(v),l=v,l.evt._schId=g,v.evt;function I(j){for(var ne=eb(),N=ne-$ce,ee=j.length,ye=0;ye<ee;){var Ve=j[ye];if(Ve&&Ve.tm<N){var Pe=null;Ve.abort?(Pe="Aborting ["+Ve.id+"] due to Excessive runtime ("+(ne-Ve.tm)+" ms)",Ve.abort(Pe)):Pe="Removing ["+Ve.id+"] due to Excessive runtime ("+(ne-Ve.tm)+" ms)",s(Pe),j.splice(ye,1),ee--}else ye++}}function S(j,ne){var N=!1,ee=u(ZC,j);if(ee||(ee=u(EF,j),N=!0),ee){ee.to&&(clearTimeout(ee.to),ee.to=null);var ye=eb()-ee.tm;ne?N?s("Timed out event ["+j+"] finally complete -- "+ye+" ms"):o("Promise ["+j+"] Complete -- "+ye+" ms"):(EF.push(ee),s("Event ["+j+"] Timed out and removed -- "+ye+" ms"))}else o("Failed to remove ["+j+"] from running queue");l&&l.id===j&&(l=null),I(ZC),I(wh),I(EF)}function x(j,ne){return function(N){return S(j,!0),ne&&ne(N),N}}function D(j,ne,N,ee){ne.then(function(ye){return ye instanceof sf?(o("Event ["+j+"] returned a promise -- waiting"),D(j,ye,N,ee),ye):x(j,N)(ye)},x(j,ee))}function A(j,ne){var N=j.id;return new sf(function(ee,ye){o("Event ["+N+"] Starting -- waited for "+(j.wTm||"--")+" ms"),j.isRunning=!0,j.abort=function(Pe){j.abort=null,j.isAborted=!0,S(N,!1),ye(new Error(Pe))};var Ve=ne(N);Ve instanceof sf?(m&&(j.to=setTimeout(function(){S(N,!1),ye(new Error("Timed out after ["+m+"] ms"))},m)),D(N,Ve,function(Pe){o("Event ["+N+"] Resolving after "+(eb()-j.tm)+" ms"),ee(Pe)},ye)):(o("Promise ["+N+"] Auto completed as the start action did not return a promise"),ee())})}function w(j){var ne=eb();return j.wTm=ne-j.tm,j.tm=ne,j.isAborted?sf.reject(new Error("["+h+"] was aborted")):(ZC.push(j),A(j,p))}function R(j,ne){var N=new sf(function(ee,ye){var Ve=eb()-ne.tm,Pe=ne.id;o("["+h+"] is waiting for ["+Pe+":"+Ve+" ms] to complete before starting -- ["+wh.length+"] waiting and ["+ZC.length+"] running"),j.abort=function(le){j.abort=null,u(wh,h),j.isAborted=!0,ye(new Error(le))},ne.evt.then(function(le){u(wh,h),w(j).then(ee,ye)},function(le){u(wh,h),w(j).then(ee,ye)})});return wh.push(j),N}};function u(p,f){for(var m=0;m<p.length;m++)if(p[m].id===f)return p.splice(m,1)[0];return null}});function o(a){var l=Jn();l&&l.QUnit&&console&&console.log("ESPromiseScheduler["+i+"] "+a)}function s(a){vl(t,"ESPromiseScheduler["+i+"] "+a)}}return r.incomplete=function(){return ZC},r.waitingToStart=function(){return wh},r}(),G8=zce});var $8,z8=te(()=>{d();dd();qC();XC();$8=function(){function r(e){var t=this,n={},i=[],o=[];e&&o.push(e);function s(u,p){var f,m=n[u];if(m&&(f=m[p]),!f&&f!==null){if(hn(u)&&hn(p))if(o.length>0){for(var h=0;h<o.length;h++)if(o[h].handleField(u,p)){f={canHandle:!0,fieldHandler:o[h]};break}}else i.length===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var h=0;h<i.length;h++)if(i[h].handleField(u,p)){f={canHandle:!0,handler:i[h],fieldHandler:null};break}}m||(m=n[u]={}),m[p]=f}return f}t.addSanitizer=function(u){u&&(i.push(u),n={})},t.addFieldSanitizer=function(u){u&&(o.push(u),n={})},t.handleField=function(u,p){var f=s(u,p);return f?f.canHandle:!1},t.value=function(u,p,f,m){var h=s(u,p);if(h&&h.canHandle){if(!h||!h.canHandle)return null;if(h.handler)return h.handler.value(u,p,f,m);if(!hn(p)||xt(f)||f===El)return null;var g=null,v=Cl(f);if((v&8192)===8192){var I=v&-8193;if(g=f,!Gn(g.value)||I!==1&&I!==2&&I!==3&&(I&4096)!==4096)return null}else v===1||v===2||v===3||(v&4096)===4096?g=l(u,p,f):v===4&&(g=l(u,p,m?JSON.stringify(f):f));if(g)return a(h,u,p,v,g,m)}return null},t.property=function(u,p,f,m){var h=s(u,p);if(!h||!h.canHandle||!hn(p)||xt(f)||!Gn(f.value))return null;var g=Cl(f.value);return g===0?null:a(h,u,p,g,f,m)};function a(u,p,f,m,h,g){if(u.handler)return u.handler.property(p,f,h,g);if(!xt(h.kind)){if((m&4096)===4096||!Zy(h.kind))return null;h.value=h.value.toString()}return c(u.fieldHandler,p,f,m,h)}function l(u,p,f){return Gn(f)?{value:f}:null}function c(u,p,f,m,h){if(h&&u){var g=u.getSanitizer(p,f,m,h.kind,h.propertyType);if(g)if(m===4){var v={},I=h.value;Jr(I,function(x,D){var A=p+"."+f;if(Gn(D)){var w=l(A,x,D);w=c(u,A,x,Cl(D),w),w&&(v[x]=w.value)}}),h.value=v}else{var S={path:p,name:f,type:m,prop:h,sanitizer:t};h=g.call(t,S)}}return h}}return r.getFieldType=Cl,r}()});var Q8={};Um(Q8,{AppInsightsCore:()=>j8,BaseCore:()=>H8,BaseTelemetryPlugin:()=>Ih,CoreUtils:()=>V8,DiagnosticLogger:()=>gl,ESPromise:()=>sf,ESPromiseScheduler:()=>G8,EventHelper:()=>zK,EventLatency:()=>A8,EventPersistence:()=>O8,EventPropertyType:()=>M8,EventsDiscardedReason:()=>ml,FullVersionString:()=>fd,InternalAppInsightsCore:()=>jC,InternalBaseCore:()=>Sh,LoggingSeverity:()=>dF,MinChannelPriorty:()=>eK,NotificationManager:()=>VC,PerfEvent:()=>hh,PerfManager:()=>wC,ProcessTelemetryContext:()=>sF,TraceLevel:()=>L8,Undefined:()=>nr,Utils:()=>W8,ValueKind:()=>R8,ValueSanitizer:()=>$8,Version:()=>lk,_ExtendedInternalMessageId:()=>K8,_InternalLogMessage:()=>mh,_InternalMessageId:()=>JC,__getRegisteredEvents:()=>YK,_logInternalMessage:()=>UK,_throwInternal:()=>tn,_warnToConsole:()=>vl,addEventHandler:()=>tf,addEventListeners:()=>$T,addPageHideEventListener:()=>Jy,addPageShowEventListener:()=>qy,addPageUnloadEventListener:()=>yh,areCookiesSupported:()=>Il,arrForEach:()=>je,arrIndexOf:()=>ni,arrMap:()=>sh,arrReduce:()=>ah,attachEvent:()=>By,cookieAvailable:()=>Il,createCookieMgr:()=>od,createEnumStyle:()=>No,createGuid:()=>SF,createProcessTelemetryContext:()=>ss,createTraceParent:()=>eF,createUniqueNamespace:()=>bl,createUnloadHandlerContainer:()=>bh,dateNow:()=>ii,deleteCookie:()=>yF,detachEvent:()=>Hy,disableCookies:()=>gF,disallowsSameSiteNone:()=>Vy,doPerf:()=>wn,dumpObj:()=>ln,eventOff:()=>vh,eventOn:()=>gh,extend:()=>of,findW3cTraceParent:()=>nF,formatTraceParent:()=>rF,generateW3CId:()=>ad,getCommonSchemaMetaData:()=>QC,getConsole:()=>IC,getCookie:()=>bF,getCookieValue:()=>IF,getCrypto:()=>SC,getDocument:()=>os,getExceptionName:()=>lh,getFieldValueType:()=>Cl,getGlobal:()=>Jn,getGlobalInst:()=>gn,getHistory:()=>NK,getIEVersion:()=>RK,getISOString:()=>ya,getJSON:()=>Ly,getLocation:()=>dh,getMsCrypto:()=>_C,getNavigator:()=>Os,getPerformance:()=>Oy,getSetValue:()=>qp,getTenantId:()=>YC,getTime:()=>Ro,getWindow:()=>Mc,hasDocument:()=>OT,hasHistory:()=>LT,hasJSON:()=>ph,hasNavigator:()=>bC,hasOwnProperty:()=>Zu,hasWindow:()=>yC,isArray:()=>bt,isArrayValid:()=>ck,isBeaconsSupported:()=>Yp,isBoolean:()=>ed,isChromium:()=>uk,isDate:()=>ky,isDocumentObjectAvailable:()=>GC,isError:()=>oh,isFetchSupported:()=>Ky,isFunction:()=>Zt,isIE:()=>hl,isLatency:()=>$C,isNotTruthy:()=>mK,isNullOrUndefined:()=>xt,isNumber:()=>rs,isObject:()=>Oi,isReactNative:()=>id,isSampledFlag:()=>tF,isString:()=>hn,isTruthy:()=>Ny,isTypeof:()=>Py,isUint8ArrayAvailable:()=>hF,isUndefined:()=>gr,isValidSpanId:()=>zy,isValidTraceId:()=>$y,isValidTraceParent:()=>XT,isValueAssigned:()=>Gn,isValueKind:()=>Zy,isWindowObjectAvailable:()=>mF,isXhrSupported:()=>Fy,mergeEvtNamespace:()=>sd,newGuid:()=>Gy,newId:()=>Qp,normalizeJsName:()=>nh,objCreate:()=>Po,objDefineAccessors:()=>Ms,objForEachKey:()=>Jr,objFreeze:()=>ns,objKeys:()=>ko,objSeal:()=>fK,openXhr:()=>dk,optimizeObject:()=>td,parseTraceParent:()=>KC,perfNow:()=>Yy,proxyAssign:()=>hK,proxyFunctionAs:()=>Gp,proxyFunctions:()=>ch,random32:()=>yl,randomValue:()=>Wy,removeEventHandler:()=>YT,removeEventListeners:()=>ef,removePageHideEventListener:()=>OC,removePageShowEventListener:()=>LC,removePageUnloadEventListener:()=>MC,safeGetCookieMgr:()=>Zp,safeGetLogger:()=>EC,sanitizeProperty:()=>zC,setCookie:()=>vF,setEnableEnvMocks:()=>kK,setProcessTelemetryTimings:()=>Eh,setValue:()=>is,strContains:()=>Rn,strEndsWith:()=>ih,strFunction:()=>an,strObject:()=>ht,strPrototype:()=>Vt,strStartsWith:()=>Ty,strTrim:()=>qr,strUndefined:()=>nr,throwError:()=>oi,toISOString:()=>ya,useXDomainRequest:()=>fh});var xh=te(()=>{d();F8();B8();J8();_F();Y8();z8();dd();XC()});var Dh,pk,fk,CF=te(()=>{d();Dh="REAL_TIME",pk="NEAR_REAL_TIME",fk="BEST_EFFORT"});var wl,mk,X8,hk,Z8,wF,e6,t6,r6,xF,DF,gk,n6,PF,i6,TF,vk,kF,yk,bk,Ik,ew,NF,o6,tb,RF,Sk,tw=te(()=>{d();wl="",mk="POST",X8="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",hk="drop",Z8="send",wF="requeue",e6="rspFail",t6="oth",r6="no-cache, no-store",xF="application/x-json-stream",DF="cache-control",gk="content-type",n6="kill-tokens",PF="kill-duration",i6="kill-duration-seconds",TF="time-delta-millis",vk="client-version",kF="client-id",yk="time-delta-to-apply-millis",bk="upload-time",Ik="apikey",ew="AuthMsaDeviceTicket",NF="AuthXToken",o6="NoResponseBody",tb="msfpc",RF="trace",Sk="user"});function a6(r){var e=(r.ext||{}).intweb;return e&&Gn(e[tb])?e[tb]:null}function s6(r){for(var e=null,t=0;e===null&&t<r.length;t++)e=a6(r[t]);return e}var rb,AF=te(()=>{d();xh();tw();rb=function(){function r(e,t){var n=t?[].concat(t):[],i=this,o=s6(n);i.iKey=function(){return e},i.Msfpc=function(){return o||wl},i.count=function(){return n.length},i.events=function(){return n},i.addEvent=function(s){return s?(n.push(s),o||(o=a6(s)),!0):!1},i.split=function(s,a){var l;if(s<n.length){var c=n.length-s;xt(a)||(c=a<c?a:c),l=n.splice(s,c),o=s6(n)}return new r(e,l)}}return r.create=function(e,t){return new r(e,t)},r}()});var Qce,l6,c6=te(()=>{d();vr();Qce=function(){function r(){var e=!0,t=!0,n=!0,i="use-collector-delta",o=!1;Ge(r,this,function(s){s.allowRequestSending=function(){return e},s.firstRequestSent=function(){n&&(n=!1,o||(e=!1))},s.shouldAddClockSkewHeaders=function(){return t},s.getClockSkewHeaderValue=function(){return i},s.setClockSkew=function(a){o||(a?(i=a,t=!0,o=!0):t=!1,e=!0)}})}return r.__ieDyn=1,r}(),l6=Qce});var Xce,Zce,u6,d6=te(()=>{d();vr();xh();Xce=1e3,Zce=function(){function r(){var e={};function t(n){var i=[];return n&&je(n,function(o){i.push(qr(o))}),i}Ge(r,this,function(n){n.setKillSwitchTenants=function(i,o){if(i&&o)try{var s=t(i.split(","));if(o==="this-request-only")return s;for(var a=parseInt(o,10)*Xce,l=0;l<s.length;++l)e[s[l]]=ii()+a}catch(c){return[]}return[]},n.isTenantKilled=function(i){var o=e,s=qr(i);return o[s]!==void 0&&o[s]>ii()?!0:(delete o[s],!1)}})}return r.__ieDyn=1,r}(),u6=Zce});function f6(r){return!(r>=300&&r<500&&r!=408&&r!=429||r==501||r==505)}function _k(r){var e=0,t=p6*eue,n=p6*tue,i=Math.floor(Math.random()*(n-t))+t;return e=Math.pow(2,r)*i,Math.min(e,rue)}var eue,tue,p6,rue,MF=te(()=>{d();eue=.8,tue=1.2,p6=3e3,rue=6e5});function h6(r,e,t,n){if(n&&r){var i=QC(n.value,n.kind,n.propertyType);if(i>-1){var o=r[m6];o||(o=r[m6]={f:{}});var s=o[Ek];if(s||(s=o[Ek]={}),e)for(var a=0;a<e.length;a++){var l=e[a];s[l]||(s[l]={f:{}});var c=s[l][Ek];c||(c=s[l][Ek]={}),s=c}s=s[t]={},bt(n.value)?s.a={t:i}:s.t=i}}}var nue,iue,g6,v6,oue,m6,Ek,sue,y6,b6=te(()=>{d();vr();xh();AF();tw();nue=20,iue=3984588,g6=65e3,v6=2e6,oue=Math.min(v6,g6),m6="metadata",Ek="f",sue=/\./,y6=function(){function r(e,t,n,i){var o="data",s="baseData",a="ext",l=!!i,c=!0,u=t,p={};Ge(r,this,function(f){f.createPayload=function(g,v,I,S,x,D){return{apiKeys:[],payloadBlob:wl,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:g,isTeardown:v,isSync:I,isBeacon:S,sendType:D,sendReason:x}},f.appendPayload=function(g,v,I){var S=g&&v&&!g.overflow;return S&&wn(e,function(){return"Serializer:appendPayload"},function(){for(var x=v.events(),D=g.payloadBlob,A=g.numEvents,w=!1,R=[],j=[],ne=g.isBeacon,N=ne?g6:iue,ee=ne?oue:v6,ye=0,Ve=0;ye<x.length;){var Pe=x[ye];if(Pe){if(A>=I){g.overflow=v.split(ye);break}var le=f.getEventBlob(Pe);if(le&&le.length<=ee){var At=le.length,Ye=D.length;if(Ye+At>N){g.overflow=v.split(ye);break}D&&(D+=`
`),D+=le,Ve++,Ve>nue&&(D.substr(0,1),Ve=0),w=!0,A++}else le?R.push(Pe):j.push(Pe),x.splice(ye,1),ye--}ye++}if(R&&R.length>0&&g.sizeExceed.push(rb.create(v.iKey(),R)),j&&j.length>0&&g.failedEvts.push(rb.create(v.iKey(),j)),w){g.batches.push(v),g.payloadBlob=D,g.numEvents=A;var Ir=v.iKey();ni(g.apiKeys,Ir)===-1&&g.apiKeys.push(Ir)}},function(){return{payload:g,theBatch:{iKey:v.iKey(),evts:v.events()},max:I}}),S},f.getEventBlob=function(g){try{return wn(e,function(){return"Serializer.getEventBlob"},function(){var v={};v.name=g.name,v.time=g.time,v.ver=g.ver,v.iKey="o:"+YC(g.iKey);var I={},S=g[a];S&&(v[a]=I,Jr(S,function(A,w){var R=I[A]={};h(w,R,"ext."+A,!0,null,null,!0)}));var x=v[o]={};x.baseType=g.baseType;var D=x[s]={};return h(g.baseData,D,s,!1,[s],function(A,w,R){h6(I,A,w,R)},c),h(g.data,x,o,!1,[],function(A,w,R){h6(I,A,w,R)},c),JSON.stringify(v)},function(){return{item:g}})}catch(v){return null}};function m(g,v){var I=p[g];return I===void 0&&(g.length>=7&&(I=Ty(g,"ext.metadata")||Ty(g,"ext.web")),p[g]=I),I}function h(g,v,I,S,x,D,A){Jr(g,function(w,R){var j=null;if(R||Gn(R)){var ne=I,N=w,ee=x,ye=v;if(l&&!S&&sue.test(w)){var Ve=w.split("."),Pe=Ve.length;if(Pe>1){ee&&(ee=ee.slice());for(var le=0;le<Pe-1;le++){var At=Ve[le];ye=ye[At]=ye[At]||{},ne+="."+At,ee&&ee.push(At)}N=Ve[Pe-1]}}var Ye=S&&m(ne,N);if(!Ye&&u&&u.handleField(ne,N)?j=u.value(ne,N,R,n):j=zC(N,R,n),j){var Ir=j.value;if(ye[N]=Ir,D&&D(ee,N,j),A&&typeof Ir=="object"&&!bt(Ir)){var en=ee;en&&(en=en.slice(),en.push(N)),h(R,Ir,ne+"."+N,S,en,D,A)}}}})}})}return r.__ieDyn=1,r}()});function Th(r,e,t){LF[r]=e,t!==!1&&(KF[e]=r)}function S6(r){try{return r.responseText}catch(e){}return wl}function _6(r,e){var t=!1;if(r&&e){var n=ko(r);if(n&&n.length>0)for(var i=e.toLowerCase(),o=0;o<n.length;o++){var s=n[o];if(s&&Zu(e,s)&&s.toLowerCase()===i){t=!0;break}}}return t}function nb(r,e,t,n){e&&t&&t.length>0&&(n&&LF[e]?(r.hdrs[LF[e]]=t,r.useHdrs=!0):r.url+="&"+e+"="+t)}function E6(r,e){return e&&(rs(e)?r=[e].concat(r):bt(e)&&(r=e.concat(r))),r}var Ph,OF,I6,aue,LF,KF,C6,w6=te(()=>{d();vr();c6();d6();xh();tw();MF();b6();OF="sendAttempt",I6="&"+o6+"=true",aue=(Ph={},Ph[1]=wF,Ph[100]=wF,Ph[200]="sent",Ph[8004]=hk,Ph[8003]=hk,Ph),LF={},KF={};Th(ew,ew,!1);Th(vk,vk);Th(kF,"Client-Id");Th(Ik,Ik);Th(yk,yk);Th(bk,bk);Th(NF,NF);C6=function(){function r(e,t,n,i,o){this._responseHandlers=[];var s="?cors=true&"+gk.toLowerCase()+"="+xF,a=new u6,l=!1,c=new l6,u=!1,p=0,f,m,h,g,v=!0,I=[],S={},x=[],D=null,A=!1,w,R=!1,j=!1,ne,N,ee,ye,Ve;Ge(r,this,function(Pe){var le=!0;Pe.initialize=function(F,pe,T,M,Z){var de;Z||(Z={}),s=F+s,j=gr(Z.avoidOptions)?!0:!Z.avoidOptions,g=pe,w=pe.getCookieMgr(),A=!g.config.disableEventTimings;var be=!!g.config.enableCompoundKey;f=T,m=f.diagLog();var V=Z.valueSanitizer,Y=Z.stringifyObjects;gr(Z.enableCompoundKey)||(be=!!Z.enableCompoundKey),ne=Z.xhrTimeout,N=!!Z.disableXhrSync,ee=!!Z.disableFetchKeepAlive,Ve=Z.addNoResponse!==!1,u=!id(),D=new y6(g,V,Y,be),xt(Z.useSendBeacon)||(u=!!Z.useSendBeacon);var $=M,se=Z.alwaysUseXhrOverride?M:null,Ee=Z.alwaysUseXhrOverride?M:null,G=[3,2];if(!M){v=!1;var ae=dh();ae&&ae.protocol&&ae.protocol.toLowerCase()==="file:"&&(le=!1);var K=[];id()?(K=[2,1],G=[2,1,3]):K=[1,2,3],K=E6(K,Z.transports),M=At(K,!1),M||vl(m,"No available transport to send events"),$=At(K,!0)}se||(G=E6(G,Z.unloadTransports),se=At(G,!0)),ye=!v&&(u&&Yp()||!ee&&Ky(!0)),h=(de={},de[0]=M,de[1]=$||At([1,2,3],!0),de[2]=se||$||At([1],!0),de[3]=Ee||At([2,3],!0)||$||At([1],!0),de)};function At(F,pe){for(var T=0,M=null,Z=0;M==null&&Z<F.length;)T=F[Z],T===1?fh()?M=Ye:Fy()&&(M=en):T===2&&Ky(pe)&&(!pe||pe&&!ee)?M=Ir:u&&T===3&&Yp()&&(M=fe),Z++;return M?{_transport:T,_isSync:pe,sendPOST:M}:null}Pe._getDbgPlgTargets=function(){return[h[0],a,D,h]};function Ye(F,pe,T){var M=new XDomainRequest;M.open(mk,F.urlString),F.timeout&&(M.timeout=F.timeout),M.onload=function(){var Z=S6(M);H(pe,200,{},Z),rr(Z)},M.onerror=function(){H(pe,400,{})},M.ontimeout=function(){H(pe,500,{})},M.onprogress=function(){},T?M.send(F.data):o.set(function(){M.send(F.data)},0)}function Ir(F,pe,T){var M,Z=F.urlString,de=!1,be=!1,V=(M={body:F.data,method:mk},M[X8]=!0,M);T&&(V.keepalive=!0,F._sendReason===2&&(de=!0,Ve&&(Z+=I6))),le&&(V.credentials="include"),F.headers&&ko(F.headers).length>0&&(V.headers=F.headers),fetch(Z,V).then(function(Y){var $={},se=wl,Ee=Y.headers;Ee&&Ee.forEach(function(G,ae){$[ae]=G}),Y.body&&Y.text().then(function(G){se=G}),be||(be=!0,H(pe,Y.status,$,se),rr(se))}).catch(function(Y){be||(be=!0,H(pe,0,{}))}),de&&!be&&(be=!0,H(pe,200,{})),!be&&F.timeout>0&&o.set(function(){be||(be=!0,H(pe,500,{}))},F.timeout)}function en(F,pe,T){var M=F.urlString;function Z(Y,$,se){if(!Y[se]&&$&&$.getResponseHeader){var Ee=$.getResponseHeader(se);Ee&&(Y[se]=qr(Ee))}return Y}function de(Y){var $={};return Y.getAllResponseHeaders?$=et(Y.getAllResponseHeaders()):($=Z($,Y,TF),$=Z($,Y,PF),$=Z($,Y,i6)),$}function be(Y,$){H(pe,Y.status,de(Y),$)}T&&F.disableXhrSync&&(T=!1);var V=dk(mk,M,le,!0,T,F.timeout);Jr(F.headers,function(Y,$){V.setRequestHeader(Y,$)}),V.onload=function(){var Y=S6(V);be(V,Y),rr(Y)},V.onerror=function(){be(V)},V.ontimeout=function(){be(V)},V.send(F.data)}function H(F,pe,T,M){try{F(pe,T,M)}catch(Z){tn(m,2,518,ln(Z))}}function fe(F,pe,T){var M=F,Z=200,de=M._thePayload,be=F.urlString+(Ve?I6:wl);try{var V=Os();if(!V.sendBeacon(be,F.data))if(de){var Y=[];je(de.batches,function($){if(Y&&$&&$.count()>0){for(var se=$.events(),Ee=0;Ee<se.length;Ee++)if(!V.sendBeacon(be,D.getEventBlob(se[Ee]))){Y.push($.split(Ee));break}}else Y.push($.split(0))}),Ut(Y,8003,de.sendType,!0)}else Z=0}catch($){vl(m,"Failed to send telemetry using sendBeacon API. Ex:"+ln($)),Z=0}finally{H(pe,Z,{},wl)}}function Ae(F){return F===2||F===3}function _e(F){return R&&Ae(F)&&(F=2),F}Pe.addQueryStringParameter=function(F,pe){for(var T=0;T<I.length;T++)if(I[T].name===F){I[T].value=pe;return}I.push({name:F,value:pe})},Pe.addHeader=function(F,pe){S[F]=pe},Pe.canSendRequest=function(){return Te()&&c.allowRequestSending()},Pe.sendQueuedRequests=function(F,pe){gr(F)&&(F=0),R&&(F=_e(F),pe=2),ce(x,F,0)&&ke(L(),0,!1,F,pe||0)},Pe.isCompletelyIdle=function(){return!l&&p===0&&x.length===0},Pe.setUnloading=function(F){R=F},Pe.addBatch=function(F){if(F&&F.count()>0){if(a.isTenantKilled(F.iKey()))return!1;x.push(F)}return!0},Pe.teardown=function(){x.length>0&&ke(L(),0,!0,2,2)},Pe.pause=function(){l=!0},Pe.resume=function(){l=!1,Pe.sendQueuedRequests(0,4)},Pe.sendSynchronousBatch=function(F,pe,T){F&&F.count()>0&&(xt(pe)&&(pe=1),R&&(pe=_e(pe),T=2),ke([F],0,!1,pe,T||0))};function Te(){return!l&&p<t}function L(){var F=x;return x=[],F}function ce(F,pe,T){var M=!1;return F&&F.length>0&&!l&&h[pe]&&D&&(M=pe!==0||Te()&&(T>0||c.allowRequestSending())),M}function ve(F){var pe={};return F&&je(F,function(T,M){pe[M]={iKey:T.iKey(),evts:T.events()}}),pe}function ke(F,pe,T,M,Z){if(!(!F||F.length===0)){if(l){Ut(F,1,M);return}M=_e(M);try{var de=F,be=M!==0;wn(g,function(){return"HttpManager:_sendBatches"},function(V){V&&(F=F.slice(0));for(var Y=[],$=null,se=Ro(),Ee=h[M]||(be?h[1]:h[0]),G=Ee&&Ee._transport,ae=ye&&(R||Ae(M)||G===3||Ee._isSync&&G===2);ce(F,M,pe);){var K=F.shift();K&&K.count()>0&&(a.isTenantKilled(K.iKey())?Y.push(K):($=$||D.createPayload(pe,T,be,ae,Z,M),D.appendPayload($,K,e)?$.overflow!==null&&(F=[$.overflow].concat(F),$.overflow=null,k($,se,Ro(),Z),se=Ro(),$=null):(k($,se,Ro(),Z),se=Ro(),F=[K].concat(F),$=null)))}$&&k($,se,Ro(),Z),F.length>0&&(x=F.concat(x)),Ut(Y,8004,M)},function(){return{batches:ve(de),retryCount:pe,isTeardown:T,isSynchronous:be,sendReason:Z,useSendBeacon:Ae(M),sendType:M}},!be)}catch(V){tn(m,2,48,"Unexpected Exception sending batch: "+ln(V))}}}function We(F,pe){var T={url:s,hdrs:{},useHdrs:!1};pe?(T.hdrs=of(T.hdrs,S),T.useHdrs=ko(T.hdrs).length>0):Jr(S,function(V,Y){KF[V]?nb(T,KF[V],Y,!1):(T.hdrs[V]=Y,T.useHdrs=!0)}),nb(T,kF,"NO_AUTH",pe),nb(T,vk,fd,pe);var M=wl;je(F.apiKeys,function(V){M.length>0&&(M+=","),M+=V}),nb(T,Ik,M,pe),nb(T,bk,ii().toString(),pe);var Z=Et(F);if(Gn(Z)&&(T.url+="&ext.intweb.msfpc="+Z),c.shouldAddClockSkewHeaders()&&nb(T,yk,c.getClockSkewHeaderValue(),pe),g.getWParam){var de=g.getWParam();de>=0&&(T.url+="&w="+de)}for(var be=0;be<I.length;be++)T.url+="&"+I[be].name+"="+I[be].value;return T}function it(F,pe,T){F[pe]=F[pe]||{},F[pe][f.identifier]=T}function k(F,pe,T,M){if(F&&F.payloadBlob&&F.payloadBlob.length>0){var Z=!!Pe.sendHook,de=h[F.sendType];!Ae(F.sendType)&&F.isBeacon&&F.sendReason===2&&(de=h[2]||h[3]||de);var be=j;(F.isBeacon||de._transport===3)&&(be=!1);var V=We(F,be);be=be||V.useHdrs;var Y=Ro();wn(g,function(){return"HttpManager:_doPayloadSend"},function(){for(var $=0;$<F.batches.length;$++)for(var se=F.batches[$],Ee=se.events(),G=0;G<Ee.length;G++){var ae=Ee[G];if(A){var K=ae.timings=ae.timings||{};it(K,"sendEventStart",Y),it(K,"serializationStart",pe),it(K,"serializationCompleted",T)}ae[OF]>0?ae[OF]++:ae[OF]=1}Ut(F.batches,1e3+(M||0),F.sendType,!0);var U={data:F.payloadBlob,urlString:V.url,headers:V.hdrs,_thePayload:F,_sendReason:M,timeout:ne,disableXhrSync:N,disableFetchKeepAlive:ee};be&&(_6(U.headers,DF)||(U.headers[DF]=r6),_6(U.headers,gk)||(U.headers[gk]=xF));var ie=null;de&&(ie=function(Oe){c.firstRequestSent();var Ue=function(hi,Bu){me(hi,Bu,F,M)},Wt=F.isTeardown||F.isSync;try{de.sendPOST(Oe,Ue,Wt),Pe.sendListener&&Pe.sendListener(U,Oe,Wt,F.isBeacon)}catch(hi){vl(m,"Unexpected exception sending payload. Ex:"+ln(hi)),H(Ue,0,{})}}),wn(g,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(ie)if(F.sendType===0&&p++,Z&&!F.isBeacon&&de._transport!==3){var Oe={data:U.data,urlString:U.urlString,headers:of({},U.headers),timeout:U.timeout,disableXhrSync:U.disableXhrSync,disableFetchKeepAlive:U.disableFetchKeepAlive},Ue=!1;wn(g,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{Pe.sendHook(Oe,function(Wt){Ue=!0,!v&&!Wt._thePayload&&(Wt._thePayload=Wt._thePayload||U._thePayload,Wt._sendReason=Wt._sendReason||U._sendReason),ie(Wt)},F.isSync||F.isTeardown)}catch(Wt){Ue||ie(U)}})}else ie(U)})},function(){return{thePayload:F,serializationStart:pe,serializationCompleted:T,sendReason:M}},F.isSync)}F.sizeExceed&&F.sizeExceed.length>0&&Ut(F.sizeExceed,8003,F.sendType),F.failedEvts&&F.failedEvts.length>0&&Ut(F.failedEvts,8002,F.sendType)}function W(F,pe){A&&je(F,function(T){var M=T.timings=T.timings||{};it(M,"sendEventCompleted",pe)})}function me(F,pe,T,M){var Z=9e3,de=null,be=!1,V=!1;try{var Y=!0;if(typeof F!==nr){if(pe){c.setClockSkew(pe[TF]);var $=pe[PF]||pe["kill-duration-seconds"];je(a.setKillSwitchTenants(pe[n6],$),function(Ee){je(T.batches,function(G){if(G.iKey()===Ee){de=de||[];var ae=G.split(0);T.numEvents-=ae.count(),de.push(ae)}})})}if(F==200||F==204){Z=200;return}(!f6(F)||T.numEvents<=0)&&(Y=!1),Z=9e3+F%1e3}if(Y){Z=100;var se=T.retryCnt;T.sendType===0&&(se<n?(be=!0,Xt(function(){T.sendType===0&&p--,ke(T.batches,se+1,T.isTeardown,R?2:T.sendType,5)},R,_k(se))):(V=!0,R&&(Z=8001)))}}finally{be||(c.setClockSkew(),we(T,Z,M,V)),Ut(de,8004,T.sendType)}}function we(F,pe,T,M){try{M&&f._backOffTransmission(),pe===200&&(!M&&!F.isSync&&f._clearBackOff(),Fe(F.batches)),Ut(F.batches,pe,F.sendType,!0)}finally{F.sendType===0&&(p--,T!==5&&Pe.sendQueuedRequests(F.sendType,T))}}function Fe(F){if(A){var pe=Ro();je(F,function(T){T&&T.count()>0&&W(T.events(),pe)})}}function Xt(F,pe,T){pe?F():o.set(F,T)}function et(F){var pe={};if(hn(F)){var T=qr(F).split(/[\r\n]+/);je(T,function(M){if(M){var Z=M.indexOf(": ");if(Z!==-1){var de=qr(M.substring(0,Z)).toLowerCase(),be=qr(M.substring(Z+1));pe[de]=be}else pe[qr(M)]=1}})}return pe}function Et(F){for(var pe=0;pe<F.batches.length;pe++){var T=F.batches[pe].Msfpc();if(T)return encodeURIComponent(T)}return wl}function rr(F){var pe=Pe._responseHandlers;try{for(var T=0;T<pe.length;T++)try{pe[T](F)}catch(Z){tn(m,1,519,"Response handler failed: "+Z)}if(F){var M=JSON.parse(F);Gn(M.webResult)&&Gn(M.webResult[tb])&&w.set("MSFPC",M.webResult[tb],365*86400)}}catch(Z){}}function Ut(F,pe,T,M){if(F&&F.length>0&&i){var Z=i[Ar(pe)];if(Z){var de=T!==0;wn(g,function(){return"HttpManager:_sendBatchesNotification"},function(){Xt(function(){try{Z.call(i,F,pe,de,T)}catch(be){tn(m,1,74,"send request notification failed: "+be)}},M||de,0)},function(){return{batches:ve(F),reason:pe,isSync:de,sendSync:M,sendType:T}},!de)}}}function Ar(F){var pe=aue[F];return Gn(pe)||(pe=t6,F>=9e3&&F<=9999?pe=e6:F>=8e3&&F<=8999?pe=hk:F>=1e3&&F<=1999&&(pe=Z8)),pe}})}return r.__ieDyn=1,r}()});function lue(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout(r,e,t)}function cue(r){clearTimeout(r)}function rw(r,e){return{set:r||lue,clear:e||cue}}var x6=te(()=>{d()});var uue,D6,due,P6,T6,pue,k6,fue,kh,Ck,N6,R6,mue,hue,A6,M6=te(()=>{d();pr();vr();xh();CF();AF();w6();tw();MF();x6();uue=.25,D6=500,due=20,P6=6,T6=2,pue=4,k6=2,fue=1,kh="eventsDiscarded",Ck="overrideInstrumentationKey",N6="maxEventRetryAttempts",R6="maxUnloadEventRetryAttempts",mue="addUnloadCb",hue=function(r){Cn(e,r);function e(){var t=r.call(this)||this;t.identifier="PostChannel",t.priority=1011,t.version="3.2.9";var n,i=!1,o=[],s=null,a=!1,l=0,c=500,u=0,p=1e4,f={},m=Dh,h=null,g=null,v=0,I=0,S,x,D={},A,w,R=-1,j,ne=!0,N=!1,ee=P6,ye=T6,Ve,Pe;return Ge(e,t,function(le,At){Te(),le._getDbgPlgTargets=function(){return[x]},le.initialize=function(V,Y,$){wn(Y,function(){return"PostChannel:initialize"},function(){var se=Y;At.initialize(V,Y,$);try{var Ee=!!Y[mue];Ve=sd(bl(le.identifier),Y.evtNamespace&&Y.evtNamespace());var G=le._getTelCtx();V.extensionConfig[le.identifier]=V.extensionConfig[le.identifier]||{},n=G.getExtCfg(le.identifier),Pe=rw(n.setTimeoutOverride,n.clearTimeoutOverride),ne=!n.disableOptimizeObj&&uk(),Ye(se),n.eventsLimitInMem>0&&(p=n.eventsLimitInMem),n.immediateEventLimit>0&&(c=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(A=n.autoFlushEventsLimit),rs(n[N6])&&(ee=n[N6]),rs(n[R6])&&(ye=n[R6]),be(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(S=n.httpXHROverride),Gn(V.anonCookieName)&&x.addQueryStringParameter("anoncknm",V.anonCookieName),x.sendHook=n.payloadPreprocessor,x.sendListener=n.payloadListener;var ae=n.overrideEndpointUrl?n.overrideEndpointUrl:V.endpointUrl;le._notificationManager=Y.getNotifyMgr(),x.initialize(ae,le.core,le,S,n);var K=V.disablePageUnloadEvents||[];yh(Ir,K,Ve),Jy(Ir,K,Ve),qy(en,V.disablePageShowEvents,Ve)}catch(U){throw le.setInitialized(!1),U}},function(){return{coreConfig:V,core:Y,extensions:$}})},le.processTelemetry=function(V,Y){Eh(V,le.identifier),Y=le._getTelCtx(Y);var $=Y.getExtCfg(le.identifier),se=!!n.disableTelemetry;$&&(se=se||!!$.disableTelemetry);var Ee=V;!se&&!i&&(n[Ck]&&(Ee.iKey=n[Ck]),$&&$[Ck]&&(Ee.iKey=$[Ck]),H(Ee,!0),N?ve(2,2):_e()),le.processNext(Ee,Y)},le._doTeardown=function(V,Y){ve(2,2),i=!0,x.teardown(),MC(null,Ve),OC(null,Ve),LC(null,Ve),Te()};function Ye(V){var Y=V.getWParam;V.getWParam=function(){var $=0;return n.ignoreMc1Ms0CookieProcessing&&($=$|2),$|Y()}}function Ir(V){var Y=V||Mc().event;Y.type!=="beforeunload"&&(N=!0,x.setUnloading(N)),ve(2,2)}function en(V){N=!1,x.setUnloading(N)}function H(V,Y){if(V.sendAttempt||(V.sendAttempt=0),V.latency||(V.latency=1),V.ext&&V.ext[RF]&&delete V.ext[RF],V.ext&&V.ext[Sk]&&V.ext[Sk].id&&delete V.ext[Sk].id,ne&&(Eh,V.ext=td(V.ext),V.baseData&&(V.baseData=td(V.baseData)),V.data&&(V.data=td(V.data))),V.sync){if(v||a)V.latency=3,V.sync=!1;else if(x){ne&&(V=td(V)),x.sendSynchronousBatch(rb.create(V.iKey,[V]),V.sync===!0?1:V.sync,3);return}}var $=V.latency,se=u,Ee=p;$===4&&(se=l,Ee=c);var G=!1;if(se<Ee)G=!k(V,Y);else{var ae=1,K=due;$===4&&(ae=4,K=1),G=!0,W(V.iKey,V.latency,ae,K)&&(G=!k(V,Y))}G&&Ar(kh,[V],ml.QueueFull)}le.setEventQueueLimits=function(V,Y){p=V>0?V:1e4,A=Y>0?Y:0,be();var $=u>V;if(!$&&w>0)for(var se=1;!$&&se<=3;se++){var Ee=D[se];Ee&&Ee.batches&&je(Ee.batches,function(G){G&&G.count()>=w&&($=!0)})}it(!0,$)},le.pause=function(){ce(),a=!0,x.pause()},le.resume=function(){a=!1,x.resume(),_e()},le.addResponseHandler=function(V){x._responseHandlers.push(V)},le._loadTransmitProfiles=function(V){et(),Jr(V,function(Y,$){var se=$.length;if(se>=2){var Ee=se>2?$[2]:0;if($.splice(0,se-2),$[1]<0&&($[0]=-1),$[1]>0&&$[0]>0){var G=$[0]/$[1];$[0]=Math.ceil(G)*$[1]}Ee>=0&&$[1]>=0&&Ee>$[1]&&(Ee=$[1]),$.push(Ee),f[Y]=$}})},le.flush=function(V,Y,$){if(V===void 0&&(V=!0),!a)if($=$||1,V)s==null?(ce(),we(1,0,$),s=L(function(){s=null,Fe(Y,$)},0)):o.push(Y);else{var se=ce();fe(1,1,$),Y!=null&&Y(),se&&_e()}},le.setMsaAuthTicket=function(V){x.addHeader(ew,V)},le.hasEvents=Ae,le._setTransmitProfile=function(V){m!==V&&f[V]!==void 0&&(ce(),m=V,_e())};function fe(V,Y,$){var se=we(V,Y,$);return x.sendQueuedRequests(Y,$),se}function Ae(){return u>0}function _e(){if(R>=0&&we(R,0,j)&&x.sendQueuedRequests(0,j),l>0&&!g&&!a){var V=f[m][2];V>=0&&(g=L(function(){g=null,fe(4,0,1),_e()},V))}var Y=f[m][1];!h&&!s&&Y>=0&&!a&&(Ae()?h=L(function(){h=null,fe(I===0?3:1,0,1),I++,I%=2,_e()},Y):I=0)}le._backOffTransmission=function(){v<pue&&(v++,ce(),_e())},le._clearBackOff=function(){v&&(v=0,ce(),_e())};function Te(){n=null,i=!1,o=[],s=null,a=!1,l=0,c=500,u=0,p=1e4,f={},m=Dh,h=null,g=null,v=0,I=0,S=null,D={},A=void 0,w=0,R=-1,j=null,ne=!0,N=!1,ee=P6,ye=T6,Ve=null,Pe=rw(),x=new C6(D6,k6,fue,{requeue:rr,send:pe,sent:T,drop:M,rspFail:Z,oth:de},Pe),Et(),ke(),be()}function L(V,Y){Y===0&&v&&(Y=1);var $=1e3;return v&&($=_k(v-1)),Pe.set(V,Y*$)}function ce(){return h!==null?(Pe.clear(h),h=null,I=0,!0):!1}function ve(V,Y){ce(),s&&(Pe.clear(s),s=null),a||fe(1,V,Y)}function ke(){D[4]={batches:[],iKeyMap:{}},D[3]={batches:[],iKeyMap:{}},D[2]={batches:[],iKeyMap:{}},D[1]={batches:[],iKeyMap:{}}}function We(V,Y,$){var se=D[Y];se||(Y=1,se=D[Y]);var Ee=se.iKeyMap[V];return!Ee&&$&&(Ee=rb.create(V),se.batches.push(Ee),se.iKeyMap[V]=Ee),Ee}function it(V,Y){x.canSendRequest()&&!v&&(A>0&&u>A&&(Y=!0),Y&&s==null&&le.flush(V,null,20))}function k(V,Y){ne&&(V=td(V));var $=V.latency,se=We(V.iKey,$,!0);return se.addEvent(V)?($!==4?(u++,Y&&V.sendAttempt===0&&it(!V.sync,w>0&&se.count()>=w)):l++,!0):!1}function W(V,Y,$,se){for(;$<=Y;){var Ee=We(V,Y,!0);if(Ee&&Ee.count()>0){var G=Ee.split(0,se),ae=G.count();if(ae>0)return $===4?l-=ae:u-=ae,F(kh,[G],ml.QueueFull),!0}$++}return me(),!1}function me(){for(var V=0,Y=0,$=function(Ee){var G=D[Ee];G&&G.batches&&je(G.batches,function(ae){Ee===4?V+=ae.count():Y+=ae.count()})},se=1;se<=4;se++)$(se);u=Y,l=V}function we(V,Y,$){var se=!1,Ee=Y===0;return!Ee||x.canSendRequest()?wn(le.core,function(){return"PostChannel._queueBatches"},function(){for(var G=[],ae=4;ae>=V;){var K=D[ae];K&&K.batches&&K.batches.length>0&&(je(K.batches,function(U){x.addBatch(U)?se=se||U&&U.count()>0:G=G.concat(U.events()),ae===4?l-=U.count():u-=U.count()}),K.batches=[],K.iKeyMap={}),ae--}G.length>0&&Ar(kh,G,ml.KillSwitch),se&&R>=V&&(R=-1,j=0)},function(){return{latency:V,sendType:Y,sendReason:$}},!Ee):(R=R>=0?Math.min(R,V):V,j=Math.max(j,$)),se}function Fe(V,Y){fe(1,0,Y),me(),Xt(function(){V&&V(),o.length>0?s=L(function(){s=null,Fe(o.shift(),Y)},0):(s=null,_e())})}function Xt(V){x.isCompletelyIdle()?V():s=L(function(){s=null,Xt(V)},uue)}function et(){ce(),Et(),m=Dh,_e()}function Et(){f={},f[Dh]=[2,1,0],f[pk]=[6,3,0],f[fk]=[18,9,0]}function rr(V,Y){var $=[],se=ee;N&&(se=ye),je(V,function(Ee){Ee&&Ee.count()>0&&je(Ee.events(),function(G){G&&(G.sync&&(G.latency=4,G.sync=!1),G.sendAttempt<se?(Eh(G,le.identifier),H(G,!1)):$.push(G))})}),$.length>0&&Ar(kh,$,ml.NonRetryableStatus),N&&ve(2,2)}function Ut(V,Y){var $=le._notificationManager||{},se=$[V];if(se)try{se.apply($,Y)}catch(Ee){tn(le.diagLog(),1,74,V+" notification failed: "+Ee)}}function Ar(V,Y){for(var $=[],se=2;se<arguments.length;se++)$[se-2]=arguments[se];Y&&Y.length>0&&Ut(V,[Y].concat($))}function F(V,Y){for(var $=[],se=2;se<arguments.length;se++)$[se-2]=arguments[se];Y&&Y.length>0&&je(Y,function(Ee){Ee&&Ee.count()>0&&Ut(V,[Ee.events()].concat($))})}function pe(V,Y,$){V&&V.length>0&&Ut("eventsSendRequest",[Y>=1e3&&Y<=1999?Y-1e3:0,$!==!0])}function T(V,Y){F("eventsSent",V,Y),_e()}function M(V,Y){F(kh,V,Y>=8e3&&Y<=8999?Y-8e3:ml.Unknown)}function Z(V){F(kh,V,ml.NonRetryableStatus),_e()}function de(V,Y){F(kh,V,ml.Unknown),_e()}function be(){!n||!n.disableAutoBatchFlushLimit?w=Math.max(D6*(k6+1),p/6):w=0}Ms(le,"_setTimeoutOverride",function(){return Pe.set},function(V){Pe=rw(V,Pe.clear)}),Ms(le,"_clearTimeoutOverride",function(){return Pe.clear},function(V){Pe=rw(Pe.set,V)})}),t}return e.__ieDyn=1,e}(Ih),A6=hue});var O6={};Um(O6,{BE_PROFILE:()=>fk,NRT_PROFILE:()=>pk,PostChannel:()=>A6,RT_PROFILE:()=>Dh});var L6=te(()=>{d();M6();CF()});var gue,K6,F6=te(()=>{d();gue=async(r,e,t)=>{let n=await Promise.resolve().then(()=>(xh(),Q8)),i=await Promise.resolve().then(()=>(L6(),O6)),o=new n.AppInsightsCore,s=new i.PostChannel,a={instrumentationKey:r,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[s]]};if(t){a.extensionConfig={};let u={alwaysUseXhrOverride:!0,httpXHROverride:t};a.extensionConfig[s.identifier]=u}let c=e.workspace.getConfiguration("telemetry").get("internalTesting");return o.initialize(a,[]),o.addTelemetryInitializer(u=>{var p,f;c&&(u.ext=(p=u.ext)!=null?p:{},u.ext.utc=(f=u.ext.utc)!=null?f:{},u.ext.utc.flags=8462029)}),o},K6=async(r,e,t)=>{let n=await gue(r,e,t);return{logEvent:(o,s)=>{try{n==null||n.track({name:o,baseData:{name:o,properties:s==null?void 0:s.properties,measurements:s==null?void 0:s.measurements}})}catch(a){throw new Error(`Failed to log event to app insights!
`+a.message)}},flush:async()=>{try{n==null||n.unload()}catch(o){throw new Error(`Failed to flush app insights!
`+o.message)}}}}});var md,wk,U6=te(()=>{d();(function(r){r[r.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",r[r.INSTANTIATING=1]="INSTANTIATING",r[r.INSTANTIATED=2]="INSTANTIATED"})(md||(md={}));wk=class{constructor(e,t){this._instantiationStatus=md.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}sendEventData(e,t){if(!this._telemetryClient){this._instantiationStatus!==md.INSTANTIATED&&this._eventQueue.push({eventName:e,data:t});return}this._telemetryClient.logEvent(e,t)}sendErrorData(e,t){if(!this._telemetryClient){this._instantiationStatus!==md.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:t});return}}async flush(){this._telemetryClient&&(await this._telemetryClient.flush(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:t})=>this.sendEventData(e,t)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:t})=>this.sendErrorData(e,t)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===md.NOT_INSTANTIATED&&(this._instantiationStatus=md.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=md.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=md.INSTANTIATED}))}}});var xk,W6=te(()=>{d();xk=class{constructor(e,t,n){this.telemetrySender=e,this.vscodeAPI=t,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,n),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logUsage(e,{properties:t,measurements:n})}sendTelemetryEvent(e,t,n){this.internalSendTelemetryEvent(e,t,n,!1)}sendDangerousTelemetryEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,t,n,!0)}internalSendTelemetryErrorEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryErrorEvent(e,t,n){this.internalSendTelemetryErrorEvent(e,t,n,!1)}sendDangerousTelemetryErrorEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,t,n,!0)}internalSendTelemetryException(e,t,n,i){i?this.telemetrySender.sendErrorData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryException(e,t,n){this.internalSendTelemetryException(e,t,n,!1)}sendDangerousTelemetryException(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryException(e,t,n,!0)}dispose(){return this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}}});var ib,V6=te(()=>{d();ib=class r{static applyReplacements(e,t){for(let n of Object.keys(e))for(let i of t)i.lookup.test(n)&&(i.replacementString!==void 0?e[n]=i.replacementString:delete e[n])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.7.7"}}static getInstance(){return r._instance||(r._instance=new r),r._instance}}});var Dk,ob,hd,Pk,sb,FF,nw,UF,j6,Sa,Tk=te(()=>{d();Dk="name",ob="push",hd="length",Pk="messageId",sb="message",FF="diagLog",nw="replace",UF="enableDebugExceptions",j6="logInternalMessage",Sa="call"});var xl,kk,Nk,Rk=te(()=>{d();xl="",kk="errorToConsole",Nk="warnToConsole"});function Ak(r){return r===void 0||typeof r===nr}function Nh(r){return r===null||Ak(r)}function Rh(r){return!!(r&&typeof r===ht)}function iw(r){return!!(r&&typeof r===an)}function Lc(r,e){if(r)for(var t in r)dr[Sa](r,t)&&e[Sa](r,t,r[t])}function wue(r){return!!(r&&z6[Sa](r)==="[object Array]")}function ow(r){return!!(r&&z6[Sa](r)==="[object Error]")}function as(r){return typeof r=="string"}function Mk(r){if(r)return _ue?r[Y6]():xue(r)}function xue(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[hd]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function sw(r,e,t){var n=r[hd];try{for(var i=0;i<n&&!(i in r&&e[Sa](t||r,r[i],i,r)===-1);i++);}catch(o){}}function HF(r,e,t){if(r){if(r[B6])return r[B6](e,t);var n=r[hd],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function Mh(r,e,t){var n;if(r){if(r[H6])return r[H6](e,t);var i=r[hd],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Sa](o,r[s],r))}catch(a){}}return n}function JF(r,e,t){var n;if(r){if(r[J6])return r[J6](e,t);var i=r[hd],o=0;if(arguments[hd]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Dl(r){return r&&(r=Iue&&r[VF]?r[VF]():r[nw]?r[nw](/^\s+|(?=\s)\s+$/g,xl):r),r}function qF(r){var e=typeof r;if(e!==an&&(e!==ht||r===null)&&ha("objKeys called on non-object"),!G6&&q6)return q6(r);var t=[];for(var n in r)r&&dr[Sa](r,n)&&t[ob](n);if(G6)for(var i=WF[hd],o=0;o<i;o++)r&&dr[Sa](r,WF[o])&&t[ob](WF[o]);return t}function Due(r){return r}function Ok(r){return jF&&Lc(r,function(e,t){(Ah(t)||Rh(t))&&jF(t)}),Q6(r)}function aw(r){return ow(r)?r[Dk]:xl}function lw(r,e){return Nh(r)?e:r}function GF(r){return function(){function e(){var t=this;r&&Lc(r,function(n,i){t[n]=i})}return e}()}var Y6,yue,bue,B6,H6,J6,VF,$6,jF,BFe,q6,BF,Iue,HFe,JFe,Sue,_ue,Eue,z6,Cue,qFe,Ah,G6,WF,Q6,Lk=te(()=>{d();pr();Tk();Rk();Y6="toISOString",yue="endsWith",bue="startsWith",B6="indexOf",H6="map",J6="reduce",VF="trim",$6="toString",jF=Pr.freeze,BFe=Pr.seal,q6=Pr.keys,BF=String[Vt],Iue=BF[VF],HFe=BF[yue],JFe=BF[bue],Sue=Date[Vt],_ue=Sue[Y6],Eue=Array.isArray,z6=ma[$6],Cue=dr[$6],qFe=Cue[Sa](Pr);Ah=Eue||wue;G6=!{toString:null}.propertyIsEnumerable("toString"),WF=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Q6=jF||Due});function ab(r){var e={};return Lc(r,function(t,n){e[t]=n,e[n]=t}),Ok(e)}function YF(r){var e={};return Lc(r,function(t,n){e[t]=n[1],e[n[0]]=n[1]}),Ok(e)}var X6=te(()=>{d();Lk()});function gd(r){var e=Jn();return e&&e[r]?e[r]:r===Pue&&e3()?window:null}function e3(){return!!(typeof window===ht&&window)}function t3(){return!!(typeof document===ht&&document)}function $F(){return t3()?document:gd(Tue)}function zF(){return typeof console!==nr?console:gd(kue)}function Oh(){return!!(typeof JSON===ht&&JSON||gd(Z6)!==null)}function lb(){return Oh()?JSON||gd(Z6):null}function Lh(r){var e=Object[Vt].toString[Sa](r),t=xl;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Dk]+"'":Oh()&&(t=lb().stringify(r)),e+t}var Pue,Tue,kue,Z6,Kk=te(()=>{"use strict";d();pr();Tk();Rk();Pue="window",Tue="document",kue="console",Z6="JSON"});function Nue(){var r=gd("Microsoft");return r&&(Fk=r.ApplicationInsights),Fk}function r3(r){var e=Fk;return!e&&r.disableDbgExt!==!0&&(e=Fk||Nue()),e?e.ChromeDbgExt:null}var Fk,n3=te(()=>{d();Kk();Fk=null});function i3(r){return r?'"'+r[nw](/\"/g,xl)+'"':xl}function o3(r,e){var t=zF();if(t){var n="log";t[r]&&(n=r),iw(t[n])&&t[n](e)}}function Oue(r){return r||new s3}function Pl(r,e,t,n,i,o){o===void 0&&(o=!1),Oue(r).throwInternal(e,t,n,i,o)}var Rue,Aue,Mue,QF,s3,a3=te(()=>{"use strict";d();vr();Tk();n3();Kk();Lk();Rk();Rue="AI (Internal): ",Aue="AI: ",Mue="AITR_";QF=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Pk]=e,o[sb]=(n?Aue:Rue)+e;var s=xl;Oh()&&(s=lb().stringify(i));var a=(t?" message:"+i3(t):xl)+(i?" props:"+i3(s):xl);o[sb]+=a}return r.dataType="MessageData",r}(),s3=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Ge(r,this,function(l){u(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[UF]=function(){return a},l.throwInternal=function(m,h,g,v,I){I===void 0&&(I=!1);var S=new QF(h,g,I,v);if(a)throw Lh(S);var x=m===1?kk:Nk;if(Ak(S[sb]))f("throw"+(m===1?"Critical":"Warning"),S);else{if(I){var D=+S[Pk];!n[D]&&i>=m&&(l[x](S[sb]),n[D]=!0)}else i>=m&&l[x](S[sb]);c(m,S)}},l[Nk]=function(m){o3("warn",m),f("warning",m)},l[kk]=function(m){o3("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[j6]=c;function c(m,h){if(!p()){var g=!0,v=Mue+h[Pk];if(n[v]?g=!1:n[v]=!0,g&&(m<=o&&(l.queue[ob](h),t++,f(m===1?"error":"warn",h)),t===s)){var I="Internal events throttle limit per PageView reached for this app.",S=new QF(23,I,!1);l.queue[ob](S),m===1?l[kk](I):l[Nk](I)}}}function u(m){i=lw(m.loggingLevelConsole,0),o=lw(m.loggingLevelTelemetry,1),s=lw(m.maxMessageLimit,25),a=lw(m[UF],!1)}function p(){return t>=s}function f(m,h){var g=r3(e||{});g&&g[FF]&&g[FF](m,h)}})}return r.__ieDyn=1,r}()});var _a=te(()=>{d();Lk();X6();Kk();pr();a3()});var cw,uw,dw,Uk,Kh,vd,Li,Tl=te(()=>{d();cw="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",uw="sampleRate",dw="ProcessLegacy",Uk="http.method",Kh="https://dc.services.visualstudio.com",vd="/v2/track",Li="not_specified"});var Fh,Lt,Uh,pw,kl,l3,ro,yd,c3,fw,mw,Wk,Wh,Ea,no,io,Vh,Kc,jh,Vk,jk,XF,Bh,hw,gw,Hh,cb,ub,Jh,ZF,qh,u3,d3,p3,f3,Ao=te(()=>{d();Fh="split",Lt="length",Uh="toLowerCase",pw="ingestionendpoint",kl="toString",l3="removeItem",ro="name",yd="message",c3="count",fw="stringify",mw="pathname",Wk="indexOf",Wh="exceptions",Ea="parsedStack",no="properties",io="measurements",Vh="sizeInBytes",Kc="typeName",jh="severityLevel",Vk="problemGroup",jk="isManual",XF="CreateFromInterface",Bh="assembly",hw="hasFullStack",gw="level",Hh="method",cb="fileName",ub="line",Jh="duration",ZF="receivedResponse",qh="substring",u3="sanitizeKeyAndAddUniqueness",d3="sanitizeException",p3="sanitizeProperties",f3="sanitizeMeasurements"});function Bk(r){(isNaN(r)||r<0)&&(r=0),r=Math.round(r);var e=vw+r%1e3,t=vw+Math.floor(r/1e3)%60,n=vw+Math.floor(r/(1e3*60))%60,i=vw+Math.floor(r/(1e3*60*60))%24,o=Math.floor(r/(1e3*60*60*24));return e=e[Lt]===1?"00"+e:e[Lt]===2?"0"+e:e,t=t[Lt]<2?"0"+t:t,n=n[Lt]<2?"0"+n:n,i=i[Lt]<2?"0"+i:i,(o>0?o+".":vw)+i+":"+n+":"+t+"."+e}var vw,eU=te(()=>{d();Ao();vw=""});var db,m3=te(()=>{d();_a();db=YF({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var Hk,D2e,h3=te(()=>{d();_a();Hk=ab({LocalStorage:0,SessionStorage:1}),D2e=ab({AI:0,AI_AND_W3C:1,W3C:2})});function g3(r){try{if(Nh(Jn()))return null;var e=new Date()[kl](),t=gd(r===Hk.LocalStorage?"localStorage":"sessionStorage");t.setItem(e,e);var n=t.getItem(e)!==e;if(t[l3](e),!n)return t}catch(i){}return null}function v3(){return Jk()?g3(Hk.SessionStorage):null}function Jk(r){return(r||yw===void 0)&&(yw=!!g3(Hk.SessionStorage)),yw}function tU(r,e){var t=v3();if(t!==null)try{return t.getItem(e)}catch(n){yw=!1,Pl(r,2,2,"Browser failed read of session storage. "+aw(n),{exception:Lh(n)})}return null}function qk(r,e,t){var n=v3();if(n!==null)try{return n.setItem(e,t),!0}catch(i){yw=!1,Pl(r,2,4,"Browser failed write to session storage. "+aw(i),{exception:Lh(i)})}return!1}var yw,y3=te(()=>{d();_a();h3();Ao();yw=void 0});function Gk(r,e,t){var n=e[Lt],i=rU(r,e);if(i[Lt]!==n){for(var o=0,s=i;t[s]!==void 0;)o++,s=i[qh](0,150-3)+nU(o);i=s}return i}function rU(r,e){var t;return e&&(e=Dl(e[kl]()),e[Lt]>150&&(t=e[qh](0,150),Pl(r,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),t||e}function rn(r,e,t){t===void 0&&(t=1024);var n;return e&&(t=t||1024,e=Dl(e),e.toString()[Lt]>t&&(n=e[kl]()[qh](0,t),Pl(r,2,61,"string value is too long. It has been truncated to "+t+" characters.",{value:e},!0))),n||e}function af(r,e){return zk(r,e,2048,66)}function pb(r,e){var t;return e&&e[Lt]>32768&&(t=e[qh](0,32768),Pl(r,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),t||e}function Yk(r,e){var t;if(e){var n=""+e;n[Lt]>32768&&(t=n[qh](0,32768),Pl(r,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return t||e}function oo(r,e){if(e){var t={};Lc(e,function(n,i){if(Rh(i)&&Oh())try{i=lb()[fw](i)}catch(o){Pl(r,2,49,"custom property is not valid",{exception:o},!0)}i=rn(r,i,8192),n=Gk(r,n,t),t[n]=i}),e=t}return e}function so(r,e){if(e){var t={};Lc(e,function(n,i){n=Gk(r,n,t),t[n]=i}),e=t}return e}function $k(r,e){return e&&zk(r,e,128,69)[kl]()}function zk(r,e,t,n){var i;return e&&(e=Dl(e),e[Lt]>t&&(i=e[qh](0,t),Pl(r,2,n,"input is too long, it has been truncated to "+t+" characters.",{data:e},!0))),i||e}function nU(r){var e="00"+r;return e.substr(e[Lt]-3)}var ls,Vue,Nl=te(()=>{d();_a();Ao();Vue=(ls={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768},ls[u3]=Gk,ls.sanitizeKey=rU,ls.sanitizeString=rn,ls.sanitizeUrl=af,ls.sanitizeMessage=pb,ls[d3]=Yk,ls[p3]=oo,ls[f3]=so,ls.sanitizeId=$k,ls.sanitizeInput=zk,ls.padNumber=nU,ls.trim=Dl,ls)});function S3(r){var e=I3,t=jue,n=t[e];return b3.createElement?t[e]||(n=t[e]=b3.createElement("a")):n={host:_3(r,!0)},n.href=r,e++,e>=t[Lt]&&(e=0),I3=e,n}function _3(r,e){var t=E3(r,e)||"";if(t){var n=t.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Lt]>3&&as(n[2])&&n[2][Lt]>0)return n[2]+(n[3]||"")}return t}function E3(r,e){var t=null;if(r){var n=r.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Lt]>2&&as(n[2])&&n[2][Lt]>0&&(t=n[2]||"",e&&n[Lt]>2)){var i=(n[1]||"")[Uh](),o=n[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),t+=o}}return t}var b3,I3,jue,C3=te(()=>{d();_a();Ao();b3=$F()||{},I3=0,jue=[null,null,null,null,null]});function bw(r){return HF(Bue,r[Uh]())!==-1}function w3(r,e,t,n){var i,o=n,s=n;if(e&&e[Lt]>0){var a=S3(e);if(i=a.host,!o)if(a[mw]!=null){var l=a.pathname[Lt]===0?"/":a[mw];l.charAt(0)!=="/"&&(l="/"+l),s=a[mw],o=rn(r,t?t+" "+l:l)}else o=rn(r,e)}else i=n,o=n;return{target:i,name:o,data:s}}var Bue,iU=te(()=>{d();_a();Tl();Nl();C3();Ao();Bue=[Kh+vd,"https://breeze.aimon.applicationinsights.io"+vd,"https://dc-int.services.visualstudio.com"+vd]});function oU(r){if(!r)return{};var e=r[Fh](Hue),t=JF(e,function(i,o){var s=o[Fh](Jue);if(s[Lt]===2){var a=s[0][Uh](),l=s[1];i[a]=l}return i},{});if(qF(t)[Lt]>0){if(t.endpointsuffix){var n=t.location?t.location+".":"";t[pw]=t[pw]||"https://"+n+"dc."+t.endpointsuffix}t[pw]=t[pw]||Kh}return t}var Hue,Jue,x3=te(()=>{d();_a();Tl();Ao();Hue=";",Jue="="});var sU,D3=te(()=>{d();_a();Tl();Ao();Nl();sU=function(){function r(e,t,n){var i=this,o=this;o.ver=1,o.sampleRate=100,o.tags={},o[ro]=rn(e,n)||Li,o.data=t,o.time=Mk(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return i.sampleRate===100?4:1},tags:1,data:1}}return r}()});var bd,P3=te(()=>{d();Tl();Ao();Nl();bd=function(){function r(e,t,n,i){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var o=this;o.ver=2,o[ro]=rn(e,t)||Li,o[no]=oo(e,n),o[io]=so(e,i)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Event",r.dataType="EventData",r}()});function uU(r,e){var t=r;return t&&!as(t)&&(JSON&&JSON[fw]?(t=JSON[fw](r),e&&(!t||t==="{}")&&(iw(r[kl])?t=r[kl]():t=""+r)):t=""+r+" - (Missing JSON.stringify)"),t||""}function A3(r,e){var t=r;return r&&(t&&!as(t)&&(t=r[cU]||r[R3]||t),t&&!as(t)&&(t=uU(t,!0)),r.filename&&(t=t+" @"+(r.filename||"")+":"+(r.lineno||"?")+":"+(r.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(t||"")[Wk](e)===-1&&(t=e+": "+t),t||""}function Gue(r){try{if(Rh(r))return"hasFullStack"in r&&"typeName"in r}catch(e){}return!1}function Yue(r){try{if(Rh(r))return"ver"in r&&"exceptions"in r&&"properties"in r}catch(e){}return!1}function k3(r){return r&&r.src&&as(r.src)&&r.obj&&Ah(r.obj)}function Gh(r){var e=r||"";as(e)||(as(e[cs])?e=e[cs]:e=""+e);var t=e[Fh](`
`);return{src:e,obj:t}}function $ue(r){for(var e=[],t=r[Fh](`
`),n=0;n<t[Lt];n++){var i=t[n];t[n+1]&&(i+="@"+t[n+1],n++),e.push(i)}return{src:r,obj:e}}function M3(r){var e=null;if(r)try{if(r[cs])e=Gh(r[cs]);else if(r[fb]&&r[fb][cs])e=Gh(r[fb][cs]);else if(r.exception&&r.exception[cs])e=Gh(r.exception[cs]);else if(k3(r))e=r;else if(k3(r[lU]))e=r[lU];else if(window&&window.opera&&r[cU])e=$ue(r[yd]);else if(r.reason&&r.reason[cs])e=Gh(r.reason[cs]);else if(as(r))e=Gh(r);else{var t=r[cU]||r[R3]||"";as(r[T3])&&(t&&(t+=`
`),t+=" from "+r[T3]),t&&(e=Gh(t))}}catch(n){e=Gh(n)}return e||{src:"",obj:null}}function zue(r){var e="";return r&&(r.obj?sw(r.obj,function(t){e+=t+`
`}):e=r.src||""),e}function Que(r){var e,t=r.obj;if(t&&t[Lt]>0){e=[];var n=0,i=0;sw(t,function(h){var g=h[kl]();if(dU.regex.test(g)){var v=new dU(g,n++);i+=v[Vh],e.push(v)}});var o=32*1024;if(i>o)for(var s=0,a=e[Lt]-1,l=0,c=s,u=a;s<a;){var p=e[s][Vh],f=e[a][Vh];if(l+=p+f,l>o){var m=u-c+1;e.splice(c,m);break}c=s,u=a,s++,a--}}return e}function Qk(r){var e="";if(r&&(e=r.typeName||r[ro]||"",!e))try{var t=/function (.{1,200})\(/,n=t.exec(r.constructor[kl]());e=n&&n[Lt]>1?n[1]:""}catch(i){}return e}function aU(r){if(r)try{if(!as(r)){var e=Qk(r),t=uU(r,!1);return(!t||t==="{}")&&(r[fb]&&(r=r[fb],e=Qk(r)),t=uU(r,!0)),t[Wk](e)!==0&&e!=="String"?e+":"+t:t}}catch(n){}return""+(r||"")}var que,fb,cs,lU,T3,cU,R3,Yh,N3,dU,O3=te(()=>{d();pr();_a();Tl();Ao();Nl();que="<no_method>",fb="error",cs="stack",lU="stackDetails",T3="errorSrc",cU="message",R3="description";Yh=function(){function r(e,t,n,i,o,s){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var a=this;a.ver=2,Yue(t)?(a[Wh]=t[Wh]||[],a[no]=t[no],a[io]=t[io],t[jh]&&(a[jh]=t[jh]),t.id&&(a.id=t.id),t[Vk]&&(a[Vk]=t[Vk]),Nh(t[jk])||(a[jk]=t[jk])):(n||(n={}),a[Wh]=[new N3(e,t,n)],a[no]=oo(e,n),a[io]=so(e,i),o&&(a[jh]=o),s&&(a.id=s))}return r.CreateAutoException=function(e,t,n,i,o,s,a,l){var c,u=Qk(o||s||e);return c={},c[yd]=A3(e,u),c.url=t,c.lineNumber=n,c.columnNumber=i,c.error=aU(o||s||e),c.evt=aU(s||e),c[Kc]=u,c.stackDetails=M3(a||o||s),c.errorSrc=l,c},r.CreateFromInterface=function(e,t,n,i){var o=t[Wh]&&Mh(t[Wh],function(a){return N3[XF](e,a)}),s=new r(e,To(To({},t),{exceptions:o}),n,i);return s},r.prototype.toInterface=function(){var e,t=this,n=t.exceptions,i=t.properties,o=t.measurements,s=t.severityLevel,a=t.problemGroup,l=t.id,c=t.isManual,u=n instanceof Array&&Mh(n,function(p){return p.toInterface()})||void 0;return e={ver:"4.0"},e[Wh]=u,e.severityLevel=s,e.properties=i,e.measurements=o,e.problemGroup=a,e.id=l,e.isManual=c,e},r.CreateSimpleException=function(e,t,n,i,o,s){var a;return{exceptions:[(a={},a[hw]=!0,a.message=e,a.stack=o,a.typeName=t,a)]}},r.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",r.dataType="ExceptionData",r.formatError=aU,r}(),N3=function(){function r(e,t,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var i=this;if(Gue(t))i[Kc]=t[Kc],i[yd]=t[yd],i[cs]=t[cs],i[Ea]=t[Ea]||[],i[hw]=t[hw];else{var o=t,s=o&&o.evt;ow(o)||(o=o[fb]||s||o),i[Kc]=rn(e,Qk(o))||Li,i[yd]=pb(e,A3(t||o,i[Kc]))||Li;var a=t[lU]||M3(t);i[Ea]=Que(a),Ah(i[Ea])&&Mh(i[Ea],function(l){return l[Bh]=rn(e,l[Bh])}),i[cs]=Yk(e,zue(a)),i.hasFullStack=Ah(i.parsedStack)&&i.parsedStack[Lt]>0,n&&(n[Kc]=n[Kc]||i[Kc])}}return r.prototype.toInterface=function(){var e,t=this,n=t[Ea]instanceof Array&&Mh(t[Ea],function(o){return o.toInterface()}),i=(e={id:t.id,outerId:t.outerId,typeName:t[Kc],message:t[yd],hasFullStack:t[hw],stack:t[cs]},e[Ea]=n||void 0,e);return i},r.CreateFromInterface=function(e,t){var n=t[Ea]instanceof Array&&Mh(t[Ea],function(o){return dU[XF](o)})||t[Ea],i=new r(e,To(To({},t),{parsedStack:n}));return i},r}(),dU=function(){function r(e,t){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[Vh]=0,typeof e=="string"){var i=e;n[gw]=t,n[Hh]=que,n[Bh]=Dl(i),n[cb]="",n[ub]=0;var o=i.match(r.regex);o&&o[Lt]>=5&&(n[Hh]=Dl(o[2])||n[Hh],n[cb]=Dl(o[4]),n[ub]=parseInt(o[5])||0)}else n[gw]=e[gw],n[Hh]=e[Hh],n[Bh]=e[Bh],n[cb]=e[cb],n[ub]=e[ub],n[Vh]=0;n.sizeInBytes+=n.method[Lt],n.sizeInBytes+=n.fileName[Lt],n.sizeInBytes+=n.assembly[Lt],n[Vh]+=r.baseSize,n.sizeInBytes+=n.level.toString()[Lt],n.sizeInBytes+=n.line.toString()[Lt]}return r.CreateFromInterface=function(e){return new r(e,null)},r.prototype.toInterface=function(){var e=this;return{level:e[gw],method:e[Hh],assembly:e[Bh],fileName:e[cb],line:e[ub]}},r.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,r.baseSize=58,r}()});var L3,K3=te(()=>{d();L3=function(){function r(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return r}()});var Id,F3=te(()=>{d();Tl();Ao();K3();Nl();Id=function(){function r(e,t,n,i,o,s,a,l,c){this.aiDataContract={ver:1,metrics:1,properties:0};var u=this;u.ver=2;var p=new L3;p[c3]=i>0?i:void 0,p.max=isNaN(s)||s===null?void 0:s,p.min=isNaN(o)||o===null?void 0:o,p[ro]=rn(e,t)||Li,p.value=n,p.stdDev=isNaN(a)||a===null?void 0:a,u.metrics=[p],u[no]=oo(e,l),u[io]=so(e,c)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",r.dataType="MetricData",r}()});var $h,U3=te(()=>{d();Tl();eU();Ao();Nl();$h=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var l=this;l.ver=2,l.id=$k(e,a),l.url=af(e,n),l[ro]=rn(e,t)||Li,isNaN(i)||(l[Jh]=Bk(i)),l[no]=oo(e,o),l[io]=so(e,s)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",r.dataType="PageviewData",r}()});var zh,W3=te(()=>{d();eU();iU();Ao();Nl();zh=function(){function r(e,t,n,i,o,s,a,l,c,u,p,f){c===void 0&&(c="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=t,m[Jh]=Bk(o),m.success=s,m.resultCode=a+"",m.type=rn(e,c);var h=w3(e,n,l,i);m.data=af(e,i)||h.data,m.target=rn(e,h.target),u&&(m.target="".concat(m.target," | ").concat(u)),m[ro]=rn(e,h[ro]),m[no]=oo(e,p),m[io]=so(e,f)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",r.dataType="RemoteDependencyData",r}()});var Qh,V3=te(()=>{d();Tl();Ao();Nl();Qh=function(){function r(e,t,n,i,o){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var s=this;s.ver=2,t=t||Li,s[yd]=pb(e,t),s[no]=oo(e,i),s[io]=so(e,o),n&&(s[jh]=n)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Message",r.dataType="MessageData",r}()});var Xh,j3=te(()=>{d();Tl();Ao();Nl();Xh=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var l=this;l.ver=2,l.url=af(e,n),l[ro]=rn(e,t)||Li,l[no]=oo(e,o),l[io]=so(e,s),a&&(l.domProcessing=a.domProcessing,l[Jh]=a[Jh],l.networkConnect=a.networkConnect,l.perfTotal=a.perfTotal,l[ZF]=a[ZF],l.sentRequest=a.sentRequest)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",r.dataType="PageviewPerformanceData",r}()});var Sd,B3=te(()=>{d();Sd=function(){function r(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t}return r}()});var pU,H3=te(()=>{d();_a();pU=ab({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});function cf(r){var e="ai."+r+".";return function(t){return e+t}}var Iw,si,Xk,mb,fU,lf,Zh,Sw,_w,mU=te(()=>{d();pr();_a();Iw=cf("application"),si=cf("device"),Xk=cf("location"),mb=cf("operation"),fU=cf("session"),lf=cf("user"),Zh=cf("cloud"),Sw=cf("internal"),_w=function(r){Cn(e,r);function e(){return r.call(this)||this}return e}(GF({applicationVersion:Iw("ver"),applicationBuild:Iw("build"),applicationTypeId:Iw("typeId"),applicationId:Iw("applicationId"),applicationLayer:Iw("layer"),deviceId:si("id"),deviceIp:si("ip"),deviceLanguage:si("language"),deviceLocale:si("locale"),deviceModel:si("model"),deviceFriendlyName:si("friendlyName"),deviceNetwork:si("network"),deviceNetworkName:si("networkName"),deviceOEMName:si("oemName"),deviceOS:si("os"),deviceOSVersion:si("osVersion"),deviceRoleInstance:si("roleInstance"),deviceRoleName:si("roleName"),deviceScreenResolution:si("screenResolution"),deviceType:si("type"),deviceMachineName:si("machineName"),deviceVMName:si("vmName"),deviceBrowser:si("browser"),deviceBrowserVersion:si("browserVersion"),locationIp:Xk("ip"),locationCountry:Xk("country"),locationProvince:Xk("province"),locationCity:Xk("city"),operationId:mb("id"),operationName:mb("name"),operationParentId:mb("parentId"),operationRootId:mb("rootId"),operationSyntheticSource:mb("syntheticSource"),operationCorrelationVector:mb("correlationVector"),sessionId:fU("id"),sessionIsFirst:fU("isFirst"),sessionIsNew:fU("isNew"),userAccountAcquisitionDate:lf("accountAcquisitionDate"),userAccountId:lf("accountId"),userAgent:lf("userAgent"),userId:lf("id"),userStoreRegion:lf("storeRegion"),userAuthUserId:lf("authUserId"),userAnonymousUserAcquisitionDate:lf("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:lf("authUserAcquisitionDate"),cloudName:Zh("name"),cloudRole:Zh("role"),cloudRoleVer:Zh("roleVer"),cloudRoleInstance:Zh("roleInstance"),cloudEnvironment:Zh("environment"),cloudLocation:Zh("location"),cloudDeploymentUnit:Zh("deploymentUnit"),internalNodeName:Sw("nodeName"),internalSdkVersion:Sw("sdkVersion"),internalAgentVersion:Sw("agentVersion"),internalSnippet:Sw("snippet"),internalSdkSrc:Sw("sdkSrc")}))});var ai,J3=te(()=>{d();mU();ai=new _w});var q3,uf=te(()=>{d();iU();x3();m3();Tl();D3();P3();O3();F3();U3();W3();V3();j3();B3();H3();mU();Nl();J3();y3();q3="AppInsightsChannelPlugin"});var G3,eg,hU,ao,Zk,eN,tN,Ki,rN,Rl,Y3,gU,$3,_d,nN,hb,gb,vU,tg,Ed,Fc,Ew,rg,yU,iN,vb,oN,z3,Cd,bU,Q3,sN,lo,Uc,aN,IU,ng,Al,lN,Ml=te(()=>{d();G3="initialize",eg="name",hU="identifier",ao="push",Zk="isInitialized",eN="config",tN="logger",Ki="length",rN="time",Rl="processNext",Y3="getProcessTelContext",gU="getPlugin",$3="splice",_d="teardown",nN="messageId",hb="message",gb="isAsync",vU="_doTeardown",tg="update",Ed="getNext",Fc="diagLog",Ew="setNextPlugin",rg="createNew",yU="indexOf",iN="userAgent",vb="split",oN="nodeType",z3="apply",Cd="replace",bU="enableDebugExceptions",Q3="logInternalMessage",sN="toLowerCase",lo="call",Uc="type",aN="handler",IU="isChildEvt",ng="getCtx",Al="setCtx",lN="complete"});var Tr,Mo,X3,cN,df,Z3,SU,uN,Cw,_U,Wc=te(()=>{d();Tr="",Mo="core",X3="disabled",cN="extensionConfig",df="processTelemetry",Z3="priority",SU="perfEvent",uN="errorToConsole",Cw="warnToConsole",_U="getPerfMgr"});function ude(r){if(r){if(pN)return pN(r);var e=r[tde]||r[Vt]||r[dN];if(e)return e}return null}function Ol(r){return r===void 0||typeof r===nr}function Yt(r){return r===null||Ol(r)}function pf(r){return!!(r&&typeof r===ht)}function cn(r){return!!(r&&typeof r===an)}function ww(r){var e=r;return e&&ff(e)&&(e=e[Cd](ade,function(t,n){return n.toUpperCase()}),e=e[Cd](lde,"_"),e=e[Cd](cde,function(t,n){return"_"+n})),e}function co(r,e){if(r)for(var t in r)dr[lo](r,t)&&e[lo](r,t,r[t])}function yb(r,e){return r&&e?r[yU](e)!==-1:!1}function dde(r){return!!(r&&aJ[lo](r)==="[object Array]")}function cJ(r){return!!(r&&aJ[lo](r)==="[object Error]")}function ff(r){return typeof r=="string"}function wU(r){return typeof r=="number"}function uJ(r){return typeof r=="boolean"}function nJ(r){var e=!1;if(r&&typeof r=="object"){var t=pN?pN(r):ude(r);t?(t[dN]&&dr[lo](t,dN)&&(t=t[dN]),e=typeof t===an&&lJ[lo](t)===sde):e=!0}return e}function xU(r){if(r)return ide?r[oJ]():pde(r)}function pde(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[Ki]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function _i(r,e,t){var n=r[Ki];try{for(var i=0;i<n&&!(i in r&&e[lo](t||r,r[i],i,r)===-1);i++);}catch(o){}}function fN(r,e,t){if(r){if(r[eJ])return r[eJ](e,t);var n=r[Ki],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function mf(r){var e=typeof r;if(e!==an&&(e!==ht||r===null)&&ha("objKeys called on non-object"),!iJ&&rJ)return rJ(r);var t=[];for(var n in r)r&&dr[lo](r,n)&&t[ao](n);if(iJ)for(var i=EU[Ki],o=0;o<i;o++)r&&dr[lo](r,EU[o])&&t[ao](EU[o]);return t}function DU(r,e,t,n){if(tJ)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),tJ(r,e,i),!0}catch(o){}return!1}function fde(r){return r}function wd(){var r=Date;return r.now?r.now():new r().getTime()}function Ca(r){return cJ(r)?r[eg]:Tr}function xw(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Dw(r,e){return Yt(r)?e:r}function TU(r){return!!r}function mde(r,e){var t=null,n=null;return cn(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][z3](n,i)}}function mN(r,e,t,n,i){r&&e&&t&&(i!==!1||Ol(r[e]))&&(r[e]=mde(t,n))}function kU(r,e,t,n){return r&&e&&pf(r)&&nn(t)&&_i(t,function(i){ff(i)&&mN(r,i,e,i,n)}),r}function hN(r){return r&&al&&(r=Pr(al({},r))),r}function gN(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[Ki],c=!1,u=1;for(l>0&&uJ(a)&&(c=a,a=s[u]||{},u++),pf(a)||(a={});u<l;u++){var p=s[u],f=nn(p),m=pf(p);for(var h in p){var g=f&&h in p||m&&dr[lo](p,h);if(g){var v=p[h],I=void 0;if(c&&v&&((I=nn(v))||nJ(v))){var S=a[h];I?nn(S)||(S=[]):nJ(S)||(S={}),v=gN(c,S,v)}v!==void 0&&(a[h]=v)}}}return a}var oJ,Xue,Zue,eJ,ede,sJ,tde,dN,tJ,rde,fje,rJ,CU,mje,hje,gje,nde,ide,ode,aJ,lJ,sde,ade,lde,cde,pN,nn,iJ,EU,PU,Ll=te(()=>{d();pr();Ml();Wc();oJ="toISOString",Xue="endsWith",Zue="startsWith",eJ="indexOf",ede="trim",sJ="toString",tde="__proto__",dN="constructor",tJ=Do,rde=Pr.freeze,fje=Pr.seal,rJ=Pr.keys,CU=String[Vt],mje=CU[ede],hje=CU[Xue],gje=CU[Zue],nde=Date[Vt],ide=nde[oJ],ode=Array.isArray,aJ=ma[sJ],lJ=dr[sJ],sde=lJ[lo](Pr),ade=/-([a-z])/g,lde=/([^\w\d_$])/g,cde=/^(\d+[\w\d_$])/,pN=Object.getPrototypeOf;nn=ode||dde;iJ=!{toString:null}.propertyIsEnumerable("toString"),EU=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];PU=rde||fde});function mJ(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Vt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!Ol(i[e])}catch(o){}}return t}function Oo(r){var e=Jn();return e&&e[r]?e[r]:r===dJ&&LU()?window:null}function LU(){return!!(typeof window===ht&&window)}function Ib(){return LU()?window:Oo(dJ)}function hJ(){return!!(typeof document===ht&&document)}function vN(){return hJ()?document:Oo(hde)}function KU(){return!!(typeof navigator===ht&&navigator)}function hf(){return KU()?navigator:Oo(vde)}function FU(){return typeof console!==nr?console:Oo(yde)}function ig(){return!!(typeof JSON===ht&&JSON||Oo(pJ)!==null)}function us(){return ig()?JSON||Oo(pJ):null}function UU(){return Oo(bde)}function WU(){return Oo(Ide)}function VU(){var r=hf();if(r&&(r[iN]!==RU||NU===null)){RU=r[iN];var e=(RU||Tr)[sN]();NU=yb(e,MU)||yb(e,OU)}return NU}function jU(r){if(r===void 0&&(r=null),!r){var e=hf()||{};r=e?(e[iN]||Tr)[sN]():Tr}var t=(r||Tr)[sN]();if(yb(t,MU)){var n=vN()||{};return Math.max(parseInt(t[vb](MU)[1]),n[gde]||0)}else if(yb(t,OU)){var i=parseInt(t[vb](OU)[1]);if(i)return i+4}return null}function Yn(r){var e=Object[Vt].toString[lo](r),t=Tr;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[eg]+"'":ig()&&(t=us().stringify(r)),e+t}function Sb(){return AU===null&&(AU=KU()&&!!hf().sendBeacon),AU}function yN(r){var e=!1;try{e=!!Oo("fetch");var t=Oo("Request");e&&r&&t&&(e=mJ(t,"keepalive"))}catch(n){}return e}function bN(){return bb===null&&(bb=typeof XDomainRequest!==nr,bb&&Pw()&&(bb=bb&&!mJ(Oo(fJ),"withCredentials"))),bb}function Pw(){var r=!1;try{var e=Oo(fJ);r=!!e}catch(t){}return r}var dJ,hde,gde,vde,yde,pJ,bde,Ide,MU,OU,fJ,NU,RU,bb,AU,og=te(()=>{"use strict";d();pr();Ml();Ll();Wc();dJ="window",hde="document",gde="documentMode",vde="navigator",yde="console",pJ="JSON",bde="crypto",Ide="msCrypto",MU="msie",OU="trident/",fJ="XMLHttpRequest",NU=null,RU=null,bb=null,AU=null});function Sde(){var r=Oo("Microsoft");return r&&(IN=r.ApplicationInsights),IN}function gJ(r){var e=IN;return!e&&r.disableDbgExt!==!0&&(e=IN||Sde()),e?e.ChromeDbgExt:null}var IN,vJ=te(()=>{d();og();IN=null});function yJ(r){return r?'"'+r[Cd](/\"/g,Tr)+'"':Tr}function bJ(r,e){var t=FU();if(t){var n="log";t[r]&&(n=r),cn(t[n])&&t[n](e)}}function Tw(r,e){return(r||{})[tN]||new HU(e)}function IJ(r){return r||new HU}function vt(r,e,t,n,i,o){o===void 0&&(o=!1),IJ(r).throwInternal(e,t,n,i,o)}function kw(r,e){IJ(r)[Cw](e)}var _de,Ede,Cde,BU,HU,SN=te(()=>{"use strict";d();vr();Ml();vJ();og();Ll();Wc();_de="AI (Internal): ",Ede="AI: ",Cde="AITR_";BU=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[nN]=e,o[hb]=(n?Ede:_de)+e;var s=Tr;ig()&&(s=us().stringify(i));var a=(t?" message:"+yJ(t):Tr)+(i?" props:"+yJ(s):Tr);o[hb]+=a}return r.dataType="MessageData",r}();HU=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Ge(r,this,function(l){u(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[bU]=function(){return a},l.throwInternal=function(m,h,g,v,I){I===void 0&&(I=!1);var S=new BU(h,g,I,v);if(a)throw Yn(S);var x=m===1?uN:Cw;if(Ol(S[hb]))f("throw"+(m===1?"Critical":"Warning"),S);else{if(I){var D=+S[nN];!n[D]&&i>=m&&(l[x](S[hb]),n[D]=!0)}else i>=m&&l[x](S[hb]);c(m,S)}},l[Cw]=function(m){bJ("warn",m),f("warning",m)},l[uN]=function(m){bJ("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[Q3]=c;function c(m,h){if(!p()){var g=!0,v=Cde+h[nN];if(n[v]?g=!1:n[v]=!0,g&&(m<=o&&(l.queue[ao](h),t++,f(m===1?"error":"warn",h)),t===s)){var I="Internal events throttle limit per PageView reached for this app.",S=new BU(23,I,!1);l.queue[ao](S),m===1?l[uN](I):l[Cw](I)}}}function u(m){i=Dw(m.loggingLevelConsole,0),o=Dw(m.loggingLevelTelemetry,1),s=Dw(m.maxMessageLimit,25),a=Dw(m[bU],!1)}function p(){return t>=s}function f(m,h){var g=gJ(e||{});g&&g[Fc]&&g[Fc](m,h)}})}return r.__ieDyn=1,r}()});function SJ(r,e,t,n,i){if(r){var o=r;if(o[_U]&&(o=o[_U]()),o){var s=void 0,a=o[ng](JU);try{if(s=o.create(e(),n,i),s){if(a&&s[Al]&&(s[Al](_N[qU],a),a[ng]&&a[Al])){var l=a[ng](_N[Nw]);l||(l=[],a[Al](_N[Nw],l)),l[ao](s)}return o[Al](JU,s),t(s)}}catch(c){s&&s[Al]&&s[Al]("exception",c)}finally{s&&o.fire(s),o[Al](JU,a)}}}return t()}var _b,qU,Nw,_N,Wje,JU,_J=te(()=>{d();vr();Ml();Ll();Wc();_b="ctx",qU="ParentContextKey",Nw="ChildrenContextKey",_N=function(){function r(e,t,n){var i=this,o=!1;if(i.start=wd(),i[eg]=e,i[gb]=n,i[IU]=function(){return!1},cn(t)){var s;o=DU(i,"payload",function(){return!s&&cn(t)&&(s=t(),t=null),s})}i[ng]=function(a){return a?a===r[qU]||a===r[Nw]?i[a]:(i[_b]||{})[a]:null},i[Al]=function(a,l){if(a)if(a===r[qU])i[a]||(i[IU]=function(){return!0}),i[a]=l;else if(a===r[Nw])i[a]=l;else{var c=i[_b]=i[_b]||{};c[a]=l}},i[lN]=function(){var a=0,l=i[ng](r[Nw]);if(nn(l))for(var c=0;c<l[Ki];c++){var u=l[c];u&&(a+=u[rN])}i[rN]=wd()-i.start,i.exTime=i[rN]-a,i[lN]=function(){},!o&&cn(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),Wje=function(){function r(e){this.ctx={},Ge(r,this,function(t){t.create=function(n,i,o){return new _N(n,i,o)},t.fire=function(n){n&&(n[lN](),e&&cn(e[SU])&&e[SU](n))},t[Al]=function(n,i){if(n){var o=t[_b]=t[_b]||{};o[n]=i}},t[ng]=function(n){return(t[_b]||{})[n]}})}return r.__ieDyn=1,r}(),JU="CoreUtils.doPerf"});function wde(r){r<0&&(r>>>=0),Rw=123456789+r&sg,Aw=987654321-r&sg,wJ=!0}function xde(){try{var r=wd()&2147483647;wde((Math.random()*CJ^r)+r)}catch(e){}}function EJ(r){var e=0,t=UU()||WU();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&sg),e===0&&VU()&&(wJ||xde(),e=Dde()&sg),e===0&&(e=Math.floor(CJ*Math.random()|0)),r||(e>>>=0),e}function Dde(r){Aw=36969*(Aw&65535)+(Aw>>16)&sg,Rw=18e3*(Rw&65535)+(Rw>>16)&sg;var e=(Aw<<16)+(Rw&65535)>>>0&sg|0;return r||(e>>>=0),e}function xJ(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=EJ()>>>0,n=0,i=Tr;i[Ki]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(EJ()<<2&4294967295|t&3)>>>0,n=0);return i}var CJ,sg,wJ,Rw,Aw,DJ=te(()=>{d();Ml();og();Ll();Wc();CJ=4294967296,sg=4294967295,wJ=!1,Rw=123456789,Aw=987654321});function kde(r,e,t){if(PJ)try{return PJ(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function kJ(r){return r[oN]===1||r[oN]===9||!+r[oN]}function Nde(r,e){var t=e[r.id];if(!t){t={};try{kJ(e)&&(kde(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function xd(r,e){return e===void 0&&(e=!1),ww(r+Tde+++(e?"."+TJ:Tr)+Pde)}function EN(r){var e={id:xd("_aiData-"+(r||Tr)+"."+TJ),accept:function(t){return kJ(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[ww(n)]:(o&&(s=Nde(e,t),s[ww(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var PJ,TJ,Pde,Tde,CN=te(()=>{d();pr();Ml();Ll();Wc();DJ();PJ=Do,TJ="2.8.11",Pde="."+xJ(6),Tde=0});function OJ(r){return r&&r[Cd]?r[Cd](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Tr):r}function YU(r,e){var t;if(e){var n=Tr;nn(e)?(n=Tr,_i(e,function(o){o=OJ(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=OJ(e),n&&(n[0]!=="."&&(n="."+n),r=(r||Tr)+n)}var i=Ode.exec(r||Tr)||[];return t={},t[Uc]=i[1],t.ns=(i[2]||Tr).replace(Rde,".").replace(Ade,Tr)[vb](".").sort().join("."),t}function FJ(r,e,t){t===void 0&&(t=!0);var n=wN.get(r,GU,{},t),i=n[e];return i||(i=n[e]=[]),i}function UJ(r,e,t,n){r&&e&&e[Uc]&&(r[MJ]?r[MJ](e[Uc],t,n):r[AJ]&&r[AJ](KJ+e[Uc],t))}function Lde(r,e,t,n){var i=!1;return r&&e&&e[Uc]&&t&&(r[RJ]?(r[RJ](e[Uc],t,n),i=!0):r[NJ]&&(r[NJ](KJ+e[Uc],t),i=!0)),i}function LJ(r,e,t,n){for(var i=e[Ki];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(UJ(r,o.evtName,o[aN],o.capture),e[$3](i,1))}}function Kde(r,e,t){if(e[Uc])LJ(r,FJ(r,e[Uc]),e,t);else{var n=wN.get(r,GU,{});co(n,function(i,o){LJ(r,o,e,t)}),mf(n)[Ki]===0&&wN.kill(r,GU)}}function Mw(r,e){var t;return e?(nn(e)?t=[r].concat(e):t=[r,e],t=YU("xx",t).ns[vb](".")):t=r,t}function xN(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=YU(e,n);if(s=Lde(r,a,t,i),s&&wN.accept(r)){var l=(o={guid:Mde++,evtName:a},o[aN]=t,o.capture=i,o);FJ(r,a.type)[ao](l)}}catch(c){}return s}function $U(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=YU(e,n),s=!1;Kde(r,o,function(a){return o.ns&&!t||a[aN]===t?(s=!0,!0):!1}),s||UJ(r,o,t,i)}catch(a){}}var KJ,NJ,RJ,AJ,MJ,GU,s9e,a9e,Rde,Ade,Mde,wN,Ode,WJ=te(()=>{d();Ml();CN();Ll();Wc();KJ="on",NJ="attachEvent",RJ="addEventListener",AJ="detachEvent",MJ="removeEventListener",GU="events",s9e=xd("aiEvtPageHide"),a9e=xd("aiEvtPageShow"),Rde=/\.[\.]+/g,Ade=/[\.]+$/,Mde=1,wN=EN("events"),Ode=/^([^.]*)(?:\.(.+)|)/});function DN(r){return Fde.get(r,"state",{},!0)}var Fde,VJ=te(()=>{"use strict";d();CN();Fde=EN("plugin")});function Wde(r,e,t){for(;r;){if(r[gU]()===t)return r;r=r[Ed]()}return Ow([t],e[eN]||{},e)}function zU(r,e,t,n){var i=null,o=[];n!==null&&(i=n?Wde(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return Tw(t,e)},getCfg:function(){return e},getExtCfg:c,getConfig:u,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:p,onComplete:a}};function a(f,m){for(var h=[],g=2;g<arguments.length;g++)h[g-2]=arguments[g];f&&o[ao]({func:f,self:Ol(m)?s.ctx:m,args:h})}function l(){var f=i;if(i=f?f[Ed]():null,!f){var m=o;m&&m[Ki]>0&&(_i(m,function(h){try{h.func[lo](h.self,h.args)}catch(g){vt(t[tN],2,73,"Unexpected Exception during onComplete - "+Yn(g))}}),o=[])}return f}function c(f,m,h){m===void 0&&(m={}),h===void 0&&(h=0);var g;if(e){var v=e[cN];v&&f&&(g=v[f])}if(!g)g=m;else if(pf(m)&&h!==0){var I=gN(!0,m,g);e&&h===2&&co(m,function(S){if(Yt(I[S])){var x=e[S];Yt(x)||(I[S]=x)}}),g=I}return g}function u(f,m,h){h===void 0&&(h=!1);var g,v=c(f,null);return v&&!Yt(v[m])?g=v[m]:e&&!Yt(e[m])&&(g=e[m]),Yt(g)?h:g}function p(f){for(var m;m=s._next();){var h=m[gU]();h&&f(h)}}return s}function Eb(r,e,t,n){var i=zU(r,e,t,n),o=i.ctx;function s(l){var c=i._next();return c&&c[df](l,o),!c}function a(l,c){return l===void 0&&(l=null),nn(l)&&(l=Ow(l,e,t,c)),Eb(l||o[Ed](),e,t,c)}return o[Rl]=s,o[rg]=a,o}function QU(r,e,t){var n=e[eN]||{},i=zU(r,n,e,t),o=i.ctx;function s(l){var c=i._next();return c&&c.unload(o,l),!c}function a(l,c){return l===void 0&&(l=null),nn(l)&&(l=Ow(l,n,e,c)),QU(l||o[Ed](),e,c)}return o[Rl]=s,o[rg]=a,o}function XU(r,e,t){var n=e[eN]||{},i=zU(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(c){cn(c[tg])&&c[tg](o,l)})}function a(l,c){return l===void 0&&(l=null),nn(l)&&(l=Ow(l,n,e,c)),XU(l||o[Ed](),e,c)}return o[Rl]=s,o[rg]=a,o}function Ow(r,e,t,n){var i=null,o=!n;if(nn(r)&&r[Ki]>0){var s=null;_i(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&cn(a[df])){var l=Vde(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Ow([n],e,t):i}function Vde(r,e,t){var n=null,i=cn(r[df]),o=cn(r[Ew]),s;r?s=r[hU]+"-"+r[Z3]+"-"+HJ++:s="Unknown-0-"+HJ++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:u,unload:p,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&cn(r[BJ])&&(m=r[BJ]()),m||(m=Eb(a,e,t)),m}function c(m,h,g,v,I){var S=!1,x=r?r[hU]:Ude,D=m[jJ];return D||(D=m[jJ]={}),m.setNext(n),r&&SJ(m[Mo](),function(){return x+":"+g},function(){D[s]=!0;try{var A=n?n._id:Tr;A&&(D[A]=!1),S=h(m)}catch(R){var w=n?D[n._id]:!0;w&&(S=!0),(!n||!w)&&vt(m[Fc](),1,73,"Plugin ["+x+"] failed during "+g+" - "+Yn(R)+", run flags: "+Yn(D))}},v,I),S}function u(m,h){h=h||l();function g(v){if(!r||!i)return!1;var I=DN(r);return I[_d]||I[X3]?!1:(o&&r[Ew](n),r[df](m,v),!0)}c(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[Rl](m)}function p(m,h){function g(){var v=!1;if(r){var I=DN(r),S=r[Mo]||I[Mo];r&&(!S||S===m.core())&&!I[_d]&&(I[Mo]=null,I[_d]=!0,I[Zk]=!1,r[_d]&&r[_d](m,h)===!0&&(v=!0))}return v}c(m,g,"unload",function(){},h[gb])||m[Rl](h)}function f(m,h){function g(){var v=!1;if(r){var I=DN(r),S=r[Mo]||I[Mo];r&&(!S||S===m.core())&&!I[_d]&&r[tg]&&r[tg](m,h)===!0&&(v=!0)}return v}c(m,g,"update",function(){},!1)||m[Rl](h)}return PU(a)}var Ude,jJ,BJ,HJ,I9e,JJ=te(()=>{"use strict";d();Ml();SN();og();Ll();Wc();_J();VJ();Ude="TelemetryPluginChain",jJ="_hasRun",BJ="_getTelCtx",HJ=0;I9e=function(){function r(e,t,n,i){var o=this,s=Eb(e,t,n,i);kU(o,s,mf(s))}return r}()});function qJ(){var r=[];function e(n){n&&r[ao](n)}function t(n,i){_i(r,function(o){try{o(n,i)}catch(s){vt(n[Fc](),2,73,"Unexpected error calling unload handler - "+Yn(s))}}),r=[]}return{add:e,run:t}}var GJ=te(()=>{d();Ml();SN();og();Ll()});var gf,ZU,YJ=te(()=>{"use strict";d();vr();Ml();Ll();Wc();JJ();GJ();gf="getPlugin",ZU=function(){function r(){var e=this,t,n,i,o,s;c(),Ge(r,e,function(u){u[G3]=function(p,f,m,h){l(p,f,h),t=!0},u[_d]=function(p,f){var m,h=u[Mo];if(!h||p&&h!==p[Mo]())return;var g,v=!1,I=p||QU(null,h,i&&i[gf]?i[gf]():i),S=f||(m={reason:0},m[gb]=!1,m);function x(){if(!v){v=!0,o.run(I,f);var D=s;s=[],_i(D,function(A){A.rm()}),g===!0&&I[Rl](S),c()}}return!u[vU]||u[vU](I,S,x)!==!0?x():g=!0,g},u[tg]=function(p,f){var m=u[Mo];if(!m||p&&m!==p[Mo]())return;var h,g=!1,v=p||XU(null,m,i&&i[gf]?i[gf]():i),I=f||{reason:0};function S(){g||(g=!0,l(v.getCfg(),v.core(),v[Ed]()))}return!u._doUpdate||u._doUpdate(v,I,S)!==!0?S():h=!0,h},u._addHook=function(p){p&&(nn(p)?s=s.concat(p):s[ao](p))},mN(u,"_addUnloadCb",function(){return o},"add")}),e[Fc]=function(u){return a(u)[Fc]()},e[Zk]=function(){return t},e.setInitialized=function(u){t=u},e[Ew]=function(u){i=u},e[Rl]=function(u,p){p?p[Rl](u):i&&cn(i[df])&&i[df](u,null)},e._getTelCtx=a;function a(u){u===void 0&&(u=null);var p=u;if(!p){var f=n||Eb(null,{},e[Mo]);i&&i[gf]?p=f[rg](null,i[gf]):p=f[rg](null,i)}return p}function l(u,p,f){u&&xw(u,cN,[],null,Yt),!f&&p&&(f=p[Y3]()[Ed]());var m=i;i&&i[gf]&&(m=i[gf]()),e[Mo]=p,n=Eb(f,u,p,m)}function c(){t=!1,e[Mo]=null,n=null,i=null,s=[],o=qJ()}}return r.__ieDyn=1,r}()});var ag=te(()=>{d();YJ();Ll();WJ();og();SN();CN()});var vf,$J=te(()=>{d();vf="duration"});var $n,PN,ds,Vc,lg,Nt,yf,bf,wa,If,Dd,Lw,cg,Sf,Pd,Kw,_f,ug,Ef,dg,Cb,Cf,wb,Td,TN,pg,uo,e2,kN,xb,Gr,fg,t2,r2,Fw,wf,n2,Db,i2,NN,RN,Pb,o2,zJ,xa,AN,Uw,Ww,QJ,Tb,MN,s2,a2,l2,ON,XJ,kd=te(()=>{d();$n="tags",PN="deviceType",ds="data",Vc="name",lg="traceID",Nt="length",yf="stringify",bf="measurements",wa="dataType",If="envelopeType",Dd="toString",Lw="onLine",cg="enqueue",Sf="count",Pd="push",Kw="emitLineDelimitedJson",_f="clear",ug="batchPayloads",Ef="markAsSent",dg="clearSent",Cb="BUFFER_KEY",Cf="SENT_BUFFER_KEY",wb="MAX_BUFFER_SIZE",Td="namePrefix",TN="maxBatchSizeInBytes",pg="triggerSend",uo="diagLog",e2="onunloadDisableBeacon",kN="isBeaconApiDisabled",xb="_sender",Gr="_senderConfig",fg="_buffer",t2="enableSessionStorageBuffer",r2="samplingPercentage",Fw="instrumentationKey",wf="endpointUrl",n2="customHeaders",Db="disableXhr",i2="onunloadDisableFetch",NN="disableTelemetry",RN="baseType",Pb="sampleRate",o2="convertUndefined",zJ="_xhrReadyStateChange",xa="_onError",AN="_onPartialSuccess",Uw="_onSuccess",Ww="itemsAccepted",QJ="itemsReceived",Tb="isRetryDisabled",MN="setRequestHeader",s2="maxBatchInterval",a2="eventsSendRequest",l2="disableInstrumentationKeyValidation",ON="getSamplingScore",XJ="getHashCodeScore"});function zn(r,e,t){return xw(r,e,t,TU)}function jde(r,e,t){var n=t[$n]=t[$n]||{},i=e.ext=e.ext||{},o=e[$n]=e[$n]||[],s=i.user;s&&(zn(n,ai.userAuthUserId,s.authId),zn(n,ai.userId,s.id||s.localId));var a=i.app;a&&zn(n,ai.sessionId,a.sesId);var l=i.device;l&&(zn(n,ai.deviceId,l.id||l.localId),zn(n,ai[PN],l.deviceClass),zn(n,ai.deviceIp,l.ip),zn(n,ai.deviceModel,l.model),zn(n,ai[PN],l[PN]));var c=e.ext.web;if(c){zn(n,ai.deviceLanguage,c.browserLang),zn(n,ai.deviceBrowserVersion,c.browserVer),zn(n,ai.deviceBrowser,c.browser);var u=t[ds]=t[ds]||{},p=u[un]=u[un]||{},f=p[Ei]=p[Ei]||{};zn(f,"domain",c.domain),zn(f,"isManual",c.isManual?ZJ:null),zn(f,"screenRes",c.screenRes),zn(f,"userConsent",c.userConsent?ZJ:null)}var m=i.os;m&&zn(n,ai.deviceOS,m[Vc]);var h=i.trace;h&&(zn(n,ai.operationParentId,h.parentID),zn(n,ai.operationName,rn(r,h[Vc])),zn(n,ai.operationId,h[lg]));for(var g={},v=o[Nt]-1;v>=0;v--){var I=o[v];co(I,function(x,D){g[x]=D}),o.splice(v,1)}co(o,function(x,D){g[x]=D});var S=To(To({},n),g);S[ai.internalSdkVersion]||(S[ai.internalSdkVersion]="javascript:".concat(Bde.Version)),t[$n]=hN(S)}function xf(r,e,t){Yt(r)||co(r,function(n,i){wU(i)?t[n]=i:ff(i)?e[n]=i:ig()&&(e[n]=us()[yf](i))})}function mg(r,e){Yt(r)||co(r,function(t,n){r[t]=n||e})}function hg(r,e,t,n){var i=new sU(r,n,e);zn(i,"sampleRate",t[uw]),(t[un]||{}).startTime&&(i.time=xU(t[un].startTime)),i.iKey=t.iKey;var o=t.iKey.replace(/-/g,"");return i[Vc]=i[Vc].replace("{0}",o),jde(r,t,i),t[$n]=t[$n]||[],hN(i)}function gg(r,e){Yt(e[un])&&vt(r,1,46,"telemetryItem.baseData cannot be null.")}function eq(r,e,t){gg(r,e);var n=e[un][bf]||{},i=e[un][Ei]||{};xf(e[ds],i,n),Yt(t)||mg(i,t);var o=e[un];if(Yt(o))return kw(r,"Invalid input for dependency data"),null;var s=o[Ei]&&o[Ei][Uk]?o[Ei][Uk]:"GET",a=new zh(r,o.id,o.target,o[Vc],o[vf],o.success,o.responseCode,s,o.type,o.correlationContext,i,n),l=new Sd(zh[wa],a);return hg(r,zh[If],e,l)}function u2(r,e,t){gg(r,e);var n={},i={};e[c2]!==bd[wa]&&(n.baseTypeSource=e[c2]),e[c2]===bd[wa]?(n=e[un][Ei]||{},i=e[un][bf]||{}):e[un]&&xf(e[un],n,i),xf(e[ds],n,i),Yt(t)||mg(n,t);var o=e[un][Vc],s=new bd(r,o,n,i),a=new Sd(bd[wa],s);return hg(r,bd[If],e,a)}function tq(r,e,t){gg(r,e);var n=e[un][bf]||{},i=e[un][Ei]||{};xf(e[ds],i,n),Yt(t)||mg(i,t);var o=e[un],s=Yh.CreateFromInterface(r,o,i,n),a=new Sd(Yh[wa],s);return hg(r,Yh[If],e,a)}function rq(r,e,t){gg(r,e);var n=e[un],i=n[Ei]||{},o=n[bf]||{};xf(e[ds],i,o),Yt(t)||mg(i,t);var s=new Id(r,n[Vc],n.average,n.sampleCount,n.min,n.max,n.stdDev,i,o),a=new Sd(Id[wa],s);return hg(r,Id[If],e,a)}function nq(r,e,t){gg(r,e);var n,i=e[un];!Yt(i)&&!Yt(i[Ei])&&!Yt(i[Ei][vf])?(n=i[Ei][vf],delete i[Ei][vf]):!Yt(e[ds])&&!Yt(e[ds][vf])&&(n=e[ds][vf],delete e[ds][vf]);var o=e[un],s;((e.ext||{}).trace||{})[lg]&&(s=e.ext.trace[lg]);var a=o.id||s,l=o[Vc],c=o.uri,u=o[Ei]||{},p=o[bf]||{};if(Yt(o.refUri)||(u.refUri=o.refUri),Yt(o.pageType)||(u.pageType=o.pageType),Yt(o.isLoggedIn)||(u.isLoggedIn=o.isLoggedIn[Dd]()),!Yt(o[Ei])){var f=o[Ei];co(f,function(g,v){u[g]=v})}xf(e[ds],u,p),Yt(t)||mg(u,t);var m=new $h(r,l,c,n,u,p,a),h=new Sd($h[wa],m);return hg(r,$h[If],e,h)}function iq(r,e,t){gg(r,e);var n=e[un],i=n[Vc],o=n.uri||n.url,s=n[Ei]||{},a=n[bf]||{};xf(e[ds],s,a),Yt(t)||mg(s,t);var l=new Xh(r,i,o,void 0,s,a,n),c=new Sd(Xh[wa],l);return hg(r,Xh[If],e,c)}function oq(r,e,t){gg(r,e);var n=e[un].message,i=e[un].severityLevel,o=e[un][Ei]||{},s=e[un][bf]||{};xf(e[ds],o,s),Yt(t)||mg(o,t);var a=new Qh(r,n,i,o,s),l=new Sd(Qh[wa],a);return hg(r,Qh[If],e,l)}var c2,un,Ei,ZJ,Bde,sq=te(()=>{d();pr();uf();ag();$J();kd();c2="baseType",un="baseData",Ei="properties",ZJ="true";Bde={Version:"2.8.11"}});function aq(r,e){$U(r,null,null,e)}function lq(r){var e=vN(),t=hf(),n=!1,i=!0,o=Mw(xd("OfflineListener"),r);try{if(a(Ib())&&(n=!0),e){var s=e.body||e;s.ononline&&a(s)&&(n=!0)}n&&t&&!Yt(t[Lw])&&(i=t[Lw])}catch(f){n=!1}function a(f){var m=!1;return f&&(m=xN(f,"online",l,o),m&&xN(f,"offline",c,o)),m}function l(){i=!0}function c(){i=!1}function u(){var f=!0;return n?f=i:t&&!Yt(t[Lw])&&(f=t[Lw]),f}function p(){var f=Ib();if(f&&n){if(aq(f,o),e){var m=e.body||e;Ol(m.ononline)||aq(m,o)}n=!1}}return{isOnline:u,isListening:function(){return n},unload:p}}var cq=te(()=>{d();ag();kd()});var uq,dq,pq,fq=te(()=>{d();pr();vr();uf();ag();kd();uq=function(){function r(e,t){var n=[],i=!1;this._get=function(){return n},this._set=function(o){return n=o,n},Ge(r,this,function(o){o[cg]=function(s){if(o[Sf]()>=t.eventsLimitInMem()){i||(vt(e,2,105,"Maximum in-memory buffer size reached: "+o[Sf](),!0),i=!0);return}n[Pd](s)},o[Sf]=function(){return n[Nt]},o.size=function(){for(var s=n[Nt],a=0;a<n[Nt];a++)s+=n[a][Nt];return t[Kw]()||(s+=2),s},o[_f]=function(){n=[],i=!1},o.getItems=function(){return n.slice(0)},o[ug]=function(s){if(s&&s[Nt]>0){var a=t[Kw]()?s.join(`
`):"["+s.join(",")+"]";return a}return null}})}return r.__ieDyn=1,r}(),dq=function(r){Cn(e,r);function e(t,n){var i=r.call(this,t,n)||this;return Ge(e,i,function(o,s){o[Ef]=function(a){s[_f]()},o[dg]=function(a){}}),i}return e.__ieDyn=1,e}(uq),pq=function(r){Cn(e,r);function e(t,n){var i=r.call(this,t,n)||this,o=!1;return Ge(e,i,function(s,a){var l=f(e[Cb]),c=f(e[Cf]),u=s._set(l.concat(c));u[Nt]>e[wb]&&(u[Nt]=e[wb]),m(e[Cf],[]),m(e[Cb],u),s[cg]=function(h){if(s[Sf]()>=e[wb]){o||(vt(t,2,67,"Maximum buffer size reached: "+s[Sf](),!0),o=!0);return}a[cg](h),m(e[Cb],s._get())},s[_f]=function(){a[_f](),m(e[Cb],s._get()),m(e[Cf],[]),o=!1},s[Ef]=function(h){m(e[Cb],s._set(p(h,s._get())));var g=f(e[Cf]);g instanceof Array&&h instanceof Array&&(g=g.concat(h),g[Nt]>e[wb]&&(vt(t,1,67,"Sent buffer reached its maximum size: "+g[Nt],!0),g[Nt]=e[wb]),m(e[Cf],g))},s[dg]=function(h){var g=f(e[Cf]);g=p(h,g),m(e[Cf],g)};function p(h,g){var v=[];return _i(g,function(I){!cn(I)&&fN(h,I)===-1&&v[Pd](I)}),v}function f(h){var g=h;try{g=n[Td]&&n[Td]()?n[Td]()+"_"+g:g;var v=tU(t,g);if(v){var I=us().parse(v);if(ff(I)&&(I=us().parse(I)),I&&nn(I))return I}}catch(S){vt(t,1,42," storage key: "+g+", "+Ca(S),{exception:Yn(S)})}return[]}function m(h,g){var v=h;try{v=n[Td]&&n[Td]()?n[Td]()+"_"+v:v;var I=JSON[yf](g);qk(t,v,I)}catch(S){qk(t,v,JSON[yf]([])),vt(t,2,41," storage key: "+v+", "+Ca(S)+". Buffer cleared",{exception:Yn(S)})}}}),i}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(uq)});var mq,hq=te(()=>{d();vr();ag();kd();mq=function(){function r(e){Ge(r,this,function(t){t.serialize=function(s){var a=n(s,"root");try{return us()[yf](a)}catch(l){vt(e,1,48,l&&cn(l[Dd])?l[Dd]():"Error serializing object",null,!0)}};function n(s,a){var l="__aiCircularRefCheck",c={};if(!s)return vt(e,1,48,"cannot serialize object because it is null or undefined",{name:a},!0),c;if(s[l])return vt(e,2,50,"Circular reference detected while serializing object",{name:a},!0),c;if(!s.aiDataContract){if(a==="measurements")c=o(s,"number",a);else if(a==="properties")c=o(s,"string",a);else if(a==="tags")c=o(s,"string",a);else if(nn(s))c=i(s,a);else{vt(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:a},!0);try{us()[yf](s),c=s}catch(u){vt(e,1,48,u&&cn(u[Dd])?u[Dd]():"Error serializing object",null,!0)}}return c}return s[l]=!0,co(s.aiDataContract,function(u,p){var f=cn(p)?p()&1:p&1,m=cn(p)?p()&4:p&4,h=p&2,g=s[u]!==void 0,v=pf(s[u])&&s[u]!==null;if(f&&!g&&!h)vt(e,1,24,"Missing required field specification. The field is required but not present on source",{field:u,name:a});else if(!m){var I=void 0;v?h?I=i(s[u],u):I=n(s[u],u):I=s[u],I!==void 0&&(c[u]=I)}}),delete s[l],c}function i(s,a){var l;if(s)if(!nn(s))vt(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:a},!0);else{l=[];for(var c=0;c<s[Nt];c++){var u=s[c],p=n(u,a+"["+c+"]");l[Pd](p)}}return l}function o(s,a,l){var c;return s&&(c={},co(s,function(u,p){if(a==="string")p===void 0?c[u]="undefined":p===null?c[u]="null":p[Dd]?c[u]=p[Dd]():c[u]="invalid field: toString() is not defined.";else if(a==="number")if(p===void 0)c[u]="undefined";else if(p===null)c[u]="null";else{var f=parseFloat(p);isNaN(f)?c[u]="NaN":c[u]=f}else c[u]="invalid field: "+l+" is of unknown type.",vt(e,1,c[u],null,!0)})),c}})}return r.__ieDyn=1,r}()});var Hde,gq,vq=te(()=>{d();kd();Hde=8,gq=function(){function r(){}return r.prototype.getHashCodeScore=function(e){var t=this.getHashCode(e)/r.INT_MAX_VALUE;return t*100},r.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[Nt]<Hde;)e=e.concat(e);for(var t=5381,n=0;n<e[Nt];++n)t=(t<<5)+t+e.charCodeAt(n),t=t&t;return Math.abs(t)},r.INT_MAX_VALUE=2147483647,r}()});var yq,bq=te(()=>{d();uf();kd();vq();yq=function(){function r(){var e=this,t=new gq,n=new _w;e[ON]=function(i){var o=0;return i[$n]&&i[$n][n.userId]?o=t.getHashCodeScore(i[$n][n.userId]):i.ext&&i.ext.user&&i.ext.user.id?o=t[XJ](i.ext.user.id):i[$n]&&i[$n][n.operationId]?o=t.getHashCodeScore(i[$n][n.operationId]):i.ext&&i.ext.telemetryTrace&&i.ext.telemetryTrace[lg]?o=t.getHashCodeScore(i.ext.telemetryTrace[lg]):o=Math.random()*100,o}}return r}()});var Iq,Sq=te(()=>{d();uf();ag();kd();bq();Iq=function(){function r(e,t){this.INT_MAX_VALUE=2147483647;var n=t||Tw(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[Pb]=e,this.samplingScoreGenerator=new yq}return r.prototype.isSampledIn=function(e){var t=this[Pb],n=!1;return t==null||t>=100||e.baseType===Id[wa]?!0:(n=this.samplingScoreGenerator[ON](e)<t,n)},r}()});function LN(r){try{return r.responseText}catch(e){}return null}function _q(){var r,e,t;return r={endpointUrl:function(){return Kh+vd}},r[Kw]=function(){return!1},r[s2]=function(){return 15e3},r[TN]=function(){return 102400},r[NN]=function(){return!1},r[t2]=function(){return!0},r[Tb]=function(){return!1},r[kN]=function(){return!0},r[Db]=function(){return!1},r[i2]=function(){return!1},r[e2]=function(){return!1},r[Fw]=function(){return e},r[Td]=function(){return e},r[r2]=function(){return 100},r[n2]=function(){return t},r[o2]=function(){return e},r.eventsLimitInMem=function(){return 1e4},r}var Nd,Jde,qde,Vw,Eq=te(()=>{d();pr();vr();uf();ag();sq();cq();fq();hq();Sq();kd();Jde=65e3;qde=(Nd={},Nd[bd.dataType]=u2,Nd[Qh.dataType]=oq,Nd[$h.dataType]=nq,Nd[Xh.dataType]=iq,Nd[Yh.dataType]=tq,Nd[Id.dataType]=rq,Nd[zh.dataType]=eq,Nd),Vw=function(r){Cn(e,r);function e(){var t=r.call(this)||this;t.priority=1001,t.identifier=q3,t._senderConfig=_q();var n,i,o,s,a,l,c,u,p=0,f,m,h,g;return Ge(e,t,function(v,I){Te(),v.pause=function(){At(),s=!0},v.resume=function(){s&&(s=!1,i=null,v._buffer.size()>v._senderConfig[TN]()&&v[pg](!0,null,10),le())},v.flush=function(L,ce,ve){if(L===void 0&&(L=!0),!s){At();try{v[pg](L,null,ve||1)}catch(ke){vt(v[uo](),1,22,"flush failed, telemetry will not be collected: "+Ca(ke),{exception:Yn(ke)})}}},v.onunloadFlush=function(){if(!s)if((v._senderConfig[e2]()===!1||v[Gr][kN]()===!1)&&Sb())try{v[pg](!0,A,2)}catch(L){vt(v[uo](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Ca(L),{exception:Yn(L)})}else v.flush()},v.addHeader=function(L,ce){u[L]=ce},v.initialize=function(L,ce,ve,ke){v.isInitialized()&&vt(v[uo](),1,28,"Sender is already initialized"),I.initialize(L,ce,ve,ke);var We=v._getTelCtx(),it=v.identifier;l=new mq(ce.logger),n=0,i=null,o=0,v[xb]=null,c=0;var k=v[uo]();g=Mw(xd("Sender"),ce.evtNamespace&&ce.evtNamespace()),h=lq(g);var W=_q();co(W,function(Fe,Xt){v[Gr][Fe]=function(){var et=We.getConfig(it,Fe,Xt());return!et&&Fe==="endpointUrl"&&(et=Xt()),et}}),v._buffer=v[Gr][t2]()&&Jk()?new pq(k,v[Gr]):new dq(k,v[Gr]),v._sample=new Iq(v[Gr][r2](),k),_e(L)||vt(k,1,100,"Invalid Instrumentation key "+L[Fw]),!bw(v._senderConfig.endpointUrl())&&v._senderConfig.customHeaders()&&v._senderConfig.customHeaders()[Nt]>0&&_i(v[Gr][n2](),function(Fe){t.addHeader(Fe.header,Fe.value)});var me=v[Gr],we=null;!me[Db]()&&bN()?we=en:!me[Db]()&&Pw()&&(we=j),!we&&yN()&&(we=N),f=we||j,!me[kN]()&&Sb()&&(we=R),v[xb]=we||j,!me[i2]()&&yN(!0)?m=ne:Sb()?m=R:!me[Db]()&&bN()?m=en:!me[Db]()&&Pw()?m=j:m=f},v.processTelemetry=function(L,ce){ce=v._getTelCtx(ce);var ve=ce[uo]();try{if(v[Gr][NN]())return;if(!L){vt(ve,1,7,"Cannot send empty telemetry");return}if(L.baseData&&!L[RN]){vt(ve,1,70,"Cannot send telemetry without baseData and baseType");return}if(L[RN]||(L[RN]="EventData"),!v[xb]){vt(ve,1,28,"Sender was not initialized");return}if(S(L))L[uw]=v._sample[Pb];else{vt(ve,2,33,"Telemetry item was sampled out and not sent",{SampleRate:v._sample[Pb]});return}var ke=v[Gr][o2]()||void 0,We=L.iKey||v[Gr][Fw](),it=e.constructEnvelope(L,We,ve,ke);if(!it){vt(ve,1,47,"Unable to create an AppInsights envelope");return}var k=!1;if(L[$n]&&L[$n][dw]&&(_i(L[$n][dw],function(Fe){try{Fe&&Fe(it)===!1&&(k=!0,kw(ve,"Telemetry processor check returns false"))}catch(Xt){vt(ve,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Ca(Xt),{exception:Yn(Xt)},!0)}}),delete L[$n][dw]),k)return;var W=l.serialize(it),me=v[fg],we=me.size();we+W[Nt]>v[Gr][TN]()&&v[pg](!0,null,10),me[cg](W),le()}catch(Fe){vt(ve,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Ca(Fe),{exception:Yn(Fe)})}v.processNext(L,ce)},v[zJ]=function(L,ce,ve){L.readyState===4&&x(L.status,ce,L.responseURL,ve,Ir(L),LN(L)||L.response)},v[pg]=function(L,ce,ve){if(L===void 0&&(L=!0),!s)try{var ke=v[fg];if(v[Gr][NN]())ke[_f]();else{if(ke[Sf]()>0){var We=ke.getItems();Ae(ve||0,L),ce?ce.call(t,We,L):v[xb](We,L)}o=+new Date}At()}catch(k){var it=jU();(!it||it>9)&&vt(v[uo](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+Ca(k),{exception:Yn(k)})}},v._doTeardown=function(L,ce){v.onunloadFlush(),h.unload(),Te()},v[xa]=function(L,ce,ve){vt(v[uo](),2,26,"Failed to send telemetry.",{message:ce}),v._buffer[dg](L)},v[AN]=function(L,ce){for(var ve=[],ke=[],We=ce.errors.reverse(),it=0,k=We;it<k.length;it++){var W=k[it],me=L.splice(W.index,1)[0];Ye(W.statusCode)?ke[Pd](me):ve[Pd](me)}L[Nt]>0&&v[Uw](L,ce[Ww]),ve[Nt]>0&&v[xa](ve,Ir(null,["partial success",ce[Ww],"of",ce.itemsReceived].join(" "))),ke[Nt]>0&&(Ve(ke),vt(v[uo](),2,40,"Partial success. Delivered: "+L[Nt]+", Failed: "+ve[Nt]+". Will retry to send "+ke[Nt]+" our of "+ce[QJ]+" items"))},v[Uw]=function(L,ce){v._buffer[dg](L)},v._xdrOnLoad=function(L,ce){var ve=LN(L);if(L&&(ve+""=="200"||ve===""))n=0,v[Uw](ce,0);else{var ke=ye(ve);ke&&ke.itemsReceived&&ke.itemsReceived>ke[Ww]&&!v[Gr][Tb]()?v[AN](ce,ke):v[xa](ce,H(L))}};function S(L){return v._sample.isSampledIn(L)}function x(L,ce,ve,ke,We,it){var k=null;if(v._appId||(k=ye(it),k&&k.appId&&(v._appId=k.appId)),(L<200||L>=300)&&L!==0){if((L===301||L===307||L===308)&&!D(ve)){v[xa](ce,We);return}!v[Gr][Tb]()&&Ye(L)?(Ve(ce),vt(v[uo](),2,40,". Response code "+L+". Will retry to send "+ce[Nt]+" items.")):v[xa](ce,We)}else if(h&&!h.isOnline()){if(!v[Gr][Tb]()){var W=10;Ve(ce,W),vt(v[uo](),2,40,". Offline - Response Code: ".concat(L,". Offline status: ").concat(!h.isOnline(),". Will retry to send ").concat(ce.length," items."))}}else D(ve),L===206?(k||(k=ye(it)),k&&!v[Gr][Tb]()?v[AN](ce,k):v[xa](ce,We)):(n=0,v[Uw](ce,ke))}function D(L){return c>=10?!1:!Yt(L)&&L!==""&&L!==v[Gr][wf]()?(v[Gr][wf]=function(){return L},++c,!0):!1}function A(L,ce){m?m(L,!1):R(L,ce)}function w(L){var ce=hf(),ve=v[fg],ke=v[Gr][wf](),We=v._buffer[ug](L),it=new Blob([We],{type:"text/plain;charset=UTF-8"}),k=ce.sendBeacon(ke,it);return k&&(ve[Ef](L),v._onSuccess(L,L[Nt])),k}function R(L,ce){if(nn(L)&&L[Nt]>0&&!w(L)){for(var ve=[],ke=0;ke<L[Nt];ke++){var We=L[ke];w([We])||ve[Pd](We)}ve[Nt]>0&&(f&&f(ve,!0),vt(v[uo](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function j(L,ce){var ve=new XMLHttpRequest,ke=v[Gr][wf]();try{ve[cw]=!0}catch(it){}ve.open("POST",ke,ce),ve[MN]("Content-type","application/json"),bw(ke)&&ve[MN](db[6],db[7]),_i(mf(u),function(it){ve[MN](it,u[it])}),ve.onreadystatechange=function(){return v._xhrReadyStateChange(ve,L,L[Nt])},ve.onerror=function(it){return v[xa](L,Ir(ve),it)};var We=v._buffer[ug](L);ve.send(We),v._buffer[Ef](L)}function ne(L,ce){if(nn(L)){for(var ve=L[Nt],ke=0;ke<L[Nt];ke++)ve+=L[ke][Nt];p+ve<=Jde?ee(L,!1):Sb()?R(L,ce):(f&&f(L,!0),vt(v[uo](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function N(L,ce){ee(L,!0)}function ee(L,ce){var ve,ke=v[Gr][wf](),We=v._buffer[ug](L),it=new Blob([We],{type:"application/json"}),k=new Headers,W=We[Nt],me=!1,we=!1;bw(ke)&&k.append(db[6],db[7]),_i(mf(u),function(et){k.append(et,u[et])});var Fe=(ve={method:"POST",headers:k,body:it},ve[cw]=!0,ve);ce||(Fe.keepalive=!0,me=!0,p+=W);var Xt=new Request(ke,Fe);try{Xt[cw]=!0}catch(et){}v._buffer[Ef](L);try{fetch(Xt).then(function(et){ce||(p-=W,W=0),we||(we=!0,et.ok?et.text().then(function(Et){x(et.status,L,et.url,L[Nt],et.statusText,Et)}):v[xa](L,et.statusText))}).catch(function(et){ce||(p-=W,W=0),we||(we=!0,v[xa](L,et.message))})}catch(et){we||v[xa](L,Yn(et))}me&&!we&&(we=!0,v._onSuccess(L,L[Nt]))}function ye(L){try{if(L&&L!==""){var ce=us().parse(L);if(ce&&ce.itemsReceived&&ce.itemsReceived>=ce[Ww]&&ce.itemsReceived-ce.itemsAccepted===ce.errors[Nt])return ce}}catch(ve){vt(v[uo](),1,43,"Cannot parse the response. "+Ca(ve),{response:L})}return null}function Ve(L,ce){if(ce===void 0&&(ce=1),!(!L||L[Nt]===0)){var ve=v[fg];ve[dg](L),n++;for(var ke=0,We=L;ke<We.length;ke++){var it=We[ke];ve[cg](it)}Pe(ce),le()}}function Pe(L){var ce=10,ve;if(n<=1)ve=ce;else{var ke=(Math.pow(2,n)-1)/2,We=Math.floor(Math.random()*ke*ce)+1;We=L*We,ve=Math.max(Math.min(We,3600),ce)}var it=wd()+ve*1e3;i=it}function le(){if(!a&&!s){var L=i?Math.max(0,i-wd()):0,ce=Math.max(v[Gr][s2](),L);a=setTimeout(function(){a=null,v[pg](!0,null,1)},ce)}}function At(){clearTimeout(a),a=null,i=null}function Ye(L){return L===401||L===403||L===408||L===429||L===500||L===502||L===503||L===504}function Ir(L,ce){return L?"XMLHttpRequest,Status:"+L.status+",Response:"+LN(L)||L.response||"":ce}function en(L,ce){var ve=v[fg],ke=Ib(),We=new XDomainRequest;We.onload=function(){return v._xdrOnLoad(We,L)},We.onerror=function(me){return v[xa](L,H(We),me)};var it=ke&&ke.location&&ke.location.protocol||"";if(v[Gr][wf]().lastIndexOf(it,0)!==0){vt(v[uo](),2,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),ve[_f]();return}var k=v[Gr][wf]().replace(/^(https?:)/,"");We.open("POST",k);var W=ve[ug](L);We.send(W),ve[Ef](L)}function H(L,ce){return L?"XDomainRequest,Response:"+LN(L)||"":ce}function fe(){var L="getNotifyMgr";return v.core[L]?v.core[L]():v.core._notificationManager}function Ae(L,ce){var ve=fe();if(ve&&ve[a2])try{ve[a2](L,ce)}catch(ke){vt(v[uo](),1,74,"send request notification failed: "+Ca(ke),{exception:Yn(ke)})}}function _e(L){var ce=Yt(L[l2])?!1:L[l2];if(ce)return!0;var ve="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",ke=new RegExp(ve);return ke.test(L[Fw])}function Te(){v[xb]=null,v[fg]=null,v._appId=null,v._sample=null,u={},h=null,n=0,i=null,o=null,s=!1,a=null,l=null,c=0,p=0,f=null,m=null,g=null}}),t}return e.constructEnvelope=function(t,n,i,o){var s;n!==t.iKey&&!Yt(n)?s=To(To({},t),{iKey:n}):s=t;var a=qde[s.baseType]||u2;return a(i,s,o)},e}(ZU)});var d2=te(()=>{d();Eq()});var Kl,ps,jw,Fl,Bt,Ls,jc,KN,Ks,_t,vg,Yr,FN,yg,bg,p2,Bw,Ig,kb,Hw,Df,Fs,Nb,Pf,Ul,Rb,Sg,Us,Da,Tf,Rd,f2,kf,Wl,Jw,qw,Ad,_g,UN,Ab,Vl,m2,Cq,wq,Qn,Gw,xq,Eg,Yw,Cg,jl,WN,VN,jN,BN,Mn=te(()=>{d();Kl="initialize",ps="name",jw="getNotifyMgr",Fl="identifier",Bt="push",Ls="isInitialized",jc="config",KN="instrumentationKey",Ks="logger",_t="length",vg="time",Yr="processNext",FN="getProcessTelContext",yg="addNotificationListener",bg="removeNotificationListener",p2="stopPollingInternalLogs",Bw="onComplete",Ig="getPlugin",kb="flush",Hw="_extensions",Df="splice",Fs="teardown",Nb="messageId",Pf="message",Ul="isAsync",Rb="_doTeardown",Sg="update",Us="getNext",Da="diagLog",Tf="setNextPlugin",Rd="createNew",f2="cookieCfg",kf="indexOf",Wl="substring",Jw="userAgent",qw="split",Ad="setEnabled",_g="substr",UN="nodeType",Ab="apply",Vl="replace",m2="enableDebugExceptions",Cq="logInternalMessage",wq="toLowerCase",Qn="call",Gw="type",xq="handler",Eg="listeners",Yw="isChildEvt",Cg="getCtx",jl="setCtx",WN="complete",VN="traceId",jN="spanId",BN="traceFlags"});var Rt,h2,vn,g2,$w,Mb,Dq,fs,Pa,Ob,Nf,Lb,Rf,HN,zw,wg,Ci=te(()=>{d();Rt="",h2="channels",vn="core",g2="createPerfMgr",$w="disabled",Mb="extensionConfig",Dq="extensions",fs="processTelemetry",Pa="priority",Ob="eventsSent",Nf="eventsDiscarded",Lb="eventsSendRequest",Rf="perfEvent",HN="errorToConsole",zw="warnToConsole",wg="getPerfMgr"});function ipe(r){if(r){if(qN)return qN(r);var e=r[Yde]||r[Vt]||r[JN];if(e)return e}return null}function _2(r,e){return typeof r===e}function On(r){return r===void 0||typeof r===nr}function fr(r){return r===null||On(r)}function E2(r){return!fr(r)}function C2(r,e){return!!(r&&dr[Qn](r,e))}function Md(r){return!!(r&&typeof r===ht)}function kr(r){return!!(r&&typeof r===an)}function Qw(r){var e=r;return e&&Af(e)&&(e=e[Vl](tpe,function(t,n){return n.toUpperCase()}),e=e[Vl](rpe,"_"),e=e[Vl](npe,function(t,n){return"_"+n})),e}function Od(r,e){if(r)for(var t in r)dr[Qn](r,t)&&e[Qn](r,t,r[t])}function w2(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=zde?r[Lq](e):ope(r,e)),t}function ope(r,e){var t=!1,n=e?e[_t]:0,i=r?r[_t]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Fi(r,e){return r&&e?r[kf](e)!==-1:!1}function x2(r){return!!(r&&S2[Qn](r)==="[object Date]")}function spe(r){return!!(r&&S2[Qn](r)==="[object Array]")}function GN(r){return!!(r&&S2[Qn](r)==="[object Error]")}function Af(r){return typeof r=="string"}function D2(r){return typeof r=="number"}function Kb(r){return typeof r=="boolean"}function Aq(r){var e=!1;if(r&&typeof r=="object"){var t=qN?qN(r):ipe(r);t?(t[JN]&&dr[Qn](t,JN)&&(t=t[JN]),e=typeof t===an&&Fq[Qn](t)===epe):e=!0}return e}function Fb(r){if(r)return Xde?r[Oq]():ape(r)}function ape(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[_t]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Dt(r,e,t){var n=r[_t];try{for(var i=0;i<n&&!(i in r&&e[Qn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function Ta(r,e,t){if(r){if(r[Pq])return r[Pq](e,t);var n=r[_t],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function P2(r,e,t){var n;if(r){if(r[Tq])return r[Tq](e,t);var i=r[_t],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Qn](o,r[s],r))}catch(a){}}return n}function T2(r,e,t){var n;if(r){if(r[kq])return r[kq](e,t);var i=r[_t],o=0;if(arguments[_t]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Bl(r){return r&&(r=$de&&r[y2]?r[y2]():r[Vl]?r[Vl](/^\s+|(?=\s)\s+$/g,Rt):r),r}function Ub(r){var e=typeof r;if(e!==an&&(e!==ht||r===null)&&ha("objKeys called on non-object"),!Mq&&Rq)return Rq(r);var t=[];for(var n in r)r&&dr[Qn](r,n)&&t[Bt](n);if(Mq)for(var i=v2[_t],o=0;o<i;o++)r&&dr[Qn](r,v2[o])&&t[Bt](v2[o]);return t}function Wb(r,e,t,n){if(Nq)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),Nq(r,e,i),!0}catch(o){}return!1}function lpe(r){return r}function k2(r){return b2&&Od(r,function(e,t){(dn(t)||Md(t))&&b2(t)}),Bc(r)}function Hl(){var r=Date;return r.now?r.now():new r().getTime()}function Xw(r){return GN(r)?r[ps]:Rt}function ka(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Vb(r,e,t){var n;return r?(n=r[e],!n&&fr(n)&&(n=On(t)?{}:t,r[e]=n)):n=On(t)?{}:t,n}function Na(r,e){return fr(r)?e:r}function YN(r){return!!r}function li(r){throw new Error(r)}function cpe(r,e){var t=null,n=null;return kr(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][Ab](n,i)}}function jb(r,e,t,n,i){r&&e&&t&&(i!==!1||On(r[e]))&&(r[e]=cpe(t,n))}function Ld(r,e,t,n){return r&&e&&Md(r)&&dn(t)&&Dt(t,function(i){Af(i)&&jb(r,i,e,i,n)}),r}function Bb(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[_t],c=!1,u=1;for(l>0&&Kb(a)&&(c=a,a=s[u]||{},u++),Md(a)||(a={});u<l;u++){var p=s[u],f=dn(p),m=Md(p);for(var h in p){var g=f&&h in p||m&&dr[Qn](p,h);if(g){var v=p[h],I=void 0;if(c&&v&&((I=dn(v))||Aq(v))){var S=a[h];I?dn(S)||(S=[]):Aq(S)||(S={}),v=Bb(c,S,v)}v!==void 0&&(a[h]=v)}}}return a}var Oq,Lq,Gde,Pq,Tq,kq,y2,Kq,Yde,JN,Nq,b2,jHe,Rq,I2,$de,zde,BHe,Qde,Xde,Zde,S2,Fq,epe,tpe,rpe,npe,qN,dn,Mq,v2,Bc,Xn=te(()=>{d();pr();Mn();Ci();Oq="toISOString",Lq="endsWith",Gde="startsWith",Pq="indexOf",Tq="map",kq="reduce",y2="trim",Kq="toString",Yde="__proto__",JN="constructor",Nq=Do,b2=Pr.freeze,jHe=Pr.seal,Rq=Pr.keys,I2=String[Vt],$de=I2[y2],zde=I2[Lq],BHe=I2[Gde],Qde=Date[Vt],Xde=Qde[Oq],Zde=Array.isArray,S2=ma[Kq],Fq=dr[Kq],epe=Fq[Qn](Pr),tpe=/-([a-z])/g,rpe=/([^\w\d_$])/g,npe=/^(\d+[\w\d_$])/,qN=Object.getPrototypeOf;dn=Zde||spe;Mq=!{toString:null}.propertyIsEnumerable("toString"),v2=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Bc=b2||lpe});function N2(r){var e={};return Od(r,function(t,n){e[t]=n,e[n]=t}),k2(e)}var Uq=te(()=>{d();Xn()});function Ws(r){var e=Jn();return e&&e[r]?e[r]:r===Wq&&jq()?window:null}function jq(){return!!(typeof window===ht&&window)}function Bq(){return jq()?window:Ws(Wq)}function Ipe(){return!!(typeof document===ht&&document)}function $N(){return Ipe()?document:Ws(upe)}function Spe(){return!!(typeof navigator===ht&&navigator)}function M2(){return Spe()?navigator:Ws(dpe)}function Hq(r){if(r&&bpe){var e=Ws("__mockLocation");if(e)return e}return typeof location===ht&&location?location:Ws(ppe)}function Jq(){return typeof console!==nr?console:Ws(fpe)}function qq(){return Ws(mpe)}function zN(){return!!(typeof JSON===ht&&JSON||Ws(Vq)!==null)}function O2(){return zN()?JSON||Ws(Vq):null}function Gq(){return Ws(hpe)}function Yq(){return Ws(gpe)}function xg(){var r=M2();if(r&&(r[Jw]!==A2||R2===null)){A2=r[Jw];var e=(A2||Rt)[wq]();R2=Fi(e,vpe)||Fi(e,ype)}return R2}function Ra(r){var e=Object[Vt].toString[Qn](r),t=Rt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[ps]+"'":zN()&&(t=O2().stringify(r)),e+t}var Wq,upe,dpe,ppe,fpe,mpe,Vq,hpe,gpe,vpe,ype,R2,A2,bpe,Hc=te(()=>{"use strict";d();pr();Mn();Xn();Ci();Wq="window",upe="document",dpe="navigator",ppe="location",fpe="console",mpe="performance",Vq="JSON",hpe="crypto",gpe="msCrypto",vpe="msie",ype="trident/",R2=null,A2=null,bpe=!1});function _pe(r,e){return function(){var t=arguments,n=K2(e);if(n){var i=n.listener;i&&i[r]&&i[r][Ab](i,t)}}}function Epe(){var r=Ws("Microsoft");return r&&(XN=r.ApplicationInsights),XN}function K2(r){var e=XN;return!e&&r.disableDbgExt!==!0&&(e=XN||Epe()),e?e.ChromeDbgExt:null}function $q(r){if(!QN){QN={};for(var e=0;e<L2[_t];e++)QN[L2[e]]=_pe(L2[e],r)}return QN}var L2,XN,QN,F2=te(()=>{d();Mn();Hc();L2=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],XN=null});function zq(r){return r?'"'+r[Vl](/\"/g,Rt)+'"':Rt}function Qq(r,e){var t=Jq();if(t){var n="log";t[r]&&(n=r),kr(t[n])&&t[n](e)}}function Xq(r,e){return(r||{})[Ks]||new Hb(e)}function Zq(r){return r||new Hb}function Jl(r,e,t,n,i,o){o===void 0&&(o=!1),Zq(r).throwInternal(e,t,n,i,o)}function e4(r,e){Zq(r)[zw](e)}var Cpe,wpe,xpe,ZN,Hb,Dg=te(()=>{"use strict";d();vr();Mn();F2();Hc();Xn();Ci();Cpe="AI (Internal): ",wpe="AI: ",xpe="AITR_";ZN=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Nb]=e,o[Pf]=(n?wpe:Cpe)+e;var s=Rt;zN()&&(s=O2().stringify(i));var a=(t?" message:"+zq(t):Rt)+(i?" props:"+zq(s):Rt);o[Pf]+=a}return r.dataType="MessageData",r}();Hb=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Ge(r,this,function(l){u(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[m2]=function(){return a},l.throwInternal=function(m,h,g,v,I){I===void 0&&(I=!1);var S=new ZN(h,g,I,v);if(a)throw Ra(S);var x=m===1?HN:zw;if(On(S[Pf]))f("throw"+(m===1?"Critical":"Warning"),S);else{if(I){var D=+S[Nb];!n[D]&&i>=m&&(l[x](S[Pf]),n[D]=!0)}else i>=m&&l[x](S[Pf]);c(m,S)}},l[zw]=function(m){Qq("warn",m),f("warning",m)},l[HN]=function(m){Qq("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[Cq]=c;function c(m,h){if(!p()){var g=!0,v=xpe+h[Nb];if(n[v]?g=!1:n[v]=!0,g&&(m<=o&&(l.queue[Bt](h),t++,f(m===1?"error":"warn",h)),t===s)){var I="Internal events throttle limit per PageView reached for this app.",S=new ZN(23,I,!1);l.queue[Bt](S),m===1?l[HN](I):l[zw](I)}}}function u(m){i=Na(m.loggingLevelConsole,0),o=Na(m.loggingLevelTelemetry,1),s=Na(m.maxMessageLimit,25),a=Na(m[m2],!1)}function p(){return t>=s}function f(m,h){var g=K2(e||{});g&&g[Da]&&g[Da](m,h)}})}return r.__ieDyn=1,r}()});function t0(r,e,t,n,i){if(r){var o=r;if(o[wg]&&(o=o[wg]()),o){var s=void 0,a=o[Cg](U2);try{if(s=o.create(e(),n,i),s){if(a&&s[jl]&&(s[jl](e0[W2],a),a[Cg]&&a[jl])){var l=a[Cg](e0[Zw]);l||(l=[],a[jl](e0[Zw],l)),l[Bt](s)}return o[jl](U2,s),t(s)}}catch(c){s&&s[jl]&&s[jl]("exception",c)}finally{s&&o.fire(s),o[jl](U2,a)}}}return t()}function r4(){return Dpe}var Jb,W2,Zw,Dpe,e0,t4,U2,r0=te(()=>{d();vr();Mn();Xn();Ci();Jb="ctx",W2="ParentContextKey",Zw="ChildrenContextKey",Dpe=null,e0=function(){function r(e,t,n){var i=this,o=!1;if(i.start=Hl(),i[ps]=e,i[Ul]=n,i[Yw]=function(){return!1},kr(t)){var s;o=Wb(i,"payload",function(){return!s&&kr(t)&&(s=t(),t=null),s})}i[Cg]=function(a){return a?a===r[W2]||a===r[Zw]?i[a]:(i[Jb]||{})[a]:null},i[jl]=function(a,l){if(a)if(a===r[W2])i[a]||(i[Yw]=function(){return!0}),i[a]=l;else if(a===r[Zw])i[a]=l;else{var c=i[Jb]=i[Jb]||{};c[a]=l}},i[WN]=function(){var a=0,l=i[Cg](r[Zw]);if(dn(l))for(var c=0;c<l[_t];c++){var u=l[c];u&&(a+=u[vg])}i[vg]=Hl()-i.start,i.exTime=i[vg]-a,i[WN]=function(){},!o&&kr(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),t4=function(){function r(e){this.ctx={},Ge(r,this,function(t){t.create=function(n,i,o){return new e0(n,i,o)},t.fire=function(n){n&&(n[WN](),e&&kr(e[Rf])&&e[Rf](n))},t[jl]=function(n,i){if(n){var o=t[Jb]=t[Jb]||{};o[n]=i}},t[Cg]=function(n){return(t[Jb]||{})[n]}})}return r.__ieDyn=1,r}(),U2="CoreUtils.doPerf"});function o4(r){r<0&&(r>>>=0),ex=123456789+r&Mf,tx=987654321-r&Mf,i4=!0}function s4(){try{var r=Hl()&2147483647;o4((Math.random()*n4^r)+r)}catch(e){}}function a4(r){return r>0?Math.floor(Pg()/Mf*(r+1))>>>0:0}function Pg(r){var e=0,t=Gq()||Yq();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Mf),e===0&&xg()&&(i4||s4(),e=V2()&Mf),e===0&&(e=Math.floor(n4*Math.random()|0)),r||(e>>>=0),e}function l4(r){r?o4(r):s4()}function V2(r){tx=36969*(tx&65535)+(tx>>16)&Mf,ex=18e3*(ex&65535)+(ex>>16)&Mf;var e=(tx<<16)+(ex&65535)>>>0&Mf|0;return r||(e>>>=0),e}function n0(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=Pg()>>>0,n=0,i=Rt;i[_t]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(Pg()<<2&4294967295|t&3)>>>0,n=0);return i}var n4,Mf,i4,ex,tx,j2=te(()=>{d();Mn();Hc();Xn();Ci();n4=4294967296,Mf=4294967295,i4=!1,ex=123456789,tx=987654321});function kpe(r,e,t){if(c4)try{return c4(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function d4(r){return r[UN]===1||r[UN]===9||!+r[UN]}function Npe(r,e){var t=e[r.id];if(!t){t={};try{d4(e)&&(kpe(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function qb(r,e){return e===void 0&&(e=!1),Qw(r+Tpe+++(e?"."+u4:Rt)+Ppe)}function i0(r){var e={id:qb("_aiData-"+(r||Rt)+"."+u4),accept:function(t){return d4(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Qw(n)]:(o&&(s=Npe(e,t),s[Qw(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var c4,u4,Ppe,Tpe,o0=te(()=>{d();pr();Mn();Xn();Ci();j2();c4=Do,u4="2.8.11",Ppe="."+n0(6),Tpe=0});function _4(r,e){var t=rx[Gb]||l0[Gb];return t||(t=rx[Gb]=rx(r,e),l0[Gb]=t),t}function a0(r){return r?r.isEnabled():!0}function Rpe(r){var e=r[f2]=r[f2]||{};if(ka(e,"domain",r.cookieDomain,E2,fr),ka(e,"path",r.cookiePath||"/",null,fr),fr(e[J2])){var t=void 0;On(r[m4])||(t=!r[m4]),On(r[h4])||(t=!r[h4]),e[J2]=t}return e}function E4(r,e){return e&&r&&dn(r.ignoreCookies)?r.ignoreCookies[kf](e)!==-1:!1}function Ape(r,e){return e&&r&&dn(r.blockedCookies)&&r.blockedCookies[kf](e)!==-1?!0:E4(r,e)}function rx(r,e){var t,n=Rpe(r||l0),i=n.path||"/",o=n.domain,s=n[J2]!==!1,a=(t={isEnabled:function(){var l=s&&y4(e),c=l0[Gb];return l&&c&&a!==c&&(l=a0(c)),l}},t[Ad]=function(l){s=l!==!1},t.set=function(l,c,u,p,f){var m=!1;if(a0(a)&&!Ape(n,l)){var h={},g=Bl(c||Rt),v=g[kf](";");if(v!==-1&&(g=Bl(c[Wl](0,v)),h=C4(c[Wl](v+1))),ka(h,"domain",p||o,YN,On),!fr(u)){var I=xg();if(On(h[B2])){var S=Hl(),x=S+u*1e3;if(x>0){var D=new Date;D.setTime(x),ka(h,B2,b4(D,I?p4:f4)||b4(D,I?p4:f4)||Rt,YN)}}I||ka(h,"max-age",Rt+u,null,On)}var A=Hq();A&&A.protocol==="https:"&&(ka(h,"secure",null,null,On),H2===null&&(H2=!Ope((M2()||{})[Jw])),H2&&ka(h,"SameSite","None",null,On)),ka(h,"path",f||i,null,On);var w=n.setCookie||S4;w(l,I4(g,h)),m=!0}return m},t.get=function(l){var c=Rt;return a0(a)&&!E4(n,l)&&(c=(n.getCookie||Mpe)(l)),c},t.del=function(l,c){var u=!1;return a0(a)&&(u=a.purge(l,c)),u},t.purge=function(l,c){var u,p=!1;if(y4(e)){var f=(u={},u.path=c||"/",u[B2]="Thu, 01 Jan 1970 00:00:01 GMT",u);xg()||(f["max-age"]="0");var m=n.delCookie||S4;m(l,I4(Rt,f)),p=!0}return p},t);return a[Gb]=a,a}function y4(r){if(s0===null){s0=!1;try{var e=nx||{};s0=e[q2]!==void 0}catch(t){Jl(r,2,68,"Cannot access document.cookie - "+Xw(t),{exception:Ra(t)})}}return s0}function C4(r){var e={};if(r&&r[_t]){var t=Bl(r)[qw](";");Dt(t,function(n){if(n=Bl(n||Rt),n){var i=n[kf]("=");i===-1?e[n]=null:e[Bl(n[Wl](0,i))]=Bl(n[Wl](i+1))}})}return e}function b4(r,e){return kr(r[e])?r[e]():null}function I4(r,e){var t=r||Rt;return Od(e,function(n,i){t+="; "+n+(fr(i)?Rt:"="+i)}),t}function Mpe(r){var e=Rt;if(nx){var t=nx[q2]||Rt;g4!==t&&(v4=C4(t),g4=t),e=Bl(v4[r]||Rt)}return e}function S4(r,e){nx&&(nx[q2]=r+"="+e)}function Ope(r){return Af(r)?!!(Fi(r,"CPU iPhone OS 12")||Fi(r,"iPad; CPU OS 12")||Fi(r,"Macintosh; Intel Mac OS X 10_14")&&Fi(r,"Version/")&&Fi(r,"Safari")||Fi(r,"Macintosh; Intel Mac OS X 10_14")&&w2(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Fi(r,"Chrome/5")||Fi(r,"Chrome/6")||Fi(r,"UnrealEngine")&&!Fi(r,"Chrome")||Fi(r,"UCBrowser/12")||Fi(r,"UCBrowser/11")):!1}var p4,f4,q2,B2,J2,m4,h4,Gb,s0,H2,g4,nx,v4,l0,G2=te(()=>{d();Mn();Dg();Hc();Xn();Ci();p4="toGMTString",f4="toUTCString",q2="cookie",B2="expires",J2="enabled",m4="isCookieUseDisabled",h4="disableCookiesUsage",Gb="_ckMgr",s0=null,H2=null,g4=null,nx=$N(),v4={},l0={}});function D4(r){return r&&r[Vl]?r[Vl](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Rt):r}function jpe(r,e){var t;if(e){var n=Rt;dn(e)?(n=Rt,Dt(e,function(o){o=D4(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=D4(e),n&&(n[0]!=="."&&(n="."+n),r=(r||Rt)+n)}var i=Vpe.exec(r||Rt)||[];return t={},t[Gw]=i[1],t.ns=(i[2]||Rt).replace(Fpe,".").replace(Upe,Rt)[qw](".").sort().join("."),t}function Bpe(r,e,t){t===void 0&&(t=!0);var n=P4.get(r,Kpe,{},t),i=n[e];return i||(i=n[e]=[]),i}function Hpe(r,e,t,n){var i=!1;return r&&e&&e[Gw]&&t&&(r[x4]?(r[x4](e[Gw],t,n),i=!0):r[w4]&&(r[w4](Lpe+e[Gw],t),i=!0)),i}function Y2(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=jpe(e,n);if(s=Hpe(r,a,t,i),s&&P4.accept(r)){var l=(o={guid:Wpe++,evtName:a},o[xq]=t,o.capture=i,o);Bpe(r,a.type)[Bt](l)}}catch(c){}return s}function T4(r,e,t){var n=!1,i=Bq();i&&(n=Y2(i,r,e,t),n=Y2(i.body,r,e,t)||n);var o=$N();return o&&(n=Y2(o,r,e,t)||n),n}var Lpe,w4,x4,Kpe,H7e,J7e,Fpe,Upe,Wpe,P4,Vpe,k4=te(()=>{d();Mn();o0();Hc();Xn();Ci();Lpe="on",w4="attachEvent",x4="addEventListener",Kpe="events",H7e=qb("aiEvtPageHide"),J7e=qb("aiEvtPageShow"),Fpe=/\.[\.]+/g,Upe=/[\.]+$/,Wpe=1,P4=i0("events"),Vpe=/^([^.]*)(?:\.(.+)|)/});function N4(){var r=$2();return r[Wl](0,8)+"-"+r[Wl](8,12)+"-"+r[Wl](12,16)+"-"+r[Wl](16,20)+"-"+r[Wl](20)}function R4(){var r=qq();return r&&r.now?r.now():Hl()}function $2(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=Rt,t,n=0;n<4;n++)t=Pg(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(Pg()&3)|0];return e[_g](0,8)+e[_g](9,4)+"4"+e[_g](13,3)+i+e[_g](16,3)+e[_g](19,12)}function A4(r,e){var t=_4(r,e),n=sx._canUseCookies;return ix===null&&(ix=[],ox=n,Wb(sx,"_canUseCookies",function(){return ox},function(i){ox=i,Dt(ix,function(o){o[Ad](i)})})),Ta(ix,t)===-1&&ix[Bt](t),Kb(n)&&t[Ad](n),Kb(ox)&&t[Ad](ox),t}function M4(){A4()[Ad](!1)}var ix,ox,sx,O4=te(()=>{"use strict";d();pr();Mn();G2();Hc();k4();Xn();Ci();j2();ix=null;sx={_canUseCookies:void 0,isTypeof:_2,isUndefined:On,isNullOrUndefined:fr,hasOwnProperty:C2,isFunction:kr,isObject:Md,isDate:x2,isArray:dn,isError:GN,isString:Af,isNumber:D2,isBoolean:Kb,toISOString:Fb,arrForEach:Dt,arrIndexOf:Ta,arrMap:P2,arrReduce:T2,strTrim:Bl,objCreate:Po,objKeys:Ub,objDefineAccessors:Wb,addEventHandler:T4,dateNow:Hl,isIE:xg,disableCookies:M4,newGuid:N4,perfNow:R4,newId:n0,randomValue:a4,random32:Pg,mwcRandomSeed:l4,mwcRandom32:V2,generateW3CId:$2}});function L4(r,e,t){return r&&r[_t]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function K4(r){return L4(r,32,Jpe)}function F4(r){return L4(r,16,qpe)}var Jpe,qpe,U4=te(()=>{d();Mn();Jpe="00000000000000000000000000000000",qpe="0000000000000000"});function Kd(r){return Gpe.get(r,"state",{},!0)}function c0(r,e){for(var t=[],n=null,i=r[Us](),o;i;){var s=i[Ig]();if(s){n&&kr(n[Tf])&&kr(s[fs])&&n[Tf](s);var a=!1;kr(s[Ls])?a=s[Ls]():(o=Kd(s),a=o[Ls]),a||t[Bt](s),n=s,i=i[Us]()}}Dt(t,function(l){var c=r[vn]();l[Kl](r.getCfg(),c,e,r[Us]()),o=Kd(l),!l[vn]&&!o[vn]&&(o[vn]=c),o[Ls]=!0,delete o[Fs]})}function u0(r){return r.sort(function(e,t){var n=0;if(t){var i=kr(t[fs]);kr(e[fs])?n=i?e[Pa]-t[Pa]:1:i&&(n=-1)}else n=e?1:-1;return n})}function W4(r){var e={};return{getName:function(){return e[ps]},setName:function(t){r&&r.setName(t),e[ps]=t},getTraceId:function(){return e[VN]},setTraceId:function(t){r&&r.setTraceId(t),K4(t)&&(e[VN]=t)},getSpanId:function(){return e[jN]},setSpanId:function(t){r&&r.setSpanId(t),F4(t)&&(e[jN]=t)},getTraceFlags:function(){return e[BN]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[BN]=t}}}var Gpe,d0=te(()=>{"use strict";d();Mn();o0();Xn();Ci();U4();Gpe=i0("plugin")});function $pe(r,e,t){for(;r;){if(r[Ig]()===t)return r;r=r[Us]()}return Jc([t],e[jc]||{},e)}function z2(r,e,t,n){var i=null,o=[];n!==null&&(i=n?$pe(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return Xq(t,e)},getCfg:function(){return e},getExtCfg:c,getConfig:u,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:p,onComplete:a}};function a(f,m){for(var h=[],g=2;g<arguments.length;g++)h[g-2]=arguments[g];f&&o[Bt]({func:f,self:On(m)?s.ctx:m,args:h})}function l(){var f=i;if(i=f?f[Us]():null,!f){var m=o;m&&m[_t]>0&&(Dt(m,function(h){try{h.func[Qn](h.self,h.args)}catch(g){Jl(t[Ks],2,73,"Unexpected Exception during onComplete - "+Ra(g))}}),o=[])}return f}function c(f,m,h){m===void 0&&(m={}),h===void 0&&(h=0);var g;if(e){var v=e[Mb];v&&f&&(g=v[f])}if(!g)g=m;else if(Md(m)&&h!==0){var I=Bb(!0,m,g);e&&h===2&&Od(m,function(S){if(fr(I[S])){var x=e[S];fr(x)||(I[S]=x)}}),g=I}return g}function u(f,m,h){h===void 0&&(h=!1);var g,v=c(f,null);return v&&!fr(v[m])?g=v[m]:e&&!fr(e[m])&&(g=e[m]),fr(g)?h:g}function p(f){for(var m;m=s._next();){var h=m[Ig]();h&&f(h)}}return s}function ql(r,e,t,n){var i=z2(r,e,t,n),o=i.ctx;function s(l){var c=i._next();return c&&c[fs](l,o),!c}function a(l,c){return l===void 0&&(l=null),dn(l)&&(l=Jc(l,e,t,c)),ql(l||o[Us](),e,t,c)}return o[Yr]=s,o[Rd]=a,o}function Yb(r,e,t){var n=e[jc]||{},i=z2(r,n,e,t),o=i.ctx;function s(l){var c=i._next();return c&&c.unload(o,l),!c}function a(l,c){return l===void 0&&(l=null),dn(l)&&(l=Jc(l,n,e,c)),Yb(l||o[Us](),e,c)}return o[Yr]=s,o[Rd]=a,o}function ax(r,e,t){var n=e[jc]||{},i=z2(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(c){kr(c[Sg])&&c[Sg](o,l)})}function a(l,c){return l===void 0&&(l=null),dn(l)&&(l=Jc(l,n,e,c)),ax(l||o[Us](),e,c)}return o[Yr]=s,o[Rd]=a,o}function Jc(r,e,t,n){var i=null,o=!n;if(dn(r)&&r[_t]>0){var s=null;Dt(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&kr(a[fs])){var l=zpe(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Jc([n],e,t):i}function zpe(r,e,t){var n=null,i=kr(r[fs]),o=kr(r[Tf]),s;r?s=r[Fl]+"-"+r[Pa]+"-"+B4++:s="Unknown-0-"+B4++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:u,unload:p,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&kr(r[j4])&&(m=r[j4]()),m||(m=ql(a,e,t)),m}function c(m,h,g,v,I){var S=!1,x=r?r[Fl]:Ype,D=m[V4];return D||(D=m[V4]={}),m.setNext(n),r&&t0(m[vn](),function(){return x+":"+g},function(){D[s]=!0;try{var A=n?n._id:Rt;A&&(D[A]=!1),S=h(m)}catch(R){var w=n?D[n._id]:!0;w&&(S=!0),(!n||!w)&&Jl(m[Da](),1,73,"Plugin ["+x+"] failed during "+g+" - "+Ra(R)+", run flags: "+Ra(D))}},v,I),S}function u(m,h){h=h||l();function g(v){if(!r||!i)return!1;var I=Kd(r);return I[Fs]||I[$w]?!1:(o&&r[Tf](n),r[fs](m,v),!0)}c(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[Yr](m)}function p(m,h){function g(){var v=!1;if(r){var I=Kd(r),S=r[vn]||I[vn];r&&(!S||S===m.core())&&!I[Fs]&&(I[vn]=null,I[Fs]=!0,I[Ls]=!1,r[Fs]&&r[Fs](m,h)===!0&&(v=!0))}return v}c(m,g,"unload",function(){},h[Ul])||m[Yr](h)}function f(m,h){function g(){var v=!1;if(r){var I=Kd(r),S=r[vn]||I[vn];r&&(!S||S===m.core())&&!I[Fs]&&r[Sg]&&r[Sg](m,h)===!0&&(v=!0)}return v}c(m,g,"update",function(){},!1)||m[Yr](h)}return Bc(a)}var Ype,V4,j4,B4,C5e,p0=te(()=>{"use strict";d();Mn();Dg();Hc();Xn();Ci();r0();d0();Ype="TelemetryPluginChain",V4="_hasRun",j4="_getTelCtx",B4=0;C5e=function(){function r(e,t,n,i){var o=this,s=ql(e,t,n,i);Ld(o,s,Ub(s))}return r}()});function H4(r,e,t){e&&dn(e)&&e[_t]>0&&(e=e.sort(function(n,i){return n[Pa]-i[Pa]}),Dt(e,function(n){n[Pa]<lx&&li(Qpe+n[Fl])}),r[Bt]({queue:Bc(e),chain:Jc(e,t[jc],t)}))}function J4(r,e){function t(){return ql(null,e[jc],e,null)}function n(c,u,p,f){var m=c?c[_t]+1:1;function h(){m--,m===0&&(f&&f(),f=null)}m>0&&Dt(c,function(g){if(g&&g.queue[_t]>0){var v=g.chain,I=u[Rd](v);I[Bw](h),p(I)}else m--}),h()}function i(c,u){var p=u||{reason:0};return n(r,c,function(f){f[Yr](p)},function(){c[Yr](p)}),!0}function o(c,u){var p=u||{reason:0,isAsync:!1};return n(r,c,function(f){f[Yr](p)},function(){c[Yr](p),a=!1}),!0}function s(c){var u=null;return r&&r[_t]>0&&Dt(r,function(p){if(p&&p.queue[_t]>0&&(Dt(p.queue,function(f){if(f[Fl]===c)return u=f,-1}),u))return-1}),u}var a=!1,l={identifier:"ChannelControllerPlugin",priority:lx,initialize:function(c,u,p,f){a=!0,Dt(r,function(m){m&&m.queue[_t]>0&&c0(ql(m.chain,c,u),p)})},isInitialized:function(){return a},processTelemetry:function(c,u){n(r,u||t(),function(p){p[Yr](c)},function(){u[Yr](c)})},update:i,pause:function(){n(r,t(),function(c){c.iterate(function(u){u.pause&&u.pause()})},null)},resume:function(){n(r,t(),function(c){c.iterate(function(u){u.resume&&u.resume()})},null)},teardown:o,getChannel:s,flush:function(c,u,p,f){var m=1,h=!1,g=null;f=f||5e3;function v(){m--,h&&m===0&&(g&&(clearTimeout(g),g=null),u&&u(h),u=null)}return n(r,t(),function(I){I.iterate(function(S){if(S[kb]){m++;var x=!1;S[kb](c,function(){x=!0,v()},p)||x||(c&&g==null?g=setTimeout(function(){g=null,v()},f):v())}})},function(){h=!0,v()}),!0},_setQueue:function(c){r=c}};return l}function q4(r,e,t){var n=[];if(r&&Dt(r,function(o){return H4(n,o,t)}),e){var i=[];Dt(e,function(o){o[Pa]>lx&&i[Bt](o)}),H4(n,i,t)}return n}var lx,Qpe,G4=te(()=>{d();Mn();Xn();Ci();p0();d0();lx=500,Qpe="Channel has invalid priority - "});function f0(){var r=[];function e(n){n&&r[Bt](n)}function t(n,i){Dt(r,function(o){try{o(n,i)}catch(s){Jl(n[Da](),2,73,"Unexpected error calling unload handler - "+Ra(s))}}),r=[]}return{add:e,run:t}}var Q2=te(()=>{d();Mn();Dg();Hc();Xn()});var Of,Y4,$4=te(()=>{"use strict";d();vr();Mn();Xn();Ci();p0();Q2();Of="getPlugin",Y4=function(){function r(){var e=this,t,n,i,o,s;c(),Ge(r,e,function(u){u[Kl]=function(p,f,m,h){l(p,f,h),t=!0},u[Fs]=function(p,f){var m,h=u[vn];if(!h||p&&h!==p[vn]())return;var g,v=!1,I=p||Yb(null,h,i&&i[Of]?i[Of]():i),S=f||(m={reason:0},m[Ul]=!1,m);function x(){if(!v){v=!0,o.run(I,f);var D=s;s=[],Dt(D,function(A){A.rm()}),g===!0&&I[Yr](S),c()}}return!u[Rb]||u[Rb](I,S,x)!==!0?x():g=!0,g},u[Sg]=function(p,f){var m=u[vn];if(!m||p&&m!==p[vn]())return;var h,g=!1,v=p||ax(null,m,i&&i[Of]?i[Of]():i),I=f||{reason:0};function S(){g||(g=!0,l(v.getCfg(),v.core(),v[Us]()))}return!u._doUpdate||u._doUpdate(v,I,S)!==!0?S():h=!0,h},u._addHook=function(p){p&&(dn(p)?s=s.concat(p):s[Bt](p))},jb(u,"_addUnloadCb",function(){return o},"add")}),e[Da]=function(u){return a(u)[Da]()},e[Ls]=function(){return t},e.setInitialized=function(u){t=u},e[Tf]=function(u){i=u},e[Yr]=function(u,p){p?p[Yr](u):i&&kr(i[fs])&&i[fs](u,null)},e._getTelCtx=a;function a(u){u===void 0&&(u=null);var p=u;if(!p){var f=n||ql(null,{},e[vn]);i&&i[Of]?p=f[Rd](null,i[Of]):p=f[Rd](null,i)}return p}function l(u,p,f){u&&ka(u,Mb,[],null,fr),!f&&p&&(f=p[FN]()[Us]());var m=i;i&&i[Of]&&(m=i[Of]()),e[vn]=p,n=ql(f,u,p,m)}function c(){t=!1,e[vn]=null,n=null,i=null,s=[],o=f0()}}return r.__ieDyn=1,r}()});var z4,Q4=te(()=>{d();pr();vr();Mn();$4();Dg();Hc();Xn();Ci();z4=function(r){Cn(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),Ge(e,t,function(s,a){s.addTelemetryInitializer=function(l){var c={id:n++,fn:l};i[Bt](c);var u={remove:function(){Dt(i,function(p,f){if(p.id===c.id)return i[Df](f,1),-1})}};return u},s[fs]=function(l,c){for(var u=!1,p=i[_t],f=0;f<p;++f){var m=i[f];if(m)try{if(m.fn[Ab](null,[l])===!1){u=!0;break}}catch(h){Jl(c[Da](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Xw(h),{exception:Ra(h)},!0)}}u||s[Yr](l,c)},s[Rb]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(Y4)});function efe(r,e){return new t4(e)}function tfe(r,e,t){var n,i=[],o={};return Dt(t,function(s){(fr(s)||fr(s[Kl]))&&li(tG);var a=s[Pa],l=s[Fl];s&&a&&(fr(o[a])?o[a]=l:e4(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Bt](s)}),n={all:t},n[vn]=i,n}function eG(r,e){var t=!1;return Dt(e,function(n){if(n===r)return t=!0,-1}),t}function rfe(){var r;return Po((r={},r[yg]=function(e){},r[bg]=function(e){},r[Ob]=function(e){},r[Nf]=function(e,t){},r[Lb]=function(e,t){},r))}var tG,X4,Z4,Xpe,Zpe,rG,nG=te(()=>{"use strict";d();pr();vr();pr();Mn();G4();G2();o0();F2();Dg();Xn();Ci();r0();p0();d0();Q4();Q2();tG="Plugins must provide initialize method",X4="_notificationManager",Z4="SDK is still unloading...",Xpe="SDK is not initialized",Zpe={loggingLevelConsole:1};rG=function(){function r(){var e,t,n,i,o,s,a,l,c,u,p,f,m,h,g,v,I,S,x,D,A=0;Ge(r,this,function(w){R(),w[Ls]=function(){return t},w[Kl]=function(H,fe,Ae,_e){h&&li(Z4),w[Ls]()&&li("Core should not be initialized more than once"),e=H||{},w[jc]=e,fr(H[KN])&&li("Please provide instrumentation key"),i=_e,w[X4]=_e,le(),At(),Ye(),Ae&&(w[Ks]=Ae);var Te=Vb(e,Dq,[]);c=[],c[Bt].apply(c,Gm(Gm([],fe,!1),Te,!1)),f=Vb(e,h2,[]),ne(null),(!m||m[_t]===0)&&li("No "+h2+" available"),t=!0,w.releaseQueue()},w.getTransmissionControls=function(){var H=[];return m&&Dt(m,function(fe){H[Bt](fe.queue)}),Bc(H)},w.track=function(H){H.iKey=H.iKey||e[KN],H[vg]=H[vg]||Fb(new Date),H.ver=H.ver||"4.0",!h&&w[Ls]()?j()[Yr](H):n[Bt](H)},w[FN]=j,w[jw]=function(){return i||(i=rfe(),w[X4]=i),i},w[yg]=function(H){i&&i[yg](H)},w[bg]=function(H){i&&i[bg](H)},w.getCookieMgr=function(){return a||(a=rx(e,w[Ks])),a},w.setCookieMgr=function(H){a=H},w[wg]=function(){if(!o&&!s&&Na(e.enablePerfMgr)){var H=Na(e[g2]);kr(H)&&(s=H(w,w[jw]()))}return o||s||r4()},w.setPerfMgr=function(H){o=H},w.eventCnt=function(){return n[_t]},w.releaseQueue=function(){if(t&&n[_t]>0){var H=n;n=[],Dt(H,function(fe){j()[Yr](fe)})}},w.pollInternalLogs=function(H){v=H||null;var fe=Na(e.diagnosticLogInterval);return(!fe||!(fe>0))&&(fe=1e4),A&&clearInterval(A),A=setInterval(function(){Ve()},fe),A},w[p2]=function(){A&&(clearInterval(A),A=0,Ve())},Ld(w,function(){return g},["addTelemetryInitializer"]),w.unload=function(H,fe,Ae){var _e;H===void 0&&(H=!0),t||li(Xpe),h&&li(Z4);var Te=(_e={reason:50},_e[Ul]=H,_e.flushComplete=!1,_e),L=Yb(ee(),w);L[Bw](function(){R(),fe&&fe(Te)},w);function ce(ve){Te.flushComplete=ve,h=!0,S.run(L,Te),w[p2](),L[Yr](Te)}Pe(H,ce,6,Ae)||ce(!1)},w[Ig]=N,w.addPlugin=function(H,fe,Ae,_e){if(!H){_e&&_e(!1),en(tG);return}var Te=N(H[Fl]);if(Te&&!fe){_e&&_e(!1),en("Plugin ["+H[Fl]+"] is already loaded!");return}var L={reason:16};function ce(We){c[Bt](H),L.added=[H],ne(L),_e&&_e(!0)}if(Te){var ve=[Te.plugin],ke={reason:2,isAsync:!!Ae};ye(ve,ke,function(We){We?(L.removed=ve,L.reason|=32,ce(!0)):_e&&_e(!1)})}else ce(!1)},w.evtNamespace=function(){return I},w[kb]=Pe,w.getTraceCtx=function(H){return D||(D=W4()),D},w.setTraceCtx=function(H){D=H||null},jb(w,"addUnloadCb",function(){return S},"add");function R(){t=!1,e=Bb(!0,{},Zpe),w[jc]=e,w[Ks]=new Hb(e),w[Hw]=[],g=new z4,n=[],i=null,o=null,s=null,a=null,l=null,u=null,c=[],p=null,f=null,m=null,h=!1,v=null,I=qb("AIBaseCore",!0),S=f0(),D=null}function j(){return ql(ee(),e,w)}function ne(H){var fe=tfe(w[Ks],lx,c);u=fe[vn],l=null;var Ae=fe.all;if(m=Bc(q4(f,Ae,w)),p){var _e=Ta(Ae,p);_e!==-1&&Ae[Df](_e,1),_e=Ta(u,p),_e!==-1&&u[Df](_e,1),p._setQueue(m)}else p=J4(m,w);Ae[Bt](p),u[Bt](p),w[Hw]=u0(Ae),p[Kl](e,w,Ae),c0(j(),Ae),w[Hw]=Bc(u0(u||[])).slice(),H&&Ir(H)}function N(H){var fe,Ae=null,_e=null;return Dt(w[Hw],function(Te){if(Te[Fl]===H&&Te!==p&&Te!==g)return _e=Te,-1}),!_e&&p&&(_e=p.getChannel(H)),_e&&(Ae=(fe={plugin:_e},fe[Ad]=function(Te){Kd(_e)[$w]=!Te},fe.isEnabled=function(){var Te=Kd(_e);return!Te[Fs]&&!Te[$w]},fe.remove=function(Te,L){var ce;Te===void 0&&(Te=!0);var ve=[_e],ke=(ce={reason:1},ce[Ul]=Te,ce);ye(ve,ke,function(We){We&&ne({reason:32,removed:ve}),L&&L(We)})},fe)),Ae}function ee(){if(!l){var H=(u||[]).slice();Ta(H,g)===-1&&H[Bt](g),l=Jc(u0(H),e,w)}return l}function ye(H,fe,Ae){if(H&&H[_t]>0){var _e=Jc(H,e,w),Te=Yb(_e,w);Te[Bw](function(){var L=!1,ce=[];Dt(c,function(ke,We){eG(ke,H)?L=!0:ce[Bt](ke)}),c=ce;var ve=[];f&&(Dt(f,function(ke,We){var it=[];Dt(ke,function(k){eG(k,H)?L=!0:it[Bt](k)}),ve[Bt](it)}),f=ve),Ae&&Ae(L)}),Te[Yr](fe)}else Ae(!1)}function Ve(){var H=w[Ks]?w[Ks].queue:[];H&&(Dt(H,function(fe){var Ae,_e=(Ae={},Ae[ps]=v||"InternalMessageId: "+fe[Nb],Ae.iKey=Na(e[KN]),Ae.time=Fb(new Date),Ae.baseType=ZN.dataType,Ae.baseData={message:fe[Pf]},Ae);w.track(_e)}),H[_t]=0)}function Pe(H,fe,Ae,_e){return p?p[kb](H,fe,Ae||6,_e):(fe&&fe(!1),!0)}function le(){var H=Na(e.disableDbgExt);H===!0&&x&&(i[bg](x),x=null),i&&!x&&H!==!0&&(x=$q(e),i[yg](x))}function At(){var H=Na(e.enablePerfMgr);!H&&s&&(s=null),H&&Vb(e,g2,efe)}function Ye(){var H=Vb(e,Mb,{});H.NotificationManager=i}function Ir(H){var fe=ax(ee(),w);(!w._updateHook||w._updateHook(fe,H)!==!0)&&fe[Yr](H)}function en(H){var fe=w[Ks];fe?Jl(fe,2,73,H):li(H)}})}return r.__ieDyn=1,r}()});function m0(r,e,t,n){Dt(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var iG,oG=te(()=>{d();vr();Mn();Xn();Ci();iG=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;Ge(r,this,function(n){n[yg]=function(i){n.listeners[Bt](i)},n[bg]=function(i){for(var o=Ta(n[Eg],i);o>-1;)n.listeners[Df](o,1),o=Ta(n[Eg],i)},n[Ob]=function(i){m0(n[Eg],Ob,!0,function(o){o[Ob](i)})},n[Nf]=function(i,o){m0(n[Eg],Nf,!0,function(s){s[Nf](i,o)})},n[Lb]=function(i,o){m0(n[Eg],Lb,o,function(s){s[Lb](i,o)})},n[Rf]=function(i){i&&(t||!i[Yw]())&&m0(n[Eg],Rf,!1,function(o){i[Ul]?setTimeout(function(){return o[Rf](i)},0):o[Rf](i)})}})}return r.__ieDyn=1,r}()});var cx,sG=te(()=>{d();pr();vr();Mn();nG();Dg();Xn();Ci();oG();r0();cx=function(r){Cn(e,r);function e(){var t=r.call(this)||this;return Ge(e,t,function(n,i){n[Kl]=function(a,l,c,u){i[Kl](a,l,c||new Hb(a),u||new iG(a))},n.track=function(a){t0(n[wg](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),li("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){fr(a[ps])&&(s(a),li("telemetry name required"))}function s(a){var l=n[jw]();l&&l[Nf]([a],2)}}),t}return e.__ieDyn=1,e}(rG)});var Re,Kr,Tg,Gl,aG,lG,h0,X2,ux,g0,$b,Yl,Lf,Fd,dx,cG,nfe,Z2,uG=te(()=>{d();Uq();Kr="Failed",Tg=Kr+"MonitorAjax",Gl="Track",aG="Start",lG="Stop",h0="Event",X2="AuthContext",ux="Exception",g0="Local",$b="Session",Yl="Storage",Lf="Browser",Fd="Cannot",dx="Buffer",cG="InstrumentationKey",nfe=N2({CRITICAL:1,WARNING:2}),Z2=N2((Re={},Re[Lf+"DoesNotSupport"+g0+Yl]=0,Re[Lf+Fd+"Read"+g0+Yl]=1,Re[Lf+Fd+"Read"+$b+Yl]=2,Re[Lf+Fd+"Write"+g0+Yl]=3,Re[Lf+Fd+"Write"+$b+Yl]=4,Re[Lf+Kr+"RemovalFrom"+g0+Yl]=5,Re[Lf+Kr+"RemovalFrom"+$b+Yl]=6,Re[Fd+"SendEmptyTelemetry"]=7,Re.ClientPerformanceMathError=8,Re["ErrorParsingAI"+$b+"Cookie"]=9,Re.ErrorPVCalc=10,Re[ux+"WhileLoggingError"]=11,Re[Kr+"AddingTelemetryTo"+dx]=12,Re[Tg+"Abort"]=13,Re[Tg+"Dur"]=14,Re[Tg+"Open"]=15,Re[Tg+"RSC"]=16,Re[Tg+"Send"]=17,Re[Tg+"GetCorrelationHeader"]=18,Re[Kr+"ToAddHandlerForOnBeforeUnload"]=19,Re[Kr+"ToSendQueuedTelemetry"]=20,Re[Kr+"ToReportDataLoss"]=21,Re["Flush"+Kr]=22,Re.MessageLimitPerPVExceeded=23,Re.MissingRequiredFieldSpecification=24,Re.NavigationTimingNotSupported=25,Re.OnError=26,Re[$b+"RenewalDateIsZero"]=27,Re.SenderNotInitialized=28,Re[aG+Gl+h0+Kr]=29,Re[lG+Gl+h0+Kr]=30,Re[aG+Gl+Kr]=31,Re[lG+Gl+Kr]=32,Re.TelemetrySampledAndNotSent=33,Re[Gl+h0+Kr]=34,Re[Gl+ux+Kr]=35,Re[Gl+"Metric"+Kr]=36,Re[Gl+"PV"+Kr]=37,Re[Gl+"PV"+Kr+"Calc"]=38,Re[Gl+"Trace"+Kr]=39,Re["Transmission"+Kr]=40,Re[Kr+"ToSet"+Yl+dx]=41,Re[Kr+"ToRestore"+Yl+dx]=42,Re.InvalidBackendResponse=43,Re[Kr+"ToFixDepricatedValues"]=44,Re.InvalidDurationValue=45,Re.TelemetryEnvelopeInvalid=46,Re.CreateEnvelopeError=47,Re[Fd+"SerializeObject"]=48,Re[Fd+"SerializeObjectNonSerializable"]=49,Re.CircularReferenceDetected=50,Re["Clear"+X2+Kr]=51,Re[ux+"Truncated"]=52,Re.IllegalCharsInName=53,Re.ItemNotInArray=54,Re.MaxAjaxPerPVExceeded=55,Re.MessageTruncated=56,Re.NameTooLong=57,Re.SampleRateOutOfRange=58,Re["Set"+X2+Kr]=59,Re["Set"+X2+Kr+"AccountName"]=60,Re.StringValueTooLong=61,Re.StartCalledMoreThanOnce=62,Re.StopCalledWithoutStart=63,Re["TelemetryInitializer"+Kr]=64,Re.TrackArgumentsNotSpecified=65,Re.UrlTooLong=66,Re[$b+Yl+dx+"Full"]=67,Re[Fd+"AccessCookie"]=68,Re.IdTooLong=69,Re.InvalidEvent=70,Re[Tg+"SetRequestHeader"]=71,Re["Send"+Lf+"InfoOnUserInit"]=72,Re["Plugin"+ux]=73,Re["Notification"+ux]=74,Re.SnippetScriptLoadFailure=99,Re["Invalid"+cG]=100,Re[Fd+"ParseAiBlobValue"]=101,Re.InvalidContentBlob=102,Re[Gl+"PageAction"+h0+Kr]=103,Re[Kr+"AddingCustomDefinedRequestContext"]=104,Re["InMemory"+Yl+dx+"Full"]=105,Re[cG+"Deprecation"]=106,Re))});var eW=te(()=>{d();sG();O4();Xn();uG()});var v0,y0,px,dG=te(()=>{d();v0="instrumentationKey",y0="connectionString",px="diagnosticLogInterval"});var pG={};Um(pG,{AppInsightsCore:()=>cx,ApplicationInsights:()=>ife,CoreUtils:()=>sx,Sender:()=>Vw,SeverityLevel:()=>pU,_InternalMessageId:()=>Z2,arrForEach:()=>Dt,isNullOrUndefined:()=>fr,proxyFunctions:()=>Ld,throwError:()=>li});var ife,fG=te(()=>{d();vr();d2();uf();eW();dG();eW();uf();d2();ife=function(){function r(e){var t=new cx;(fr(e)||fr(e[v0])&&fr(e[y0]))&&li("Invalid input configuration"),Ge(r,this,function(n){if(e[y0]){var i=oU(e[y0]),o=i.ingestionendpoint;e.endpointUrl=o?o+vd:e.endpointUrl,e[v0]=i.instrumentationkey||e[v0]}n.config=e,s(),n.initialize=s,n.getSKUDefaults=function(){n.config[px]=n.config[px]&&n.config[px]>0?n.config[px]:1e4},n.getSKUDefaults(),Ld(n,t,["track","flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb"]);function s(){t.initialize(n.config,[new Vw]),t.pollInternalLogs()}})}return r.__ieDyn=1,r}()});var hG={};Um(hG,{default:()=>b0});function sfe(r){if(r.userAgentData){let e=r.userAgentData.brands[r.userAgentData.brands.length-1];return`${r.userAgentData.platform} - ${e==null?void 0:e.brand} v${e==null?void 0:e.version}}`}else return r.appVersion}var mG,ofe,b0,gG=te(()=>{d();mG=z(require("vscode"));F6();U6();W6();V6();ofe=async(r,e)=>{let t;try{let i=await Promise.resolve().then(()=>(fG(),pG));t=new i.ApplicationInsights({instrumentationKey:r,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0})}catch(i){return Promise.reject(i)}return{logEvent:(i,o)=>{let s={...o==null?void 0:o.properties,...o==null?void 0:o.measurements};e!=null&&e.length&&ib.applyReplacements(s,e),t==null||t.track({name:i,data:s})},flush:async()=>{t==null||t.flush()}}};b0=class extends xk{constructor(e,t){let n=s=>ofe(s,t);ib.shouldUseOneDataSystemSDK(e)&&(n=s=>K6(s,mG));let i={release:sfe(navigator),platform:"web",architecture:"web"},o=new wk(e,n);if(e&&e.indexOf("AIF")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(o,mG,{additionalCommonProperties:ib.getAdditionalCommonProperties(i)})}}});var _W=Q((yt,KG)=>{d();yt=KG.exports=ir;var Nr;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?Nr=function(){var r=Array.prototype.slice.call(arguments,0);r.unshift("SEMVER"),console.log.apply(console,r)}:Nr=function(){};yt.SEMVER_SPEC_VERSION="2.0.0";var fx=256,x0=Number.MAX_SAFE_INTEGER||9007199254740991,iW=16,uge=fx-6,mx=yt.re=[],$r=yt.safeRe=[],Ce=yt.src=[],er=0,cW="[a-zA-Z0-9-]",oW=[["\\s",1],["\\d",fx],[cW,uge]];function R0(r){for(var e=0;e<oW.length;e++){var t=oW[e][0],n=oW[e][1];r=r.split(t+"*").join(t+"{0,"+n+"}").split(t+"+").join(t+"{1,"+n+"}")}return r}var Zb=er++;Ce[Zb]="0|[1-9]\\d*";var eI=er++;Ce[eI]="\\d+";var uW=er++;Ce[uW]="\\d*[a-zA-Z-]"+cW+"*";var EG=er++;Ce[EG]="("+Ce[Zb]+")\\.("+Ce[Zb]+")\\.("+Ce[Zb]+")";var CG=er++;Ce[CG]="("+Ce[eI]+")\\.("+Ce[eI]+")\\.("+Ce[eI]+")";var sW=er++;Ce[sW]="(?:"+Ce[Zb]+"|"+Ce[uW]+")";var aW=er++;Ce[aW]="(?:"+Ce[eI]+"|"+Ce[uW]+")";var dW=er++;Ce[dW]="(?:-("+Ce[sW]+"(?:\\."+Ce[sW]+")*))";var pW=er++;Ce[pW]="(?:-?("+Ce[aW]+"(?:\\."+Ce[aW]+")*))";var lW=er++;Ce[lW]=cW+"+";var gx=er++;Ce[gx]="(?:\\+("+Ce[lW]+"(?:\\."+Ce[lW]+")*))";var fW=er++,wG="v?"+Ce[EG]+Ce[dW]+"?"+Ce[gx]+"?";Ce[fW]="^"+wG+"$";var mW="[v=\\s]*"+Ce[CG]+Ce[pW]+"?"+Ce[gx]+"?",hW=er++;Ce[hW]="^"+mW+"$";var oI=er++;Ce[oI]="((?:<|>)?=?)";var D0=er++;Ce[D0]=Ce[eI]+"|x|X|\\*";var P0=er++;Ce[P0]=Ce[Zb]+"|x|X|\\*";var Ng=er++;Ce[Ng]="[v=\\s]*("+Ce[P0]+")(?:\\.("+Ce[P0]+")(?:\\.("+Ce[P0]+")(?:"+Ce[dW]+")?"+Ce[gx]+"?)?)?";var rI=er++;Ce[rI]="[v=\\s]*("+Ce[D0]+")(?:\\.("+Ce[D0]+")(?:\\.("+Ce[D0]+")(?:"+Ce[pW]+")?"+Ce[gx]+"?)?)?";var xG=er++;Ce[xG]="^"+Ce[oI]+"\\s*"+Ce[Ng]+"$";var DG=er++;Ce[DG]="^"+Ce[oI]+"\\s*"+Ce[rI]+"$";var PG=er++;Ce[PG]="(?:^|[^\\d])(\\d{1,"+iW+"})(?:\\.(\\d{1,"+iW+"}))?(?:\\.(\\d{1,"+iW+"}))?(?:$|[^\\d])";var A0=er++;Ce[A0]="(?:~>?)";var nI=er++;Ce[nI]="(\\s*)"+Ce[A0]+"\\s+";mx[nI]=new RegExp(Ce[nI],"g");$r[nI]=new RegExp(R0(Ce[nI]),"g");var dge="$1~",TG=er++;Ce[TG]="^"+Ce[A0]+Ce[Ng]+"$";var kG=er++;Ce[kG]="^"+Ce[A0]+Ce[rI]+"$";var M0=er++;Ce[M0]="(?:\\^)";var iI=er++;Ce[iI]="(\\s*)"+Ce[M0]+"\\s+";mx[iI]=new RegExp(Ce[iI],"g");$r[iI]=new RegExp(R0(Ce[iI]),"g");var pge="$1^",NG=er++;Ce[NG]="^"+Ce[M0]+Ce[Ng]+"$";var RG=er++;Ce[RG]="^"+Ce[M0]+Ce[rI]+"$";var gW=er++;Ce[gW]="^"+Ce[oI]+"\\s*("+mW+")$|^$";var vW=er++;Ce[vW]="^"+Ce[oI]+"\\s*("+wG+")$|^$";var Rg=er++;Ce[Rg]="(\\s*)"+Ce[oI]+"\\s*("+mW+"|"+Ce[Ng]+")";mx[Rg]=new RegExp(Ce[Rg],"g");$r[Rg]=new RegExp(R0(Ce[Rg]),"g");var fge="$1$2$3",AG=er++;Ce[AG]="^\\s*("+Ce[Ng]+")\\s+-\\s+("+Ce[Ng]+")\\s*$";var MG=er++;Ce[MG]="^\\s*("+Ce[rI]+")\\s+-\\s+("+Ce[rI]+")\\s*$";var OG=er++;Ce[OG]="(<|>)?=?\\s*\\*";for(Yc=0;Yc<er;Yc++)Nr(Yc,Ce[Yc]),mx[Yc]||(mx[Yc]=new RegExp(Ce[Yc]),$r[Yc]=new RegExp(R0(Ce[Yc])));var Yc;yt.parse=Ag;function Ag(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof ir)return r;if(typeof r!="string"||r.length>fx)return null;var t=e.loose?$r[hW]:$r[fW];if(!t.test(r))return null;try{return new ir(r,e)}catch(n){return null}}yt.valid=mge;function mge(r,e){var t=Ag(r,e);return t?t.version:null}yt.clean=hge;function hge(r,e){var t=Ag(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null}yt.SemVer=ir;function ir(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof ir){if(r.loose===e.loose)return r;r=r.version}else if(typeof r!="string")throw new TypeError("Invalid Version: "+r);if(r.length>fx)throw new TypeError("version is longer than "+fx+" characters");if(!(this instanceof ir))return new ir(r,e);Nr("SemVer",r,e),this.options=e,this.loose=!!e.loose;var t=r.trim().match(e.loose?$r[hW]:$r[fW]);if(!t)throw new TypeError("Invalid Version: "+r);if(this.raw=r,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>x0||this.major<0)throw new TypeError("Invalid major version");if(this.minor>x0||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>x0||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<x0)return i}return n}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}ir.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};ir.prototype.toString=function(){return this.version};ir.prototype.compare=function(r){return Nr("SemVer.compare",this.version,this.options,r),r instanceof ir||(r=new ir(r,this.options)),this.compareMain(r)||this.comparePre(r)};ir.prototype.compareMain=function(r){return r instanceof ir||(r=new ir(r,this.options)),tI(this.major,r.major)||tI(this.minor,r.minor)||tI(this.patch,r.patch)};ir.prototype.comparePre=function(r){if(r instanceof ir||(r=new ir(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;var e=0;do{var t=this.prerelease[e],n=r.prerelease[e];if(Nr("prerelease compare",e,t,n),t===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(t===void 0)return-1;if(t===n)continue;return tI(t,n)}while(++e)};ir.prototype.inc=function(r,e){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)typeof this.prerelease[t]=="number"&&(this.prerelease[t]++,t=-2);t===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+r)}return this.format(),this.raw=this.version,this};yt.inc=gge;function gge(r,e,t,n){typeof t=="string"&&(n=t,t=void 0);try{return new ir(r,t).inc(e,n).version}catch(i){return null}}yt.diff=vge;function vge(r,e){if(yW(r,e))return null;var t=Ag(r),n=Ag(e),i="";if(t.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in t)if((s==="major"||s==="minor"||s==="patch")&&t[s]!==n[s])return i+s;return o}yt.compareIdentifiers=tI;var _G=/^[0-9]+$/;function tI(r,e){var t=_G.test(r),n=_G.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1}yt.rcompareIdentifiers=yge;function yge(r,e){return tI(e,r)}yt.major=bge;function bge(r,e){return new ir(r,e).major}yt.minor=Ige;function Ige(r,e){return new ir(r,e).minor}yt.patch=Sge;function Sge(r,e){return new ir(r,e).patch}yt.compare=Ud;function Ud(r,e,t){return new ir(r,t).compare(new ir(e,t))}yt.compareLoose=_ge;function _ge(r,e){return Ud(r,e,!0)}yt.rcompare=Ege;function Ege(r,e,t){return Ud(e,r,t)}yt.sort=Cge;function Cge(r,e){return r.sort(function(t,n){return yt.compare(t,n,e)})}yt.rsort=wge;function wge(r,e){return r.sort(function(t,n){return yt.rcompare(t,n,e)})}yt.gt=hx;function hx(r,e,t){return Ud(r,e,t)>0}yt.lt=T0;function T0(r,e,t){return Ud(r,e,t)<0}yt.eq=yW;function yW(r,e,t){return Ud(r,e,t)===0}yt.neq=LG;function LG(r,e,t){return Ud(r,e,t)!==0}yt.gte=bW;function bW(r,e,t){return Ud(r,e,t)>=0}yt.lte=IW;function IW(r,e,t){return Ud(r,e,t)<=0}yt.cmp=k0;function k0(r,e,t,n){switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return yW(r,t,n);case"!=":return LG(r,t,n);case">":return hx(r,t,n);case">=":return bW(r,t,n);case"<":return T0(r,t,n);case"<=":return IW(r,t,n);default:throw new TypeError("Invalid operator: "+e)}}yt.Comparator=Aa;function Aa(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof Aa){if(r.loose===!!e.loose)return r;r=r.value}if(!(this instanceof Aa))return new Aa(r,e);r=r.trim().split(/\s+/).join(" "),Nr("comparator",r,e),this.options=e,this.loose=!!e.loose,this.parse(r),this.semver===vx?this.value="":this.value=this.operator+this.semver.version,Nr("comp",this)}var vx={};Aa.prototype.parse=function(r){var e=this.options.loose?$r[gW]:$r[vW],t=r.match(e);if(!t)throw new TypeError("Invalid comparator: "+r);this.operator=t[1],this.operator==="="&&(this.operator=""),t[2]?this.semver=new ir(t[2],this.options.loose):this.semver=vx};Aa.prototype.toString=function(){return this.value};Aa.prototype.test=function(r){return Nr("Comparator.test",r,this.options.loose),this.semver===vx?!0:(typeof r=="string"&&(r=new ir(r,this.options)),k0(r,this.operator,this.semver,this.options))};Aa.prototype.intersects=function(r,e){if(!(r instanceof Aa))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var t;if(this.operator==="")return t=new yn(r.value,e),N0(this.value,t,e);if(r.operator==="")return t=new yn(this.value,e),N0(r.semver,t,e);var n=(this.operator===">="||this.operator===">")&&(r.operator===">="||r.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(r.operator==="<="||r.operator==="<"),o=this.semver.version===r.semver.version,s=(this.operator===">="||this.operator==="<=")&&(r.operator===">="||r.operator==="<="),a=k0(this.semver,"<",r.semver,e)&&(this.operator===">="||this.operator===">")&&(r.operator==="<="||r.operator==="<"),l=k0(this.semver,">",r.semver,e)&&(this.operator==="<="||this.operator==="<")&&(r.operator===">="||r.operator===">");return n||i||o&&s||a||l};yt.Range=yn;function yn(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof yn)return r.loose===!!e.loose&&r.includePrerelease===!!e.includePrerelease?r:new yn(r.raw,e);if(r instanceof Aa)return new yn(r.value,e);if(!(this instanceof yn))return new yn(r,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=r.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}yn.prototype.format=function(){return this.range=this.set.map(function(r){return r.join(" ").trim()}).join("||").trim(),this.range};yn.prototype.toString=function(){return this.range};yn.prototype.parseRange=function(r){var e=this.options.loose,t=e?$r[MG]:$r[AG];r=r.replace(t,Oge),Nr("hyphen replace",r),r=r.replace($r[Rg],fge),Nr("comparator trim",r,$r[Rg]),r=r.replace($r[nI],dge),r=r.replace($r[iI],pge);var n=e?$r[gW]:$r[vW],i=r.split(" ").map(function(o){return Dge(o,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(o){return!!o.match(n)})),i=i.map(function(o){return new Aa(o,this.options)},this),i};yn.prototype.intersects=function(r,e){if(!(r instanceof yn))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(n){return r.set.some(function(i){return i.every(function(o){return n.intersects(o,e)})})})})};yt.toComparators=xge;function xge(r,e){return new yn(r,e).set.map(function(t){return t.map(function(n){return n.value}).join(" ").trim().split(" ")})}function Dge(r,e){return Nr("comp",r,e),r=kge(r,e),Nr("caret",r),r=Pge(r,e),Nr("tildes",r),r=Rge(r,e),Nr("xrange",r),r=Mge(r,e),Nr("stars",r),r}function Ko(r){return!r||r.toLowerCase()==="x"||r==="*"}function Pge(r,e){return r.trim().split(/\s+/).map(function(t){return Tge(t,e)}).join(" ")}function Tge(r,e){var t=e.loose?$r[kG]:$r[TG];return r.replace(t,function(n,i,o,s,a){Nr("tilde",r,n,i,o,s,a);var l;return Ko(i)?l="":Ko(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Ko(s)?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":a?(Nr("replaceTilde pr",a),l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0"):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0",Nr("tilde return",l),l})}function kge(r,e){return r.trim().split(/\s+/).map(function(t){return Nge(t,e)}).join(" ")}function Nge(r,e){Nr("caret",r,e);var t=e.loose?$r[RG]:$r[NG];return r.replace(t,function(n,i,o,s,a){Nr("caret",r,n,i,o,s,a);var l;return Ko(i)?l="":Ko(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Ko(s)?i==="0"?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+".0 <"+(+i+1)+".0.0":a?(Nr("replaceCaret pr",a),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+"-"+a+" <"+(+i+1)+".0.0"):(Nr("no pr"),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+" <"+(+i+1)+".0.0"),Nr("caret return",l),l})}function Rge(r,e){return Nr("replaceXRanges",r,e),r.split(/\s+/).map(function(t){return Age(t,e)}).join(" ")}function Age(r,e){r=r.trim();var t=e.loose?$r[DG]:$r[xG];return r.replace(t,function(n,i,o,s,a,l){Nr("xRange",r,n,i,o,s,a,l);var c=Ko(o),u=c||Ko(s),p=u||Ko(a),f=p;return i==="="&&f&&(i=""),c?i===">"||i==="<"?n="<0.0.0":n="*":i&&f?(u&&(s=0),a=0,i===">"?(i=">=",u?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",u?o=+o+1:s=+s+1),n=i+o+"."+s+"."+a):u?n=">="+o+".0.0 <"+(+o+1)+".0.0":p&&(n=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0"),Nr("xRange return",n),n})}function Mge(r,e){return Nr("replaceStars",r,e),r.trim().replace($r[OG],"")}function Oge(r,e,t,n,i,o,s,a,l,c,u,p,f){return Ko(t)?e="":Ko(n)?e=">="+t+".0.0":Ko(i)?e=">="+t+"."+n+".0":e=">="+e,Ko(l)?a="":Ko(c)?a="<"+(+l+1)+".0.0":Ko(u)?a="<"+l+"."+(+c+1)+".0":p?a="<="+l+"."+c+"."+u+"-"+p:a="<="+a,(e+" "+a).trim()}yn.prototype.test=function(r){if(!r)return!1;typeof r=="string"&&(r=new ir(r,this.options));for(var e=0;e<this.set.length;e++)if(Lge(this.set[e],r,this.options))return!0;return!1};function Lge(r,e,t){for(var n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(n=0;n<r.length;n++)if(Nr(r[n].semver),r[n].semver!==vx&&r[n].semver.prerelease.length>0){var i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}yt.satisfies=N0;function N0(r,e,t){try{e=new yn(e,t)}catch(n){return!1}return e.test(r)}yt.maxSatisfying=Kge;function Kge(r,e,t){var n=null,i=null;try{var o=new yn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new ir(n,t))}),n}yt.minSatisfying=Fge;function Fge(r,e,t){var n=null,i=null;try{var o=new yn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new ir(n,t))}),n}yt.minVersion=Uge;function Uge(r,e){r=new yn(r,e);var t=new ir("0.0.0");if(r.test(t)||(t=new ir("0.0.0-0"),r.test(t)))return t;t=null;for(var n=0;n<r.set.length;++n){var i=r.set[n];i.forEach(function(o){var s=new ir(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!t||hx(t,s))&&(t=s);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+o.operator)}})}return t&&r.test(t)?t:null}yt.validRange=Wge;function Wge(r,e){try{return new yn(r,e).range||"*"}catch(t){return null}}yt.ltr=Vge;function Vge(r,e,t){return SW(r,e,"<",t)}yt.gtr=jge;function jge(r,e,t){return SW(r,e,">",t)}yt.outside=SW;function SW(r,e,t,n){r=new ir(r,n),e=new yn(e,n);var i,o,s,a,l;switch(t){case">":i=hx,o=IW,s=T0,a=">",l=">=";break;case"<":i=T0,o=bW,s=hx,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(N0(r,e,n))return!1;for(var c=0;c<e.set.length;++c){var u=e.set[c],p=null,f=null;if(u.forEach(function(m){m.semver===vx&&(m=new Aa(">=0.0.0")),p=p||m,f=f||m,i(m.semver,p.semver,n)?p=m:s(m.semver,f.semver,n)&&(f=m)}),p.operator===a||p.operator===l||(!f.operator||f.operator===a)&&o(r,f.semver))return!1;if(f.operator===l&&s(r,f.semver))return!1}return!0}yt.prerelease=Bge;function Bge(r,e){var t=Ag(r,e);return t&&t.prerelease.length?t.prerelease:null}yt.intersects=Hge;function Hge(r,e,t){return r=new yn(r,t),e=new yn(e,t),r.intersects(e)}yt.coerce=Jge;function Jge(r){if(r instanceof ir)return r;if(typeof r!="string")return null;var e=r.match($r[PG]);return e==null?null:Ag(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var Fg=Q(($0,iY)=>{d();(function(r,e){typeof $0=="object"&&typeof iY!="undefined"?e($0):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})($0,function(r){"use strict";r.ArrayExt=void 0,function(k){function W(G,ae,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ie=G.length;if(ie===0)return-1;K<0?K=Math.max(0,K+ie):K=Math.min(K,ie-1),U<0?U=Math.max(0,U+ie):U=Math.min(U,ie-1);var Oe;U<K?Oe=U+1+(ie-K):Oe=U-K+1;for(var Ue=0;Ue<Oe;++Ue){var Wt=(K+Ue)%ie;if(G[Wt]===ae)return Wt}return-1}k.firstIndexOf=W;function me(G,ae,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ie=G.length;if(ie===0)return-1;K<0?K=Math.max(0,K+ie):K=Math.min(K,ie-1),U<0?U=Math.max(0,U+ie):U=Math.min(U,ie-1);var Oe;K<U?Oe=K+1+(ie-U):Oe=K-U+1;for(var Ue=0;Ue<Oe;++Ue){var Wt=(K-Ue+ie)%ie;if(G[Wt]===ae)return Wt}return-1}k.lastIndexOf=me;function we(G,ae,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ie=G.length;if(ie===0)return-1;K<0?K=Math.max(0,K+ie):K=Math.min(K,ie-1),U<0?U=Math.max(0,U+ie):U=Math.min(U,ie-1);var Oe;U<K?Oe=U+1+(ie-K):Oe=U-K+1;for(var Ue=0;Ue<Oe;++Ue){var Wt=(K+Ue)%ie;if(ae(G[Wt],Wt))return Wt}return-1}k.findFirstIndex=we;function Fe(G,ae,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ie=G.length;if(ie===0)return-1;K<0?K=Math.max(0,K+ie):K=Math.min(K,ie-1),U<0?U=Math.max(0,U+ie):U=Math.min(U,ie-1);var Oe;K<U?Oe=K+1+(ie-U):Oe=K-U+1;for(var Ue=0;Ue<Oe;++Ue){var Wt=(K-Ue+ie)%ie;if(ae(G[Wt],Wt))return Wt}return-1}k.findLastIndex=Fe;function Xt(G,ae,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ie=we(G,ae,K,U);return ie!==-1?G[ie]:void 0}k.findFirstValue=Xt;function et(G,ae,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ie=Fe(G,ae,K,U);return ie!==-1?G[ie]:void 0}k.findLastValue=et;function Et(G,ae,K,U,ie){U===void 0&&(U=0),ie===void 0&&(ie=-1);var Oe=G.length;if(Oe===0)return 0;U<0?U=Math.max(0,U+Oe):U=Math.min(U,Oe-1),ie<0?ie=Math.max(0,ie+Oe):ie=Math.min(ie,Oe-1);for(var Ue=U,Wt=ie-U+1;Wt>0;){var hi=Wt>>1,Bu=Ue+hi;K(G[Bu],ae)<0?(Ue=Bu+1,Wt-=hi+1):Wt=hi}return Ue}k.lowerBound=Et;function rr(G,ae,K,U,ie){U===void 0&&(U=0),ie===void 0&&(ie=-1);var Oe=G.length;if(Oe===0)return 0;U<0?U=Math.max(0,U+Oe):U=Math.min(U,Oe-1),ie<0?ie=Math.max(0,ie+Oe):ie=Math.min(ie,Oe-1);for(var Ue=U,Wt=ie-U+1;Wt>0;){var hi=Wt>>1,Bu=Ue+hi;K(G[Bu],ae)>0?Wt=hi:(Ue=Bu+1,Wt-=hi+1)}return Ue}k.upperBound=rr;function Ut(G,ae,K){if(G===ae)return!0;if(G.length!==ae.length)return!1;for(var U=0,ie=G.length;U<ie;++U)if(K?!K(G[U],ae[U]):G[U]!==ae[U])return!1;return!0}k.shallowEqual=Ut;function Ar(G,ae){ae===void 0&&(ae={});var K=ae.start,U=ae.stop,ie=ae.step;if(ie===void 0&&(ie=1),ie===0)throw new Error("Slice `step` cannot be zero.");var Oe=G.length;K===void 0?K=ie<0?Oe-1:0:K<0?K=Math.max(K+Oe,ie<0?-1:0):K>=Oe&&(K=ie<0?Oe-1:Oe),U===void 0?U=ie<0?-1:Oe:U<0?U=Math.max(U+Oe,ie<0?-1:0):U>=Oe&&(U=ie<0?Oe-1:Oe);var Ue;ie<0&&U>=K||ie>0&&K>=U?Ue=0:ie<0?Ue=Math.floor((U-K+1)/ie+1):Ue=Math.floor((U-K-1)/ie+1);for(var Wt=[],hi=0;hi<Ue;++hi)Wt[hi]=G[K+hi*ie];return Wt}k.slice=Ar;function F(G,ae,K){var U=G.length;if(!(U<=1)&&(ae<0?ae=Math.max(0,ae+U):ae=Math.min(ae,U-1),K<0?K=Math.max(0,K+U):K=Math.min(K,U-1),ae!==K)){for(var ie=G[ae],Oe=ae<K?1:-1,Ue=ae;Ue!==K;Ue+=Oe)G[Ue]=G[Ue+Oe];G[K]=ie}}k.move=F;function pe(G,ae,K){ae===void 0&&(ae=0),K===void 0&&(K=-1);var U=G.length;if(!(U<=1))for(ae<0?ae=Math.max(0,ae+U):ae=Math.min(ae,U-1),K<0?K=Math.max(0,K+U):K=Math.min(K,U-1);ae<K;){var ie=G[ae],Oe=G[K];G[ae++]=Oe,G[K--]=ie}}k.reverse=pe;function T(G,ae,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ie=G.length;if(!(ie<=1)&&(K<0?K=Math.max(0,K+ie):K=Math.min(K,ie-1),U<0?U=Math.max(0,U+ie):U=Math.min(U,ie-1),!(K>=U))){var Oe=U-K+1;if(ae>0?ae=ae%Oe:ae<0&&(ae=(ae%Oe+Oe)%Oe),ae!==0){var Ue=K+ae;pe(G,K,Ue-1),pe(G,Ue,U),pe(G,K,U)}}}k.rotate=T;function M(G,ae,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ie=G.length;if(ie!==0){K<0?K=Math.max(0,K+ie):K=Math.min(K,ie-1),U<0?U=Math.max(0,U+ie):U=Math.min(U,ie-1);var Oe;U<K?Oe=U+1+(ie-K):Oe=U-K+1;for(var Ue=0;Ue<Oe;++Ue)G[(K+Ue)%ie]=ae}}k.fill=M;function Z(G,ae,K){var U=G.length;ae<0?ae=Math.max(0,ae+U):ae=Math.min(ae,U);for(var ie=U;ie>ae;--ie)G[ie]=G[ie-1];G[ae]=K}k.insert=Z;function de(G,ae){var K=G.length;if(ae<0&&(ae+=K),!(ae<0||ae>=K)){for(var U=G[ae],ie=ae+1;ie<K;++ie)G[ie-1]=G[ie];return G.length=K-1,U}}k.removeAt=de;function be(G,ae,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ie=W(G,ae,K,U);return ie!==-1&&de(G,ie),ie}k.removeFirstOf=be;function V(G,ae,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ie=me(G,ae,K,U);return ie!==-1&&de(G,ie),ie}k.removeLastOf=V;function Y(G,ae,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ie=G.length;if(ie===0)return 0;K<0?K=Math.max(0,K+ie):K=Math.min(K,ie-1),U<0?U=Math.max(0,U+ie):U=Math.min(U,ie-1);for(var Oe=0,Ue=0;Ue<ie;++Ue)K<=U&&Ue>=K&&Ue<=U&&G[Ue]===ae||U<K&&(Ue<=U||Ue>=K)&&G[Ue]===ae?Oe++:Oe>0&&(G[Ue-Oe]=G[Ue]);return Oe>0&&(G.length=ie-Oe),Oe}k.removeAllOf=Y;function $(G,ae,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ie,Oe=we(G,ae,K,U);return Oe!==-1&&(ie=de(G,Oe)),{index:Oe,value:ie}}k.removeFirstWhere=$;function se(G,ae,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ie,Oe=Fe(G,ae,K,U);return Oe!==-1&&(ie=de(G,Oe)),{index:Oe,value:ie}}k.removeLastWhere=se;function Ee(G,ae,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ie=G.length;if(ie===0)return 0;K<0?K=Math.max(0,K+ie):K=Math.min(K,ie-1),U<0?U=Math.max(0,U+ie):U=Math.min(U,ie-1);for(var Oe=0,Ue=0;Ue<ie;++Ue)K<=U&&Ue>=K&&Ue<=U&&ae(G[Ue],Ue)||U<K&&(Ue<=U||Ue>=K)&&ae(G[Ue],Ue)?Oe++:Oe>0&&(G[Ue-Oe]=G[Ue]);return Oe>0&&(G.length=ie-Oe),Oe}k.removeAllWhere=Ee}(r.ArrayExt||(r.ArrayExt={}));function e(k){var W;return typeof k.iter=="function"?W=k.iter():W=new p(k),W}function t(k){return new f(k)}function n(k){return new m(k)}function i(k){return new h(k)}function o(k){return new g(k)}function s(k,W){for(var me=0,we=e(k),Fe;(Fe=we.next())!==void 0;)if(W(Fe,me++)===!1)return}function a(k,W){for(var me=0,we=e(k),Fe;(Fe=we.next())!==void 0;)if(!W(Fe,me++))return!1;return!0}function l(k,W){for(var me=0,we=e(k),Fe;(Fe=we.next())!==void 0;)if(W(Fe,me++))return!0;return!1}function c(k){for(var W=0,me=[],we=e(k),Fe;(Fe=we.next())!==void 0;)me[W++]=Fe;return me}function u(k){for(var W=e(k),me,we={};(me=W.next())!==void 0;)we[me[0]]=me[1];return we}var p=function(){function k(W){this._index=0,this._source=W}return k.prototype.iter=function(){return this},k.prototype.clone=function(){var W=new k(this._source);return W._index=this._index,W},k.prototype.next=function(){if(!(this._index>=this._source.length))return this._source[this._index++]},k}(),f=function(){function k(W,me){me===void 0&&(me=Object.keys(W)),this._index=0,this._source=W,this._keys=me}return k.prototype.iter=function(){return this},k.prototype.clone=function(){var W=new k(this._source,this._keys);return W._index=this._index,W},k.prototype.next=function(){if(!(this._index>=this._keys.length)){var W=this._keys[this._index++];return W in this._source?W:this.next()}},k}(),m=function(){function k(W,me){me===void 0&&(me=Object.keys(W)),this._index=0,this._source=W,this._keys=me}return k.prototype.iter=function(){return this},k.prototype.clone=function(){var W=new k(this._source,this._keys);return W._index=this._index,W},k.prototype.next=function(){if(!(this._index>=this._keys.length)){var W=this._keys[this._index++];return W in this._source?this._source[W]:this.next()}},k}(),h=function(){function k(W,me){me===void 0&&(me=Object.keys(W)),this._index=0,this._source=W,this._keys=me}return k.prototype.iter=function(){return this},k.prototype.clone=function(){var W=new k(this._source,this._keys);return W._index=this._index,W},k.prototype.next=function(){if(!(this._index>=this._keys.length)){var W=this._keys[this._index++];return W in this._source?[W,this._source[W]]:this.next()}},k}(),g=function(){function k(W){this._fn=W}return k.prototype.iter=function(){return this},k.prototype.clone=function(){throw new Error("An `FnIterator` cannot be cloned.")},k.prototype.next=function(){return this._fn.call(void 0)},k}();function v(){for(var k=[],W=0;W<arguments.length;W++)k[W]=arguments[W];return new I(e(k.map(e)))}var I=function(){function k(W){this._cloned=!1,this._source=W,this._active=void 0}return k.prototype.iter=function(){return this},k.prototype.clone=function(){var W=new k(this._source.clone());return W._active=this._active&&this._active.clone(),W._cloned=!0,this._cloned=!0,W},k.prototype.next=function(){if(this._active===void 0){var W=this._source.next();if(W===void 0)return;this._active=this._cloned?W.clone():W}var me=this._active.next();return me!==void 0?me:(this._active=void 0,this.next())},k}();function S(){return new x}var x=function(){function k(){}return k.prototype.iter=function(){return this},k.prototype.clone=function(){return new k},k.prototype.next=function(){},k}();function D(k,W){return W===void 0&&(W=0),new A(e(k),W)}var A=function(){function k(W,me){this._source=W,this._index=me}return k.prototype.iter=function(){return this},k.prototype.clone=function(){return new k(this._source.clone(),this._index)},k.prototype.next=function(){var W=this._source.next();if(W!==void 0)return[this._index++,W]},k}();function w(k,W){return new R(e(k),W)}var R=function(){function k(W,me){this._index=0,this._source=W,this._fn=me}return k.prototype.iter=function(){return this},k.prototype.clone=function(){var W=new k(this._source.clone(),this._fn);return W._index=this._index,W},k.prototype.next=function(){for(var W=this._fn,me=this._source,we;(we=me.next())!==void 0;)if(W(we,this._index++))return we},k}();function j(k,W){for(var me=0,we=e(k),Fe;(Fe=we.next())!==void 0;)if(W(Fe,me++))return Fe}function ne(k,W){for(var me=0,we=e(k),Fe;(Fe=we.next())!==void 0;)if(W(Fe,me++))return me-1;return-1}function N(k,W){var me=e(k),we=me.next();if(we!==void 0){for(var Fe=we;(we=me.next())!==void 0;)W(we,Fe)<0&&(Fe=we);return Fe}}function ee(k,W){var me=e(k),we=me.next();if(we!==void 0){for(var Fe=we;(we=me.next())!==void 0;)W(we,Fe)>0&&(Fe=we);return Fe}}function ye(k,W){var me=e(k),we=me.next();if(we!==void 0){for(var Fe=we,Xt=we;(we=me.next())!==void 0;)W(we,Fe)<0?Fe=we:W(we,Xt)>0&&(Xt=we);return[Fe,Xt]}}function Ve(k,W){return new Pe(e(k),W)}var Pe=function(){function k(W,me){this._index=0,this._source=W,this._fn=me}return k.prototype.iter=function(){return this},k.prototype.clone=function(){var W=new k(this._source.clone(),this._fn);return W._index=this._index,W},k.prototype.next=function(){var W=this._source.next();if(W!==void 0)return this._fn.call(void 0,W,this._index++)},k}();function le(k,W,me){return W===void 0?new At(0,k,1):me===void 0?new At(k,W,1):new At(k,W,me)}var At=function(){function k(W,me,we){this._index=0,this._start=W,this._stop=me,this._step=we,this._length=Ye.rangeLength(W,me,we)}return k.prototype.iter=function(){return this},k.prototype.clone=function(){var W=new k(this._start,this._stop,this._step);return W._index=this._index,W},k.prototype.next=function(){if(!(this._index>=this._length))return this._start+this._step*this._index++},k}(),Ye;(function(k){function W(me,we,Fe){return Fe===0?1/0:me>we&&Fe>0||me<we&&Fe<0?0:Math.ceil((we-me)/Fe)}k.rangeLength=W})(Ye||(Ye={}));function Ir(k,W,me){var we=0,Fe=e(k),Xt=Fe.next();if(Xt===void 0&&me===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Xt===void 0)return me;var et=Fe.next();if(et===void 0&&me===void 0)return Xt;if(et===void 0)return W(me,Xt,we++);var Et;me===void 0?Et=W(Xt,et,we++):Et=W(W(me,Xt,we++),et,we++);for(var rr;(rr=Fe.next())!==void 0;)Et=W(Et,rr,we++);return Et}function en(k,W){return new fe(k,W)}function H(k){return new fe(k,1)}var fe=function(){function k(W,me){this._value=W,this._count=me}return k.prototype.iter=function(){return this},k.prototype.clone=function(){return new k(this._value,this._count)},k.prototype.next=function(){if(!(this._count<=0))return this._count--,this._value},k}();function Ae(k){var W;return typeof k.retro=="function"?W=k.retro():W=new _e(k),W}var _e=function(){function k(W){this._source=W,this._index=W.length-1}return k.prototype.iter=function(){return this},k.prototype.clone=function(){var W=new k(this._source);return W._index=this._index,W},k.prototype.next=function(){if(!(this._index<0||this._index>=this._source.length))return this._source[this._index--]},k}();function Te(k){var W=[],me=new Set,we=new Map;return s(k,Fe),we.forEach(function(et,Et){Xt(Et)}),W;function Fe(et){var Et=et[0],rr=et[1],Ut=we.get(rr);Ut?Ut.push(Et):we.set(rr,[Et])}function Xt(et){if(!me.has(et)){me.add(et);var Et=we.get(et);Et&&Et.forEach(Xt),W.push(et)}}}function L(k,W){return new ce(e(k),W)}var ce=function(){function k(W,me){this._source=W,this._step=me}return k.prototype.iter=function(){return this},k.prototype.clone=function(){return new k(this._source.clone(),this._step)},k.prototype.next=function(){for(var W=this._source.next(),me=this._step-1;me>0;--me)this._source.next();return W},k}();r.StringExt=void 0,function(k){function W(et,Et,rr){rr===void 0&&(rr=0);for(var Ut=new Array(Et.length),Ar=0,F=rr,pe=Et.length;Ar<pe;++Ar,++F){if(F=et.indexOf(Et[Ar],F),F===-1)return null;Ut[Ar]=F}return Ut}k.findIndices=W;function me(et,Et,rr){rr===void 0&&(rr=0);var Ut=W(et,Et,rr);if(!Ut)return null;for(var Ar=0,F=0,pe=Ut.length;F<pe;++F){var T=Ut[F]-rr;Ar+=T*T}return{score:Ar,indices:Ut}}k.matchSumOfSquares=me;function we(et,Et,rr){rr===void 0&&(rr=0);var Ut=W(et,Et,rr);if(!Ut)return null;for(var Ar=0,F=rr-1,pe=0,T=Ut.length;pe<T;++pe){var M=Ut[pe];Ar+=M-F-1,F=M}return{score:Ar,indices:Ut}}k.matchSumOfDeltas=we;function Fe(et,Et,rr){for(var Ut=[],Ar=0,F=0,pe=Et.length;Ar<pe;){for(var T=Et[Ar],M=Et[Ar];++Ar<pe&&Et[Ar]===M+1;)M++;F<T&&Ut.push(et.slice(F,T)),T<M+1&&Ut.push(rr(et.slice(T,M+1))),F=M+1}return F<et.length&&Ut.push(et.slice(F)),Ut}k.highlight=Fe;function Xt(et,Et){return et<Et?-1:et>Et?1:0}k.cmp=Xt}(r.StringExt||(r.StringExt={}));function ve(k,W){return new ke(e(k),W)}var ke=function(){function k(W,me){this._source=W,this._count=me}return k.prototype.iter=function(){return this},k.prototype.clone=function(){return new k(this._source.clone(),this._count)},k.prototype.next=function(){if(!(this._count<=0)){var W=this._source.next();if(W!==void 0)return this._count--,W}},k}();function We(){for(var k=[],W=0;W<arguments.length;W++)k[W]=arguments[W];return new it(k.map(e))}var it=function(){function k(W){this._source=W}return k.prototype.iter=function(){return this},k.prototype.clone=function(){return new k(this._source.map(function(W){return W.clone()}))},k.prototype.next=function(){for(var W=new Array(this._source.length),me=0,we=this._source.length;me<we;++me){var Fe=this._source[me].next();if(Fe===void 0)return;W[me]=Fe}return W},k}();r.ArrayIterator=p,r.ChainIterator=I,r.EmptyIterator=x,r.EnumerateIterator=A,r.FilterIterator=R,r.FnIterator=g,r.ItemIterator=h,r.KeyIterator=f,r.MapIterator=Pe,r.RangeIterator=At,r.RepeatIterator=fe,r.RetroArrayIterator=_e,r.StrideIterator=ce,r.TakeIterator=ke,r.ValueIterator=m,r.ZipIterator=it,r.chain=v,r.each=s,r.empty=S,r.enumerate=D,r.every=a,r.filter=w,r.find=j,r.findIndex=ne,r.iter=e,r.iterFn=o,r.iterItems=i,r.iterKeys=t,r.iterValues=n,r.map=Ve,r.max=ee,r.min=N,r.minmax=ye,r.once=H,r.range=le,r.reduce=Ir,r.repeat=en,r.retro=Ae,r.some=l,r.stride=L,r.take=ve,r.toArray=c,r.toObject=u,r.topologicSort=Te,r.zip=We,Object.defineProperty(r,"__esModule",{value:!0})})});var DW=Q((z0,oY)=>{d();(function(r,e){typeof z0=="object"&&typeof oY!="undefined"?e(z0):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_properties={}))})(z0,function(r){"use strict";r.AttachedProperty=function(){function t(n){this._pid=e.nextPID(),this.name=n.name,this._create=n.create,this._coerce=n.coerce||null,this._compare=n.compare||null,this._changed=n.changed||null}return t.prototype.get=function(n){var i,o=e.ensureMap(n);return this._pid in o?i=o[this._pid]:i=o[this._pid]=this._createValue(n),i},t.prototype.set=function(n,i){var o,s=e.ensureMap(n);this._pid in s?o=s[this._pid]:o=s[this._pid]=this._createValue(n);var a=this._coerceValue(n,i);this._maybeNotify(n,o,s[this._pid]=a)},t.prototype.coerce=function(n){var i,o=e.ensureMap(n);this._pid in o?i=o[this._pid]:i=o[this._pid]=this._createValue(n);var s=this._coerceValue(n,i);this._maybeNotify(n,i,o[this._pid]=s)},t.prototype._createValue=function(n){var i=this._create;return i(n)},t.prototype._coerceValue=function(n,i){var o=this._coerce;return o?o(n,i):i},t.prototype._compareValue=function(n,i){var o=this._compare;return o?o(n,i):n===i},t.prototype._maybeNotify=function(n,i,o){var s=this._changed;s&&!this._compareValue(i,o)&&s(n,i,o)},t}(),function(t){function n(i){e.ownerData.delete(i)}t.clearData=n}(r.AttachedProperty||(r.AttachedProperty={}));var e;(function(t){t.ownerData=new WeakMap,t.nextPID=function(){var i=0;return function(){var o=Math.random(),s=(""+o).slice(2);return"pid-"+s+"-"+i++}}();function n(i){var o=t.ownerData.get(i);return o||(o=Object.create(null),t.ownerData.set(i,o),o)}t.ensureMap=n})(e||(e={})),Object.defineProperty(r,"__esModule",{value:!0})})});var Vi=Q((Q0,sY)=>{d();(function(r,e){typeof Q0=="object"&&typeof sY!="undefined"?e(Q0,Fg(),DW()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/properties"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_properties))})(Q0,function(r,e,t){"use strict";r.Signal=function(){function i(o){this._blockedCount=0,this.sender=o}return i.prototype.block=function(o){this._blockedCount++;try{o()}finally{this._blockedCount--}},i.prototype.connect=function(o,s){return n.connect(this,o,s)},i.prototype.disconnect=function(o,s){return n.disconnect(this,o,s)},i.prototype.emit=function(o){this._blockedCount||n.emit(this,o)},i}(),function(i){function o(m,h){var g=n.blockedProperty;g.set(m,g.get(m)+1);try{h()}finally{g.set(m,g.get(m)-1)}}i.blockAll=o;function s(m,h){n.disconnectBetween(m,h)}i.disconnectBetween=s;function a(m){n.disconnectSender(m)}i.disconnectSender=a;function l(m){n.disconnectReceiver(m)}i.disconnectReceiver=l;function c(m){n.disconnectAll(m)}i.disconnectAll=c;function u(m){n.disconnectAll(m)}i.clearData=u;function p(){return n.exceptionHandler}i.getExceptionHandler=p;function f(m){var h=n.exceptionHandler;return n.exceptionHandler=m,h}i.setExceptionHandler=f}(r.Signal||(r.Signal={}));var n;(function(i){i.exceptionHandler=function(w){console.error(w)};function o(w,R,j){j=j||void 0;var ne=f.get(w.sender);if(ne||(ne=[],f.set(w.sender,ne)),v(ne,w,R,j))return!1;var N=j||R,ee=m.get(N);ee||(ee=[],m.set(N,ee));var ye={signal:w,slot:R,thisArg:j};return ne.push(ye),ee.push(ye),!0}i.connect=o;function s(w,R,j){j=j||void 0;var ne=f.get(w.sender);if(!ne||ne.length===0)return!1;var N=v(ne,w,R,j);if(!N)return!1;var ee=j||R,ye=m.get(ee);return N.signal=null,S(ne),S(ye),!0}i.disconnect=s;function a(w,R){var j=f.get(w);if(!(!j||j.length===0)){var ne=m.get(R);!ne||ne.length===0||(e.each(ne,function(N){N.signal&&N.signal.sender===w&&(N.signal=null)}),S(j),S(ne))}}i.disconnectBetween=a;function l(w){var R=f.get(w);!R||R.length===0||(e.each(R,function(j){if(j.signal){var ne=j.thisArg||j.slot;j.signal=null,S(m.get(ne))}}),S(R))}i.disconnectSender=l;function c(w){var R=m.get(w);!R||R.length===0||(e.each(R,function(j){if(j.signal){var ne=j.signal.sender;j.signal=null,S(f.get(ne))}}),S(R))}i.disconnectReceiver=c;function u(w){l(w),c(w)}i.disconnectAll=u;function p(w,R){if(!(i.blockedProperty.get(w.sender)>0)){var j=f.get(w.sender);if(!(!j||j.length===0))for(var ne=0,N=j.length;ne<N;++ne){var ee=j[ne];ee.signal===w&&I(ee,R)}}}i.emit=p;var f=new WeakMap,m=new WeakMap,h=new Set,g=function(){var w=typeof requestAnimationFrame=="function";return w?requestAnimationFrame:setImmediate}();function v(w,R,j,ne){return e.find(w,function(N){return N.signal===R&&N.slot===j&&N.thisArg===ne})}function I(w,R){var j=w.signal,ne=w.slot,N=w.thisArg;try{ne.call(N,j.sender,R)}catch(ee){i.exceptionHandler(ee)}}function S(w){h.size===0&&g(x),h.add(w)}function x(){h.forEach(D),h.clear()}function D(w){e.ArrayExt.removeAllWhere(w,A)}function A(w){return w.signal===null}i.blockedProperty=new t.AttachedProperty({name:"blocked",create:function(){return 0}})})(n||(n={})),Object.defineProperty(r,"__esModule",{value:!0})})});var lY=Q(X0=>{"use strict";d();Object.defineProperty(X0,"__esModule",{value:!0});X0.ActivityMonitor=void 0;var aY=Vi(),PW=class{constructor(e){this._timer=-1,this._timeout=-1,this._isDisposed=!1,this._activityStopped=new aY.Signal(this),e.signal.connect(this._onSignalFired,this),this._timeout=e.timeout||1e3}get activityStopped(){return this._activityStopped}get timeout(){return this._timeout}set timeout(e){this._timeout=e}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,aY.Signal.clearData(this))}_onSignalFired(e,t){clearTimeout(this._timer),this._sender=e,this._args=t,this._timer=setTimeout(()=>{this._activityStopped.emit({sender:this._sender,args:this._args})},this._timeout)}};X0.ActivityMonitor=PW});var uY=Q(cY=>{"use strict";d();Object.defineProperty(cY,"__esModule",{value:!0})});var dY=Q(Sx=>{"use strict";d();Object.defineProperty(Sx,"__esModule",{value:!0});Sx.MarkdownCodeBlocks=void 0;var ove;(function(r){r.CODE_BLOCK_MARKER="```";let e=[".markdown",".mdown",".mkdn",".md",".mkd",".mdwn",".mdtxt",".mdtext",".text",".txt",".Rmd"];class t{constructor(s){this.startLine=s,this.code="",this.endLine=-1}}r.MarkdownCodeBlock=t;function n(o){return e.indexOf(o)>-1}r.isMarkdown=n;function i(o){if(!o||o==="")return[];let s=o.split(`
`),a=[],l=null;for(let c=0;c<s.length;c++){let u=s[c],p=u.indexOf(r.CODE_BLOCK_MARKER)===0,f=l!=null;if(!(!p&&!f))if(f)l&&(p?(l.endLine=c-1,a.push(l),l=null):l.code+=u+`
`);else{l=new t(c);let m=u.indexOf(r.CODE_BLOCK_MARKER),h=u.lastIndexOf(r.CODE_BLOCK_MARKER);m!==h&&(l.code=u.substring(m+r.CODE_BLOCK_MARKER.length,h),l.endLine=c,a.push(l),l=null)}}return a}r.findMarkdownCodeBlocks=i})(ove=Sx.MarkdownCodeBlocks||(Sx.MarkdownCodeBlocks={}))});var Ql=Q((Z0,pY)=>{d();(function(r,e){typeof Z0=="object"&&typeof pY!="undefined"?e(Z0):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={}))})(Z0,function(r){"use strict";r.JSONExt=void 0,function(s){s.emptyObject=Object.freeze({}),s.emptyArray=Object.freeze([]);function a(v){return v===null||typeof v=="boolean"||typeof v=="number"||typeof v=="string"}s.isPrimitive=a;function l(v){return Array.isArray(v)}s.isArray=l;function c(v){return!a(v)&&!l(v)}s.isObject=c;function u(v,I){if(v===I)return!0;if(a(v)||a(I))return!1;var S=l(v),x=l(I);return S!==x?!1:S&&x?f(v,I):m(v,I)}s.deepEqual=u;function p(v){return a(v)?v:l(v)?h(v):g(v)}s.deepCopy=p;function f(v,I){if(v===I)return!0;if(v.length!==I.length)return!1;for(var S=0,x=v.length;S<x;++S)if(!u(v[S],I[S]))return!1;return!0}function m(v,I){if(v===I)return!0;for(var S in v)if(v[S]!==void 0&&!(S in I))return!1;for(var S in I)if(I[S]!==void 0&&!(S in v))return!1;for(var S in v){var x=v[S],D=I[S];if(!(x===void 0&&D===void 0)&&(x===void 0||D===void 0||!u(x,D)))return!1}return!0}function h(v){for(var I=new Array(v.length),S=0,x=v.length;S<x;++S)I[S]=p(v[S]);return I}function g(v){var I={};for(var S in v){var x=v[S];x!==void 0&&(I[S]=p(x))}return I}}(r.JSONExt||(r.JSONExt={}));var e=function(){function s(){this._types=[],this._values=[]}return s.prototype.types=function(){return this._types.slice()},s.prototype.hasData=function(a){return this._types.indexOf(a)!==-1},s.prototype.getData=function(a){var l=this._types.indexOf(a);return l!==-1?this._values[l]:void 0},s.prototype.setData=function(a,l){this.clearData(a),this._types.push(a),this._values.push(l)},s.prototype.clearData=function(a){var l=this._types.indexOf(a);l!==-1&&(this._types.splice(l,1),this._values.splice(l,1))},s.prototype.clear=function(){this._types.length=0,this._values.length=0},s}(),t=function(){function s(){var a=this;this.promise=new Promise(function(l,c){a._resolve=l,a._reject=c})}return s.prototype.resolve=function(a){var l=this._resolve;l(a)},s.prototype.reject=function(a){var l=this._reject;l(a)},s}(),n=function(){function s(a){this.name=a,this._tokenStructuralPropertyT=null}return s}();function i(s){for(var a=0,l=0,c=s.length;l<c;++l)l%4===0&&(a=Math.random()*4294967295>>>0),s[l]=a&255,a>>>=8}r.Random=void 0,function(s){s.getRandomValues=function(){var a=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return a&&typeof a.getRandomValues=="function"?function(c){return a.getRandomValues(c)}:i}()}(r.Random||(r.Random={}));function o(s){for(var a=new Uint8Array(16),l=new Array(256),c=0;c<16;++c)l[c]="0"+c.toString(16);for(var c=16;c<256;++c)l[c]=c.toString(16);return function(){return s(a),a[6]=64|a[6]&15,a[8]=128|a[8]&63,l[a[0]]+l[a[1]]+l[a[2]]+l[a[3]]+"-"+l[a[4]]+l[a[5]]+"-"+l[a[6]]+l[a[7]]+"-"+l[a[8]]+l[a[9]]+"-"+l[a[10]]+l[a[11]]+l[a[12]]+l[a[13]]+l[a[14]]+l[a[15]]}}r.UUID=void 0,function(s){s.uuid4=o(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=e,r.PromiseDelegate=t,r.Token=n,Object.defineProperty(r,"__esModule",{value:!0})})});var gY=Q((HJe,hY)=>{"use strict";d();function sve(r,e){var t=r;e.slice(0,-1).forEach(function(i){t=t[i]||{}});var n=e[e.length-1];return n in t}function fY(r){return typeof r=="number"||/^0x[0-9a-f]+$/i.test(r)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(r)}function mY(r,e){return e==="constructor"&&typeof r[e]=="function"||e==="__proto__"}hY.exports=function(r,e){e||(e={});var t={bools:{},strings:{},unknownFn:null};typeof e.unknown=="function"&&(t.unknownFn=e.unknown),typeof e.boolean=="boolean"&&e.boolean?t.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(D){t.bools[D]=!0});var n={};function i(D){return n[D].some(function(A){return t.bools[A]})}Object.keys(e.alias||{}).forEach(function(D){n[D]=[].concat(e.alias[D]),n[D].forEach(function(A){n[A]=[D].concat(n[D].filter(function(w){return A!==w}))})}),[].concat(e.string).filter(Boolean).forEach(function(D){t.strings[D]=!0,n[D]&&[].concat(n[D]).forEach(function(A){t.strings[A]=!0})});var o=e.default||{},s={_:[]};function a(D,A){return t.allBools&&/^--[^=]+$/.test(A)||t.strings[D]||t.bools[D]||n[D]}function l(D,A,w){for(var R=D,j=0;j<A.length-1;j++){var ne=A[j];if(mY(R,ne))return;R[ne]===void 0&&(R[ne]={}),(R[ne]===Object.prototype||R[ne]===Number.prototype||R[ne]===String.prototype)&&(R[ne]={}),R[ne]===Array.prototype&&(R[ne]=[]),R=R[ne]}var N=A[A.length-1];mY(R,N)||((R===Object.prototype||R===Number.prototype||R===String.prototype)&&(R={}),R===Array.prototype&&(R=[]),R[N]===void 0||t.bools[N]||typeof R[N]=="boolean"?R[N]=w:Array.isArray(R[N])?R[N].push(w):R[N]=[R[N],w])}function c(D,A,w){if(!(w&&t.unknownFn&&!a(D,w)&&t.unknownFn(w)===!1)){var R=!t.strings[D]&&fY(A)?Number(A):A;l(s,D.split("."),R),(n[D]||[]).forEach(function(j){l(s,j.split("."),R)})}}Object.keys(t.bools).forEach(function(D){c(D,o[D]===void 0?!1:o[D])});var u=[];r.indexOf("--")!==-1&&(u=r.slice(r.indexOf("--")+1),r=r.slice(0,r.indexOf("--")));for(var p=0;p<r.length;p++){var f=r[p],m,h;if(/^--.+=/.test(f)){var g=f.match(/^--([^=]+)=([\s\S]*)$/);m=g[1];var v=g[2];t.bools[m]&&(v=v!=="false"),c(m,v,f)}else if(/^--no-.+/.test(f))m=f.match(/^--no-(.+)/)[1],c(m,!1,f);else if(/^--.+/.test(f))m=f.match(/^--(.+)/)[1],h=r[p+1],h!==void 0&&!/^(-|--)[^-]/.test(h)&&!t.bools[m]&&!t.allBools&&(!n[m]||!i(m))?(c(m,h,f),p+=1):/^(true|false)$/.test(h)?(c(m,h==="true",f),p+=1):c(m,t.strings[m]?"":!0,f);else if(/^-[^-]+/.test(f)){for(var I=f.slice(1,-1).split(""),S=!1,x=0;x<I.length;x++){if(h=f.slice(x+2),h==="-"){c(I[x],h,f);continue}if(/[A-Za-z]/.test(I[x])&&h[0]==="="){c(I[x],h.slice(1),f),S=!0;break}if(/[A-Za-z]/.test(I[x])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(h)){c(I[x],h,f),S=!0;break}if(I[x+1]&&I[x+1].match(/\W/)){c(I[x],f.slice(x+2),f),S=!0;break}else c(I[x],t.strings[I[x]]?"":!0,f)}m=f.slice(-1)[0],!S&&m!=="-"&&(r[p+1]&&!/^(-|--)[^-]/.test(r[p+1])&&!t.bools[m]&&(!n[m]||!i(m))?(c(m,r[p+1],f),p+=1):r[p+1]&&/^(true|false)$/.test(r[p+1])?(c(m,r[p+1]==="true",f),p+=1):c(m,t.strings[m]?"":!0,f))}else if((!t.unknownFn||t.unknownFn(f)!==!1)&&s._.push(t.strings._||!fY(f)?f:Number(f)),e.stopEarly){s._.push.apply(s._,r.slice(p+1));break}}return Object.keys(o).forEach(function(D){sve(s,D.split("."))||(l(s,D.split("."),o[D]),(n[D]||[]).forEach(function(A){l(s,A.split("."),o[D])}))}),e["--"]?s["--"]=u.slice():u.forEach(function(D){s._.push(D)}),s}});var eR=Q((qJe,yY)=>{"use strict";d();function Xc(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function vY(r,e){for(var t="",n=0,i=-1,o=0,s,a=0;a<=r.length;++a){if(a<r.length)s=r.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(i===a-1||o===1))if(i!==a-1&&o===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",n=0):(t=t.slice(0,l),n=t.length-1-t.lastIndexOf("/")),i=a,o=0;continue}}else if(t.length===2||t.length===1){t="",n=0,i=a,o=0;continue}}e&&(t.length>0?t+="/..":t="..",n=2)}else t.length>0?t+="/"+r.slice(i+1,a):t=r.slice(i+1,a),n=a-i-1;i=a,o=0}else s===46&&o!==-1?++o:o=-1}return t}function ave(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var fI={resolve:function(){for(var e="",t=!1,n,i=arguments.length-1;i>=-1&&!t;i--){var o;i>=0?o=arguments[i]:(n===void 0&&(n=process.cwd()),o=n),Xc(o),o.length!==0&&(e=o+"/"+e,t=o.charCodeAt(0)===47)}return e=vY(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Xc(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=vY(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Xc(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];Xc(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":fI.normalize(e)},relative:function(e,t){if(Xc(e),Xc(t),e===t||(e=fI.resolve(e),t=fI.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,o=i-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,l=a-s,c=o<l?o:l,u=-1,p=0;p<=c;++p){if(p===c){if(l>c){if(t.charCodeAt(s+p)===47)return t.slice(s+p+1);if(p===0)return t.slice(s+p)}else o>c&&(e.charCodeAt(n+p)===47?u=p:p===0&&(u=0));break}var f=e.charCodeAt(n+p),m=t.charCodeAt(s+p);if(f!==m)break;f===47&&(u=p)}var h="";for(p=n+u+1;p<=i;++p)(p===i||e.charCodeAt(p)===47)&&(h.length===0?h+="..":h+="/..");return h.length>0?h+t.slice(s+u):(s+=u,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(Xc(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,i=-1,o=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!o){i=s;break}}else o=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Xc(e);var n=0,i=-1,o=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(s=e.length-1;s>=0;--s){var c=e.charCodeAt(s);if(c===47){if(!o){n=s+1;break}}else l===-1&&(o=!1,l=s+1),a>=0&&(c===t.charCodeAt(a)?--a===-1&&(i=s):(a=-1,i=l))}return n===i?i=l:i===-1&&(i=e.length),e.slice(n,i)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!o){n=s+1;break}}else i===-1&&(o=!1,i=s+1);return i===-1?"":e.slice(n,i)}},extname:function(e){Xc(e);for(var t=-1,n=0,i=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return ave("/",e)},parse:function(e){Xc(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,o;i?(t.root="/",o=1):o=0;for(var s=-1,a=0,l=-1,c=!0,u=e.length-1,p=0;u>=o;--u){if(n=e.charCodeAt(u),n===47){if(!c){a=u+1;break}continue}l===-1&&(c=!1,l=u+1),n===46?s===-1?s=u:p!==1&&(p=1):s!==-1&&(p=-1)}return s===-1||l===-1||p===0||p===1&&s===l-1&&s===a+1?l!==-1&&(a===0&&i?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(a,l)):(a===0&&i?(t.name=e.slice(1,s),t.base=e.slice(1,l)):(t.name=e.slice(a,s),t.base=e.slice(a,l)),t.ext=e.slice(s,l)),a>0?t.dir=e.slice(0,a-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};fI.posix=fI;yY.exports=fI});var IY=Q((YJe,bY)=>{"use strict";d();bY.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var EY=Q(TW=>{"use strict";d();var lve=Object.prototype.hasOwnProperty,cve;function SY(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch(e){return null}}function _Y(r){try{return encodeURIComponent(r)}catch(e){return null}}function uve(r){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},n;n=e.exec(r);){var i=SY(n[1]),o=SY(n[2]);i===null||o===null||i in t||(t[i]=o)}return t}function dve(r,e){e=e||"";var t=[],n,i;typeof e!="string"&&(e="?");for(i in r)if(lve.call(r,i)){if(n=r[i],!n&&(n===null||n===cve||isNaN(n))&&(n=""),i=_Y(i),n=_Y(n),i===null||n===null)continue;t.push(i+"="+n)}return t.length?e+t.join("&"):""}TW.stringify=dve;TW.parse=uve});var RW=Q((XJe,kY)=>{"use strict";d();var wY=IY(),tR=EY(),pve=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,xY=/[\n\r\t]/g,fve=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,DY=/:\d+$/,mve=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,hve=/^[a-zA-Z]:/;function NW(r){return(r||"").toString().replace(pve,"")}var kW=[["#","hash"],["?","query"],function(e,t){return Zc(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],CY={hash:1,query:1};function PY(r){var e;typeof window!="undefined"?e=window:typeof this!="undefined"?e=this:typeof self!="undefined"?e=self:e={};var t=e.location||{};r=r||t;var n={},i=typeof r,o;if(r.protocol==="blob:")n=new eu(unescape(r.pathname),{});else if(i==="string"){n=new eu(r,{});for(o in CY)delete n[o]}else if(i==="object"){for(o in r)o in CY||(n[o]=r[o]);n.slashes===void 0&&(n.slashes=fve.test(r.href))}return n}function Zc(r){return r==="file:"||r==="ftp:"||r==="http:"||r==="https:"||r==="ws:"||r==="wss:"}function TY(r,e){r=NW(r),r=r.replace(xY,""),e=e||{};var t=mve.exec(r),n=t[1]?t[1].toLowerCase():"",i=!!t[2],o=!!t[3],s=0,a;return i?o?(a=t[2]+t[3]+t[4],s=t[2].length+t[3].length):(a=t[2]+t[4],s=t[2].length):o?(a=t[3]+t[4],s=t[3].length):a=t[4],n==="file:"?s>=2&&(a=a.slice(2)):Zc(n)?a=t[4]:n?i&&(a=a.slice(2)):s>=2&&Zc(e.protocol)&&(a=t[4]),{protocol:n,slashes:i||Zc(n),slashesCount:s,rest:a}}function gve(r,e){if(r==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(r.split("/")),n=t.length,i=t[n-1],o=!1,s=0;n--;)t[n]==="."?t.splice(n,1):t[n]===".."?(t.splice(n,1),s++):s&&(n===0&&(o=!0),t.splice(n,1),s--);return o&&t.unshift(""),(i==="."||i==="..")&&t.push(""),t.join("/")}function eu(r,e,t){if(r=NW(r),r=r.replace(xY,""),!(this instanceof eu))return new eu(r,e,t);var n,i,o,s,a,l,c=kW.slice(),u=typeof e,p=this,f=0;for(u!=="object"&&u!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=tR.parse),e=PY(e),i=TY(r||"",e),n=!i.protocol&&!i.slashes,p.slashes=i.slashes||n&&e.slashes,p.protocol=i.protocol||e.protocol||"",r=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||hve.test(r))||!i.slashes&&(i.protocol||i.slashesCount<2||!Zc(p.protocol)))&&(c[3]=[/(.*)/,"pathname"]);f<c.length;f++){if(s=c[f],typeof s=="function"){r=s(r,p);continue}o=s[0],l=s[1],o!==o?p[l]=r:typeof o=="string"?(a=o==="@"?r.lastIndexOf(o):r.indexOf(o),~a&&(typeof s[2]=="number"?(p[l]=r.slice(0,a),r=r.slice(a+s[2])):(p[l]=r.slice(a),r=r.slice(0,a)))):(a=o.exec(r))&&(p[l]=a[1],r=r.slice(0,a.index)),p[l]=p[l]||n&&s[3]&&e[l]||"",s[4]&&(p[l]=p[l].toLowerCase())}t&&(p.query=t(p.query)),n&&e.slashes&&p.pathname.charAt(0)!=="/"&&(p.pathname!==""||e.pathname!=="")&&(p.pathname=gve(p.pathname,e.pathname)),p.pathname.charAt(0)!=="/"&&Zc(p.protocol)&&(p.pathname="/"+p.pathname),wY(p.port,p.protocol)||(p.host=p.hostname,p.port=""),p.username=p.password="",p.auth&&(a=p.auth.indexOf(":"),~a?(p.username=p.auth.slice(0,a),p.username=encodeURIComponent(decodeURIComponent(p.username)),p.password=p.auth.slice(a+1),p.password=encodeURIComponent(decodeURIComponent(p.password))):p.username=encodeURIComponent(decodeURIComponent(p.auth)),p.auth=p.password?p.username+":"+p.password:p.username),p.origin=p.protocol!=="file:"&&Zc(p.protocol)&&p.host?p.protocol+"//"+p.host:"null",p.href=p.toString()}function vve(r,e,t){var n=this;switch(r){case"query":typeof e=="string"&&e.length&&(e=(t||tR.parse)(e)),n[r]=e;break;case"port":n[r]=e,wY(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[r]="");break;case"hostname":n[r]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[r]=e,DY.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!t;break;case"pathname":case"hash":if(e){var i=r==="pathname"?"/":"#";n[r]=e.charAt(0)!==i?i+e:e}else n[r]=e;break;case"username":case"password":n[r]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(n.username=e.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var s=0;s<kW.length;s++){var a=kW[s];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&Zc(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function yve(r){(!r||typeof r!="function")&&(r=tR.stringify);var e,t=this,n=t.host,i=t.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var o=i+(t.protocol&&t.slashes||Zc(t.protocol)?"//":"");return t.username?(o+=t.username,t.password&&(o+=":"+t.password),o+="@"):t.password?(o+=":"+t.password,o+="@"):t.protocol!=="file:"&&Zc(t.protocol)&&!n&&t.pathname!=="/"&&(o+="@"),(n[n.length-1]===":"||DY.test(t.hostname)&&!t.port)&&(n+=":"),o+=n+t.pathname,e=typeof t.query=="object"?r(t.query):t.query,e&&(o+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(o+=t.hash),o}eu.prototype={set:vve,toString:yve};eu.extractProtocol=TY;eu.location=PY;eu.trimLeft=NW;eu.qs=tR;kY.exports=eu});var MW=Q(Ug=>{"use strict";d();var bve=Ug&&Ug.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ug,"__esModule",{value:!0});Ug.URLExt=void 0;var Ive=eR(),AW=bve(RW()),Sve;(function(r){function e(c){if(typeof document!="undefined"&&document){let u=document.createElement("a");return u.href=c,u}return AW.default(c)}r.parse=e;function t(c){return AW.default(c).hostname}r.getHostName=t;function n(c){return c&&e(c).toString()}r.normalize=n;function i(...c){let u=AW.default(c[0],{}),p=`${u.protocol}${u.slashes?"//":""}${u.auth}${u.auth?"@":""}${u.host}`,f=Ive.posix.join(`${p&&u.pathname[0]!=="/"?"/":""}${u.pathname}`,...c.slice(1));return`${p}${f==="."?"":f}`}r.join=i;function o(c){return i(...c.split("/").map(encodeURIComponent))}r.encodeParts=o;function s(c){let u=Object.keys(c).filter(p=>p.length>0);return u.length?"?"+u.map(p=>{let f=encodeURIComponent(String(c[p]));return p+(f?"="+f:"")}).join("&"):""}r.objectToQueryString=s;function a(c){return c.replace(/^\?/,"").split("&").reduce((u,p)=>{let[f,m]=p.split("=");return f.length>0&&(u[f]=decodeURIComponent(m||"")),u},{})}r.queryStringToObject=a;function l(c){let{protocol:u}=e(c);return(!u||c.toLowerCase().indexOf(u)!==0)&&c.indexOf("/")!==0}r.isLocal=l})(Sve=Ug.URLExt||(Ug.URLExt={}))});var NY=Q((exports,module)=>{"use strict";d();var __importDefault=exports&&exports.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(exports,"__esModule",{value:!0});exports.PageConfig=void 0;var coreutils_1=Ql(),minimist_1=__importDefault(gY()),url_1=MW(),PageConfig;(function(PageConfig){function getOption(name){if(configData)return configData[name]||getBodyData(name);configData=Object.create(null);let found=!1;if(typeof document!="undefined"&&document){let r=document.getElementById("jupyter-config-data");r&&(configData=JSON.parse(r.textContent||""),found=!0)}if(!found&&typeof process!="undefined"&&process.argv)try{let cli=minimist_1.default(process.argv.slice(2)),path=eR(),fullPath="";"jupyter-config-data"in cli?fullPath=path.resolve(cli["jupyter-config-data"]):"JUPYTER_CONFIG_DATA"in process.env&&(fullPath=path.resolve(process.env.JUPYTER_CONFIG_DATA)),fullPath&&(configData=eval("require")(fullPath))}catch(r){console.error(r)}if(!coreutils_1.JSONExt.isObject(configData))configData=Object.create(null);else for(let r in configData)typeof configData[r]!="string"&&(configData[r]=JSON.stringify(configData[r]));return configData[name]||getBodyData(name)}PageConfig.getOption=getOption;function setOption(r,e){let t=getOption(r);return configData[r]=e,t}PageConfig.setOption=setOption;function getBaseUrl(){return url_1.URLExt.normalize(getOption("baseUrl")||"/")}PageConfig.getBaseUrl=getBaseUrl;function getTreeUrl(){return url_1.URLExt.join(getBaseUrl(),getOption("treeUrl"))}PageConfig.getTreeUrl=getTreeUrl;function getShareUrl(){return url_1.URLExt.normalize(getOption("shareUrl")||getBaseUrl())}PageConfig.getShareUrl=getShareUrl;function getTreeShareUrl(){return url_1.URLExt.normalize(url_1.URLExt.join(getShareUrl(),getOption("treeUrl")))}PageConfig.getTreeShareUrl=getTreeShareUrl;function getUrl(r){var e,t,n;let i=getOption("baseUrl")||"/",o=(e=r.mode)!==null&&e!==void 0?e:getOption("mode"),s=(t=r.workspace)!==null&&t!==void 0?t:getOption("workspace"),a=o==="multiple-document"?"lab":"doc";i=url_1.URLExt.join(i,a),s!==PageConfig.defaultWorkspace&&(i=url_1.URLExt.join(i,"workspaces",encodeURIComponent(getOption("workspace"))));let l=(n=r.treePath)!==null&&n!==void 0?n:getOption("treePath");return l&&(i=url_1.URLExt.join(i,"tree",url_1.URLExt.encodeParts(l))),i}PageConfig.getUrl=getUrl,PageConfig.defaultWorkspace="default";function getWsUrl(r){let e=getOption("wsUrl");if(!e){if(r=r?url_1.URLExt.normalize(r):getBaseUrl(),r.indexOf("http")!==0)return"";e="ws"+r.slice(4)}return url_1.URLExt.normalize(e)}PageConfig.getWsUrl=getWsUrl;function getNBConvertURL({path:r,format:e,download:t}){let n=url_1.URLExt.encodeParts(r),i=url_1.URLExt.join(getBaseUrl(),"nbconvert",e,n);return t?i+"?download=true":i}PageConfig.getNBConvertURL=getNBConvertURL;function getToken(){return getOption("token")||getBodyData("jupyterApiToken")}PageConfig.getToken=getToken;function getNotebookVersion(){let r=getOption("notebookVersion");return r===""?[0,0,0]:JSON.parse(r)}PageConfig.getNotebookVersion=getNotebookVersion;let configData=null;function getBodyData(r){if(typeof document=="undefined"||!document.body)return"";let e=document.body.dataset[r];return typeof e=="undefined"?"":decodeURIComponent(e)}let Extension;(function(r){function e(i){try{let o=getOption(i);if(o)return JSON.parse(o)}catch(o){console.warn(`Unable to parse ${i}.`,o)}return[]}r.deferred=e("deferredExtensions"),r.disabled=e("disabledExtensions");function t(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.deferred.some(a=>a===i||s&&a===s)}r.isDeferred=t;function n(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.disabled.some(a=>a===i||s&&a===s)}r.isDisabled=n})(Extension=PageConfig.Extension||(PageConfig.Extension={}))})(PageConfig=exports.PageConfig||(exports.PageConfig={}))});var RY=Q(_x=>{"use strict";d();Object.defineProperty(_x,"__esModule",{value:!0});_x.PathExt=void 0;var Wg=eR(),_ve;(function(r){function e(...u){let p=Wg.posix.join(...u);return p==="."?"":c(p)}r.join=e;function t(u,p){return Wg.posix.basename(u,p)}r.basename=t;function n(u){let p=c(Wg.posix.dirname(u));return p==="."?"":p}r.dirname=n;function i(u){return Wg.posix.extname(u)}r.extname=i;function o(u){return u===""?"":c(Wg.posix.normalize(u))}r.normalize=o;function s(...u){return c(Wg.posix.resolve(...u))}r.resolve=s;function a(u,p){return c(Wg.posix.relative(u,p))}r.relative=a;function l(u){return u.length>0&&u.indexOf(".")!==0&&(u=`.${u}`),u}r.normalizeExtension=l;function c(u){return u.indexOf("/")===0&&(u=u.slice(1)),u}r.removeSlash=c})(_ve=_x.PathExt||(_x.PathExt={}))});var AY=Q(Ex=>{"use strict";d();Object.defineProperty(Ex,"__esModule",{value:!0});Ex.Text=void 0;var Eve;(function(r){let e=2>1;function t(s,a){if(e)return s;let l=s;for(let c=0;c+1<a.length&&c<s;c++){let u=a.charCodeAt(c);if(u>=55296&&u<=56319){let p=a.charCodeAt(c+1);p>=56320&&p<=57343&&(l--,c++)}}return l}r.jsIndexToCharIndex=t;function n(s,a){if(e)return s;let l=s;for(let c=0;c+1<a.length&&c<l;c++){let u=a.charCodeAt(c);if(u>=55296&&u<=56319){let p=a.charCodeAt(c+1);p>=56320&&p<=57343&&(l++,c++)}}return l}r.charIndexToJsIndex=n;function i(s,a=!1){return s.replace(/^(\w)|[\s-_:]+(\w)/g,function(l,c,u){return u?u.toUpperCase():a?c.toUpperCase():c.toLowerCase()})}r.camelCase=i;function o(s){return(s||"").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}r.titleCase=o})(Eve=Ex.Text||(Ex.Text={}))});var MY={};Um(MY,{default:()=>Cve});function Cve(r){return{formatNow:()=>{try{return r.toLocaleString()}catch(e){return`${r}`}},format:()=>{try{return r.toLocaleTimeString()}catch(e){return`${r}`}}}}var OY=te(()=>{"use strict";d()});var LY=Q(Vg=>{"use strict";d();var wve=Vg&&Vg.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Vg,"__esModule",{value:!0});Vg.Time=void 0;var OW=wve((OY(),iP(MY))),xve;(function(r){function e(n){OW.default.locale(document.documentElement.lang);let i=OW.default(n).fromNow();return i=i==="a few seconds ago"?"seconds ago":i,i}r.formatHuman=e;function t(n,i="YYYY-MM-DD HH:mm"){return OW.default(n).format(i)}r.format=t})(xve=Vg.Time||(Vg.Time={}))});var hs=Q(ms=>{"use strict";d();var Dve=ms&&ms.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Uf=ms&&ms.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Dve(e,r,t)};Object.defineProperty(ms,"__esModule",{value:!0});Uf(lY(),ms);Uf(uY(),ms);Uf(dY(),ms);Uf(NY(),ms);Uf(RY(),ms);Uf(AY(),ms);Uf(LY(),ms);Uf(MW(),ms)});var KY=Q(jg=>{"use strict";d();Object.defineProperty(jg,"__esModule",{value:!0});jg.ConfigWithDefaults=jg.ConfigSection=void 0;var Pve=hs(),Cx=ci(),Tve="api/config",kve;(function(r){function e(t){let n=new LW(t);return n.load().then(()=>n)}r.create=e})(kve=jg.ConfigSection||(jg.ConfigSection={}));var LW=class{constructor(e){var t;this._url="unknown";let n=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Cx.ServerConnection.makeSettings();this._url=Pve.URLExt.join(n.baseUrl,Tve,encodeURIComponent(e.name))}get data(){return this._data}async load(){let e=await Cx.ServerConnection.makeRequest(this._url,{},this.serverSettings);if(e.status!==200)throw await Cx.ServerConnection.ResponseError.create(e);this._data=await e.json()}async update(e){this._data=Object.assign(Object.assign({},this._data),e);let t={method:"PATCH",body:JSON.stringify(e)},n=await Cx.ServerConnection.makeRequest(this._url,t,this.serverSettings);if(n.status!==200)throw await Cx.ServerConnection.ResponseError.create(n);return this._data=await n.json(),this._data}},KW=class{constructor(e){var t,n;this._className="",this._section=e.section,this._defaults=(t=e.defaults)!==null&&t!==void 0?t:{},this._className=(n=e.className)!==null&&n!==void 0?n:""}get(e){let t=this._classData();return e in t?t[e]:this._defaults[e]}set(e,t){let n={};if(n[e]=t,this._className){let i={};return i[this._className]=n,this._section.update(i)}else return this._section.update(n)}_classData(){let e=this._section.data;return this._className&&this._className in e?e[this._className]:e}};jg.ConfigWithDefaults=KW});var wx=Q(rR=>{"use strict";d();Object.defineProperty(rR,"__esModule",{value:!0});rR.validateProperty=void 0;function Nve(r,e,t,n=[]){if(!r.hasOwnProperty(e))throw Error(`Missing property '${e}'`);let i=r[e];if(t!==void 0){let o=!0;switch(t){case"array":o=Array.isArray(i);break;case"object":o=typeof i!="undefined";break;default:o=typeof i===t}if(!o)throw new Error(`Property '${e}' is not of type '${t}'`);if(n.length>0){let s=!0;switch(t){case"string":case"number":case"boolean":s=n.includes(i);break;default:s=n.findIndex(a=>a===i)>=0;break}if(!s)throw new Error(`Property '${e}' is not one of the valid values ${JSON.stringify(n)}`)}}}rR.validateProperty=Nve});var FY=Q(mI=>{"use strict";d();Object.defineProperty(mI,"__esModule",{value:!0});mI.validateCheckpointModel=mI.validateContentsModel=void 0;var tu=wx();function Rve(r){tu.validateProperty(r,"name","string"),tu.validateProperty(r,"path","string"),tu.validateProperty(r,"type","string"),tu.validateProperty(r,"created","string"),tu.validateProperty(r,"last_modified","string"),tu.validateProperty(r,"mimetype","object"),tu.validateProperty(r,"content","object"),tu.validateProperty(r,"format","object")}mI.validateContentsModel=Rve;function Ave(r){tu.validateProperty(r,"id","string"),tu.validateProperty(r,"last_modified","string")}mI.validateCheckpointModel=Ave});var WW=Q(Fo=>{"use strict";d();var Mve=Fo&&Fo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ove=Fo&&Fo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Lve=Fo&&Fo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Mve(e,r,t);return Ove(e,r),e};Object.defineProperty(Fo,"__esModule",{value:!0});Fo.Drive=Fo.ContentsManager=Fo.Contents=void 0;var Vs=hs(),Kve=Fg(),nR=Vi(),xn=ci(),Vd=Lve(FY()),Fve="api/contents",Uve="files",Wve;(function(r){function e(n){Vd.validateContentsModel(n)}r.validateContentsModel=e;function t(n){Vd.validateCheckpointModel(n)}r.validateCheckpointModel=t})(Wve=Fo.Contents||(Fo.Contents={}));var FW=class{constructor(e={}){var t,n;this._isDisposed=!1,this._additionalDrives=new Map,this._fileChanged=new nR.Signal(this);let i=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:xn.ServerConnection.makeSettings();this._defaultDrive=(n=e.defaultDrive)!==null&&n!==void 0?n:new iR({serverSettings:i}),this._defaultDrive.fileChanged.connect(this._onFileChanged,this)}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,nR.Signal.clearData(this))}addDrive(e){this._additionalDrives.set(e.name,e),e.fileChanged.connect(this._onFileChanged,this)}getModelDBFactory(e){var t;let[n]=this._driveForPath(e);return(t=n==null?void 0:n.modelDBFactory)!==null&&t!==void 0?t:null}localPath(e){let t=e.split("/"),n=t[0].split(":");return n.length===1||!this._additionalDrives.has(n[0])?Vs.PathExt.removeSlash(e):Vs.PathExt.join(n.slice(1).join(":"),...t.slice(1))}normalize(e){let t=e.split(":");return t.length===1?Vs.PathExt.normalize(e):`${t[0]}:${Vs.PathExt.normalize(t.slice(1).join(":"))}`}resolvePath(e,t){let n=this.driveName(e),i=this.localPath(e),o=Vs.PathExt.resolve("/",i,t);return n?`${n}:${o}`:o}driveName(e){let n=e.split("/")[0].split(":");return n.length===1?"":this._additionalDrives.has(n[0])?n[0]:""}get(e,t){let[n,i]=this._driveForPath(e);return n.get(i,t).then(o=>{let s=[];return o.type==="directory"&&o.content?(Kve.each(o.content,a=>{s.push(Object.assign(Object.assign({},a),{path:this._toGlobalPath(n,a.path)}))}),Object.assign(Object.assign({},o),{path:this._toGlobalPath(n,i),content:s})):Object.assign(Object.assign({},o),{path:this._toGlobalPath(n,i)})})}getDownloadUrl(e){let[t,n]=this._driveForPath(e);return t.getDownloadUrl(n)}newUntitled(e={}){if(e.path){let t=this.normalize(e.path),[n,i]=this._driveForPath(t);return n.newUntitled(Object.assign(Object.assign({},e),{path:i})).then(o=>Object.assign(Object.assign({},o),{path:Vs.PathExt.join(t,o.name)}))}else return this._defaultDrive.newUntitled(e)}delete(e){let[t,n]=this._driveForPath(e);return t.delete(n)}rename(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n!==o)throw Error("ContentsManager: renaming files must occur within a Drive");return n.rename(i,s).then(a=>Object.assign(Object.assign({},a),{path:this._toGlobalPath(n,s)}))}save(e,t={}){let n=this.normalize(e),[i,o]=this._driveForPath(e);return i.save(o,Object.assign(Object.assign({},t),{path:o})).then(s=>Object.assign(Object.assign({},s),{path:n}))}copy(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n===o)return n.copy(i,s).then(a=>Object.assign(Object.assign({},a),{path:this._toGlobalPath(n,a.path)}));throw Error("Copying files between drives is not currently implemented")}createCheckpoint(e){let[t,n]=this._driveForPath(e);return t.createCheckpoint(n)}listCheckpoints(e){let[t,n]=this._driveForPath(e);return t.listCheckpoints(n)}restoreCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.restoreCheckpoint(i,t)}deleteCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.deleteCheckpoint(i,t)}_toGlobalPath(e,t){return e===this._defaultDrive?Vs.PathExt.removeSlash(t):`${e.name}:${Vs.PathExt.removeSlash(t)}`}_driveForPath(e){let t=this.driveName(e),n=this.localPath(e);return t?[this._additionalDrives.get(t),n]:[this._defaultDrive,n]}_onFileChanged(e,t){var n,i;if(e===this._defaultDrive)this._fileChanged.emit(t);else{let o=null,s=null;!((n=t.newValue)===null||n===void 0)&&n.path&&(o=Object.assign(Object.assign({},t.newValue),{path:this._toGlobalPath(e,t.newValue.path)})),!((i=t.oldValue)===null||i===void 0)&&i.path&&(s=Object.assign(Object.assign({},t.oldValue),{path:this._toGlobalPath(e,t.oldValue.path)})),this._fileChanged.emit({type:t.type,newValue:o,oldValue:s})}}};Fo.ContentsManager=FW;var iR=class{constructor(e={}){var t,n,i;this._isDisposed=!1,this._fileChanged=new nR.Signal(this),this.name=(t=e.name)!==null&&t!==void 0?t:"Default",this._apiEndpoint=(n=e.apiEndpoint)!==null&&n!==void 0?n:Fve,this.serverSettings=(i=e.serverSettings)!==null&&i!==void 0?i:xn.ServerConnection.makeSettings()}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,nR.Signal.clearData(this))}async get(e,t){let n=this._getUrl(e);if(t){t.type==="notebook"&&delete t.format;let a=t.content?"1":"0",l=Object.assign(Object.assign({},t),{content:a});n+=Vs.URLExt.objectToQueryString(l)}let i=this.serverSettings,o=await xn.ServerConnection.makeRequest(n,{},i);if(o.status!==200)throw await xn.ServerConnection.ResponseError.create(o);let s=await o.json();return Vd.validateContentsModel(s),s}getDownloadUrl(e){let t=this.serverSettings.baseUrl,n=Vs.URLExt.join(t,Uve,Vs.URLExt.encodeParts(e)),i=document.cookie.match("\\b_xsrf=([^;]*)\\b");if(i){let o=new URL(n);o.searchParams.append("_xsrf",i[1]),n=o.toString()}return Promise.resolve(n)}async newUntitled(e={}){var t;let n="{}";e&&(e.ext&&(e.ext=UW.normalizeExtension(e.ext)),n=JSON.stringify(e));let i=this.serverSettings,o=this._getUrl((t=e.path)!==null&&t!==void 0?t:""),s={method:"POST",body:n},a=await xn.ServerConnection.makeRequest(o,s,i);if(a.status!==201)throw await xn.ServerConnection.ResponseError.create(a);let l=await a.json();return Vd.validateContentsModel(l),this._fileChanged.emit({type:"new",oldValue:null,newValue:l}),l}async delete(e){let t=this._getUrl(e),n=this.serverSettings,i={method:"DELETE"},o=await xn.ServerConnection.makeRequest(t,i,n);if(o.status!==204)throw await xn.ServerConnection.ResponseError.create(o);this._fileChanged.emit({type:"delete",oldValue:{path:e},newValue:null})}async rename(e,t){let n=this.serverSettings,i=this._getUrl(e),o={method:"PATCH",body:JSON.stringify({path:t})},s=await xn.ServerConnection.makeRequest(i,o,n);if(s.status!==200)throw await xn.ServerConnection.ResponseError.create(s);let a=await s.json();return Vd.validateContentsModel(a),this._fileChanged.emit({type:"rename",oldValue:{path:e},newValue:a}),a}async save(e,t={}){let n=this.serverSettings,i=this._getUrl(e),o={method:"PUT",body:JSON.stringify(t)},s=await xn.ServerConnection.makeRequest(i,o,n);if(s.status!==200&&s.status!==201)throw await xn.ServerConnection.ResponseError.create(s);let a=await s.json();return Vd.validateContentsModel(a),this._fileChanged.emit({type:"save",oldValue:null,newValue:a}),a}async copy(e,t){let n=this.serverSettings,i=this._getUrl(t),o={method:"POST",body:JSON.stringify({copy_from:e})},s=await xn.ServerConnection.makeRequest(i,o,n);if(s.status!==201)throw await xn.ServerConnection.ResponseError.create(s);let a=await s.json();return Vd.validateContentsModel(a),this._fileChanged.emit({type:"new",oldValue:null,newValue:a}),a}async createCheckpoint(e){let t=this._getUrl(e,"checkpoints"),n={method:"POST"},i=await xn.ServerConnection.makeRequest(t,n,this.serverSettings);if(i.status!==201)throw await xn.ServerConnection.ResponseError.create(i);let o=await i.json();return Vd.validateCheckpointModel(o),o}async listCheckpoints(e){let t=this._getUrl(e,"checkpoints"),n=await xn.ServerConnection.makeRequest(t,{},this.serverSettings);if(n.status!==200)throw await xn.ServerConnection.ResponseError.create(n);let i=await n.json();if(!Array.isArray(i))throw new Error("Invalid Checkpoint list");for(let o=0;o<i.length;o++)Vd.validateCheckpointModel(i[o]);return i}async restoreCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"POST"},o=await xn.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await xn.ServerConnection.ResponseError.create(o)}async deleteCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"DELETE"},o=await xn.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await xn.ServerConnection.ResponseError.create(o)}_getUrl(...e){let t=e.map(i=>Vs.URLExt.encodeParts(i)),n=this.serverSettings.baseUrl;return Vs.URLExt.join(n,this._apiEndpoint,...t)}};Fo.Drive=iR;var UW;(function(r){function e(t){return t.length>0&&t.indexOf(".")!==0&&(t=`.${t}`),t}r.normalizeExtension=e})(UW||(UW={}))});var WY=Q(UY=>{"use strict";d();Object.defineProperty(UY,"__esModule",{value:!0})});var xx=Q(Kt=>{"use strict";d();Object.defineProperty(Kt,"__esModule",{value:!0});Kt.isInputReplyMsg=Kt.isInputRequestMsg=Kt.isDebugReplyMsg=Kt.isDebugRequestMsg=Kt.isExecuteReplyMsg=Kt.isInfoRequestMsg=Kt.isCommMsgMsg=Kt.isCommCloseMsg=Kt.isCommOpenMsg=Kt.isDebugEventMsg=Kt.isClearOutputMsg=Kt.isStatusMsg=Kt.isErrorMsg=Kt.isExecuteResultMsg=Kt.isExecuteInputMsg=Kt.isUpdateDisplayDataMsg=Kt.isDisplayDataMsg=Kt.isStreamMsg=Kt.createMessage=void 0;var Vve=Ql();function jve(r){var e,t,n,i,o;return{buffers:(e=r.buffers)!==null&&e!==void 0?e:[],channel:r.channel,content:r.content,header:{date:new Date().toISOString(),msg_id:(t=r.msgId)!==null&&t!==void 0?t:Vve.UUID.uuid4(),msg_type:r.msgType,session:r.session,username:(n=r.username)!==null&&n!==void 0?n:"",version:"5.2"},metadata:(i=r.metadata)!==null&&i!==void 0?i:{},parent_header:(o=r.parentHeader)!==null&&o!==void 0?o:{}}}Kt.createMessage=jve;function Bve(r){return r.header.msg_type==="stream"}Kt.isStreamMsg=Bve;function Hve(r){return r.header.msg_type==="display_data"}Kt.isDisplayDataMsg=Hve;function Jve(r){return r.header.msg_type==="update_display_data"}Kt.isUpdateDisplayDataMsg=Jve;function qve(r){return r.header.msg_type==="execute_input"}Kt.isExecuteInputMsg=qve;function Gve(r){return r.header.msg_type==="execute_result"}Kt.isExecuteResultMsg=Gve;function Yve(r){return r.header.msg_type==="error"}Kt.isErrorMsg=Yve;function $ve(r){return r.header.msg_type==="status"}Kt.isStatusMsg=$ve;function zve(r){return r.header.msg_type==="clear_output"}Kt.isClearOutputMsg=zve;function Qve(r){return r.header.msg_type==="debug_event"}Kt.isDebugEventMsg=Qve;function Xve(r){return r.header.msg_type==="comm_open"}Kt.isCommOpenMsg=Xve;function Zve(r){return r.header.msg_type==="comm_close"}Kt.isCommCloseMsg=Zve;function eye(r){return r.header.msg_type==="comm_msg"}Kt.isCommMsgMsg=eye;function tye(r){return r.header.msg_type==="kernel_info_request"}Kt.isInfoRequestMsg=tye;function rye(r){return r.header.msg_type==="execute_reply"}Kt.isExecuteReplyMsg=rye;function nye(r){return r.header.msg_type==="debug_request"}Kt.isDebugRequestMsg=nye;function iye(r){return r.header.msg_type==="debug_reply"}Kt.isDebugReplyMsg=iye;function oye(r){return r.header.msg_type==="input_request"}Kt.isInputRequestMsg=oye;function sye(r){return r.header.msg_type==="input_reply"}Kt.isInputReplyMsg=sye});var VY=Q(()=>{d()});var jY=Q(VW=>{"use strict";d();Object.defineProperty(VW,"__esModule",{value:!0});VW.default=WebSocket});var js=Q(Wf=>{"use strict";d();var jW,BW,HW;Object.defineProperty(Wf,"__esModule",{value:!0});Wf.ServerConnection=void 0;var Bg=hs(),JW,qW,GW,YW;if(typeof window=="undefined"){let r=VY();JW=(jW=Wf.fetch)!==null&&jW!==void 0?jW:r,GW=(BW=Wf.Request)!==null&&BW!==void 0?BW:r.Request,qW=(HW=Wf.Headers)!==null&&HW!==void 0?HW:r.Headers,YW=jY()}else JW=fetch,GW=Request,qW=Headers,YW=WebSocket;var BY;(function(r){function e(o){return oR.makeSettings(o)}r.makeSettings=e;function t(o,s,a){return oR.handleRequest(o,s,a)}r.makeRequest=t;class n extends Error{constructor(s,a=`Invalid response: ${s.status} ${s.statusText}`,l=""){super(a),this.response=s,this.traceback=l}static async create(s){try{let a=await s.json();return a.traceback&&console.error(a.traceback),a.message?new n(s,a.message):new n(s)}catch(a){return console.debug(a),new n(s)}}}r.ResponseError=n;class i extends TypeError{constructor(s){super(s.message),this.stack=s.stack}}r.NetworkError=i})(BY=Wf.ServerConnection||(Wf.ServerConnection={}));var oR;(function(r){function e(i={}){let o=Bg.PageConfig.getBaseUrl(),s=Bg.PageConfig.getWsUrl(),a=Bg.URLExt.normalize(i.baseUrl)||o,l=i.wsUrl;return!l&&a===o&&(l=s),!l&&a.indexOf("http")===0&&(l="ws"+a.slice(4)),l=l!=null?l:s,Object.assign(Object.assign({init:{cache:"no-store",credentials:"same-origin"},fetch:JW,Headers:qW,Request:GW,WebSocket:YW,token:Bg.PageConfig.getToken(),appUrl:Bg.PageConfig.getOption("appUrl"),appendToken:typeof window=="undefined"||process.env.JEST_WORKER_ID!==void 0||Bg.URLExt.getHostName(o)!==Bg.URLExt.getHostName(l)},i),{baseUrl:a,wsUrl:l})}r.makeSettings=e;function t(i,o,s){var a;if(i.indexOf(s.baseUrl)!==0)throw new Error("Can only be used for notebook server requests");((a=o.cache)!==null&&a!==void 0?a:s.init.cache)==="no-store"&&(i+=(/\?/.test(i)?"&":"?")+new Date().getTime());let c=new s.Request(i,Object.assign(Object.assign({},s.init),o)),u=!1;if(s.token&&(u=!0,c.headers.append("Authorization",`token ${s.token}`)),typeof document!="undefined"&&(document!=null&&document.cookie)){let p=n("_xsrf");p!==void 0&&(u=!0,c.headers.append("X-XSRFToken",p))}return!c.headers.has("Content-Type")&&u&&c.headers.set("Content-Type","application/json"),s.fetch.call(null,c).catch(p=>{throw new BY.NetworkError(p)})}r.handleRequest=t;function n(i){let o=document.cookie.match("\\b"+i+"=([^;]*)\\b");return o==null?void 0:o[1]}})(oR||(oR={}))});var sR=Q(Vf=>{"use strict";d();Object.defineProperty(Vf,"__esModule",{value:!0});Vf.validateModels=Vf.validateModel=Vf.validateMessage=void 0;var Hg=wx(),HY=["username","version","session","msg_id","msg_type"],aye={stream:{name:"string",text:"string"},display_data:{data:"object",metadata:"object"},execute_input:{code:"string",execution_count:"number"},execute_result:{execution_count:"number",data:"object",metadata:"object"},error:{ename:"string",evalue:"string",traceback:"object"},status:{execution_state:["string",["starting","idle","busy","restarting","dead"]]},clear_output:{wait:"boolean"},comm_open:{comm_id:"string",target_name:"string",data:"object"},comm_msg:{comm_id:"string",data:"object"},comm_close:{comm_id:"string"},shutdown_reply:{restart:"boolean"}};function lye(r){for(let e=0;e<HY.length;e++)Hg.validateProperty(r,HY[e],"string")}function cye(r){Hg.validateProperty(r,"metadata","object"),Hg.validateProperty(r,"content","object"),Hg.validateProperty(r,"channel","string"),lye(r.header),r.channel==="iopub"&&uye(r)}Vf.validateMessage=cye;function uye(r){if(r.channel==="iopub"){let e=aye[r.header.msg_type];if(e===void 0)return;let t=Object.keys(e),n=r.content;for(let i=0;i<t.length;i++){let o=e[t[i]];Array.isArray(o)||(o=[o]),Hg.validateProperty(n,t[i],...o)}}}function JY(r){Hg.validateProperty(r,"name","string"),Hg.validateProperty(r,"id","string")}Vf.validateModel=JY;function dye(r){if(!Array.isArray(r))throw new Error("Invalid kernel list");r.forEach(e=>JY(e))}Vf.validateModels=dye});var lR=Q(Dn=>{"use strict";d();Object.defineProperty(Dn,"__esModule",{value:!0});Dn.getKernelModel=Dn.shutdownKernel=Dn.interruptKernel=Dn.restartKernel=Dn.startNew=Dn.listRunning=Dn.KERNEL_SERVICE_URL=void 0;var wi=js(),hI=hs(),aR=sR();Dn.KERNEL_SERVICE_URL="api/kernels";async function pye(r=wi.ServerConnection.makeSettings()){let e=hI.URLExt.join(r.baseUrl,Dn.KERNEL_SERVICE_URL),t=await wi.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await wi.ServerConnection.ResponseError.create(t);let n=await t.json();return aR.validateModels(n),n}Dn.listRunning=pye;async function fye(r={},e=wi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,Dn.KERNEL_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await wi.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await wi.ServerConnection.ResponseError.create(i);let o=await i.json();return aR.validateModel(o),o}Dn.startNew=fye;async function mye(r,e=wi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,Dn.KERNEL_SERVICE_URL,encodeURIComponent(r),"restart"),n={method:"POST"},i=await wi.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await wi.ServerConnection.ResponseError.create(i);let o=await i.json();aR.validateModel(o)}Dn.restartKernel=mye;async function hye(r,e=wi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,Dn.KERNEL_SERVICE_URL,encodeURIComponent(r),"interrupt"),n={method:"POST"},i=await wi.ServerConnection.makeRequest(t,n,e);if(i.status!==204)throw await wi.ServerConnection.ResponseError.create(i)}Dn.interruptKernel=hye;async function gye(r,e=wi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,Dn.KERNEL_SERVICE_URL,encodeURIComponent(r)),n={method:"DELETE"},i=await wi.ServerConnection.makeRequest(t,n,e);if(i.status===404){let o=`The kernel "${r}" does not exist on the server`;console.warn(o)}else if(i.status!==204)throw await wi.ServerConnection.ResponseError.create(i)}Dn.shutdownKernel=gye;async function vye(r,e=wi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,Dn.KERNEL_SERVICE_URL,encodeURIComponent(r)),n=await wi.ServerConnection.makeRequest(t,{},e);if(n.status===404)return;if(n.status!==200)throw await wi.ServerConnection.ResponseError.create(n);let i=await n.json();return aR.validateModel(i),i}Dn.getKernelModel=vye});var Dx=Q((cR,qY)=>{d();(function(r,e){typeof cR=="object"&&typeof qY!="undefined"?e(cR,Ql(),Vi()):typeof define=="function"&&define.amd?define(["exports","@lumino/coreutils","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_polling={},r.lumino_coreutils,r.lumino_signaling))})(cR,function(r,e,t){"use strict";var n=function(h,g){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,I){v.__proto__=I}||function(v,I){for(var S in I)Object.prototype.hasOwnProperty.call(I,S)&&(v[S]=I[S])},n(h,g)};function i(h,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");n(h,g);function v(){this.constructor=h}h.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}var o=function(){return o=Object.assign||function(g){for(var v,I=1,S=arguments.length;I<S;I++){v=arguments[I];for(var x in v)Object.prototype.hasOwnProperty.call(v,x)&&(g[x]=v[x])}return g},o.apply(this,arguments)};function s(h,g,v,I){function S(x){return x instanceof v?x:new v(function(D){D(x)})}return new(v||(v=Promise))(function(x,D){function A(j){try{R(I.next(j))}catch(ne){D(ne)}}function w(j){try{R(I.throw(j))}catch(ne){D(ne)}}function R(j){j.done?x(j.value):S(j.value).then(A,w)}R((I=I.apply(h,g||[])).next())})}function a(h,g){var v={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},I,S,x,D;return D={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function A(R){return function(j){return w([R,j])}}function w(R){if(I)throw new TypeError("Generator is already executing.");for(;v;)try{if(I=1,S&&(x=R[0]&2?S.return:R[0]?S.throw||((x=S.return)&&x.call(S),0):S.next)&&!(x=x.call(S,R[1])).done)return x;switch(S=0,x&&(R=[R[0]&2,x.value]),R[0]){case 0:case 1:x=R;break;case 4:return v.label++,{value:R[1],done:!1};case 5:v.label++,S=R[1],R=[0];continue;case 7:R=v.ops.pop(),v.trys.pop();continue;default:if(x=v.trys,!(x=x.length>0&&x[x.length-1])&&(R[0]===6||R[0]===2)){v=0;continue}if(R[0]===3&&(!x||R[1]>x[0]&&R[1]<x[3])){v.label=R[1];break}if(R[0]===6&&v.label<x[1]){v.label=x[1],x=R;break}if(x&&v.label<x[2]){v.label=x[2],v.ops.push(R);break}x[2]&&v.ops.pop(),v.trys.pop();continue}R=g.call(h,v)}catch(j){R=[6,j],S=0}finally{I=x=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}}var l=typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate,c=typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearImmediate;r.Poll=function(){function h(g){var v=this;this._disposed=new t.Signal(this),this._tick=new e.PromiseDelegate,this._ticked=new t.Signal(this),this._timeout=-1,this._factory=g.factory,this._standby=g.standby||u.DEFAULT_STANDBY,this._state=o(o({},u.DEFAULT_STATE),{timestamp:new Date().getTime()});var I=g.frequency||{},S=Math.max(I.interval||0,I.max||0,u.DEFAULT_FREQUENCY.max);this.frequency=o(o(o({},u.DEFAULT_FREQUENCY),I),{max:S}),this.name=g.name||u.DEFAULT_NAME,(!("auto"in g)||g.auto)&&l(function(){return void v.start()})}return Object.defineProperty(h.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"frequency",{get:function(){return this._frequency},set:function(g){if(!(this.isDisposed||e.JSONExt.deepEqual(g,this.frequency||{}))){var v=g.backoff,I=g.interval,S=g.max;if(I=Math.round(I),S=Math.round(S),typeof v=="number"&&v<1)throw new Error("Poll backoff growth factor must be at least 1");if((I<0||I>S)&&I!==h.NEVER)throw new Error("Poll interval must be between 0 and max");if(S>h.MAX_INTERVAL&&S!==h.NEVER)throw new Error("Max interval must be less than "+h.MAX_INTERVAL);this._frequency={backoff:v,interval:I,max:S}}},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"isDisposed",{get:function(){return this.state.phase==="disposed"},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"standby",{get:function(){return this._standby},set:function(g){this.isDisposed||this.standby===g||(this._standby=g)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"tick",{get:function(){return this._tick.promise},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"ticked",{get:function(){return this._ticked},enumerable:!0,configurable:!0}),h.prototype.dispose=function(){this.isDisposed||(this._state=o(o({},u.DISPOSED_STATE),{timestamp:new Date().getTime()}),this._tick.promise.catch(function(g){}),this._tick.reject(new Error("Poll ("+this.name+") is disposed.")),this._disposed.emit(void 0),t.Signal.clearData(this))},h.prototype.refresh=function(){return this.schedule({cancel:function(g){var v=g.phase;return v==="refreshed"},interval:h.IMMEDIATE,phase:"refreshed"})},h.prototype.schedule=function(g){return g===void 0&&(g={}),s(this,void 0,void 0,function(){var v,I,S,x,D,A=this;return a(this,function(w){switch(w.label){case 0:return this.isDisposed?[2]:g.cancel&&g.cancel(this.state)?[2]:(v=this.state,I=this._tick,S=new e.PromiseDelegate,x=o({interval:this.frequency.interval,payload:null,phase:"standby",timestamp:new Date().getTime()},g),this._state=x,this._tick=S,v.interval===h.IMMEDIATE?c(this._timeout):clearTimeout(this._timeout),this._ticked.emit(this.state),I.resolve(this),[4,I.promise]);case 1:return w.sent(),D=function(){A.isDisposed||A.tick!==S.promise||A._execute()},this._timeout=x.interval===h.IMMEDIATE?l(D):x.interval===h.NEVER?-1:setTimeout(D,x.interval),[2]}})})},h.prototype.start=function(){return this.schedule({cancel:function(g){var v=g.phase;return v!=="constructed"&&v!=="standby"&&v!=="stopped"},interval:h.IMMEDIATE,phase:"started"})},h.prototype.stop=function(){return this.schedule({cancel:function(g){var v=g.phase;return v==="stopped"},interval:h.NEVER,phase:"stopped"})},h.prototype._execute=function(){var g=this,v=typeof this.standby=="function"?this.standby():this.standby;if(v=v==="never"?!1:v==="when-hidden"?!!(typeof document!="undefined"&&document&&document.hidden):v,v){this.schedule();return}var I=this.tick;this._factory(this.state).then(function(S){g.isDisposed||g.tick!==I||g.schedule({payload:S,phase:g.state.phase==="rejected"?"reconnected":"resolved"})}).catch(function(S){g.isDisposed||g.tick!==I||g.schedule({interval:u.sleep(g.frequency,g.state),payload:S,phase:"rejected"})})},h}(),function(h){h.IMMEDIATE=0,h.MAX_INTERVAL=2147483647,h.NEVER=1/0}(r.Poll||(r.Poll={}));var u;(function(h){h.DEFAULT_BACKOFF=3,h.DEFAULT_FREQUENCY={backoff:!0,interval:1e3,max:30*1e3},h.DEFAULT_NAME="unknown",h.DEFAULT_STANDBY="when-hidden",h.DEFAULT_STATE={interval:r.Poll.NEVER,payload:null,phase:"constructed",timestamp:new Date(0).getTime()},h.DISPOSED_STATE={interval:r.Poll.NEVER,payload:null,phase:"disposed",timestamp:new Date(0).getTime()};function g(I,S){return I=Math.ceil(I),S=Math.floor(S),Math.floor(Math.random()*(S-I+1))+I}function v(I,S){var x=I.backoff,D=I.interval,A=I.max;if(D===r.Poll.NEVER)return D;var w=x===!0?h.DEFAULT_BACKOFF:x===!1?1:x,R=g(D,S.interval*w);return Math.min(A,R)}h.sleep=v})(u||(u={}));var p=function(){function h(g,v){var I=this;v===void 0&&(v=500),this.payload=null,this.limit=v,this.poll=new r.Poll({auto:!1,factory:function(){return s(I,void 0,void 0,function(){return a(this,function(S){switch(S.label){case 0:return[4,g()];case 1:return[2,S.sent()]}})})},frequency:{backoff:!1,interval:r.Poll.NEVER,max:r.Poll.NEVER},standby:"never"}),this.payload=new e.PromiseDelegate,this.poll.ticked.connect(function(S,x){var D=I.payload;if(x.phase==="resolved"){I.payload=new e.PromiseDelegate,D.resolve(x.payload);return}if(x.phase==="rejected"||x.phase==="stopped"){I.payload=new e.PromiseDelegate,D.promise.catch(function(A){}),D.reject(x.payload);return}},this)}return Object.defineProperty(h.prototype,"isDisposed",{get:function(){return this.payload===null},enumerable:!0,configurable:!0}),h.prototype.dispose=function(){this.isDisposed||(this.payload=null,this.poll.dispose())},h.prototype.stop=function(){return s(this,void 0,void 0,function(){return a(this,function(g){return[2,this.poll.stop()]})})},h}(),f=function(h){i(g,h);function g(){return h!==null&&h.apply(this,arguments)||this}return g.prototype.invoke=function(){return this.poll.schedule({interval:this.limit,phase:"invoked"}),this.payload.promise},g}(p),m=function(h){i(g,h);function g(v,I){var S=h.call(this,v,typeof I=="number"?I:I&&I.limit)||this,x="leading";return typeof I!="number"&&(I=I||{},x="edge"in I?I.edge:x),S._interval=x==="trailing"?S.limit:r.Poll.IMMEDIATE,S}return g.prototype.invoke=function(){return this.poll.state.phase!=="invoked"&&this.poll.schedule({interval:this._interval,phase:"invoked"}),this.payload.promise},g}(p);r.Debouncer=f,r.RateLimiter=p,r.Throttler=m,Object.defineProperty(r,"__esModule",{value:!0})})});var Px=Q(uR=>{"use strict";d();Object.defineProperty(uR,"__esModule",{value:!0});uR.BaseManager=void 0;var GY=Vi(),yye=js(),$W=class{constructor(e){var t;this._isDisposed=!1,this._disposed=new GY.Signal(this),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:yye.ServerConnection.makeSettings()}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._disposed.emit(void 0),GY.Signal.clearData(this))}};uR.BaseManager=$W});var zW=Q((dR,YY)=>{d();(function(r,e){typeof dR=="object"&&typeof YY!="undefined"?e(dR,Fg(),Vi()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_disposable={},r.lumino_algorithm,r.lumino_signaling))})(dR,function(r,e,t){"use strict";var n=function(a,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,u){c.__proto__=u}||function(c,u){for(var p in u)Object.prototype.hasOwnProperty.call(u,p)&&(c[p]=u[p])},n(a,l)};function i(a,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");n(a,l);function c(){this.constructor=a}a.prototype=l===null?Object.create(l):(c.prototype=l.prototype,new c)}var o=function(){function a(l){this._fn=l}return Object.defineProperty(a.prototype,"isDisposed",{get:function(){return!this._fn},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){if(this._fn){var l=this._fn;this._fn=null,l()}},a}(),s=function(a){i(l,a);function l(){var c=a!==null&&a.apply(this,arguments)||this;return c._disposed=new t.Signal(c),c}return Object.defineProperty(l.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),l.prototype.dispose=function(){this.isDisposed||(a.prototype.dispose.call(this),this._disposed.emit(void 0),t.Signal.clearData(this))},l}(o);r.DisposableSet=function(){function a(){this._isDisposed=!1,this._items=new Set}return Object.defineProperty(a.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this._items.forEach(function(l){l.dispose()}),this._items.clear())},a.prototype.contains=function(l){return this._items.has(l)},a.prototype.add=function(l){this._items.add(l)},a.prototype.remove=function(l){this._items.delete(l)},a.prototype.clear=function(){this._items.clear()},a}(),function(a){function l(c){var u=new a;return e.each(c,function(p){u.add(p)}),u}a.from=l}(r.DisposableSet||(r.DisposableSet={})),r.ObservableDisposableSet=function(a){i(l,a);function l(){var c=a!==null&&a.apply(this,arguments)||this;return c._disposed=new t.Signal(c),c}return Object.defineProperty(l.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),l.prototype.dispose=function(){this.isDisposed||(a.prototype.dispose.call(this),this._disposed.emit(void 0),t.Signal.clearData(this))},l}(r.DisposableSet),function(a){function l(c){var u=new a;return e.each(c,function(p){u.add(p)}),u}a.from=l}(r.ObservableDisposableSet||(r.ObservableDisposableSet={})),r.DisposableDelegate=o,r.ObservableDisposableDelegate=s,Object.defineProperty(r,"__esModule",{value:!0})})});var $Y=Q(ru=>{"use strict";d();var bye=ru&&ru.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Iye=ru&&ru.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Sye=ru&&ru.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&bye(e,r,t);return Iye(e,r),e};Object.defineProperty(ru,"__esModule",{value:!0});ru.CommHandler=void 0;var _ye=zW(),pR=Sye(xx()),QW=class extends _ye.DisposableDelegate{constructor(e,t,n,i){super(i),this._target="",this._id="",this._id=t,this._target=e,this._kernel=n}get commId(){return this._id}get targetName(){return this._target}get onClose(){return this._onClose}set onClose(e){this._onClose=e}get onMsg(){return this._onMsg}set onMsg(e){this._onMsg=e}open(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot open");let i=pR.createMessage({msgType:"comm_open",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,target_name:this._target,data:e!=null?e:{}},metadata:t,buffers:n});return this._kernel.sendShellMessage(i,!1,!0)}send(e,t,n=[],i=!0){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot send");let o=pR.createMessage({msgType:"comm_msg",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e},metadata:t,buffers:n});return this._kernel.sendShellMessage(o,!1,i)}close(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot close");let i=pR.createMessage({msgType:"comm_close",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n}),o=this._kernel.sendShellMessage(i,!1,!0),s=this._onClose;if(s){let a=pR.createMessage({msgType:"comm_close",channel:"iopub",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n});s(a)}return this.dispose(),o}};ru.CommHandler=QW});var QY=Q(gs=>{"use strict";d();var Eye=gs&&gs.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Cye=gs&&gs.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),wye=gs&&gs.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Eye(e,r,t);return Cye(e,r),e};Object.defineProperty(gs,"__esModule",{value:!0});gs.KernelShellFutureHandler=gs.KernelControlFutureHandler=gs.KernelFutureHandler=void 0;var zY=Ql(),xye=zW(),Dye=wye(xx()),Tx=class extends xye.DisposableDelegate{constructor(e,t,n,i,o){super(e),this._status=0,this._stdin=ji.noOp,this._iopub=ji.noOp,this._reply=ji.noOp,this._done=new zY.PromiseDelegate,this._hooks=new ji.HookList,this._disposeOnDone=!0,this._msg=t,n||this._setFlag(ji.KernelFutureFlag.GotReply),this._disposeOnDone=i,this._kernel=o}get msg(){return this._msg}get done(){return this._done.promise}get onReply(){return this._reply}set onReply(e){this._reply=e}get onIOPub(){return this._iopub}set onIOPub(e){this._iopub=e}get onStdin(){return this._stdin}set onStdin(e){this._stdin=e}registerMessageHook(e){if(this.isDisposed)throw new Error("Kernel future is disposed");this._hooks.add(e)}removeMessageHook(e){this.isDisposed||this._hooks.remove(e)}sendInputReply(e){this._kernel.sendInputReply(e)}dispose(){this._stdin=ji.noOp,this._iopub=ji.noOp,this._reply=ji.noOp,this._hooks=null,this._testFlag(ji.KernelFutureFlag.IsDone)||(this._done.promise.catch(()=>{}),this._done.reject(new Error(`Canceled future for ${this.msg.header.msg_type} message before replies were done`))),super.dispose()}async handleMsg(e){switch(e.channel){case"control":case"shell":e.channel===this.msg.channel&&e.parent_header.msg_id===this.msg.header.msg_id&&await this._handleReply(e);break;case"stdin":await this._handleStdin(e);break;case"iopub":await this._handleIOPub(e);break;default:break}}async _handleReply(e){let t=this._reply;t&&await t(e),this._replyMsg=e,this._setFlag(ji.KernelFutureFlag.GotReply),this._testFlag(ji.KernelFutureFlag.GotIdle)&&this._handleDone()}async _handleStdin(e){let t=this._stdin;t&&await t(e)}async _handleIOPub(e){let t=await this._hooks.process(e),n=this._iopub;t&&n&&await n(e),Dye.isStatusMsg(e)&&e.content.execution_state==="idle"&&(this._setFlag(ji.KernelFutureFlag.GotIdle),this._testFlag(ji.KernelFutureFlag.GotReply)&&this._handleDone())}_handleDone(){this._testFlag(ji.KernelFutureFlag.IsDone)||(this._setFlag(ji.KernelFutureFlag.IsDone),this._done.resolve(this._replyMsg),this._disposeOnDone&&this.dispose())}_testFlag(e){return(this._status&e)!==0}_setFlag(e){this._status|=e}};gs.KernelFutureHandler=Tx;var XW=class extends Tx{};gs.KernelControlFutureHandler=XW;var ZW=class extends Tx{};gs.KernelShellFutureHandler=ZW;var ji;(function(r){r.noOp=()=>{};let e=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();class t{constructor(){this._hooks=[]}add(o){this.remove(o),this._hooks.push(o)}remove(o){let s=this._hooks.indexOf(o);s>=0&&(this._hooks[s]=null,this._scheduleCompact())}async process(o){await this._processing;let s=new zY.PromiseDelegate;this._processing=s.promise;let a;for(let l=this._hooks.length-1;l>=0;l--){let c=this._hooks[l];if(c!==null){try{a=await c(o)}catch(u){a=!0,console.error(u)}if(a===!1)return s.resolve(void 0),!1}}return s.resolve(void 0),!0}_scheduleCompact(){this._compactScheduled||(this._compactScheduled=!0,e(()=>{this._processing=this._processing.then(()=>{this._compactScheduled=!1,this._compact()})}))}_compact(){let o=0;for(let s=0,a=this._hooks.length;s<a;s++){let l=this._hooks[s];this._hooks[s]===null?o++:this._hooks[s-o]=l}this._hooks.length-=o}}r.HookList=t;let n;(function(i){i[i.GotReply=1]="GotReply",i[i.GotIdle=2]="GotIdle",i[i.IsDone=4]="IsDone",i[i.DisposeOnDone=8]="DisposeOnDone"})(n=r.KernelFutureFlag||(r.KernelFutureFlag={}))})(ji||(ji={}))});var eV=Q(gI=>{"use strict";d();Object.defineProperty(gI,"__esModule",{value:!0});gI.serialize=gI.deserialize=void 0;function Pye(r){let e;return typeof r=="string"?e=JSON.parse(r):e=kye(r),e}gI.deserialize=Pye;function Tye(r){var e;let t;return!((e=r.buffers)===null||e===void 0)&&e.length?t=Nye(r):t=JSON.stringify(r),t}gI.serialize=Tye;function kye(r){let e=new DataView(r),t=e.getUint32(0),n=[];if(t<2)throw new Error("Invalid incoming Kernel Message");for(let s=1;s<=t;s++)n.push(e.getUint32(s*4));let i=new Uint8Array(r.slice(n[0],n[1])),o=JSON.parse(new TextDecoder("utf8").decode(i));o.buffers=[];for(let s=1;s<t;s++){let a=n[s],l=n[s+1]||r.byteLength;o.buffers.push(new DataView(r.slice(a,l)))}return o}function Nye(r){let e=[],t=[],n=new TextEncoder,i=[];r.buffers!==void 0&&(i=r.buffers,delete r.buffers);let o=n.encode(JSON.stringify(r));t.push(o.buffer);for(let c=0;c<i.length;c++){let u=i[c];t.push(ArrayBuffer.isView(u)?u.buffer:u)}let s=t.length;e.push(4*(s+1));for(let c=0;c+1<t.length;c++)e.push(e[e.length-1]+t[c].byteLength);let a=new Uint8Array(e[e.length-1]+t[t.length-1].byteLength),l=new DataView(a.buffer);l.setUint32(0,s);for(let c=0;c<e.length;c++)l.setUint32(4*(c+1),e[c]);for(let c=0;c<t.length;c++)a.set(new Uint8Array(t[c]),e[c]);return a.buffer}});var ZY=Q(XY=>{"use strict";d();Object.defineProperty(XY,"__esModule",{value:!0})});var t$=Q(vI=>{"use strict";d();Object.defineProperty(vI,"__esModule",{value:!0});vI.validateSpecModels=vI.validateSpecModel=void 0;var Jg=wx();function e$(r){let e=r.spec;if(!e)throw new Error("Invalid kernel spec");Jg.validateProperty(r,"name","string"),Jg.validateProperty(r,"resources","object"),Jg.validateProperty(e,"language","string"),Jg.validateProperty(e,"display_name","string"),Jg.validateProperty(e,"argv","array");let t=null;e.hasOwnProperty("metadata")&&(Jg.validateProperty(e,"metadata","object"),t=e.metadata);let n=null;return e.hasOwnProperty("env")&&(Jg.validateProperty(e,"env","object"),n=e.env),{name:r.name,resources:r.resources,language:e.language,display_name:e.display_name,argv:e.argv,metadata:t,env:n}}vI.validateSpecModel=e$;function Rye(r){if(!r.hasOwnProperty("kernelspecs"))throw new Error("No kernelspecs found");let e=Object.keys(r.kernelspecs),t=Object.create(null),n=r.default;for(let i=0;i<e.length;i++){let o=r.kernelspecs[e[i]];try{t[e[i]]=e$(o)}catch(s){console.warn(`Removing errant kernel spec: ${e[i]}`)}}if(e=Object.keys(t),!e.length)throw new Error("No valid kernelspecs found");return(!n||typeof n!="string"||!(n in t))&&(n=e[0],console.warn(`Default kernel not found, using '${e[0]}'`)),{default:n,kernelspecs:t}}vI.validateSpecModels=Rye});var rV=Q(fR=>{"use strict";d();Object.defineProperty(fR,"__esModule",{value:!0});fR.getSpecs=void 0;var tV=js(),Aye=t$(),Mye=hs(),Oye="api/kernelspecs";async function Lye(r=tV.ServerConnection.makeSettings()){let e=Mye.URLExt.join(r.baseUrl,Oye),t=await tV.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await tV.ServerConnection.ResponseError.create(t);let n=await t.json();return Aye.validateSpecModels(n)}fR.getSpecs=Lye});var n$=Q(nu=>{"use strict";d();var Kye=nu&&nu.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Fye=nu&&nu.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Uye=nu&&nu.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Kye(e,r,t);return Fye(e,r),e};Object.defineProperty(nu,"__esModule",{value:!0});nu.KernelSpecManager=void 0;var Wye=Ql(),Vye=Dx(),r$=Vi(),jye=Uye(rV()),Bye=Px(),nV=class extends Bye.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._connectionFailure=new r$.Signal(this),this._specs=null,this._specsChanged=new r$.Signal(this),this._ready=Promise.all([this.requestSpecs()]).then(n=>{}).catch(n=>{}).then(()=>{this.isDisposed||(this._isReady=!0)}),this._pollSpecs=new Vye.Poll({auto:!1,factory:()=>this.requestSpecs(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelSpecManager#specs",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get specs(){return this._specs}get specsChanged(){return this._specsChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshSpecs(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestSpecs(){let e=await jye.getSpecs(this.serverSettings);this.isDisposed||Wye.JSONExt.deepEqual(e,this._specs)||(this._specs=e,this._specsChanged.emit(e))}};nu.KernelSpecManager=nV});var mR=Q(Uo=>{"use strict";d();var i$=Uo&&Uo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Hye=Uo&&Uo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),o$=Uo&&Uo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&i$(e,r,t);return Hye(e,r),e},Jye=Uo&&Uo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&i$(e,r,t)};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.KernelSpecAPI=Uo.KernelSpec=void 0;var qye=o$(ZY());Uo.KernelSpec=qye;var Gye=o$(rV());Uo.KernelSpecAPI=Gye;Jye(n$(),Uo)});var c$=Q(iu=>{"use strict";d();var Yye=iu&&iu.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),$ye=iu&&iu.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),gR=iu&&iu.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Yye(e,r,t);return $ye(e,r),e};Object.defineProperty(iu,"__esModule",{value:!0});iu.KernelConnection=void 0;var s$=hs(),jf=Ql(),qg=Vi(),zye=ci(),a$=$Y(),Bs=gR(xx()),l$=QY(),iV=gR(eV()),Qye=gR(sR()),Xye=mR(),hR=gR(lR()),Zye=3e3,yI="_RESTARTING_",ebe="",oV=class r{constructor(e){var t,n,i,o;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let s=this.serverSettings,a=s$.URLExt.join(s.wsUrl,hR.KERNEL_SERVICE_URL,encodeURIComponent(this._id)),l=a.replace(/^((?:\w+:)?\/\/)(?:[^@\/]+@)/,"$1"),c=s$.URLExt.join(a,"channels?session_id="+encodeURIComponent(this._clientId)),u=s.token;s.appendToken&&u!==""&&(c=c+`&token=${encodeURIComponent(u)}`),this._ws=new s.WebSocket(c),this._ws.binaryType="arraybuffer",this._ws.onmessage=this._onWSMessage,this._ws.onopen=this._onWSOpen,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSOpen=s=>{this._updateConnectionStatus("connected")},this._onWSMessage=s=>{let a;try{a=iV.deserialize(s.data),Qye.validateMessage(a)}catch(l){throw l.message=`Kernel message validation error: ${l.message}`,l}this._kernelSession=a.header.session,this._msgChain=this._msgChain.then(()=>this._handleMessage(a)).catch(l=>{l.message.startsWith("Canceled future for ")&&console.error(l)}),this._anyMessage.emit({msg:a,direction:"recv"})},this._onWSClose=s=>{this.isDisposed||this._reconnect()},this._id="",this._name="",this._status="unknown",this._connectionStatus="connecting",this._kernelSession="",this._isDisposed=!1,this._ws=null,this._username="",this._reconnectLimit=7,this._reconnectAttempt=0,this._reconnectTimeout=null,this._futures=new Map,this._comms=new Map,this._targetRegistry=Object.create(null),this._info=new jf.PromiseDelegate,this._pendingMessages=[],this._statusChanged=new qg.Signal(this),this._connectionStatusChanged=new qg.Signal(this),this._disposed=new qg.Signal(this),this._iopubMessage=new qg.Signal(this),this._anyMessage=new qg.Signal(this),this._unhandledMessage=new qg.Signal(this),this._displayIdToParentIds=new Map,this._msgIdToDisplayIds=new Map,this._msgChain=Promise.resolve(),this._noOp=()=>{},this._name=e.model.name,this._id=e.model.id,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:zye.ServerConnection.makeSettings(),this._clientId=(n=e.clientId)!==null&&n!==void 0?n:jf.UUID.uuid4(),this._username=(i=e.username)!==null&&i!==void 0?i:"",this.handleComms=(o=e.handleComms)!==null&&o!==void 0?o:!0,this._createSocket()}get disposed(){return this._disposed}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get model(){return{id:this.id,name:this.name}}get anyMessage(){return this._anyMessage}get id(){return this._id}get name(){return this._name}get username(){return this._username}get clientId(){return this._clientId}get status(){return this._status}get connectionStatus(){return this._connectionStatus}get isDisposed(){return this._isDisposed}get info(){return this._info.promise}get spec(){return this._specPromise?this._specPromise:(this._specPromise=Xye.KernelSpecAPI.getSpecs(this.serverSettings).then(e=>e.kernelspecs[this._name]),this._specPromise)}clone(e={}){return new r(Object.assign({model:this.model,username:this.username,serverSettings:this.serverSettings,handleComms:!1},e))}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearKernelState(),this._pendingMessages=[],this._clearSocket(),qg.Signal.clearData(this))}sendShellMessage(e,t=!1,n=!0){return this._sendKernelShellControl(l$.KernelShellFutureHandler,e,t,n)}sendControlMessage(e,t=!1,n=!0){return this._sendKernelShellControl(l$.KernelControlFutureHandler,e,t,n)}_sendKernelShellControl(e,t,n=!1,i=!0){this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"});let o=new e(()=>{let s=t.header.msg_id;this._futures.delete(s);let a=this._msgIdToDisplayIds.get(s);a&&(a.forEach(l=>{let c=this._displayIdToParentIds.get(l);if(c){let u=c.indexOf(s);if(u===-1)return;c.length===1?this._displayIdToParentIds.delete(l):(c.splice(u,1),this._displayIdToParentIds.set(l,c))}}),this._msgIdToDisplayIds.delete(s))},t,n,i,this);return this._futures.set(t.header.msg_id,o),o}_sendMessage(e,t=!0){if(this.status==="dead")throw new Error("Kernel is dead");if((this._kernelSession===ebe||this._kernelSession===yI)&&Bs.isInfoRequestMsg(e))if(this.connectionStatus==="connected"){this._ws.send(iV.serialize(e));return}else throw new Error("Could not send message: status is not connected");if(t&&this._pendingMessages.length>0){this._pendingMessages.push(e);return}if(this.connectionStatus==="connected"&&this._kernelSession!==yI)this._ws.send(iV.serialize(e));else if(t)this._pendingMessages.push(e);else throw new Error("Could not send message")}async interrupt(){if(this.status==="dead")throw new Error("Kernel is dead");return hR.interruptKernel(this.id,this.serverSettings)}async restart(){if(this.status==="dead")throw new Error("Kernel is dead");this._updateStatus("restarting"),this._clearKernelState(),this._kernelSession=yI,await hR.restartKernel(this.id,this.serverSettings),await this.reconnect()}reconnect(){this._errorIfDisposed();let e=new jf.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Kernel connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}async shutdown(){this.status!=="dead"&&await hR.shutdownKernel(this.id,this.serverSettings),this.handleShutdown()}handleShutdown(){this._updateStatus("dead"),this.dispose()}async requestKernelInfo(){let e=Bs.createMessage({msgType:"kernel_info_request",channel:"shell",username:this._username,session:this._clientId,content:{}}),t;try{t=await Xl.handleShellMessage(this,e)}catch(n){if(this.isDisposed)return;throw n}if(this._errorIfDisposed(),!!t)return t.content.status===void 0&&(t.content.status="ok"),t.content.status!=="ok"?(this._info.reject("Kernel info reply errored"),t):(this._info.resolve(t.content),this._kernelSession=t.header.session,t)}requestComplete(e){let t=Bs.createMessage({msgType:"complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Xl.handleShellMessage(this,t)}requestInspect(e){let t=Bs.createMessage({msgType:"inspect_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Xl.handleShellMessage(this,t)}requestHistory(e){let t=Bs.createMessage({msgType:"history_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Xl.handleShellMessage(this,t)}requestExecute(e,t=!0,n){let i={silent:!1,store_history:!0,user_expressions:{},allow_stdin:!0,stop_on_error:!1},o=Bs.createMessage({msgType:"execute_request",channel:"shell",username:this._username,session:this._clientId,content:Object.assign(Object.assign({},i),e),metadata:n});return this.sendShellMessage(o,!0,t)}requestDebug(e,t=!0){let n=Bs.createMessage({msgType:"debug_request",channel:"control",username:this._username,session:this._clientId,content:e});return this.sendControlMessage(n,!0,t)}requestIsComplete(e){let t=Bs.createMessage({msgType:"is_complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Xl.handleShellMessage(this,t)}requestCommInfo(e){let t=Bs.createMessage({msgType:"comm_info_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Xl.handleShellMessage(this,t)}sendInputReply(e){let t=Bs.createMessage({msgType:"input_reply",channel:"stdin",username:this._username,session:this._clientId,content:e});this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"})}createComm(e,t=jf.UUID.uuid4()){if(!this.handleComms)throw new Error("Comms are disabled on this kernel connection");if(this._comms.has(t))throw new Error("Comm is already created");let n=new a$.CommHandler(e,t,this,()=>{this._unregisterComm(t)});return this._comms.set(t,n),n}hasComm(e){return this._comms.has(e)}registerCommTarget(e,t){this.handleComms&&(this._targetRegistry[e]=t)}removeCommTarget(e,t){this.handleComms&&!this.isDisposed&&this._targetRegistry[e]===t&&delete this._targetRegistry[e]}registerMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.registerMessageHook(t)}removeMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.removeMessageHook(t)}async _handleDisplayId(e,t){var n,i;let o=t.parent_header.msg_id,s=this._displayIdToParentIds.get(e);if(s){let l={header:jf.JSONExt.deepCopy(t.header),parent_header:jf.JSONExt.deepCopy(t.parent_header),metadata:jf.JSONExt.deepCopy(t.metadata),content:jf.JSONExt.deepCopy(t.content),channel:t.channel,buffers:t.buffers?t.buffers.slice():[]};l.header.msg_type="update_display_data",await Promise.all(s.map(async c=>{let u=this._futures&&this._futures.get(c);u&&await u.handleMsg(l)}))}if(t.header.msg_type==="update_display_data")return!0;s=(n=this._displayIdToParentIds.get(e))!==null&&n!==void 0?n:[],s.indexOf(o)===-1&&s.push(o),this._displayIdToParentIds.set(e,s);let a=(i=this._msgIdToDisplayIds.get(o))!==null&&i!==void 0?i:[];return a.indexOf(o)===-1&&a.push(o),this._msgIdToDisplayIds.set(o,a),!1}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}_updateStatus(e){this._status===e||this._status==="dead"||(this._status=e,Xl.logKernelStatus(this),this._statusChanged.emit(e),e==="dead"&&this.dispose())}_sendPending(){for(;this.connectionStatus==="connected"&&this._kernelSession!==yI&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}_clearKernelState(){this._kernelSession="",this._pendingMessages=[],this._futures.forEach(e=>{e.dispose()}),this._comms.forEach(e=>{e.dispose()}),this._msgChain=Promise.resolve(),this._futures=new Map,this._comms=new Map,this._displayIdToParentIds.clear(),this._msgIdToDisplayIds.clear()}_assertCurrentMessage(e){if(this._errorIfDisposed(),e.header.session!==this._kernelSession)throw new Error(`Canceling handling of old message: ${e.header.msg_type}`)}async _handleCommOpen(e){this._assertCurrentMessage(e);let t=e.content,n=new a$.CommHandler(t.target_name,t.comm_id,this,()=>{this._unregisterComm(t.comm_id)});this._comms.set(t.comm_id,n);try{await(await Xl.loadObject(t.target_name,t.target_module,this._targetRegistry))(n,e)}catch(i){throw n.close(),console.error("Exception opening new comm"),i}}async _handleCommClose(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n){console.error("Comm not found for comm id "+t.comm_id);return}this._unregisterComm(n.commId);let i=n.onClose;i&&await i(e),n.dispose()}async _handleCommMsg(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n)return;let i=n.onMsg;i&&await i(e)}_unregisterComm(e){this._comms.delete(e)}_updateConnectionStatus(e){if(this._connectionStatus!==e){if(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),this.status!=="dead")if(e==="connected"){let t=this._kernelSession===yI,n=this.requestKernelInfo(),i=!1,o=()=>{i||(i=!0,t&&this._kernelSession===yI&&(this._kernelSession=""),clearTimeout(s),this._pendingMessages.length>0&&this._sendPending())};n.then(o);let s=setTimeout(o,Zye)}else this._updateStatus("unknown");this._connectionStatusChanged.emit(e)}}async _handleMessage(e){var t,n;let i=!1;if(e.parent_header&&e.channel==="iopub"&&(Bs.isDisplayDataMsg(e)||Bs.isUpdateDisplayDataMsg(e)||Bs.isExecuteResultMsg(e))){let s=((t=e.content.transient)!==null&&t!==void 0?t:{}).display_id;s&&(i=await this._handleDisplayId(s,e),this._assertCurrentMessage(e))}if(!i&&e.parent_header){let o=e.parent_header,s=(n=this._futures)===null||n===void 0?void 0:n.get(o.msg_id);if(s)await s.handleMsg(e),this._assertCurrentMessage(e);else{let a=o.session===this.clientId;e.channel!=="iopub"&&a&&this._unhandledMessage.emit(e)}}if(e.channel==="iopub"){switch(e.header.msg_type){case"status":{let o=e.content.execution_state;o==="restarting"&&Promise.resolve().then(async()=>{this._updateStatus("autorestarting"),this._clearKernelState(),await this.reconnect()}),this._updateStatus(o);break}case"comm_open":this.handleComms&&await this._handleCommOpen(e);break;case"comm_msg":this.handleComms&&await this._handleCommMsg(e);break;case"comm_close":this.handleComms&&await this._handleCommClose(e);break;default:break}this.isDisposed||(this._assertCurrentMessage(e),this._iopubMessage.emit(e))}}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=Xl.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.warn(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_errorIfDisposed(){if(this.isDisposed)throw new Error("Kernel connection is disposed")}};iu.KernelConnection=oV;var Xl;(function(r){function e(o){switch(o.status){case"idle":case"busy":case"unknown":return;default:console.debug(`Kernel: ${o.status} (${o.id})`);break}}r.logKernelStatus=e;async function t(o,s){return o.sendShellMessage(s,!0).done}r.handleShellMessage=t;function n(o,s,a){return new Promise((l,c)=>{if(s){if(typeof requirejs=="undefined")throw new Error("requirejs not found");requirejs([s],u=>{if(u[o]===void 0){let p=`Object '${o}' not found in module '${s}'`;c(new Error(p))}else l(u[o])},c)}else a!=null&&a[o]?l(a[o]):c(new Error(`Object '${o}' not found in registry`))})}r.loadObject=n;function i(o,s){return o=Math.ceil(o),s=Math.floor(s),Math.floor(Math.random()*(s-o+1))+o}r.getRandomIntInclusive=i})(Xl||(Xl={}))});var p$=Q(yR=>{"use strict";d();Object.defineProperty(yR,"__esModule",{value:!0});yR.KernelManager=void 0;var u$=Fg(),tbe=Dx(),d$=Vi(),rbe=ci(),nbe=Px(),vR=lR(),ibe=c$(),sV=class extends nbe.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._kernelConnections=new Set,this._models=new Map,this._runningChanged=new d$.Signal(this),this._connectionFailure=new d$.Signal(this),this._pollModels=new tbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._kernelConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){var t;let{id:n}=e.model,i=(t=e.handleComms)!==null&&t!==void 0?t:!0;if(e.handleComms===void 0){for(let s of this._kernelConnections)if(s.id===n&&s.handleComms){i=!1;break}}let o=new ibe.KernelConnection(Object.assign(Object.assign({handleComms:i},e),{serverSettings:this.serverSettings}));return this._onStarted(o),this._models.has(n)||this.refreshRunning().catch(()=>{}),o}running(){return u$.iter([...this._models.values()])}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e={},t={}){let n=await vR.startNew(e,this.serverSettings);return this.connectTo(Object.assign(Object.assign({},t),{model:n}))}async shutdown(e){await vR.shutdownKernel(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>vR.shutdownKernel(e,this.serverSettings))),await this.refreshRunning()}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async requestRunning(){var e,t;let n;try{n=await vR.listRunning(this.serverSettings)}catch(i){throw(i instanceof rbe.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&u$.every(n,i=>{let o=this._models.get(i.id);return o?o.name===i.name:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._kernelConnections.forEach(i=>{this._models.has(i.id)||i.handleShutdown()}),this._runningChanged.emit(n))}_onStarted(e){this._kernelConnections.add(e),e.statusChanged.connect(this._onStatusChanged,this),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._kernelConnections.delete(e),this.refreshRunning().catch(()=>{})}_onStatusChanged(e,t){t==="dead"&&this.refreshRunning().catch(()=>{})}};yR.KernelManager=sV});var lV=Q(Bi=>{"use strict";d();var f$=Bi&&Bi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),obe=Bi&&Bi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),aV=Bi&&Bi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&f$(e,r,t);return obe(e,r),e},sbe=Bi&&Bi.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&f$(e,r,t)};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.KernelAPI=Bi.KernelMessage=Bi.Kernel=void 0;var abe=aV(WY());Bi.Kernel=abe;var lbe=aV(xx());Bi.KernelMessage=lbe;var cbe=aV(lR());Bi.KernelAPI=cbe;sbe(p$(),Bi)});var m$=Q(bR=>{"use strict";d();Object.defineProperty(bR,"__esModule",{value:!0});bR.BuildManager=void 0;var cV=hs(),Bf=js(),ube="api/build",uV=class{constructor(e={}){var t;this._url="",this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Bf.ServerConnection.makeSettings();let{baseUrl:n,appUrl:i}=this.serverSettings;this._url=cV.URLExt.join(n,i,ube)}get isAvailable(){return cV.PageConfig.getOption("buildAvailable").toLowerCase()==="true"}get shouldCheck(){return cV.PageConfig.getOption("buildCheck").toLowerCase()==="true"}getStatus(){let{_url:e,serverSettings:t}=this;return Bf.ServerConnection.makeRequest(e,{},t).then(i=>{if(i.status!==200)throw new Bf.ServerConnection.ResponseError(i);return i.json()}).then(i=>{if(typeof i.status!="string")throw new Error("Invalid data");if(typeof i.message!="string")throw new Error("Invalid data");return i})}build(){let{_url:e,serverSettings:t}=this,n={method:"POST"};return Bf.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status===400)throw new Bf.ServerConnection.ResponseError(o,"Build aborted");if(o.status!==200){let s=`Build failed with ${o.status}, please run 'jupyter lab build' on the server for full output`;throw new Bf.ServerConnection.ResponseError(o,s)}})}cancel(){let{_url:e,serverSettings:t}=this,n={method:"DELETE"};return Bf.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status!==204)throw new Bf.ServerConnection.ResponseError(o)})}};bR.BuildManager=uV});var fV=Q(IR=>{"use strict";d();Object.defineProperty(IR,"__esModule",{value:!0});IR.NbConvertManager=void 0;var dbe=hs(),dV=js(),pbe="api/nbconvert",pV=class{constructor(e={}){var t;this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:dV.ServerConnection.makeSettings()}async getExportFormats(){let e=this.serverSettings.baseUrl,t=dbe.URLExt.join(e,pbe),{serverSettings:n}=this,i=await dV.ServerConnection.makeRequest(t,{},n);if(i.status!==200)throw await dV.ServerConnection.ResponseError.create(i);let o=await i.json(),s={};return Object.keys(o).forEach(function(l){let c=o[l].output_mimetype;s[l]={output_mimetype:c}}),s}};IR.NbConvertManager=pV});var g$=Q(h$=>{"use strict";d();Object.defineProperty(h$,"__esModule",{value:!0})});var y$=Q(Hf=>{"use strict";d();Object.defineProperty(Hf,"__esModule",{value:!0});Hf.validateModels=Hf.updateLegacySessionModel=Hf.validateModel=void 0;var fbe=sR(),kx=wx();function v$(r){kx.validateProperty(r,"id","string"),kx.validateProperty(r,"type","string"),kx.validateProperty(r,"name","string"),kx.validateProperty(r,"path","string"),kx.validateProperty(r,"kernel","object"),fbe.validateModel(r.kernel)}Hf.validateModel=v$;function mbe(r){r.path===void 0&&r.notebook!==void 0&&(r.path=r.notebook.path,r.type="notebook",r.name="")}Hf.updateLegacySessionModel=mbe;function hbe(r){if(!Array.isArray(r))throw new Error("Invalid session list");r.forEach(e=>v$(e))}Hf.validateModels=hbe});var _R=Q(ui=>{"use strict";d();Object.defineProperty(ui,"__esModule",{value:!0});ui.updateSession=ui.startSession=ui.getSessionModel=ui.shutdownSession=ui.getSessionUrl=ui.listRunning=ui.SESSION_SERVICE_URL=void 0;var po=js(),mV=hs(),Jf=y$();ui.SESSION_SERVICE_URL="api/sessions";async function gbe(r=po.ServerConnection.makeSettings()){let e=mV.URLExt.join(r.baseUrl,ui.SESSION_SERVICE_URL),t=await po.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await po.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid Session list");return n.forEach(i=>{Jf.updateLegacySessionModel(i),Jf.validateModel(i)}),n}ui.listRunning=gbe;function SR(r,e){return mV.URLExt.join(r,ui.SESSION_SERVICE_URL,e)}ui.getSessionUrl=SR;async function vbe(r,e=po.ServerConnection.makeSettings()){var t;let n=SR(e.baseUrl,r),i={method:"DELETE"},o=await po.ServerConnection.makeRequest(n,i,e);if(o.status===404){let a=(t=(await o.json()).message)!==null&&t!==void 0?t:`The session "${r}"" does not exist on the server`;console.warn(a)}else{if(o.status===410)throw new po.ServerConnection.ResponseError(o,"The kernel was deleted but the session was not");if(o.status!==204)throw await po.ServerConnection.ResponseError.create(o)}}ui.shutdownSession=vbe;async function ybe(r,e=po.ServerConnection.makeSettings()){let t=SR(e.baseUrl,r),n=await po.ServerConnection.makeRequest(t,{},e);if(n.status!==200)throw await po.ServerConnection.ResponseError.create(n);let i=await n.json();return Jf.updateLegacySessionModel(i),Jf.validateModel(i),i}ui.getSessionModel=ybe;async function bbe(r,e=po.ServerConnection.makeSettings()){let t=mV.URLExt.join(e.baseUrl,ui.SESSION_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await po.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await po.ServerConnection.ResponseError.create(i);let o=await i.json();return Jf.updateLegacySessionModel(o),Jf.validateModel(o),o}ui.startSession=bbe;async function Ibe(r,e=po.ServerConnection.makeSettings()){let t=SR(e.baseUrl,r.id),n={method:"PATCH",body:JSON.stringify(r)},i=await po.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await po.ServerConnection.ResponseError.create(i);let o=await i.json();return Jf.updateLegacySessionModel(o),Jf.validateModel(o),o}ui.updateSession=Ibe});var I$=Q(ER=>{"use strict";d();Object.defineProperty(ER,"__esModule",{value:!0});ER.SessionConnection=void 0;var jd=Vi(),Sbe=ci(),b$=_R(),_be=Ql(),hV=class{constructor(e){var t,n,i,o;this._id="",this._path="",this._name="",this._type="",this._kernel=null,this._isDisposed=!1,this._disposed=new jd.Signal(this),this._kernelChanged=new jd.Signal(this),this._statusChanged=new jd.Signal(this),this._connectionStatusChanged=new jd.Signal(this),this._iopubMessage=new jd.Signal(this),this._unhandledMessage=new jd.Signal(this),this._anyMessage=new jd.Signal(this),this._propertyChanged=new jd.Signal(this),this._id=e.model.id,this._name=e.model.name,this._path=e.model.path,this._type=e.model.type,this._username=(t=e.username)!==null&&t!==void 0?t:"",this._clientId=(n=e.clientId)!==null&&n!==void 0?n:_be.UUID.uuid4(),this._connectToKernel=e.connectToKernel,this._kernelConnectionOptions=(i=e.kernelConnectionOptions)!==null&&i!==void 0?i:{},this.serverSettings=(o=e.serverSettings)!==null&&o!==void 0?o:Sbe.ServerConnection.makeSettings(),this.setupKernel(e.model.kernel)}get disposed(){return this._disposed}get kernelChanged(){return this._kernelChanged}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get anyMessage(){return this._anyMessage}get propertyChanged(){return this._propertyChanged}get id(){return this._id}get kernel(){return this._kernel}get path(){return this._path}get type(){return this._type}get name(){return this._name}get model(){return{id:this.id,kernel:this.kernel&&{id:this.kernel.id,name:this.kernel.name},path:this._path,type:this._type,name:this._name}}get isDisposed(){return this._isDisposed}update(e){let t=this.model;if(this._path=e.path,this._name=e.name,this._type=e.type,this._kernel===null&&e.kernel!==null||this._kernel!==null&&e.kernel===null||this._kernel!==null&&e.kernel!==null&&this._kernel.id!==e.kernel.id){this._kernel!==null&&this._kernel.dispose();let n=this._kernel||null;this.setupKernel(e.kernel);let i=this._kernel||null;this._kernelChanged.emit({name:"kernel",oldValue:n,newValue:i})}this._handleModelChange(t)}dispose(){if(!this.isDisposed){if(this._isDisposed=!0,this._disposed.emit(),this._kernel){this._kernel.dispose();let e=this._kernel;this._kernel=null;let t=this._kernel;this._kernelChanged.emit({name:"kernel",oldValue:e,newValue:t})}jd.Signal.clearData(this)}}async setPath(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({path:e})}async setName(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({name:e})}async setType(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({type:e})}async changeKernel(e){if(this.isDisposed)throw new Error("Session is disposed");return await this._patch({kernel:e}),this.kernel}async shutdown(){if(this.isDisposed)throw new Error("Session is disposed");await b$.shutdownSession(this.id,this.serverSettings),this.dispose()}setupKernel(e){if(e===null){this._kernel=null;return}let t=this._connectToKernel(Object.assign(Object.assign({},this._kernelConnectionOptions),{model:e,username:this._username,clientId:this._clientId,serverSettings:this.serverSettings}));this._kernel=t,t.statusChanged.connect(this.onKernelStatus,this),t.connectionStatusChanged.connect(this.onKernelConnectionStatus,this),t.unhandledMessage.connect(this.onUnhandledMessage,this),t.iopubMessage.connect(this.onIOPubMessage,this),t.anyMessage.connect(this.onAnyMessage,this)}onKernelStatus(e,t){this._statusChanged.emit(t)}onKernelConnectionStatus(e,t){this._connectionStatusChanged.emit(t)}onIOPubMessage(e,t){this._iopubMessage.emit(t)}onUnhandledMessage(e,t){this._unhandledMessage.emit(t)}onAnyMessage(e,t){this._anyMessage.emit(t)}async _patch(e){let t=await b$.updateSession(Object.assign(Object.assign({},e),{id:this._id}),this.serverSettings);return this.update(t),t}_handleModelChange(e){e.name!==this._name&&this._propertyChanged.emit("name"),e.type!==this._type&&this._propertyChanged.emit("type"),e.path!==this._path&&this._propertyChanged.emit("path")}};ER.SessionConnection=hV});var E$=Q(CR=>{"use strict";d();Object.defineProperty(CR,"__esModule",{value:!0});CR.SessionManager=void 0;var S$=Fg(),Ebe=Dx(),_$=Vi(),Cbe=js(),wbe=Px(),xbe=I$(),Nx=_R(),gV=class extends wbe.BaseManager{constructor(e){var t;super(e),this._isReady=!1,this._sessionConnections=new Set,this._models=new Map,this._runningChanged=new _$.Signal(this),this._connectionFailure=new _$.Signal(this),this._connectToKernel=n=>this._kernelManager.connectTo(n),this._kernelManager=e.kernelManager,this._pollModels=new Ebe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:SessionManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,await this._kernelManager.ready,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._sessionConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){let t=new xbe.SessionConnection(Object.assign(Object.assign({},e),{connectToKernel:this._connectToKernel,serverSettings:this.serverSettings}));return this._onStarted(t),this._models.has(e.model.id)||this.refreshRunning().catch(()=>{}),t}running(){return S$.iter([...this._models.values()])}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e,t={}){let n=await Nx.startSession(e,this.serverSettings);return await this.refreshRunning(),this.connectTo(Object.assign(Object.assign({},t),{model:n}))}async shutdown(e){await Nx.shutdownSession(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>Nx.shutdownSession(e,this.serverSettings))),await this.refreshRunning()}async stopIfNeeded(e){try{let n=(await Nx.listRunning(this.serverSettings)).filter(i=>i.path===e);if(n.length===1){let i=n[0].id;await this.shutdown(i)}}catch(t){}}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async findByPath(e){for(let t of this._models.values())if(t.path===e)return t;await this.refreshRunning();for(let t of this._models.values())if(t.path===e)return t}async requestRunning(){var e,t;let n;try{n=await Nx.listRunning(this.serverSettings)}catch(i){throw(i instanceof Cbe.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&S$.every(n,i=>{var o,s,a,l;let c=this._models.get(i.id);return c?((o=c.kernel)===null||o===void 0?void 0:o.id)===((s=i.kernel)===null||s===void 0?void 0:s.id)&&((a=c.kernel)===null||a===void 0?void 0:a.name)===((l=i.kernel)===null||l===void 0?void 0:l.name)&&c.name===i.name&&c.path===i.path&&c.type===i.type:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._sessionConnections.forEach(i=>{this._models.has(i.id)?i.update(this._models.get(i.id)):i.dispose()}),this._runningChanged.emit(n))}_onStarted(e){this._sessionConnections.add(e),e.disposed.connect(this._onDisposed,this),e.propertyChanged.connect(this._onChanged,this),e.kernelChanged.connect(this._onChanged,this)}_onDisposed(e){this._sessionConnections.delete(e),this.refreshRunning().catch(()=>{})}_onChanged(){this.refreshRunning().catch(()=>{})}};CR.SessionManager=gV});var vV=Q(Wo=>{"use strict";d();var C$=Wo&&Wo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Dbe=Wo&&Wo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),w$=Wo&&Wo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&C$(e,r,t);return Dbe(e,r),e},Pbe=Wo&&Wo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&C$(e,r,t)};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.SessionAPI=Wo.Session=void 0;var Tbe=w$(g$());Wo.Session=Tbe;var kbe=w$(_R());Wo.SessionAPI=kbe;Pbe(E$(),Wo)});var x$=Q(wR=>{"use strict";d();Object.defineProperty(wR,"__esModule",{value:!0});wR.DataConnector=void 0;var yV=class{async list(e){throw new Error("DataConnector#list method has not been implemented.")}async remove(e){throw new Error("DataConnector#remove method has not been implemented.")}async save(e,t){throw new Error("DataConnector#save method has not been implemented.")}};wR.DataConnector=yV});var P$=Q(D$=>{"use strict";d();Object.defineProperty(D$,"__esModule",{value:!0})});var k$=Q(DR=>{"use strict";d();Object.defineProperty(DR,"__esModule",{value:!0});DR.RestorablePool=void 0;var Nbe=Ql(),T$=DW(),xR=Vi(),bV=class{constructor(e){this._added=new xR.Signal(this),this._current=null,this._currentChanged=new xR.Signal(this),this._hasRestored=!1,this._isDisposed=!1,this._objects=new Set,this._restore=null,this._restored=new Nbe.PromiseDelegate,this._updated=new xR.Signal(this),this.namespace=e.namespace}get added(){return this._added}get current(){return this._current}set current(e){this._current!==e&&e!==null&&this._objects.has(e)&&(this._current=e,this._currentChanged.emit(this._current))}get currentChanged(){return this._currentChanged}get isDisposed(){return this._isDisposed}get restored(){return this._restored.promise}get size(){return this._objects.size}get updated(){return this._updated}async add(e){var t,n;if(e.isDisposed){let i="A disposed object cannot be added.";throw console.warn(i,e),new Error(i)}if(this._objects.has(e)){let i="This object already exists in the pool.";throw console.warn(i,e),new Error(i)}if(this._objects.add(e),e.disposed.connect(this._onInstanceDisposed,this),!ou.injectedProperty.get(e)){if(this._restore){let{connector:i}=this._restore,o=this._restore.name(e);if(o){let s=`${this.namespace}:${o}`,a=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);ou.nameProperty.set(e,s),await i.save(s,{data:a})}}this._added.emit(e)}}dispose(){this.isDisposed||(this._current=null,this._isDisposed=!0,this._objects.clear(),xR.Signal.clearData(this))}find(e){let t=this._objects.values();for(let n of t)if(e(n))return n}forEach(e){this._objects.forEach(e)}filter(e){let t=[];return this.forEach(n=>{e(n)&&t.push(n)}),t}inject(e){return ou.injectedProperty.set(e,!0),this.add(e)}has(e){return this._objects.has(e)}async restore(e){if(this._hasRestored)throw new Error("This pool has already been restored.");this._hasRestored=!0;let{command:t,connector:n,registry:i,when:o}=e,s=this.namespace,a=o?[n.list(s)].concat(o):[n.list(s)];this._restore=e;let[l]=await Promise.all(a),c=await Promise.all(l.ids.map(async(u,p)=>{let f=l.values[p],m=f&&f.data;return m===void 0?n.remove(u):i.execute(t,m).catch(()=>n.remove(u))}));return this._restored.resolve(),c}async save(e){var t,n;let i=ou.injectedProperty.get(e);if(!this._restore||!this.has(e)||i)return;let{connector:o}=this._restore,s=this._restore.name(e),a=ou.nameProperty.get(e),l=s?`${this.namespace}:${s}`:"";if(a&&a!==l&&await o.remove(a),ou.nameProperty.set(e,l),l){let c=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);await o.save(l,{data:c})}a!==l&&this._updated.emit(e)}_onInstanceDisposed(e){if(this._objects.delete(e),e===this._current&&(this._current=null,this._currentChanged.emit(this._current)),ou.injectedProperty.get(e)||!this._restore)return;let{connector:t}=this._restore,n=ou.nameProperty.get(e);n&&t.remove(n)}};DR.RestorablePool=bV;var ou;(function(r){r.injectedProperty=new T$.AttachedProperty({name:"injected",create:()=>!1}),r.nameProperty=new T$.AttachedProperty({name:"name",create:()=>""})})(ou||(ou={}))});var N$=Q(bI=>{"use strict";d();Object.defineProperty(bI,"__esModule",{value:!0});bI.StateDB=void 0;var Rbe=Vi(),PR=class r{constructor(e={}){this._changed=new Rbe.Signal(this);let{connector:t,transform:n}=e;this._connector=t||new r.Connector,n?this._ready=n.then(i=>{let{contents:o,type:s}=i;switch(s){case"cancel":return;case"clear":return this._clear();case"merge":return this._merge(o||{});case"overwrite":return this._overwrite(o||{});default:return}}):this._ready=Promise.resolve(void 0)}get changed(){return this._changed}async clear(){await this._ready,await this._clear()}async fetch(e){return await this._ready,this._fetch(e)}async list(e){return await this._ready,this._list(e)}async remove(e){await this._ready,await this._remove(e),this._changed.emit({id:e,type:"remove"})}async save(e,t){await this._ready,await this._save(e,t),this._changed.emit({id:e,type:"save"})}async toJSON(){await this._ready;let{ids:e,values:t}=await this._list();return t.reduce((n,i,o)=>(n[e[o]]=i,n),{})}async _clear(){await Promise.all((await this._list()).ids.map(e=>this._remove(e)))}async _fetch(e){let t=await this._connector.fetch(e);if(t)return JSON.parse(t).v}async _list(e=""){let{ids:t,values:n}=await this._connector.list(e);return{ids:t,values:n.map(i=>JSON.parse(i).v)}}async _merge(e){await Promise.all(Object.keys(e).map(t=>e[t]&&this._save(t,e[t])))}async _overwrite(e){await this._clear(),await this._merge(e)}async _remove(e){return this._connector.remove(e)}async _save(e,t){return this._connector.save(e,JSON.stringify({v:t}))}};bI.StateDB=PR;(function(r){class e{constructor(){this._storage={}}async fetch(n){return this._storage[n]}async list(n=""){return Object.keys(this._storage).reduce((i,o)=>((n===""||n===o.split(":")[0])&&(i.ids.push(o),i.values.push(this._storage[o])),i),{ids:[],values:[]})}async remove(n){delete this._storage[n]}async save(n,i){this._storage[n]=i}}r.Connector=e})(PR=bI.StateDB||(bI.StateDB={}))});var R$=Q(TR=>{"use strict";d();Object.defineProperty(TR,"__esModule",{value:!0});TR.IStateDB=void 0;var Abe=Ql();TR.IStateDB=new Abe.Token("@jupyterlab/coreutils:IStateDB")});var IV=Q(Zl=>{"use strict";d();var Mbe=Zl&&Zl.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Rx=Zl&&Zl.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Mbe(e,r,t)};Object.defineProperty(Zl,"__esModule",{value:!0});Rx(x$(),Zl);Rx(P$(),Zl);Rx(k$(),Zl);Rx(N$(),Zl);Rx(R$(),Zl)});var _V=Q(NR=>{"use strict";d();Object.defineProperty(NR,"__esModule",{value:!0});NR.SettingManager=void 0;var Obe=hs(),Lbe=IV(),kR=js(),Kbe="api/settings",SV=class extends Lbe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:kR.ServerConnection.makeSettings()}async fetch(e){if(!e)throw new Error("Plugin `id` parameter is required for settings fetch.");let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=kR.ServerConnection,a=n+i,l=Ax.url(a,e),c=await o(l,{},t);if(c.status!==200)throw await s.create(c);return c.json()}async list(){var e,t;let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=kR.ServerConnection,l=i+o,c=Ax.url(l,""),u=await s(c,{},n);if(u.status!==200)throw new a(u);let p=await u.json(),f=(t=(e=p==null?void 0:p.settings)===null||e===void 0?void 0:e.map(h=>(h.data={composite:{},user:{}},h)))!==null&&t!==void 0?t:[];return{ids:f.map(h=>h.id),values:f}}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=kR.ServerConnection,l=i+o,c=Ax.url(l,e),u={body:JSON.stringify({raw:t}),method:"PUT"},p=await s(c,u,n);if(p.status!==204)throw new a(p)}};NR.SettingManager=SV;var Ax;(function(r){function e(t,n){return Obe.URLExt.join(t,Kbe,n)}r.url=e})(Ax||(Ax={}))});var Ox=Q(Vo=>{"use strict";d();Object.defineProperty(Vo,"__esModule",{value:!0});Vo.shutdownTerminal=Vo.listRunning=Vo.startNew=Vo.isAvailable=Vo.TERMINAL_SERVICE_URL=void 0;var RR=hs(),Bd=js();Vo.TERMINAL_SERVICE_URL="api/terminals";function A$(){return String(RR.PageConfig.getOption("terminalsAvailable")).toLowerCase()==="true"}Vo.isAvailable=A$;async function Fbe(r=Bd.ServerConnection.makeSettings()){Mx.errorIfNotAvailable();let e=RR.URLExt.join(r.baseUrl,Vo.TERMINAL_SERVICE_URL),t={method:"POST"},n=await Bd.ServerConnection.makeRequest(e,t,r);if(n.status!==200)throw await Bd.ServerConnection.ResponseError.create(n);return await n.json()}Vo.startNew=Fbe;async function Ube(r=Bd.ServerConnection.makeSettings()){Mx.errorIfNotAvailable();let e=RR.URLExt.join(r.baseUrl,Vo.TERMINAL_SERVICE_URL),t=await Bd.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await Bd.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid terminal list");return n}Vo.listRunning=Ube;async function Wbe(r,e=Bd.ServerConnection.makeSettings()){var t;Mx.errorIfNotAvailable();let n=RR.URLExt.join(e.baseUrl,Vo.TERMINAL_SERVICE_URL,r),i={method:"DELETE"},o=await Bd.ServerConnection.makeRequest(n,i,e);if(o.status===404){let a=(t=(await o.json()).message)!==null&&t!==void 0?t:`The terminal session "${r}"" does not exist on the server`;console.warn(a)}else if(o.status!==204)throw await Bd.ServerConnection.ResponseError.create(o)}Vo.shutdownTerminal=Wbe;var Mx;(function(r){function e(){if(!A$())throw new Error("Terminals Unavailable")}r.errorIfNotAvailable=e})(Mx||(Mx={}))});var M$=Q(AR=>{"use strict";d();Object.defineProperty(AR,"__esModule",{value:!0});AR.isAvailable=void 0;var Vbe=Ox();Object.defineProperty(AR,"isAvailable",{enumerable:!0,get:function(){return Vbe.isAvailable}})});var K$=Q(OR=>{"use strict";d();Object.defineProperty(OR,"__esModule",{value:!0});OR.TerminalConnection=void 0;var O$=hs(),jbe=Ql(),MR=Vi(),Bbe=ci(),L$=Ox(),EV=class r{constructor(e){var t;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let n=this._name,i=this.serverSettings,o=O$.URLExt.join(i.wsUrl,"terminals","websocket",encodeURIComponent(n)),s=i.token;i.appendToken&&s!==""&&(o=o+`?token=${encodeURIComponent(s)}`),this._ws=new i.WebSocket(o),this._ws.onmessage=this._onWSMessage,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSMessage=n=>{if(this._isDisposed)return;let i=JSON.parse(n.data);if(i[0]==="disconnect"&&this.dispose(),this._connectionStatus==="connecting"){i[0]==="setup"&&this._updateConnectionStatus("connected");return}this._messageReceived.emit({type:i[0],content:i.slice(1)})},this._onWSClose=n=>{console.warn(`Terminal websocket closed: ${n.code}`),this.isDisposed||this._reconnect()},this._connectionStatus="connecting",this._connectionStatusChanged=new MR.Signal(this),this._isDisposed=!1,this._disposed=new MR.Signal(this),this._messageReceived=new MR.Signal(this),this._reconnectTimeout=null,this._ws=null,this._noOp=()=>{},this._reconnectLimit=7,this._reconnectAttempt=0,this._pendingMessages=[],this._name=e.model.name,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Bbe.ServerConnection.makeSettings(),this._createSocket()}get disposed(){return this._disposed}get messageReceived(){return this._messageReceived}get name(){return this._name}get model(){return{name:this._name}}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearSocket(),MR.Signal.clearData(this))}send(e){this._sendMessage(e)}_sendMessage(e,t=!0){if(!(this._isDisposed||!e.content))if(this.connectionStatus==="connected"&&this._ws){let n=[e.type,...e.content];this._ws.send(JSON.stringify(n))}else if(t)this._pendingMessages.push(e);else throw new Error(`Could not send message: ${JSON.stringify(e)}`)}_sendPending(){for(;this.connectionStatus==="connected"&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}reconnect(){this._errorIfDisposed();let e=new jbe.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Terminal connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=CV.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.error(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}async shutdown(){await L$.shutdownTerminal(this.name,this.serverSettings),this.dispose()}clone(){return new r(this)}_updateConnectionStatus(e){this._connectionStatus!==e&&(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),e==="connected"&&this._sendPending(),this._connectionStatusChanged.emit(e))}_errorIfDisposed(){if(this.isDisposed)throw new Error("Terminal connection is disposed")}get connectionStatusChanged(){return this._connectionStatusChanged}get connectionStatus(){return this._connectionStatus}};OR.TerminalConnection=EV;var CV;(function(r){function e(n,i){return O$.URLExt.join(n,L$.TERMINAL_SERVICE_URL,encodeURIComponent(i))}r.getTermUrl=e;function t(n,i){return n=Math.ceil(n),i=Math.floor(i),Math.floor(Math.random()*(i-n+1))+n}r.getRandomIntInclusive=t})(CV||(CV={}))});var U$=Q(LR=>{"use strict";d();Object.defineProperty(LR,"__esModule",{value:!0});LR.TerminalManager=void 0;var Hbe=Fg(),Jbe=Dx(),F$=Vi(),qbe=ci(),Gbe=Px(),Lx=Ox(),Ybe=K$(),wV=class extends Gbe.BaseManager{constructor(e={}){var t;if(super(e),this._isReady=!1,this._names=[],this._terminalConnections=new Set,this._runningChanged=new F$.Signal(this),this._connectionFailure=new F$.Signal(this),!this.isAvailable()){this._ready=Promise.reject("Terminals unavailable"),this._ready.catch(n=>{});return}this._pollModels=new Jbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:TerminalManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._names.length=0,this._terminalConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}isAvailable(){return Lx.isAvailable()}connectTo(e){let t=new Ybe.TerminalConnection(Object.assign(Object.assign({},e),{serverSettings:this.serverSettings}));return this._onStarted(t),this._names.includes(e.model.name)||this.refreshRunning().catch(()=>{}),t}running(){return Hbe.iter(this._models)}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(){let e=await Lx.startNew(this.serverSettings);return await this.refreshRunning(),this.connectTo({model:e})}async shutdown(e){await Lx.shutdownTerminal(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all(this._names.map(e=>Lx.shutdownTerminal(e,this.serverSettings))),await this.refreshRunning()}async requestRunning(){var e,t;let n;try{n=await Lx.listRunning(this.serverSettings)}catch(o){throw(o instanceof qbe.ServerConnection.NetworkError||((e=o.response)===null||e===void 0?void 0:e.status)===503||((t=o.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(o),o}if(this.isDisposed)return;let i=n.map(({name:o})=>o).sort();i!==this._names&&(this._names=i,this._terminalConnections.forEach(o=>{i.includes(o.name)||o.dispose()}),this._runningChanged.emit(this._models))}_onStarted(e){this._terminalConnections.add(e),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._terminalConnections.delete(e),this.refreshRunning().catch(()=>{})}get _models(){return this._names.map(e=>({name:e}))}};LR.TerminalManager=wV});var xV=Q(jo=>{"use strict";d();var W$=jo&&jo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),$be=jo&&jo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),V$=jo&&jo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&W$(e,r,t);return $be(e,r),e},zbe=jo&&jo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&W$(e,r,t)};Object.defineProperty(jo,"__esModule",{value:!0});jo.TerminalAPI=jo.Terminal=void 0;var Qbe=V$(M$());jo.Terminal=Qbe;var Xbe=V$(Ox());jo.TerminalAPI=Xbe;zbe(U$(),jo)});var PV=Q(KR=>{"use strict";d();Object.defineProperty(KR,"__esModule",{value:!0});KR.WorkspaceManager=void 0;var Zbe=hs(),eIe=IV(),Kx=js(),tIe="api/workspaces",DV=class extends eIe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Kx.ServerConnection.makeSettings()}async fetch(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Kx.ServerConnection,a=n+i,l=II.url(a,e),c=await o(l,{},t);if(c.status!==200)throw await s.create(c);return c.json()}async list(){let{serverSettings:e}=this,{baseUrl:t,appUrl:n}=e,{makeRequest:i,ResponseError:o}=Kx.ServerConnection,s=t+n,a=II.url(s,""),l=await i(a,{},e);if(l.status!==200)throw await o.create(l);return(await l.json()).workspaces}async remove(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Kx.ServerConnection,a=n+i,l=II.url(a,e),u=await o(l,{method:"DELETE"},t);if(u.status!==204)throw await s.create(u)}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=Kx.ServerConnection,l=i+o,c=II.url(l,e),u={body:JSON.stringify(t),method:"PUT"},p=await s(c,u,n);if(p.status!==204)throw await a.create(p)}};KR.WorkspaceManager=DV;var II;(function(r){function e(t,n){return Zbe.URLExt.join(t,tIe,n)}r.url=e})(II||(II={}))});var B$=Q(FR=>{"use strict";d();Object.defineProperty(FR,"__esModule",{value:!0});FR.ServiceManager=void 0;var j$=Vi(),rIe=m$(),nIe=fV(),iIe=WW(),oIe=mR(),sIe=vV(),aIe=_V(),lIe=xV(),cIe=js(),uIe=PV(),dIe=lV(),TV=class{constructor(e={}){var t,n;this._isDisposed=!1,this._connectionFailure=new j$.Signal(this),this._isReady=!1;let i=e.defaultDrive,o=(t=e.serverSettings)!==null&&t!==void 0?t:cIe.ServerConnection.makeSettings(),s=(n=e.standby)!==null&&n!==void 0?n:"when-hidden",a={defaultDrive:i,serverSettings:o,standby:s},l=new dIe.KernelManager(a);this.serverSettings=o,this.contents=new iIe.ContentsManager(a),this.sessions=new sIe.SessionManager(Object.assign(Object.assign({},a),{kernelManager:l})),this.settings=new aIe.SettingManager(a),this.terminals=new lIe.TerminalManager(a),this.builder=new rIe.BuildManager(a),this.workspaces=new uIe.WorkspaceManager(a),this.nbconvert=new nIe.NbConvertManager(a),this.kernelspecs=new oIe.KernelSpecManager(a),this.kernelspecs.connectionFailure.connect(this._onConnectionFailure,this),this.sessions.connectionFailure.connect(this._onConnectionFailure,this),this.terminals.connectionFailure.connect(this._onConnectionFailure,this);let c=[this.sessions.ready,this.kernelspecs.ready];this.terminals.isAvailable()&&c.push(this.terminals.ready),this._readyPromise=Promise.all(c).then(()=>{this._isReady=!0})}get connectionFailure(){return this._connectionFailure}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,j$.Signal.clearData(this),this.contents.dispose(),this.sessions.dispose(),this.terminals.dispose())}get isReady(){return this._isReady}get ready(){return this._readyPromise}_onConnectionFailure(e,t){this._connectionFailure.emit(t)}};FR.ServiceManager=TV});var ci=Q(Hi=>{"use strict";d();var pIe=Hi&&Hi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ec=Hi&&Hi.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pIe(e,r,t)};Object.defineProperty(Hi,"__esModule",{value:!0});ec(KY(),Hi);ec(WW(),Hi);ec(lV(),Hi);ec(mR(),Hi);ec(B$(),Hi);ec(js(),Hi);ec(vV(),Hi);ec(_V(),Hi);ec(xV(),Hi);ec(PV(),Hi);ec(fV(),Hi)});var RV=Q((wGe,Y$)=>{"use strict";d();var q$=Array.isArray,G$=Object.keys,mIe=Object.prototype.hasOwnProperty;Y$.exports=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=q$(e),i=q$(t),o,s,a;if(n&&i){if(s=e.length,s!=t.length)return!1;for(o=s;o--!==0;)if(!r(e[o],t[o]))return!1;return!0}if(n!=i)return!1;var l=e instanceof Date,c=t instanceof Date;if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var u=e instanceof RegExp,p=t instanceof RegExp;if(u!=p)return!1;if(u&&p)return e.toString()==t.toString();var f=G$(e);if(s=f.length,s!==G$(t).length)return!1;for(o=s;o--!==0;)if(!mIe.call(t,f[o]))return!1;for(o=s;o--!==0;)if(a=f[o],!r(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}});var $V=Q(tm=>{"use strict";d();Object.defineProperty(tm,"__esModule",{value:!0});tm.TargetPopulation=tm.Filters=tm.VSCodeFilterProvider=void 0;var b1=require("vscode"),YV=class r{constructor(e,t,n){this.extensionName=e,this.extensionVersion=t,this.targetPopulation=n}static trimVersionSuffix(e){let t=/\-[a-zA-Z0-9]+$/;return e.split(t)[0]}getFilterValue(e){switch(e){case hu.ApplicationVersion:return r.trimVersionSuffix(b1.version);case hu.Build:return b1.env.appName;case hu.ClientId:return b1.env.machineId;case hu.ExtensionName:return this.extensionName;case hu.ExtensionVersion:return r.trimVersionSuffix(this.extensionVersion);case hu.Language:return b1.env.language;case hu.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,t=Object.values(hu);for(let n of t)e.set(n,this.getFilterValue(n));return e}};tm.VSCodeFilterProvider=YV;var hu;(function(r){r.Market="X-MSEdge-Market",r.CorpNet="X-FD-Corpnet",r.ApplicationVersion="X-VSCode-AppVersion",r.Build="X-VSCode-Build",r.ClientId="X-MSEdge-ClientId",r.ExtensionName="X-VSCode-ExtensionName",r.ExtensionVersion="X-VSCode-ExtensionVersion",r.Language="X-VSCode-Language",r.TargetPopulation="X-VSCode-TargetPopulation"})(hu||(tm.Filters=hu={}));var Yz;(function(r){r.Team="team",r.Internal="internal",r.Insiders="insider",r.Public="public"})(Yz||(tm.TargetPopulation=Yz={}))});var $z=Q(I1=>{"use strict";d();Object.defineProperty(I1,"__esModule",{value:!0});I1.BaseFeatureProvider=void 0;var zV=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};I1.BaseFeatureProvider=zV});var zz=Q(S1=>{"use strict";d();Object.defineProperty(S1,"__esModule",{value:!0});S1.FilteredFeatureProvider=void 0;var UIe=$z(),QV=class extends UIe.BaseFeatureProvider{constructor(e,t){super(e),this.telemetry=e,this.filterProviders=t,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let t of this.filterProviders){let n=t.getFilters();for(let i of n.keys()){let o=n.get(i);e.set(i,o)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let t=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",t]])),this.cachedTelemetryEvents.push(e)}};S1.FilteredFeatureProvider=QV});var Qz=Q(rm=>{"use strict";d();Object.defineProperty(rm,"__esModule",{value:!0});rm.TasApiFeatureProvider=rm.TASAPI_FETCHERROR_EVENTNAME=void 0;var WIe=zz();rm.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var XV="ErrorType",ZV=class extends WIe.FilteredFeatureProvider{constructor(e,t,n){super(t,n),this.httpClient=e,this.telemetry=t,this.filterProviders=n}async fetch(){let e=this.getFilters(),t={};for(let a of e.keys()){let l=e.get(a);t[a]=l}let n;try{n=await this.httpClient.get({headers:t})}catch(a){let l=a,c=new Map;l.response?c.set(XV,"ServerError"):l.request?c.set(XV,"NoResponse"):c.set(XV,"GenericError"),this.telemetry.postEvent(rm.TASAPI_FETCHERROR_EVENTNAME,c)}if(!n)throw Error(rm.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(t);let i=n.data,o=i.Configs,s=[];for(let a of o)if(a.Parameters)for(let l of Object.keys(a.Parameters)){let c=l+(a.Parameters[l]?"":"cf");s.includes(c)||s.push(c)}return{features:s,assignmentContext:i.AssignmentContext,configs:o}}};rm.TasApiFeatureProvider=ZV});var RQ=Q((kQ,NQ)=>{"use strict";d();function cQ(r,e){return function(){return r.apply(e,arguments)}}var{toString:VIe}=Object.prototype,{getPrototypeOf:dj}=Object,w1=(r=>e=>{let t=VIe.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),vu=r=>(r=r.toLowerCase(),e=>w1(e)===r),x1=r=>e=>typeof e===r,{isArray:VI}=Array,Qx=x1("undefined");function jIe(r){return r!==null&&!Qx(r)&&r.constructor!==null&&!Qx(r.constructor)&&Fa(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}var uQ=vu("ArrayBuffer");function BIe(r){let e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&uQ(r.buffer),e}var HIe=x1("string"),Fa=x1("function"),dQ=x1("number"),D1=r=>r!==null&&typeof r=="object",JIe=r=>r===!0||r===!1,_1=r=>{if(w1(r)!=="object")return!1;let e=dj(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},qIe=vu("Date"),GIe=vu("File"),YIe=vu("Blob"),$Ie=vu("FileList"),zIe=r=>D1(r)&&Fa(r.pipe),QIe=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||Fa(r.append)&&((e=w1(r))==="formdata"||e==="object"&&Fa(r.toString)&&r.toString()==="[object FormData]"))},XIe=vu("URLSearchParams"),ZIe=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xx(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r=="undefined")return;let n,i;if(typeof r!="object"&&(r=[r]),VI(r))for(n=0,i=r.length;n<i;n++)e.call(null,r[n],n,r);else{let o=t?Object.getOwnPropertyNames(r):Object.keys(r),s=o.length,a;for(n=0;n<s;n++)a=o[n],e.call(null,r[a],a,r)}}function pQ(r,e){e=e.toLowerCase();let t=Object.keys(r),n=t.length,i;for(;n-- >0;)if(i=t[n],e===i.toLowerCase())return i;return null}var fQ=(()=>typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:kQ)(),mQ=r=>!Qx(r)&&r!==fQ;function ij(){let{caseless:r}=mQ(this)&&this||{},e={},t=(n,i)=>{let o=r&&pQ(e,i)||i;_1(e[o])&&_1(n)?e[o]=ij(e[o],n):_1(n)?e[o]=ij({},n):VI(n)?e[o]=n.slice():e[o]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Xx(arguments[n],t);return e}var eSe=(r,e,t,{allOwnKeys:n}={})=>(Xx(e,(i,o)=>{t&&Fa(i)?r[o]=cQ(i,t):r[o]=i},{allOwnKeys:n}),r),tSe=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),rSe=(r,e,t,n)=>{r.prototype=Object.create(e.prototype,n),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},nSe=(r,e,t,n)=>{let i,o,s,a={};if(e=e||{},r==null)return e;do{for(i=Object.getOwnPropertyNames(r),o=i.length;o-- >0;)s=i[o],(!n||n(s,r,e))&&!a[s]&&(e[s]=r[s],a[s]=!0);r=t!==!1&&dj(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},iSe=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;let n=r.indexOf(e,t);return n!==-1&&n===t},oSe=r=>{if(!r)return null;if(VI(r))return r;let e=r.length;if(!dQ(e))return null;let t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},sSe=(r=>e=>r&&e instanceof r)(typeof Uint8Array!="undefined"&&dj(Uint8Array)),aSe=(r,e)=>{let n=(r&&r[Symbol.iterator]).call(r),i;for(;(i=n.next())&&!i.done;){let o=i.value;e.call(r,o[0],o[1])}},lSe=(r,e)=>{let t,n=[];for(;(t=r.exec(e))!==null;)n.push(t);return n},cSe=vu("HTMLFormElement"),uSe=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,i){return n.toUpperCase()+i}),Xz=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),dSe=vu("RegExp"),hQ=(r,e)=>{let t=Object.getOwnPropertyDescriptors(r),n={};Xx(t,(i,o)=>{let s;(s=e(i,o,r))!==!1&&(n[o]=s||i)}),Object.defineProperties(r,n)},pSe=r=>{hQ(r,(e,t)=>{if(Fa(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;let n=r[t];if(Fa(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},fSe=(r,e)=>{let t={},n=i=>{i.forEach(o=>{t[o]=!0})};return VI(r)?n(r):n(String(r).split(e)),t},mSe=()=>{},hSe=(r,e)=>(r=+r,Number.isFinite(r)?r:e),ej="abcdefghijklmnopqrstuvwxyz",Zz="0123456789",gQ={DIGIT:Zz,ALPHA:ej,ALPHA_DIGIT:ej+ej.toUpperCase()+Zz},gSe=(r=16,e=gQ.ALPHA_DIGIT)=>{let t="",{length:n}=e;for(;r--;)t+=e[Math.random()*n|0];return t};function vSe(r){return!!(r&&Fa(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}var ySe=r=>{let e=new Array(10),t=(n,i)=>{if(D1(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[i]=n;let o=VI(n)?[]:{};return Xx(n,(s,a)=>{let l=t(s,i+1);!Qx(l)&&(o[a]=l)}),e[i]=void 0,o}}return n};return t(r,0)},bSe=vu("AsyncFunction"),ISe=r=>r&&(D1(r)||Fa(r))&&Fa(r.then)&&Fa(r.catch),ge={isArray:VI,isArrayBuffer:uQ,isBuffer:jIe,isFormData:QIe,isArrayBufferView:BIe,isString:HIe,isNumber:dQ,isBoolean:JIe,isObject:D1,isPlainObject:_1,isUndefined:Qx,isDate:qIe,isFile:GIe,isBlob:YIe,isRegExp:dSe,isFunction:Fa,isStream:zIe,isURLSearchParams:XIe,isTypedArray:sSe,isFileList:$Ie,forEach:Xx,merge:ij,extend:eSe,trim:ZIe,stripBOM:tSe,inherits:rSe,toFlatObject:nSe,kindOf:w1,kindOfTest:vu,endsWith:iSe,toArray:oSe,forEachEntry:aSe,matchAll:lSe,isHTMLForm:cSe,hasOwnProperty:Xz,hasOwnProp:Xz,reduceDescriptors:hQ,freezeMethods:pSe,toObjectSet:fSe,toCamelCase:uSe,noop:mSe,toFiniteNumber:hSe,findKey:pQ,global:fQ,isContextDefined:mQ,ALPHABET:gQ,generateString:gSe,isSpecCompliantForm:vSe,toJSONObject:ySe,isAsyncFn:bSe,isThenable:ISe};function lr(r,e,t,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),i&&(this.response=i)}ge.inherits(lr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ge.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var vQ=lr.prototype,yQ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{yQ[r]={value:r}});Object.defineProperties(lr,yQ);Object.defineProperty(vQ,"isAxiosError",{value:!0});lr.from=(r,e,t,n,i,o)=>{let s=Object.create(vQ);return ge.toFlatObject(r,s,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),lr.call(s,r.message,e,t,n,i),s.cause=r,s.name=r.name,o&&Object.assign(s,o),s};var SSe=null;function oj(r){return ge.isPlainObject(r)||ge.isArray(r)}function bQ(r){return ge.endsWith(r,"[]")?r.slice(0,-2):r}function eQ(r,e,t){return r?r.concat(e).map(function(i,o){return i=bQ(i),!t&&o?"["+i+"]":i}).join(t?".":""):e}function _Se(r){return ge.isArray(r)&&!r.some(oj)}var ESe=ge.toFlatObject(ge,{},null,function(e){return/^is[A-Z]/.test(e)});function P1(r,e,t){if(!ge.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=ge.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,v){return!ge.isUndefined(v[g])});let n=t.metaTokens,i=t.visitor||u,o=t.dots,s=t.indexes,l=(t.Blob||typeof Blob!="undefined"&&Blob)&&ge.isSpecCompliantForm(e);if(!ge.isFunction(i))throw new TypeError("visitor must be a function");function c(h){if(h===null)return"";if(ge.isDate(h))return h.toISOString();if(!l&&ge.isBlob(h))throw new lr("Blob is not supported. Use a Buffer instead.");return ge.isArrayBuffer(h)||ge.isTypedArray(h)?l&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function u(h,g,v){let I=h;if(h&&!v&&typeof h=="object"){if(ge.endsWith(g,"{}"))g=n?g:g.slice(0,-2),h=JSON.stringify(h);else if(ge.isArray(h)&&_Se(h)||(ge.isFileList(h)||ge.endsWith(g,"[]"))&&(I=ge.toArray(h)))return g=bQ(g),I.forEach(function(x,D){!(ge.isUndefined(x)||x===null)&&e.append(s===!0?eQ([g],D,o):s===null?g:g+"[]",c(x))}),!1}return oj(h)?!0:(e.append(eQ(v,g,o),c(h)),!1)}let p=[],f=Object.assign(ESe,{defaultVisitor:u,convertValue:c,isVisitable:oj});function m(h,g){if(!ge.isUndefined(h)){if(p.indexOf(h)!==-1)throw Error("Circular reference detected in "+g.join("."));p.push(h),ge.forEach(h,function(I,S){(!(ge.isUndefined(I)||I===null)&&i.call(e,I,ge.isString(S)?S.trim():S,g,f))===!0&&m(I,g?g.concat(S):[S])}),p.pop()}}if(!ge.isObject(r))throw new TypeError("data must be an object");return m(r),e}function tQ(r){let e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function pj(r,e){this._pairs=[],r&&P1(r,this,e)}var IQ=pj.prototype;IQ.append=function(e,t){this._pairs.push([e,t])};IQ.toString=function(e){let t=e?function(n){return e.call(this,n,tQ)}:tQ;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function CSe(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function SQ(r,e,t){if(!e)return r;let n=t&&t.encode||CSe,i=t&&t.serialize,o;if(i?o=i(e,t):o=ge.isURLSearchParams(e)?e.toString():new pj(e,t).toString(n),o){let s=r.indexOf("#");s!==-1&&(r=r.slice(0,s)),r+=(r.indexOf("?")===-1?"?":"&")+o}return r}var sj=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ge.forEach(this.handlers,function(n){n!==null&&e(n)})}},rQ=sj,_Q={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wSe=typeof URLSearchParams!="undefined"?URLSearchParams:pj,xSe=typeof FormData!="undefined"?FormData:null,DSe=typeof Blob!="undefined"?Blob:null,PSe={isBrowser:!0,classes:{URLSearchParams:wSe,FormData:xSe,Blob:DSe},protocols:["http","https","file","blob","url","data"]},EQ=typeof window!="undefined"&&typeof document!="undefined",TSe=(r=>EQ&&["ReactNative","NativeScript","NS"].indexOf(r)<0)(typeof navigator!="undefined"&&navigator.product),kSe=(()=>typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),NSe=Object.freeze({__proto__:null,hasBrowserEnv:EQ,hasStandardBrowserWebWorkerEnv:kSe,hasStandardBrowserEnv:TSe}),gu={...NSe,...PSe};function RSe(r,e){return P1(r,new gu.classes.URLSearchParams,Object.assign({visitor:function(t,n,i,o){return gu.isNode&&ge.isBuffer(t)?(this.append(n,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function ASe(r){return ge.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function MSe(r){let e={},t=Object.keys(r),n,i=t.length,o;for(n=0;n<i;n++)o=t[n],e[o]=r[o];return e}function CQ(r){function e(t,n,i,o){let s=t[o++],a=Number.isFinite(+s),l=o>=t.length;return s=!s&&ge.isArray(i)?i.length:s,l?(ge.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!a):((!i[s]||!ge.isObject(i[s]))&&(i[s]=[]),e(t,n,i[s],o)&&ge.isArray(i[s])&&(i[s]=MSe(i[s])),!a)}if(ge.isFormData(r)&&ge.isFunction(r.entries)){let t={};return ge.forEachEntry(r,(n,i)=>{e(ASe(n),i,t,0)}),t}return null}function OSe(r,e,t){if(ge.isString(r))try{return(e||JSON.parse)(r),ge.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(r)}var fj={transitional:_Q,adapter:["xhr","http"],transformRequest:[function(e,t){let n=t.getContentType()||"",i=n.indexOf("application/json")>-1,o=ge.isObject(e);if(o&&ge.isHTMLForm(e)&&(e=new FormData(e)),ge.isFormData(e))return i&&i?JSON.stringify(CQ(e)):e;if(ge.isArrayBuffer(e)||ge.isBuffer(e)||ge.isStream(e)||ge.isFile(e)||ge.isBlob(e))return e;if(ge.isArrayBufferView(e))return e.buffer;if(ge.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return RSe(e,this.formSerializer).toString();if((a=ge.isFileList(e))||n.indexOf("multipart/form-data")>-1){let l=this.env&&this.env.FormData;return P1(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return o||i?(t.setContentType("application/json",!1),OSe(e)):e}],transformResponse:[function(e){let t=this.transitional||fj.transitional,n=t&&t.forcedJSONParsing,i=this.responseType==="json";if(e&&ge.isString(e)&&(n&&!this.responseType||i)){let s=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(s)throw a.name==="SyntaxError"?lr.from(a,lr.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:gu.classes.FormData,Blob:gu.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ge.forEach(["delete","get","head","post","put","patch"],r=>{fj.headers[r]={}});var mj=fj,LSe=ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),KSe=r=>{let e={},t,n,i;return r&&r.split(`
`).forEach(function(s){i=s.indexOf(":"),t=s.substring(0,i).trim().toLowerCase(),n=s.substring(i+1).trim(),!(!t||e[t]&&LSe[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e},nQ=Symbol("internals");function zx(r){return r&&String(r).trim().toLowerCase()}function E1(r){return r===!1||r==null?r:ge.isArray(r)?r.map(E1):String(r)}function FSe(r){let e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,n;for(;n=t.exec(r);)e[n[1]]=n[2];return e}var USe=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function tj(r,e,t,n,i){if(ge.isFunction(n))return n.call(this,e,t);if(i&&(e=t),!!ge.isString(e)){if(ge.isString(n))return e.indexOf(n)!==-1;if(ge.isRegExp(n))return n.test(e)}}function WSe(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function VSe(r,e){let t=ge.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+t,{value:function(i,o,s){return this[n].call(this,e,i,o,s)},configurable:!0})})}var FI=class{constructor(e){e&&this.set(e)}set(e,t,n){let i=this;function o(a,l,c){let u=zx(l);if(!u)throw new Error("header name must be a non-empty string");let p=ge.findKey(i,u);(!p||i[p]===void 0||c===!0||c===void 0&&i[p]!==!1)&&(i[p||l]=E1(a))}let s=(a,l)=>ge.forEach(a,(c,u)=>o(c,u,l));return ge.isPlainObject(e)||e instanceof this.constructor?s(e,t):ge.isString(e)&&(e=e.trim())&&!USe(e)?s(KSe(e),t):e!=null&&o(t,e,n),this}get(e,t){if(e=zx(e),e){let n=ge.findKey(this,e);if(n){let i=this[n];if(!t)return i;if(t===!0)return FSe(i);if(ge.isFunction(t))return t.call(this,i,n);if(ge.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=zx(e),e){let n=ge.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||tj(this,this[n],n,t)))}return!1}delete(e,t){let n=this,i=!1;function o(s){if(s=zx(s),s){let a=ge.findKey(n,s);a&&(!t||tj(n,n[a],a,t))&&(delete n[a],i=!0)}}return ge.isArray(e)?e.forEach(o):o(e),i}clear(e){let t=Object.keys(this),n=t.length,i=!1;for(;n--;){let o=t[n];(!e||tj(this,this[o],o,e,!0))&&(delete this[o],i=!0)}return i}normalize(e){let t=this,n={};return ge.forEach(this,(i,o)=>{let s=ge.findKey(n,o);if(s){t[s]=E1(i),delete t[o];return}let a=e?WSe(o):String(o).trim();a!==o&&delete t[o],t[a]=E1(i),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){let t=Object.create(null);return ge.forEach(this,(n,i)=>{n!=null&&n!==!1&&(t[i]=e&&ge.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){let n=new this(e);return t.forEach(i=>n.set(i)),n}static accessor(e){let n=(this[nQ]=this[nQ]={accessors:{}}).accessors,i=this.prototype;function o(s){let a=zx(s);n[a]||(VSe(i,s),n[a]=!0)}return ge.isArray(e)?e.forEach(o):o(e),this}};FI.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ge.reduceDescriptors(FI.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(n){this[t]=n}}});ge.freezeMethods(FI);var Yd=FI;function rj(r,e){let t=this||mj,n=e||t,i=Yd.from(n.headers),o=n.data;return ge.forEach(r,function(a){o=a.call(t,o,i.normalize(),e?e.status:void 0)}),i.normalize(),o}function wQ(r){return!!(r&&r.__CANCEL__)}function Zx(r,e,t){lr.call(this,r==null?"canceled":r,lr.ERR_CANCELED,e,t),this.name="CanceledError"}ge.inherits(Zx,lr,{__CANCEL__:!0});function jSe(r,e,t){let n=t.config.validateStatus;!t.status||!n||n(t.status)?r(t):e(new lr("Request failed with status code "+t.status,[lr.ERR_BAD_REQUEST,lr.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}var BSe=gu.hasStandardBrowserEnv?function(){return{write:function(t,n,i,o,s,a){let l=[];l.push(t+"="+encodeURIComponent(n)),ge.isNumber(i)&&l.push("expires="+new Date(i).toGMTString()),ge.isString(o)&&l.push("path="+o),ge.isString(s)&&l.push("domain="+s),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(t){let n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function HSe(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function JSe(r,e){return e?r.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):r}function xQ(r,e){return r&&!HSe(e)?JSe(r,e):e}var qSe=gu.hasStandardBrowserEnv?function(){let e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),n;function i(o){let s=o;return e&&(t.setAttribute("href",s),s=t.href),t.setAttribute("href",s),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return n=i(window.location.href),function(s){let a=ge.isString(s)?i(s):s;return a.protocol===n.protocol&&a.host===n.host}}():function(){return function(){return!0}}();function GSe(r){let e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function YSe(r,e){r=r||10;let t=new Array(r),n=new Array(r),i=0,o=0,s;return e=e!==void 0?e:1e3,function(l){let c=Date.now(),u=n[o];s||(s=c),t[i]=l,n[i]=c;let p=o,f=0;for(;p!==i;)f+=t[p++],p=p%r;if(i=(i+1)%r,i===o&&(o=(o+1)%r),c-s<e)return;let m=u&&c-u;return m?Math.round(f*1e3/m):void 0}}function iQ(r,e){let t=0,n=YSe(50,250);return i=>{let o=i.loaded,s=i.lengthComputable?i.total:void 0,a=o-t,l=n(a),c=o<=s;t=o;let u={loaded:o,total:s,progress:s?o/s:void 0,bytes:a,rate:l||void 0,estimated:l&&s&&c?(s-o)/l:void 0,event:i};u[e?"download":"upload"]=!0,r(u)}}var $Se=typeof XMLHttpRequest!="undefined",zSe=$Se&&function(r){return new Promise(function(t,n){let i=r.data,o=Yd.from(r.headers).normalize(),s=r.responseType,a;function l(){r.cancelToken&&r.cancelToken.unsubscribe(a),r.signal&&r.signal.removeEventListener("abort",a)}let c;if(ge.isFormData(i)){if(gu.hasStandardBrowserEnv||gu.hasStandardBrowserWebWorkerEnv)o.setContentType(!1);else if((c=o.getContentType())!==!1){let[h,...g]=c?c.split(";").map(v=>v.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...g].join("; "))}}let u=new XMLHttpRequest;if(r.auth){let h=r.auth.username||"",g=r.auth.password?unescape(encodeURIComponent(r.auth.password)):"";o.set("Authorization","Basic "+btoa(h+":"+g))}let p=xQ(r.baseURL,r.url);u.open(r.method.toUpperCase(),SQ(p,r.params,r.paramsSerializer),!0),u.timeout=r.timeout;function f(){if(!u)return;let h=Yd.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),v={data:!s||s==="text"||s==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:h,config:r,request:u};jSe(function(S){t(S),l()},function(S){n(S),l()},v),u=null}if("onloadend"in u?u.onloadend=f:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(f)},u.onabort=function(){u&&(n(new lr("Request aborted",lr.ECONNABORTED,r,u)),u=null)},u.onerror=function(){n(new lr("Network Error",lr.ERR_NETWORK,r,u)),u=null},u.ontimeout=function(){let g=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded",v=r.transitional||_Q;r.timeoutErrorMessage&&(g=r.timeoutErrorMessage),n(new lr(g,v.clarifyTimeoutError?lr.ETIMEDOUT:lr.ECONNABORTED,r,u)),u=null},gu.hasStandardBrowserEnv){let h=qSe(p)&&r.xsrfCookieName&&BSe.read(r.xsrfCookieName);h&&o.set(r.xsrfHeaderName,h)}i===void 0&&o.setContentType(null),"setRequestHeader"in u&&ge.forEach(o.toJSON(),function(g,v){u.setRequestHeader(v,g)}),ge.isUndefined(r.withCredentials)||(u.withCredentials=!!r.withCredentials),s&&s!=="json"&&(u.responseType=r.responseType),typeof r.onDownloadProgress=="function"&&u.addEventListener("progress",iQ(r.onDownloadProgress,!0)),typeof r.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",iQ(r.onUploadProgress)),(r.cancelToken||r.signal)&&(a=h=>{u&&(n(!h||h.type?new Zx(null,r,u):h),u.abort(),u=null)},r.cancelToken&&r.cancelToken.subscribe(a),r.signal&&(r.signal.aborted?a():r.signal.addEventListener("abort",a)));let m=GSe(p);if(m&&gu.protocols.indexOf(m)===-1){n(new lr("Unsupported protocol "+m+":",lr.ERR_BAD_REQUEST,r));return}u.send(i||null)})},aj={http:SSe,xhr:zSe};ge.forEach(aj,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch(t){}Object.defineProperty(r,"adapterName",{value:e})}});var oQ=r=>`- ${r}`,QSe=r=>ge.isFunction(r)||r===null||r===!1,DQ={getAdapter:r=>{r=ge.isArray(r)?r:[r];let{length:e}=r,t,n,i={};for(let o=0;o<e;o++){t=r[o];let s;if(n=t,!QSe(t)&&(n=aj[(s=String(t)).toLowerCase()],n===void 0))throw new lr(`Unknown adapter '${s}'`);if(n)break;i[s||"#"+o]=n}if(!n){let o=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build")),s=e?o.length>1?`since :
`+o.map(oQ).join(`
`):" "+oQ(o[0]):"as no adapter specified";throw new lr("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return n},adapters:aj};function nj(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Zx(null,r)}function sQ(r){return nj(r),r.headers=Yd.from(r.headers),r.data=rj.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),DQ.getAdapter(r.adapter||mj.adapter)(r).then(function(n){return nj(r),n.data=rj.call(r,r.transformResponse,n),n.headers=Yd.from(n.headers),n},function(n){return wQ(n)||(nj(r),n&&n.response&&(n.response.data=rj.call(r,r.transformResponse,n.response),n.response.headers=Yd.from(n.response.headers))),Promise.reject(n)})}var aQ=r=>r instanceof Yd?r.toJSON():r;function UI(r,e){e=e||{};let t={};function n(c,u,p){return ge.isPlainObject(c)&&ge.isPlainObject(u)?ge.merge.call({caseless:p},c,u):ge.isPlainObject(u)?ge.merge({},u):ge.isArray(u)?u.slice():u}function i(c,u,p){if(ge.isUndefined(u)){if(!ge.isUndefined(c))return n(void 0,c,p)}else return n(c,u,p)}function o(c,u){if(!ge.isUndefined(u))return n(void 0,u)}function s(c,u){if(ge.isUndefined(u)){if(!ge.isUndefined(c))return n(void 0,c)}else return n(void 0,u)}function a(c,u,p){if(p in e)return n(c,u);if(p in r)return n(void 0,c)}let l={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(c,u)=>i(aQ(c),aQ(u),!0)};return ge.forEach(Object.keys(Object.assign({},r,e)),function(u){let p=l[u]||i,f=p(r[u],e[u],u);ge.isUndefined(f)&&p!==a||(t[u]=f)}),t}var PQ="1.6.1",hj={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{hj[r]=function(n){return typeof n===r||"a"+(e<1?"n ":" ")+r}});var lQ={};hj.transitional=function(e,t,n){function i(o,s){return"[Axios v"+PQ+"] Transitional option '"+o+"'"+s+(n?". "+n:"")}return(o,s,a)=>{if(e===!1)throw new lr(i(s," has been removed"+(t?" in "+t:"")),lr.ERR_DEPRECATED);return t&&!lQ[s]&&(lQ[s]=!0,console.warn(i(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,s,a):!0}};function XSe(r,e,t){if(typeof r!="object")throw new lr("options must be an object",lr.ERR_BAD_OPTION_VALUE);let n=Object.keys(r),i=n.length;for(;i-- >0;){let o=n[i],s=e[o];if(s){let a=r[o],l=a===void 0||s(a,o,r);if(l!==!0)throw new lr("option "+o+" must be "+l,lr.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new lr("Unknown option "+o,lr.ERR_BAD_OPTION)}}var lj={assertOptions:XSe,validators:hj},nm=lj.validators,WI=class{constructor(e){this.defaults=e,this.interceptors={request:new rQ,response:new rQ}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=UI(this.defaults,t);let{transitional:n,paramsSerializer:i,headers:o}=t;n!==void 0&&lj.assertOptions(n,{silentJSONParsing:nm.transitional(nm.boolean),forcedJSONParsing:nm.transitional(nm.boolean),clarifyTimeoutError:nm.transitional(nm.boolean)},!1),i!=null&&(ge.isFunction(i)?t.paramsSerializer={serialize:i}:lj.assertOptions(i,{encode:nm.function,serialize:nm.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=o&&ge.merge(o.common,o[t.method]);o&&ge.forEach(["delete","get","head","post","put","patch","common"],h=>{delete o[h]}),t.headers=Yd.concat(s,o);let a=[],l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(l=l&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});let c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let u,p=0,f;if(!l){let h=[sQ.bind(this),void 0];for(h.unshift.apply(h,a),h.push.apply(h,c),f=h.length,u=Promise.resolve(t);p<f;)u=u.then(h[p++],h[p++]);return u}f=a.length;let m=t;for(p=0;p<f;){let h=a[p++],g=a[p++];try{m=h(m)}catch(v){g.call(this,v);break}}try{u=sQ.call(this,m)}catch(h){return Promise.reject(h)}for(p=0,f=c.length;p<f;)u=u.then(c[p++],c[p++]);return u}getUri(e){e=UI(this.defaults,e);let t=xQ(e.baseURL,e.url);return SQ(t,e.params,e.paramsSerializer)}};ge.forEach(["delete","get","head","options"],function(e){WI.prototype[e]=function(t,n){return this.request(UI(n||{},{method:e,url:t,data:(n||{}).data}))}});ge.forEach(["post","put","patch"],function(e){function t(n){return function(o,s,a){return this.request(UI(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}WI.prototype[e]=t(),WI.prototype[e+"Form"]=t(!0)});var C1=WI,cj=class r{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});let n=this;this.promise.then(i=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](i);n._listeners=null}),this.promise.then=i=>{let o,s=new Promise(a=>{n.subscribe(a),o=a}).then(i);return s.cancel=function(){n.unsubscribe(o)},s},e(function(o,s,a){n.reason||(n.reason=new Zx(o,s,a),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;let t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new r(function(i){e=i}),cancel:e}}},ZSe=cj;function e_e(r){return function(t){return r.apply(null,t)}}function t_e(r){return ge.isObject(r)&&r.isAxiosError===!0}var uj={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(uj).forEach(([r,e])=>{uj[e]=r});var r_e=uj;function TQ(r){let e=new C1(r),t=cQ(C1.prototype.request,e);return ge.extend(t,C1.prototype,e,{allOwnKeys:!0}),ge.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return TQ(UI(r,i))},t}var ei=TQ(mj);ei.Axios=C1;ei.CanceledError=Zx;ei.CancelToken=ZSe;ei.isCancel=wQ;ei.VERSION=PQ;ei.toFormData=P1;ei.AxiosError=lr;ei.Cancel=ei.CanceledError;ei.all=function(e){return Promise.all(e)};ei.spread=e_e;ei.isAxiosError=t_e;ei.mergeConfig=UI;ei.AxiosHeaders=Yd;ei.formToJSON=r=>CQ(ge.isHTMLForm(r)?new FormData(r):r);ei.getAdapter=DQ.getAdapter;ei.HttpStatusCode=r_e;ei.default=ei;NQ.exports=ei});var AQ=Q(T1=>{"use strict";d();Object.defineProperty(T1,"__esModule",{value:!0});T1.AxiosHttpClient=void 0;var n_e=RQ(),gj=class{constructor(e){this.endpoint=e}get(e){return n_e.default.get(this.endpoint,Object.assign(Object.assign({},e),{proxy:!1}))}};T1.AxiosHttpClient=gj});var MQ=Q(k1=>{"use strict";d();Object.defineProperty(k1,"__esModule",{value:!0});k1.MemoryKeyValueStorage=void 0;var vj=class{constructor(){this.storage=new Map}async getValue(e,t){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(t||void 0)}setValue(e,t){this.storage.set(e,t)}};k1.MemoryKeyValueStorage=vj});var OQ=Q(N1=>{"use strict";d();Object.defineProperty(N1,"__esModule",{value:!0});N1.ExperimentationServiceBase=void 0;var i_e=MQ(),yj=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,t,n,i,o){this.telemetry=e,this.assignmentContextTelemetryPropertyName=t,this.telemetryEventName=n,this.storageKey=i,this.storage=o,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(o=new i_e.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((s,a)=>{this.resolveInitialFetchPromise=s})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch(t){}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async n=>await n.getFeatures()));let t=await this.fetchPromise;this.updateFeatures(t,e)}catch(t){}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,t=!1){let n={features:[],assignmentContext:"",configs:[]};for(let i of e){for(let o of i.features)n.features.includes(o)||n.features.push(o);for(let o of i.configs){let s=n.configs.find(a=>a.Id===o.Id);s?s.Parameters=Object.assign(Object.assign({},s.Parameters),o.Parameters):n.configs.push(o)}n.assignmentContext+=i.assignmentContext}(t||!this.featuresConsumed)&&(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let t=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),t.features.includes(e)}getTreatmentVariable(e,t){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${t}`);let n=this.features.configs.find(i=>i.Id===e);return n==null?void 0:n.Parameters[t]}async getTreatmentVariableAsync(e,t,n){if(n){let i=this.featuresConsumed,o=this.getTreatmentVariable(e,t);if(o===void 0)this.featuresConsumed=i;else return o}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,t)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let t of e)this.featureProviders.push(t)}};N1.ExperimentationServiceBase=yj});var LQ=Q(R1=>{"use strict";d();Object.defineProperty(R1,"__esModule",{value:!0});R1.PollingService=void 0;var bj=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};R1.PollingService=bj});var KQ=Q(A1=>{"use strict";d();Object.defineProperty(A1,"__esModule",{value:!0});A1.ExperimentationServiceAutoPolling=void 0;var o_e=OQ(),s_e=LQ(),Ij=class extends o_e.ExperimentationServiceBase{constructor(e,t,n,i,o,s,a){if(super(e,i,o,s,a),this.telemetry=e,this.filterProviders=t,this.refreshRateMs=n,this.assignmentContextTelemetryPropertyName=i,this.telemetryEventName=o,this.storageKey=s,this.storage=a,n<1e3&&n!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new s_e.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let t=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),t}else return await super.getFeaturesAsync(e)}};A1.ExperimentationServiceAutoPolling=Ij});var FQ=Q(O1=>{"use strict";d();Object.defineProperty(O1,"__esModule",{value:!0});O1.ExperimentationService=void 0;var a_e=Qz(),l_e=AQ(),c_e=KQ(),M1=class extends c_e.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new a_e.TasApiFeatureProvider(new l_e.AxiosHttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};O1.ExperimentationService=M1;M1.REFRESH_RATE_IN_MINUTES=30});var UQ=Q(L1=>{"use strict";d();Object.defineProperty(L1,"__esModule",{value:!0});L1.ExperimentationService=void 0;var u_e=FQ();Object.defineProperty(L1,"ExperimentationService",{enumerable:!0,get:function(){return u_e.ExperimentationService}})});var WQ=Q(K1=>{"use strict";d();Object.defineProperty(K1,"__esModule",{value:!0});K1.MementoKeyValueStorage=void 0;var Sj=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,t){return await this.mementoGlobalStorage.get(e)||t}setValue(e,t){this.mementoGlobalStorage.update(e,t)}};K1.MementoKeyValueStorage=Sj});var VQ=Q(Ej=>{"use strict";d();Object.defineProperty(Ej,"__esModule",{value:!0});var _j=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}};Ej.default=_j});var BQ=Q(jI=>{"use strict";d();Object.defineProperty(jI,"__esModule",{value:!0});jI.getExperimentationServiceAsync=jI.getExperimentationService=void 0;var d_e=$V(),p_e=UQ(),Cj=require("vscode"),f_e=WQ(),m_e=VQ(),h_e="https://default.exp-tas.com/vscode/ab",g_e="query-expfeature",v_e="abexp.assignmentcontext",y_e="VSCode.ABExp.FeatureData",b_e=1e3*60*30;function jQ(r,e,t,n,i,...o){if(!i)throw new Error("Memento storage was not provided.");let s=Cj.workspace.getConfiguration("telemetry");if(!(Cj.env.isTelemetryEnabled===void 0?s.get("enableTelemetry",!0):Cj.env.isTelemetryEnabled))return new m_e.default;let c=[new d_e.VSCodeFilterProvider(r,e,t),...o],u=new f_e.MementoKeyValueStorage(i);return new p_e.ExperimentationService({filterProviders:c,telemetry:n,storageKey:y_e,keyValueStorage:u,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:v_e,telemetryEventName:g_e,endpoint:h_e,refetchInterval:b_e})}jI.getExperimentationService=jQ;async function I_e(r,e,t,n,i,...o){let s=jQ(r,e,t,n,i,...o);return await s.initializePromise,s}jI.getExperimentationServiceAsync=I_e});var JQ=Q(im=>{"use strict";d();Object.defineProperty(im,"__esModule",{value:!0});im.TargetPopulation=im.getExperimentationServiceAsync=im.getExperimentationService=void 0;var HQ=BQ();Object.defineProperty(im,"getExperimentationService",{enumerable:!0,get:function(){return HQ.getExperimentationService}});Object.defineProperty(im,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return HQ.getExperimentationServiceAsync}});var S_e=$V();Object.defineProperty(im,"TargetPopulation",{enumerable:!0,get:function(){return S_e.TargetPopulation}})});var J1=Q((Get,Tj)=>{"use strict";d();function C_e(r){var e=void 0;typeof r=="string"?e=[r]:e=r.raw;for(var t="",n=0;n<e.length;n++)t+=e[n].replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`"),n<(arguments.length<=1?0:arguments.length-1)&&(t+=arguments.length<=n+1?void 0:arguments[n+1]);var i=t.split(`
`),o=null;return i.forEach(function(s){var a=s.match(/^(\s+)\S+/);if(a){var l=a[1].length;o?o=Math.min(o,l):o=l}}),o!==null&&(t=i.map(function(s){return s[0]===" "?s.slice(o):s}).join(`
`)),t=t.trim(),t.replace(/\\n/g,`
`)}typeof Tj!="undefined"&&(Tj.exports=C_e)});var vX=Q((Zd,gX)=>{d();var hX=typeof self!="undefined"?self:Zd,Q1=function(){function r(){this.fetch=!1,this.DOMException=hX.DOMException}return r.prototype=hX,new r}();(function(r){var e=function(t){var n={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(N){return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};function i(N){return N&&DataView.prototype.isPrototypeOf(N)}if(n.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(N){return N&&o.indexOf(Object.prototype.toString.call(N))>-1};function a(N){if(typeof N!="string"&&(N=String(N)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(N))throw new TypeError("Invalid character in header field name");return N.toLowerCase()}function l(N){return typeof N!="string"&&(N=String(N)),N}function c(N){var ee={next:function(){var ye=N.shift();return{done:ye===void 0,value:ye}}};return n.iterable&&(ee[Symbol.iterator]=function(){return ee}),ee}function u(N){this.map={},N instanceof u?N.forEach(function(ee,ye){this.append(ye,ee)},this):Array.isArray(N)?N.forEach(function(ee){this.append(ee[0],ee[1])},this):N&&Object.getOwnPropertyNames(N).forEach(function(ee){this.append(ee,N[ee])},this)}u.prototype.append=function(N,ee){N=a(N),ee=l(ee);var ye=this.map[N];this.map[N]=ye?ye+", "+ee:ee},u.prototype.delete=function(N){delete this.map[a(N)]},u.prototype.get=function(N){return N=a(N),this.has(N)?this.map[N]:null},u.prototype.has=function(N){return this.map.hasOwnProperty(a(N))},u.prototype.set=function(N,ee){this.map[a(N)]=l(ee)},u.prototype.forEach=function(N,ee){for(var ye in this.map)this.map.hasOwnProperty(ye)&&N.call(ee,this.map[ye],ye,this)},u.prototype.keys=function(){var N=[];return this.forEach(function(ee,ye){N.push(ye)}),c(N)},u.prototype.values=function(){var N=[];return this.forEach(function(ee){N.push(ee)}),c(N)},u.prototype.entries=function(){var N=[];return this.forEach(function(ee,ye){N.push([ye,ee])}),c(N)},n.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);function p(N){if(N.bodyUsed)return Promise.reject(new TypeError("Already read"));N.bodyUsed=!0}function f(N){return new Promise(function(ee,ye){N.onload=function(){ee(N.result)},N.onerror=function(){ye(N.error)}})}function m(N){var ee=new FileReader,ye=f(ee);return ee.readAsArrayBuffer(N),ye}function h(N){var ee=new FileReader,ye=f(ee);return ee.readAsText(N),ye}function g(N){for(var ee=new Uint8Array(N),ye=new Array(ee.length),Ve=0;Ve<ee.length;Ve++)ye[Ve]=String.fromCharCode(ee[Ve]);return ye.join("")}function v(N){if(N.slice)return N.slice(0);var ee=new Uint8Array(N.byteLength);return ee.set(new Uint8Array(N)),ee.buffer}function I(){return this.bodyUsed=!1,this._initBody=function(N){this._bodyInit=N,N?typeof N=="string"?this._bodyText=N:n.blob&&Blob.prototype.isPrototypeOf(N)?this._bodyBlob=N:n.formData&&FormData.prototype.isPrototypeOf(N)?this._bodyFormData=N:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(N)?this._bodyText=N.toString():n.arrayBuffer&&n.blob&&i(N)?(this._bodyArrayBuffer=v(N.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(N)||s(N))?this._bodyArrayBuffer=v(N):this._bodyText=N=Object.prototype.toString.call(N):this._bodyText="",this.headers.get("content-type")||(typeof N=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(N)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var N=p(this);if(N)return N;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var N=p(this);if(N)return N;if(this._bodyBlob)return h(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(g(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(A)}),this.json=function(){return this.text().then(JSON.parse)},this}var S=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function x(N){var ee=N.toUpperCase();return S.indexOf(ee)>-1?ee:N}function D(N,ee){ee=ee||{};var ye=ee.body;if(N instanceof D){if(N.bodyUsed)throw new TypeError("Already read");this.url=N.url,this.credentials=N.credentials,ee.headers||(this.headers=new u(N.headers)),this.method=N.method,this.mode=N.mode,this.signal=N.signal,!ye&&N._bodyInit!=null&&(ye=N._bodyInit,N.bodyUsed=!0)}else this.url=String(N);if(this.credentials=ee.credentials||this.credentials||"same-origin",(ee.headers||!this.headers)&&(this.headers=new u(ee.headers)),this.method=x(ee.method||this.method||"GET"),this.mode=ee.mode||this.mode||null,this.signal=ee.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ye)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ye)}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function A(N){var ee=new FormData;return N.trim().split("&").forEach(function(ye){if(ye){var Ve=ye.split("="),Pe=Ve.shift().replace(/\+/g," "),le=Ve.join("=").replace(/\+/g," ");ee.append(decodeURIComponent(Pe),decodeURIComponent(le))}}),ee}function w(N){var ee=new u,ye=N.replace(/\r?\n[\t ]+/g," ");return ye.split(/\r?\n/).forEach(function(Ve){var Pe=Ve.split(":"),le=Pe.shift().trim();if(le){var At=Pe.join(":").trim();ee.append(le,At)}}),ee}I.call(D.prototype);function R(N,ee){ee||(ee={}),this.type="default",this.status=ee.status===void 0?200:ee.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in ee?ee.statusText:"OK",this.headers=new u(ee.headers),this.url=ee.url||"",this._initBody(N)}I.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},R.error=function(){var N=new R(null,{status:0,statusText:""});return N.type="error",N};var j=[301,302,303,307,308];R.redirect=function(N,ee){if(j.indexOf(ee)===-1)throw new RangeError("Invalid status code");return new R(null,{status:ee,headers:{location:N}})},t.DOMException=r.DOMException;try{new t.DOMException}catch(N){t.DOMException=function(ee,ye){this.message=ee,this.name=ye;var Ve=Error(ee);this.stack=Ve.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function ne(N,ee){return new Promise(function(ye,Ve){var Pe=new D(N,ee);if(Pe.signal&&Pe.signal.aborted)return Ve(new t.DOMException("Aborted","AbortError"));var le=new XMLHttpRequest;function At(){le.abort()}le.onload=function(){var Ye={status:le.status,statusText:le.statusText,headers:w(le.getAllResponseHeaders()||"")};Ye.url="responseURL"in le?le.responseURL:Ye.headers.get("X-Request-URL");var Ir="response"in le?le.response:le.responseText;ye(new R(Ir,Ye))},le.onerror=function(){Ve(new TypeError("Network request failed"))},le.ontimeout=function(){Ve(new TypeError("Network request failed"))},le.onabort=function(){Ve(new t.DOMException("Aborted","AbortError"))},le.open(Pe.method,Pe.url,!0),Pe.credentials==="include"?le.withCredentials=!0:Pe.credentials==="omit"&&(le.withCredentials=!1),"responseType"in le&&n.blob&&(le.responseType="blob"),Pe.headers.forEach(function(Ye,Ir){le.setRequestHeader(Ir,Ye)}),Pe.signal&&(Pe.signal.addEventListener("abort",At),le.onreadystatechange=function(){le.readyState===4&&Pe.signal.removeEventListener("abort",At)}),le.send(typeof Pe._bodyInit=="undefined"?null:Pe._bodyInit)})}return ne.polyfill=!0,r.fetch||(r.fetch=ne,r.Headers=u,r.Request=D,r.Response=R),t.Headers=u,t.Request=D,t.Response=R,t.fetch=ne,Object.defineProperty(t,"__esModule",{value:!0}),t}({})})(Q1);Q1.fetch.ponyfill=!0;delete Q1.fetch.polyfill;var aS=Q1;Zd=aS.fetch;Zd.default=aS.fetch;Zd.fetch=aS.fetch;Zd.Headers=aS.Headers;Zd.Request=aS.Request;Zd.Response=aS.Response;gX.exports=Zd});var OX=Q((aA,MX)=>{d();var CS=null;typeof WebSocket!="undefined"?CS=WebSocket:typeof MozWebSocket!="undefined"?CS=MozWebSocket:typeof aA!="undefined"?CS=aA.WebSocket||aA.MozWebSocket:typeof window!="undefined"?CS=window.WebSocket||window.MozWebSocket:typeof self!="undefined"&&(CS=self.WebSocket||self.MozWebSocket);MX.exports=CS});var VX=Q((Mlt,Bj)=>{d();var WX=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);WX?(Vj=new Uint8Array(16),Bj.exports=function(){return WX(Vj),Vj}):(jj=new Array(16),Bj.exports=function(){for(var e=0,t;e<16;e++)e&3||(t=Math.random()*4294967296),jj[e]=t>>>((e&3)<<3)&255;return jj});var Vj,jj});var HX=Q((Llt,BX)=>{d();var jX=[];for(dD=0;dD<256;++dD)jX[dD]=(dD+256).toString(16).substr(1);var dD;function M_e(r,e){var t=e||0,n=jX;return[n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]]].join("")}BX.exports=M_e});var iv=Q((Flt,JX)=>{d();var O_e=VX(),L_e=HX();function K_e(r,e,t){var n=e&&t||0;typeof r=="string"&&(e=r==="binary"?new Array(16):null,r=null),r=r||{};var i=r.random||(r.rng||O_e)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e)for(var o=0;o<16;++o)e[n+o]=i[o];return e||L_e(i)}JX.exports=K_e});var rZ=Q((Zmt,tZ)=>{"use strict";d();tZ.exports=({onlyFirst:r=!1}={})=>{let e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,r?void 0:"g")}});var BZ=Q((ZCt,jZ)=>{"use strict";d();var lEe=(r,e={})=>{let t=e.safe===!0||e.keepProtected===!0,n=!1,i=(o,s)=>{let a="",l,c;for(let u of o.nodes)switch(u.type){case"block":if(e.first&&n===!0){a+=i(u,o);break}if(e.preserveNewlines===!0){l=i(u,o),c=l.split(`
`),a+=`
`.repeat(c.length-1);break}if(t===!0&&u.protected===!0){a+=i(u,o);break}n=!0;break;case"line":if(e.first&&n===!0){a+=u.value;break}t===!0&&u.protected===!0&&(a+=u.value),n=!0;break;case"open":case"close":case"text":case"newline":default:{a+=u.value||"";break}}return a};return i(r)};jZ.exports=lEe});var JZ=Q((twt,HZ)=>{"use strict";d();var rM=class{constructor(e){this.type=e.type,e.value&&(this.value=e.value),e.match&&(this.match=e.match),this.newline=e.newline||""}get protected(){return!!this.match&&this.match[1]==="!"}},a9=class extends rM{constructor(e){super(e),this.nodes=e.nodes||[]}push(e){this.nodes.push(e)}get protected(){return this.nodes.length>0&&this.nodes[0].protected===!0}};HZ.exports={Node:rM,Block:a9}});var GZ=Q(qZ=>{"use strict";d();qZ.javascript={BLOCK_OPEN_REGEX:/^\/\*\*?(!?)/,BLOCK_CLOSE_REGEX:/^\*\/(\n?)/,LINE_REGEX:/^\/\/(!?).*/}});var zZ=Q((owt,$Z)=>{"use strict";d();var{Node:Sm,Block:YZ}=JZ(),cEe=GZ(),l9={ESCAPED_CHAR_REGEX:/^\\./,QUOTED_STRING_REGEX:/^(['"`])((?:\\.|[^\1])+?)(\1)/,NEWLINE_REGEX:/^\r*\n/},uEe=(r,e={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");let t=new YZ({type:"root",nodes:[]}),n=[t],i=(e.language||"javascript").toLowerCase(),o=cEe[i];if(typeof o=="undefined")throw new Error(`Language "${i}" is not supported by strip-comments`);let{LINE_REGEX:s,BLOCK_OPEN_REGEX:a,BLOCK_CLOSE_REGEX:l}=o,c=t,u=r,p,f,m=[a,l].filter(Boolean),h=!1;m.every(x=>x.source==='^"""')&&(h=!0);let g=(x=u[0]||"")=>(u=u.slice(x.length),x),v=(x,D="text")=>{let A=x.exec(u);if(A)return g(A[0]),{type:D,value:A[0],match:A}},I=x=>{if(f&&f.type==="text"&&x.type==="text"){f.value+=x.value;return}c.push(x),x.nodes&&(n.push(x),c=x),f=x},S=()=>{if(c.type==="root")throw new SyntaxError("Unclosed block comment");n.pop(),c=n[n.length-1]};for(;u!=="";){if(p=v(l9.ESCAPED_CHAR_REGEX,"text")){I(new Sm(p));continue}if(c.type!=="block"&&(!f||!/\w$/.test(f.value))&&!(h&&u.startsWith('"""'))&&(p=v(l9.QUOTED_STRING_REGEX,"text"))){I(new Sm(p));continue}if(p=v(l9.NEWLINE_REGEX,"newline")){I(new Sm(p));continue}if(a&&e.block&&!(h&&c.type==="block")&&(p=v(a,"open"))){I(new YZ({type:"block"})),I(new Sm(p));continue}if(l&&c.type==="block"&&e.block&&(p=v(l,"close"))){p.newline=p.match[1]||"",I(new Sm(p)),S();continue}if(s&&c.type!=="block"&&e.line&&(p=v(s,"line"))){I(new Sm(p));continue}if(p=v(/^[a-zABD-Z0-9\t ]+/,"text")){I(new Sm(p));continue}I(new Sm({type:"text",value:g(u[0])}))}return t};$Z.exports=uEe});var XZ=Q((awt,QZ)=>{"use strict";d();var nM=BZ(),CD=zZ(),iM=QZ.exports=(r,e)=>{let t={...e,block:!0,line:!0};return nM(CD(r,t),t)};iM.block=(r,e)=>{let t={...e,block:!0};return nM(CD(r,t),t)};iM.line=(r,e)=>{let t={...e,line:!0};return nM(CD(r,t),t)};iM.first=(r,e)=>{let t={...e,block:!0,line:!0,first:!0};return nM(CD(r,t),t)};iM.parse=CD});var Uee=Q((VD,Fee)=>{d();var LEe=typeof VD=="object"&&VD&&VD.Object===Object&&VD;Fee.exports=LEe});var Vee=Q((bFt,Wee)=>{d();var KEe=Uee(),FEe=typeof self=="object"&&self&&self.Object===Object&&self,UEe=KEe||FEe||Function("return this")();Wee.exports=UEe});var HM=Q((SFt,jee)=>{d();var WEe=Vee(),VEe=WEe.Symbol;jee.exports=VEe});var Hee=Q((EFt,Bee)=>{d();function jEe(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}Bee.exports=jEe});var qee=Q((wFt,Jee)=>{d();var BEe=Array.isArray;Jee.exports=BEe});var zee=Q((DFt,$ee)=>{d();var Gee=HM(),Yee=Object.prototype,HEe=Yee.hasOwnProperty,JEe=Yee.toString,jD=Gee?Gee.toStringTag:void 0;function qEe(r){var e=HEe.call(r,jD),t=r[jD];try{r[jD]=void 0;var n=!0}catch(o){}var i=JEe.call(r);return n&&(e?r[jD]=t:delete r[jD]),i}$ee.exports=qEe});var Xee=Q((TFt,Qee)=>{d();var GEe=Object.prototype,YEe=GEe.toString;function $Ee(r){return YEe.call(r)}Qee.exports=$Ee});var rte=Q((NFt,tte)=>{d();var Zee=HM(),zEe=zee(),QEe=Xee(),XEe="[object Null]",ZEe="[object Undefined]",ete=Zee?Zee.toStringTag:void 0;function eCe(r){return r==null?r===void 0?ZEe:XEe:ete&&ete in Object(r)?zEe(r):QEe(r)}tte.exports=eCe});var ite=Q((AFt,nte)=>{d();function tCe(r){return r!=null&&typeof r=="object"}nte.exports=tCe});var ste=Q((OFt,ote)=>{d();var rCe=rte(),nCe=ite(),iCe="[object Symbol]";function oCe(r){return typeof r=="symbol"||nCe(r)&&rCe(r)==iCe}ote.exports=oCe});var pte=Q((KFt,dte)=>{d();var ate=HM(),sCe=Hee(),aCe=qee(),lCe=ste(),cCe=1/0,lte=ate?ate.prototype:void 0,cte=lte?lte.toString:void 0;function ute(r){if(typeof r=="string")return r;if(aCe(r))return sCe(r,ute)+"";if(lCe(r))return cte?cte.call(r):"";var e=r+"";return e=="0"&&1/r==-cCe?"-0":e}dte.exports=ute});var mte=Q((UFt,fte)=>{d();var uCe=pte();function dCe(r){return r==null?"":uCe(r)}fte.exports=dCe});var vte=Q((VFt,gte)=>{d();var pCe=mte(),hte=/[\\^$.*+?()[\]{}|]/g,fCe=RegExp(hte.source);function mCe(r){return r=pCe(r),r&&fCe.test(r)?r.replace(hte,"\\$&"):r}gte.exports=mCe});var V9=Q((Gqt,yre)=>{d();function owe(r){var e=/(%?)(%([jds]))/g,t=Array.prototype.slice.call(arguments,1);return t.length&&(r=r.replace(e,function(n,i,o,s){var a=t.shift();switch(s){case"s":a=""+a;break;case"d":a=Number(a);break;case"j":a=JSON.stringify(a);break}return i?(t.unshift(a),n):a})),t.length&&(r+=" "+t.join(" ")),r=r.replace(/%{2,2}/g,"%"),""+r}yre.exports=owe});var fwe={};Um(fwe,{activate:()=>awe,deactivate:()=>lwe});module.exports=iP(fwe);d();d();Reflect.metadata===void 0&&G9();d();d();d();function Uv(){try{return($9(),iP(Y9)).isPreRelesVersionOfJupyterExtension===!0}catch(r){return!0}}var ME={isExiting:!1},oP="_builtin.JupyterServerSelectorForTesting",HO="_builtin.jupyterServerUrlProvider";var z9=!1;function Q9(r){z9=r}function X9(){return z9}var Z9=!1;function eB(r){Z9=r}function Tn(){return Z9}var Qe="python",KE="markdown",Ip="vscode-notebook-cell";var aP={language:Qe};var lP="vscode-interactive-input",Ct="jupyter-notebook",St="interactive";var fc="GitHub.codespaces",Xe="ms-toolsai.jupyter",tB="ms-toolsai.vscode-jupyter-powertoys",Wv="ms-toolsai.jupyter-hub",rB="0c6ae279ed8443289764825290e4f9e2-1a736e7c-1324-4338-be46-fc2a58ae4d14-7255",Vv="STANDARD_OUTPUT_CHANNEL",sP;(t=>(t.PythonInteractiveHelpLink="https://aka.ms/pyaiinstall",t.JupyterDataRateHelpLink="https://aka.ms/AA5ggm0"))(sP||(sP={}));var gi;(o=>(o.JupyterServerRemoteLaunchNameSeparator=`
`,o.JupyterServerRemoteLaunchService=Xe,o.JupyterServerUriListMax=10,o.IntellisenseTimeout=2e3,o.IntellisenseResolveTimeout=5e3))(gi||(gi={}));var Ni=!1;var Fre=!1;function Sn(){return Fre||FE()}var Ure=!1;function FE(){return Ure}var st;(g=>(g.GeneratedThemeName="ipython-theme",g.MatplotLibDefaultParams="_VSCode_defaultMatplotlib_Params",g.MatplotLibFigureFormats="_VSCode_matplotLib_FigureFormats",g.DefaultCodeCellMarker="# %%",g.DefaultCommTarget="jupyter.widget",g.ALL_VARIABLES="ALL_VARIABLES",g.KERNEL_VARIABLES="KERNEL_VARIABLES",g.DEBUGGER_VARIABLES="DEBUGGER_VARIABLES",g.PYTHON_VARIABLES_REQUESTER="PYTHON_VARIABLES_REQUESTER",g.MULTIPLEXING_DEBUGSERVICE="MULTIPLEXING_DEBUGSERVICE",g.RUN_BY_LINE_DEBUGSERVICE="RUN_BY_LINE_DEBUGSERVICE",g.REMOTE_URI="https://remote/",g.REMOTE_URI_ID_PARAM="id",g.REMOTE_URI_HANDLE_PARAM="uriHandle",g.REMOTE_URI_EXTENSION_ID_PARAM="extensionId"))(st||(st={}));var OE;(n=>(n.ImportIPython=`{0}
from IPython import get_ipython

{1}`,n.MatplotLibInit=`import matplotlib
%matplotlib inline
${st.MatplotLibDefaultParams} = dict(matplotlib.rcParams)
`,n.DisableJedi="%config Completer.use_jedi = False"))(OE||(OE={}));var nB="JUPYTER_OUTPUT_CHANNEL",JO="Default Light+",sa="ms-python.python",jv="ms-toolsai.jupyter-renderers",iB="ms-python.vscode-pylance",oB=["python","html","xml","javascript","markdown","latex","shellscript","bat","powershell","kusto","ruby","sql","perl","qsharp","raw"],sB=new Map([["bash","shellscript"],["c#","csharp"],["f#","fsharp"],["q#","qsharp"],["c++11","c++"],["c++12","c++"],["c++14","c++"]]),aB=["python","r","julia","c++","c#","f#","q#","powershell","java","scala","haskell","bash","cling","rust","sas","sos","ocaml"];var X;(Le=>(Le.RunAllCells="jupyter.runallcells",Le.RunAllCellsAbove="jupyter.runallcellsabove",Le.RunCellAndAllBelow="jupyter.runcellandallbelow",Le.RunAllCellsAbovePalette="jupyter.runallcellsabove.palette",Le.RunCellAndAllBelowPalette="jupyter.runcurrentcellandallbelow.palette",Le.RunToLine="jupyter.runtoline",Le.RunFromLine="jupyter.runfromline",Le.RunCell="jupyter.runcell",Le.RunCurrentCell="jupyter.runcurrentcell",Le.RunCurrentCellAdvance="jupyter.runcurrentcelladvance",Le.CreateNewInteractive="jupyter.createnewinteractive",Le.ImportNotebook="jupyter.importnotebook",Le.ImportNotebookFile="jupyter.importnotebookfile",Le.ExportFileAsNotebook="jupyter.exportfileasnotebook",Le.ExportFileAndOutputAsNotebook="jupyter.exportfileandoutputasnotebook",Le.InterruptKernel="jupyter.interruptkernel",Le.RestartKernel="jupyter.restartkernel",Le.RestartKernelAndRunAllCells="jupyter.restartkernelandrunallcells",Le.RestartKernelAndRunUpToSelectedCell="jupyter.restartkernelandrunuptoselectedcell",Le.NotebookEditorRemoveAllCells="jupyter.notebookeditor.removeallcells",Le.NotebookEditorRunAllCells="jupyter.notebookeditor.runallcells",Le.NotebookEditorRunSelectedCell="jupyter.notebookeditor.runselectedcell",Le.NotebookEditorAddCellBelow="jupyter.notebookeditor.addcellbelow",Le.ExpandAllCells="jupyter.expandallcells",Le.CollapseAllCells="jupyter.collapseallcells",Le.ExportOutputAsNotebook="jupyter.exportoutputasnotebook",Le.ExecSelectionInInteractiveWindow="jupyter.execSelectionInteractive",Le.RunFileInInteractiveWindows="jupyter.runFileInteractive",Le.DebugFileInInteractiveWindows="jupyter.debugFileInteractive",Le.AddCellBelow="jupyter.addcellbelow",Le.DebugCurrentCellPalette="jupyter.debugcurrentcell.palette",Le.DebugCell="jupyter.debugcell",Le.DebugStepOver="jupyter.debugstepover",Le.DebugContinue="jupyter.debugcontinue",Le.DebugStop="jupyter.debugstop",Le.RunCurrentCellAndAddBelow="jupyter.runcurrentcellandaddbelow",Le.InsertCellBelowPosition="jupyter.insertCellBelowPosition",Le.InsertCellBelow="jupyter.insertCellBelow",Le.InsertCellAbove="jupyter.insertCellAbove",Le.DeleteCells="jupyter.deleteCells",Le.SelectCell="jupyter.selectCell",Le.SelectCellContents="jupyter.selectCellContents",Le.ExtendSelectionByCellAbove="jupyter.extendSelectionByCellAbove",Le.ExtendSelectionByCellBelow="jupyter.extendSelectionByCellBelow",Le.MoveCellsUp="jupyter.moveCellsUp",Le.MoveCellsDown="jupyter.moveCellsDown",Le.ChangeCellToMarkdown="jupyter.changeCellToMarkdown",Le.ChangeCellToCode="jupyter.changeCellToCode",Le.GotoNextCellInFile="jupyter.gotoNextCellInFile",Le.GotoPrevCellInFile="jupyter.gotoPrevCellInFile",Le.ScrollToCell="jupyter.scrolltocell",Le.CreateNewNotebook="jupyter.createnewnotebook",Le.ViewJupyterOutput="jupyter.viewOutput",Le.ExportAsPythonScript="jupyter.exportAsPythonScript",Le.ExportToHTML="jupyter.exportToHTML",Le.ExportToPDF="jupyter.exportToPDF",Le.Export="jupyter.export",Le.NativeNotebookExport="jupyter.notebookeditor.export",Le.LatestExtension="jupyter.latestExtension",Le.EnableLoadingWidgetsFrom3rdPartySource="jupyter.enableLoadingWidgetScriptsFromThirdPartySource",Le.EnableDebugLogging="jupyter.enableDebugLogging",Le.ResetLoggingLevel="jupyter.resetLoggingLevel",Le.ShowDataViewer="jupyter.showDataViewer",Le.RefreshDataViewer="jupyter.refreshDataViewer",Le.ClearSavedJupyterUris="jupyter.clearSavedJupyterUris",Le.OpenVariableView="jupyter.openVariableView",Le.OpenOutlineView="jupyter.openOutlineView",Le.InteractiveClearAll="jupyter.interactive.clearAllCells",Le.InteractiveGoToCode="jupyter.interactive.goToCode",Le.InteractiveCopyCell="jupyter.interactive.copyCell",Le.InteractiveExportAsNotebook="jupyter.interactive.exportasnotebook",Le.InteractiveExportAs="jupyter.interactive.exportas",Le.RunByLine="jupyter.runByLine",Le.RunAndDebugCell="jupyter.runAndDebugCell",Le.RunByLineNext="jupyter.runByLineNext",Le.RunByLineStop="jupyter.runByLineStop",Le.ReplayPylanceLog="jupyter.replayPylanceLog",Le.ReplayPylanceLogStep="jupyter.replayPylanceLogStep",Le.InstallPythonExtensionViaKernelPicker="jupyter.installPythonExtensionViaKernelPicker",Le.InstallPythonViaKernelPicker="jupyter.installPythonViaKernelPicker",Le.ContinueEditSessionInCodespace="jupyter.continueEditSessionInCodespace"))(X||(X={}));var Hu;(n=>(n.DefaultDesignLenses=[X.RunCurrentCell,X.RunAllCellsAbove,X.DebugCell],n.DefaultDebuggingLenses=[X.DebugContinue,X.DebugStop,X.DebugStepOver],n.DebuggerCommands=[X.DebugContinue,X.DebugStop,X.DebugStepOver]))(Hu||(Hu={}));var Cr;(j=>(j.HasCodeCells="jupyter.hascodecells",j.IsInteractiveActive="jupyter.isinteractiveactive",j.OwnsSelection="jupyter.ownsSelection",j.HaveNativeCells="jupyter.havenativecells",j.HaveNative="jupyter.havenative",j.IsNativeActive="jupyter.isnativeactive",j.IsInteractiveOrNativeActive="jupyter.isinteractiveornativeactive",j.IsPythonOrNativeActive="jupyter.ispythonornativeactive",j.IsPythonOrInteractiveActive="jupyter.ispythonorinteractiveeactive",j.IsPythonOrInteractiveOrNativeActive="jupyter.ispythonorinteractiveornativeeactive",j.CanRestartNotebookKernel="jupyter.notebookeditor.canrestartNotebookkernel",j.CanInterruptNotebookKernel="jupyter.notebookeditor.canInterruptNotebookKernel",j.CanRestartInteractiveWindowKernel="jupyter.interactive.canRestartNotebookKernel",j.CanInterruptInteractiveWindowKernel="jupyter.interactive.canInterruptNotebookKernel",j.RunByLineCells="jupyter.notebookeditor.runByLineCells",j.RunByLineDocuments="jupyter.notebookeditor.runByLineDocuments",j.DebugDocuments="jupyter.notebookeditor.debugDocuments",j.IsPythonNotebook="jupyter.ispythonnotebook",j.IsJupyterKernelSelected="jupyter.kernel.isjupyter",j.IsDataViewerActive="jupyter.dataViewerActive",j.HasNativeNotebookOrInteractiveWindowOpen="jupyter.hasNativeNotebookOrInteractiveWindowOpen",j.ZmqAvailable="jupyter.zmqavailable",j.ReplayLogLoaded="jupyter.replayLogLoaded",j.KernelSource="jupyter.kernelSource"))(Cr||(Cr={}));var LE;(l=>(l.PythonCellMarker=/^(#\s*%%|#\s*\<codecell\>|#\s*In\[\d*?\]|#\s*In\[ \])/,l.PythonMarkdownCellMarker=/^(#\s*%%\s*\[markdown\]|#\s*\<markdowncell\>)/,l.UrlPatternRegEx="(?<PREFIX>https?:\\/\\/)((\\(.+\\s+or\\s+(?<IP>.+)\\))|(?<LOCAL>[^\\s]+))(?<REST>:.+)",l.HttpPattern=/https?:\/\//,l.ShapeSplitterRegEx=/.*,\s*(\d+).*/,l.SvgHeightRegex=/(\<svg.*height=\")(.*?)\"/,l.SvgWidthRegex=/(\<svg.*width=\")(.*?)\"/,l.SvgSizeTagRegex=/\<svg.*tag=\"sizeTag=\{(.*),\s*(.*)\}\"/))(LE||(LE={}));var GPe=Symbol("DataScienceStartupTime"),UE={major:4,minor:2},Io="application/vnd.jupyter.widget-view+json";var WE=7,cP="unknown";d();d();d();var Wre=new Map;function lB(){return Wre}d();d();d();var cB=Symbol("MicrotaskDelay");async function mc(r){return new Promise(e=>{setTimeout(()=>e(r),r)})}async function dP(r,e,t){return new Promise(n=>{let i,o=setTimeout(()=>i(!1),e),s=setInterval(()=>{r().then(a=>{a&&i(!0)}).catch(a=>i(!1))},t);i=a=>{clearTimeout(o),clearInterval(s),n(a)}})}function So(r,e,...t){let n=uP(e)?void 0:e;uP(e)&&t.push(e);let i,o=setTimeout(()=>i==null?void 0:i(n),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(o)),new Promise(s=>i=s)])}function Hv(r,e,...t){let n,i=setTimeout(()=>n==null?void 0:n(e),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(i)),new Promise((o,s)=>n=s)])}function VE(r){return typeof(r==null?void 0:r.then)=="function"&&typeof(r==null?void 0:r.catch)=="function"}function uP(r){return typeof(r==null?void 0:r.then)=="function"}var qO=class{constructor(e=null){this.scope=e;this._resolved=!1;this._rejected=!1;this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n})}get value(){return this._value}resolve(e){this._value=e,this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(e){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}};function Me(r=null){return new qO(r)}function Ju(r){let e=Me();return r.then(e.resolve.bind(e)).catch(e.reject.bind(e)),e}var Bv=class{constructor(){this.currentPromise=Promise.resolve(void 0)}async chain(e){let t=Me(),n=this.currentPromise;return this.currentPromise=this.currentPromise.then(async()=>{try{let i=await e();t.resolve(i)}catch(i){throw t.reject(i),i}}),await n,t.promise}chainFinally(e){let t=Me();return this.currentPromise=this.currentPromise.finally(()=>e().then(n=>t.resolve(n)).catch(n=>t.reject(n))),t.promise}};var Vre=(r,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},r);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},jre=r=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,r())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},Sp=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,o)=>{this.doResolve=i,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}));let n=()=>{var i;this.deferred=null,(i=this.doResolve)==null||i.call(this,null)};return this.deferred=t===cB?jre(n):Vre(t,n),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new Error("Canceled")),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}};d();var Mt=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}};function y(){}function aa(r){try{let e=r();VE(e)&&e.catch(y)}catch(e){}}function GO(r,e,t){let n=new Mt;try{t&&r(void 0);let i=e();return VE(i)?i.then(o=>(r({elapsed:n.elapsedTime,returnValue:o}),o)).catch(o=>{r({elapsed:n.elapsedTime,err:o})}):r({elapsed:n.elapsedTime,returnValue:i}),i}catch(i){throw r({elapsed:n.elapsedTime,err:i}),i}}function kn(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function dB(r){let e=kn(r)?r:r.uri;return e.scheme.includes(Ip)||e.path.endsWith(".interactive")}function _p(){return process.platform.toString()==="web"}function uB(r,e){return kn(e)?e.toString():e}function pB(r,e){return r===e?!0:r&&!e||!r&&e?!1:JSON.stringify(r,uB)===JSON.stringify(e,uB)}var ITe=lB();function _n(r){return function(e,t,n){let i=n.value,o=`Jupyter Extension (Error in ${r||t}, method:${t}):`;n.value=function(...s){try{let a=i.apply(this,s);if(a&&typeof a.then=="function"&&typeof a.catch=="function")return a.catch(l=>{Sn()||O(o,l)})}catch(a){if(Sn())return;O(o,a)}}}}function fB(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a={kind:"Class",name:t&&t.constructor?t.constructor.name:"",args:s,methodName:n,target:t},l=this;return GO(c=>r(a,c),()=>o.apply(l,s),e)},i}}function Jv(){return function(r,e,t){let n=t.value;return t.value=function(...i){if(!Sn())throw new Error(`Function: ${e} can only be called from test code`);return n.apply(this,i)},t}}function YO(){return function(r,e,t){let n=t.value,i=`chainedPromiseFor_${e}`;return t.value=async function(...o){let s=this[i];s?s=s.then(()=>n.apply(this,o)):s=n.apply(this,o),this[i]=s;let a=s.then(l=>l).catch(l=>{throw this[i]=void 0,l});return a.catch(y),a},t}}d();function $O(r,e){if(Array.isArray(r))return r.map(t=>$O(t,e)).join(", ");if(r===void 0)return"undefined";if(r===null)return"null";try{return r&&r.path?`<Uri:${r.path}>`:JSON.stringify(r)}catch(t){return`<${e} cannot be serialized for logging>`}}function zO(r){if(!r)return"";try{return r.map((t,n)=>{let i=$O(t,"argument");return`Arg ${n+1}: ${i}`}).join(", ")}catch(e){return""}}function mB(r){return`Return Value: ${$O(r,"Return value")}`}function pP(){let r=new Date,e=String(r.getHours()).padStart(2,"0"),t=String(r.getMinutes()).padStart(2,"0"),n=String(r.getSeconds()).padStart(2,"0"),i=String(r.getMilliseconds()).padStart(3,"0");return`${e}:${t}:${n}.${i}`}d();function dt(r,e={removeEmptyEntries:!0,trim:!0}){r=r||"";let t=r.split(/\r?\n/g);return e&&e.trim&&(t=t.map(n=>n.trim())),e&&e.removeEmptyEntries&&(t=t.filter(n=>n.length>0)),t}function Bre(r){return r&&(r.indexOf(" ")>=0&&!r.startsWith('"')&&!r.endsWith('"')?`"${r}"`:r.toString())}function QO(r){return r&&Bre(r).replace(/\\/g,"/")}function jE(r){return r&&r.replace(/(^['"])|(['"]$)/g,"")}function qv(r){return r?r.replace(/\$\([a-z0-9\-]+?\)/gi,"").trim():r||""}function Gv(r){let e=r.split(`
`),t=e.find(n=>n.trim().length>0&&!n.trim().startsWith("#"));if(t){let n=t.match(/^\s*/)[0];return e.map(i=>i.startsWith(n)?i.replace(n,""):i).join(`
`)}return r}d();var sL=require("vscode");d();d();d();var mP="en",gP=!1,vP=!1,BE=!1,Hre=!1,Jre=!1,ZO=!1,qre=!1,Gre=!1,Yre=!1,fP,hP=mP,$re,Cp,la=typeof self=="object"?self:{},Vn;typeof la.vscode!="undefined"&&typeof la.vscode.process!="undefined"?Vn=la.vscode.process:typeof process!="undefined"&&(Vn=process);var gB,vB=typeof((gB=Vn==null?void 0:Vn.versions)==null?void 0:gB.electron)=="string",yB=vB&&(Vn==null?void 0:Vn.type)==="renderer",DTe=yB&&(Vn==null?void 0:Vn.sandboxed);if(typeof navigator=="object"&&!yB)Cp=navigator.userAgent,gP=Cp.indexOf("Windows")>=0,vP=Cp.indexOf("Macintosh")>=0,Gre=(Cp.indexOf("Macintosh")>=0||Cp.indexOf("iPad")>=0||Cp.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,BE=Cp.indexOf("Linux")>=0,ZO=!0,fP=navigator.language,hP=fP;else if(typeof Vn=="object"){gP=Vn.platform==="win32",vP=Vn.platform==="darwin",BE=Vn.platform==="linux",Hre=BE&&!!Vn.env.SNAP&&!!Vn.env.SNAP_REVISION,qre=vB,Yre=!!Vn.env.CI||!!Vn.env.BUILD_ARTIFACTSTAGINGDIRECTORY,fP=mP,hP=mP;let r=Vn.env.VSCODE_NLS_CONFIG;if(r)try{let e=JSON.parse(r),t=e.availableLanguages["*"];fP=e.locale,hP=t||mP,$re=e._translationsConfigFile}catch(e){}Jre=!0}else console.error("Unable to resolve platform.");var XO=0;vP?XO=1:gP?XO=3:BE&&(XO=2);var HE=gP,bB=vP,IB=BE;var yP=ZO,PTe=ZO&&typeof la.importScripts=="function";var hc=Cp,Ep=hP,hB;(n=>{function r(){return Ep}n.value=r;function e(){return Ep.length===2?Ep==="en":Ep.length>=3?Ep[0]==="e"&&Ep[1]==="n"&&Ep[2]==="-":!1}n.isDefaultVariant=e;function t(){return Ep==="en"}n.isDefault=t})(hB||(hB={}));var TTe=(()=>{if(typeof la.postMessage=="function"&&!la.importScripts){let r=[];la.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=r.length;n<i;n++){let o=r[n];if(o.id===t.data.vscodeScheduleAsyncWork){r.splice(n,1),o.callback();return}}});let e=0;return t=>{let n=++e;r.push({id:n,callback:t}),la.postMessage({vscodeScheduleAsyncWork:n},"*")}}return r=>setTimeout(r)})();var zre=!!(hc&&hc.indexOf("Chrome")>=0),kTe=!!(hc&&hc.indexOf("Firefox")>=0),NTe=!!(!zre&&hc&&hc.indexOf("Safari")>=0),RTe=!!(hc&&hc.indexOf("Edg/")>=0),ATe=!!(hc&&hc.indexOf("Android")>=0);var Wm;if(typeof la.vscode!="undefined"&&typeof la.vscode.process!="undefined"){let r=la.vscode.process;Wm={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process!="undefined"?Wm={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Wm={get platform(){return HE?"win32":bB?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var bP=Wm.cwd,SB=Wm.env,Go=Wm.platform,FTe=Wm.arch;var Xre=65,Zre=97,ene=90,tne=122,Dp=46,vi=47,Yo=92,wp=58,rne=63,IP=class extends Error{constructor(t,n,i){let o;typeof n=="string"&&n.indexOf("not ")===0?(o="must not be",n=n.replace(/^not /,"")):o="must be";let s=t.indexOf(".")!==-1?"property":"argument",a=`The "${t}" ${s} ${o} of type ${n}`;a+=`. Received type ${typeof i}`;super(a);this.code="ERR_INVALID_ARG_TYPE"}};function En(r,e){if(typeof r!="string")throw new IP(e,"string",r)}function kt(r){return r===vi||r===Yo}function eL(r){return r===vi}function xp(r){return r>=Xre&&r<=ene||r>=Zre&&r<=tne}function SP(r,e,t,n){let i="",o=0,s=-1,a=0,l=0;for(let c=0;c<=r.length;++c){if(c<r.length)l=r.charCodeAt(c);else{if(n(l))break;l=vi}if(n(l)){if(!(s===c-1||a===1))if(a===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==Dp||i.charCodeAt(i.length-2)!==Dp){if(i.length>2){let u=i.lastIndexOf(t);u===-1?(i="",o=0):(i=i.slice(0,u),o=i.length-1-i.lastIndexOf(t)),s=c,a=0;continue}else if(i.length!==0){i="",o=0,s=c,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",o=2)}else i.length>0?i+=`${t}${r.slice(s+1,c)}`:i=r.slice(s+1,c),o=c-s-1;s=c,a=0}else l===Dp&&a!==-1?++a:a=-1}return i}function _B(r,e){if(e===null||typeof e!="object")throw new IP("pathObject","Object",e);let t=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${n}`:`${t}${r}${n}`:n}var jn={resolve(...r){let e="",t="",n=!1;for(let i=r.length-1;i>=-1;i--){let o;if(i>=0){if(o=r[i],En(o,"path"),o.length===0)continue}else e.length===0?o=bP():(o=SB[`=${e}`]||bP(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Yo)&&(o=`${e}\\`));let s=o.length,a=0,l="",c=!1,u=o.charCodeAt(0);if(s===1)kt(u)&&(a=1,c=!0);else if(kt(u))if(c=!0,kt(o.charCodeAt(1))){let p=2,f=p;for(;p<s&&!kt(o.charCodeAt(p));)p++;if(p<s&&p!==f){let m=o.slice(f,p);for(f=p;p<s&&kt(o.charCodeAt(p));)p++;if(p<s&&p!==f){for(f=p;p<s&&!kt(o.charCodeAt(p));)p++;(p===s||p!==f)&&(l=`\\\\${m}\\${o.slice(f,p)}`,a=p)}}}else a=1;else xp(u)&&o.charCodeAt(1)===wp&&(l=o.slice(0,2),a=2,s>2&&kt(o.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,n=c,c&&e.length>0)break}return t=SP(t,!n,"\\",kt),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){En(r,"path");let e=r.length;if(e===0)return".";let t=0,n,i=!1,o=r.charCodeAt(0);if(e===1)return eL(o)?"\\":r;if(kt(o))if(i=!0,kt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!kt(r.charCodeAt(a));)a++;if(a<e&&a!==l){let c=r.slice(l,a);for(l=a;a<e&&kt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!kt(r.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${r.slice(l)}\\`;a!==l&&(n=`\\\\${c}\\${r.slice(l,a)}`,t=a)}}}else t=1;else xp(o)&&r.charCodeAt(1)===wp&&(n=r.slice(0,2),t=2,e>2&&kt(r.charCodeAt(2))&&(i=!0,t=3));let s=t<e?SP(r.slice(t),!i,"\\",kt):"";return s.length===0&&!i&&(s="."),s.length>0&&kt(r.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(r){En(r,"path");let e=r.length;if(e===0)return!1;let t=r.charCodeAt(0);return kt(t)||e>2&&xp(t)&&r.charCodeAt(1)===wp&&kt(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let o=0;o<r.length;++o){let s=r[o];En(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&kt(t.charCodeAt(0))){++i;let o=t.length;o>1&&kt(t.charCodeAt(1))&&(++i,o>2&&(kt(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&kt(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return jn.normalize(e)},relative(r,e){if(En(r,"from"),En(e,"to"),r===e)return"";let t=jn.resolve(r),n=jn.resolve(e);if(t===n||(r=t.toLowerCase(),e=n.toLowerCase(),r===e))return"";let i=0;for(;i<r.length&&r.charCodeAt(i)===Yo;)i++;let o=r.length;for(;o-1>i&&r.charCodeAt(o-1)===Yo;)o--;let s=o-i,a=0;for(;a<e.length&&e.charCodeAt(a)===Yo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Yo;)l--;let c=l-a,u=s<c?s:c,p=-1,f=0;for(;f<u;f++){let h=r.charCodeAt(i+f);if(h!==e.charCodeAt(a+f))break;h===Yo&&(p=f)}if(f!==u){if(p===-1)return n}else{if(c>u){if(e.charCodeAt(a+f)===Yo)return n.slice(a+f+1);if(f===2)return n.slice(a+f)}s>u&&(r.charCodeAt(i+f)===Yo?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=i+p+1;f<=o;++f)(f===o||r.charCodeAt(f)===Yo)&&(m+=m.length===0?"..":"\\..");return a+=p,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===Yo&&++a,n.slice(a,l))},toNamespacedPath(r){if(typeof r!="string")return r;if(r.length===0)return"";let e=jn.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===Yo){if(e.charCodeAt(1)===Yo){let t=e.charCodeAt(2);if(t!==rne&&t!==Dp)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(xp(e.charCodeAt(0))&&e.charCodeAt(1)===wp&&e.charCodeAt(2)===Yo)return`\\\\?\\${e}`;return r},dirname(r){En(r,"path");let e=r.length;if(e===0)return".";let t=-1,n=0,i=r.charCodeAt(0);if(e===1)return kt(i)?r:".";if(kt(i)){if(t=n=1,kt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!kt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&kt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!kt(r.charCodeAt(a));)a++;if(a===e)return r;a!==l&&(t=n=a+1)}}}}else xp(i)&&r.charCodeAt(1)===wp&&(t=e>2&&kt(r.charCodeAt(2))?3:2,n=t);let o=-1,s=!0;for(let a=e-1;a>=n;--a)if(kt(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(t===-1)return".";o=t}return r.slice(0,o)},basename(r,e){e!==void 0&&En(e,"ext"),En(r,"path");let t=0,n=-1,i=!0,o;if(r.length>=2&&xp(r.charCodeAt(0))&&r.charCodeAt(1)===wp&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=t;--o){let l=r.charCodeAt(o);if(kt(l)){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=t;--o)if(kt(r.charCodeAt(o))){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){En(r,"path");let e=0,t=-1,n=0,i=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===wp&&xp(r.charCodeAt(0))&&(e=n=2);for(let a=r.length-1;a>=e;--a){let l=r.charCodeAt(a);if(kt(l)){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===Dp?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":r.slice(t,i)},format:_B.bind(null,"\\"),parse(r){En(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.length,n=0,i=r.charCodeAt(0);if(t===1)return kt(i)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(kt(i)){if(n=1,kt(r.charCodeAt(1))){let p=2,f=p;for(;p<t&&!kt(r.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&kt(r.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&!kt(r.charCodeAt(p));)p++;p===t?n=p:p!==f&&(n=p+1)}}}}else if(xp(i)&&r.charCodeAt(1)===wp){if(t<=2)return e.root=e.dir=r,e;if(n=2,kt(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;n=3}}n>0&&(e.root=r.slice(0,n));let o=-1,s=n,a=-1,l=!0,c=r.length-1,u=0;for(;c>=n;--c){if(i=r.charCodeAt(c),kt(i)){if(!l){s=c+1;break}continue}a===-1&&(l=!1,a=c+1),i===Dp?o===-1?o=c:u!==1&&(u=1):o!==-1&&(u=-1)}return a!==-1&&(o===-1||u===0||u===1&&o===a-1&&o===s+1?e.base=e.name=r.slice(s,a):(e.name=r.slice(s,o),e.base=r.slice(s,a),e.ext=r.slice(o,a))),s>0&&s!==n?e.dir=r.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},Dr={resolve(...r){let e="",t=!1;for(let n=r.length-1;n>=-1&&!t;n--){let i=n>=0?r[n]:bP();En(i,"path"),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===vi)}return e=SP(e,!t,"/",eL),t?`/${e}`:e.length>0?e:"."},normalize(r){if(En(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===vi,t=r.charCodeAt(r.length-1)===vi;return r=SP(r,!e,"/",eL),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return En(r,"path"),r.length>0&&r.charCodeAt(0)===vi},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){let n=r[t];En(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":Dr.normalize(e)},relative(r,e){if(En(r,"from"),En(e,"to"),r===e||(r=Dr.resolve(r),e=Dr.resolve(e),r===e))return"";let t=1,n=r.length,i=n-t,o=1,s=e.length-o,a=i<s?i:s,l=-1,c=0;for(;c<a;c++){let p=r.charCodeAt(t+c);if(p!==e.charCodeAt(o+c))break;p===vi&&(l=c)}if(c===a)if(s>a){if(e.charCodeAt(o+c)===vi)return e.slice(o+c+1);if(c===0)return e.slice(o+c)}else i>a&&(r.charCodeAt(t+c)===vi?l=c:c===0&&(l=0));let u="";for(c=t+l+1;c<=n;++c)(c===n||r.charCodeAt(c)===vi)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(En(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===vi,t=-1,n=!0;for(let i=r.length-1;i>=1;--i)if(r.charCodeAt(i)===vi){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&En(e,"ext"),En(r,"path");let t=0,n=-1,i=!0,o;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===vi){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===vi){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){En(r,"path");let e=-1,t=0,n=-1,i=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===vi){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===Dp?e===-1?e=s:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===t+1?"":r.slice(e,n)},format:_B.bind(null,"/"),parse(r){En(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.charCodeAt(0)===vi,n;t?(e.root="/",n=1):n=0;let i=-1,o=0,s=-1,a=!0,l=r.length-1,c=0;for(;l>=n;--l){let u=r.charCodeAt(l);if(u===vi){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),u===Dp?i===-1?i=l:c!==1&&(c=1):i!==-1&&(c=-1)}if(s!==-1){let u=o===0&&t?1:o;i===-1||c===0||c===1&&i===s-1&&i===o+1?e.base=e.name=r.slice(u,s):(e.name=r.slice(u,i),e.base=r.slice(u,s),e.ext=r.slice(i,s))}return o>0?e.dir=r.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Dr.win32=jn.win32=jn;Dr.posix=jn.posix=Dr;var Ps=Go==="win32"?jn.normalize:Dr.normalize,WTe=Go==="win32"?jn.isAbsolute:Dr.isAbsolute,JE=Go==="win32"?jn.join:Dr.join,EB=Go==="win32"?jn.resolve:Dr.resolve,CB=Go==="win32"?jn.relative:Dr.relative,Ri=Go==="win32"?jn.dirname:Dr.dirname,sr=Go==="win32"?jn.basename:Dr.basename,Pp=Go==="win32"?jn.extname:Dr.extname,VTe=Go==="win32"?jn.format:Dr.format,jTe=Go==="win32"?jn.parse:Dr.parse,BTe=Go==="win32"?jn.toNamespacedPath:Dr.toNamespacedPath,Yi=Go==="win32"?jn.sep:Dr.sep,HTe=Go==="win32"?jn.delimiter:Dr.delimiter;d();var GE=require("vscode");d();d();d();d();var nne=require("vscode");var _P=class{constructor(e){this.computeFn=e;this.lastCache=void 0;this.lastArgKey=void 0}get(e){let t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.computeFn(e)),this.lastCache}};d();var qE=class r{constructor(e){this.executor=e;this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new r(()=>e(this.getValue()))}};function TB(r,e){return r<e?-1:r>e?1:0}function ine(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),c=e.charCodeAt(i);if(l<c)return-1;if(l>c)return 1}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function kB(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),c=e.charCodeAt(i);if(l===c)continue;if(l>=128||c>=128)return ine(r.toLowerCase(),e.toLowerCase(),t,n,i,o);wB(l)&&(l-=32),wB(c)&&(c-=32);let u=l-c;if(u!==0)return u}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function wB(r){return r>=97&&r<=122}function NB(r,e){return r.length===e.length&&kB(r,e)===0}function RB(r,e){let t=e.length;return e.length>r.length?!1:kB(r,e,0,t)===0}var gc=class gc{constructor(e){this.confusableDictionary=e}static getInstance(e){return gc.cache.get(Array.from(e))}static getLocales(){return gc._locales.getValue()}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};gc.ambiguousCharacterData=new qE(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),gc.cache=new _P(e=>{function t(u){let p=new Map;for(let f=0;f<u.length;f+=2)p.set(u[f],u[f+1]);return p}function n(u,p){let f=new Map(u);for(let[m,h]of p)f.set(m,h);return f}function i(u,p){if(!u)return p;let f=new Map;for(let[m,h]of u)p.has(m)&&f.set(m,h);return f}let o=gc.ambiguousCharacterData.getValue(),s=e.filter(u=>!u.startsWith("_")&&u in o);s.length===0&&(s=["_default"]);let a;for(let u of s){let p=t(o[u]);a=i(a,p)}let l=t(o._common),c=n(l,a);return new gc(c)}),gc._locales=new qE(()=>Object.keys(gc.ambiguousCharacterData.getValue()).filter(e=>!e.startsWith("_")));var xB=gc,Yv=class Yv{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(Yv.getRawData())),this._data}static isInvisibleCharacter(e){return Yv.getData().has(e)}static get codePoints(){return Yv.getData()}};Yv._data=void 0;var DB=Yv;function Tp(r){return r===47||r===92}function tL(r){return r.replace(/[\\/]/g,Dr.sep)}function AB(r){return r.indexOf("/")===-1&&(r=tL(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function rL(r,e=Dr.sep){if(!r)return"";let t=r.length,n=r.charCodeAt(0);if(Tp(n)){if(Tp(r.charCodeAt(1))&&!Tp(r.charCodeAt(2))){let o=3,s=o;for(;o<t&&!Tp(r.charCodeAt(o));o++);if(s!==o&&!Tp(r.charCodeAt(o+1))){for(o+=1;o<t;o++)if(Tp(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(one(n)&&r.charCodeAt(1)===58)return Tp(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let i=r.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(Tp(r.charCodeAt(i)))return r.slice(0,i+1)}return""}function nL(r,e,t,n=Yi){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!RB(r,e))return!1;if(e.length===r.length)return!0;let o=e.length;return e.charAt(e.length-1)===n&&o--,r.charAt(o)===n}return e.charAt(e.length-1)!==n&&(e+=n),r.indexOf(e)===0}function one(r){return r>=65&&r<=90||r>=97&&r<=122}d();var Xa;(le=>(le.inMemory="inmemory",le.vscode="vscode",le.internal="private",le.walkThrough="walkThrough",le.walkThroughSnippet="walkThroughSnippet",le.http="http",le.https="https",le.file="file",le.mailto="mailto",le.untitled="untitled",le.data="data",le.command="command",le.vscodeRemote="vscode-remote",le.vscodeRemoteResource="vscode-remote-resource",le.vscodeUserData="vscode-userdata",le.vscodeCustomEditor="vscode-custom-editor",le.vscodeNotebook="vscode-notebook",le.vscodeNotebookCell="vscode-notebook-cell",le.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",le.vscodeNotebookCellOutput="vscode-notebook-cell-output",le.vscodeInteractive="vscode-interactive",le.vscodeInteractiveInput="vscode-interactive-input",le.vscodeSettings="vscode-settings",le.vscodeWorkspaceTrust="vscode-workspace-trust",le.vscodeTerminal="vscode-terminal",le.webviewPanel="webview-panel",le.vscodeWebview="vscode-webview",le.extension="extension",le.vscodeFileResource="vscode-file",le.tmp="tmp",le.vsls="vsls"))(Xa||(Xa={}));function Za(r){return yP?(r==null?void 0:r.path)||"":(r==null?void 0:r.fsPath)||""}var YE=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:TB(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1,i=HE?"\\":"/"){if(e.scheme===t.scheme){if(e.scheme===Xa.file)return nL(Za(e),Za(t),this._ignorePathCasing(e),i)&&e.query===t.query&&(n||e.fragment===t.fragment);if(MB(e.authority,t.authority))return nL(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return GE.Uri.joinPath(e,...t)}basenameOrAuthority(e){return yi(e)||e.authority}basename(e,t){return Dr.basename(e.path,t)}extname(e){return Dr.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Xa.file?t=GE.Uri.file(Ri(Za(e))).path:(t=Dr.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Xa.file?t=GE.Uri.file(Ps(Za(e))).path:t=Dr.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!MB(e.authority,t.authority))return;if(e.scheme===Xa.file){let o=CB(Za(e),Za(t));return HE?tL(o):o}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(let s=Math.min(n.length,i.length);o<s&&!(n.charCodeAt(o)!==i.charCodeAt(o)&&n.charAt(o).toLowerCase()!==i.charAt(o).toLowerCase());o++);n=i.substr(0,o)+n.substr(o)}return Dr.relative(n,i)}resolvePath(e,t){if(e.scheme===Xa.file){let n=GE.Uri.file(EB(Za(e),t));return e.with({authority:n.authority,path:n.path})}return t=AB(t),e.with({path:Dr.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&NB(e,t)}hasTrailingPathSeparator(e,t=Yi){if(e.scheme===Xa.file){let n=Za(e);return n.length>rL(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Yi){return OB(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Yi){let n=!1;if(e.scheme===Xa.file){let i=Za(e);n=i!==void 0&&i.length===rL(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!OB(e,t)?e.with({path:e.path+"/"}):e}},hr=new YE(()=>!1),hke=new YE(r=>r.scheme===Xa.file?!IB:!0),gke=new YE(r=>!0),ca=hr.isEqual.bind(hr),EP=hr.isEqualOrParent.bind(hr),el=hr.getComparisonKey.bind(hr),vke=hr.basenameOrAuthority.bind(hr),yi=hr.basename.bind(hr),$v=hr.extname.bind(hr),zv=hr.dirname.bind(hr),$i=hr.joinPath.bind(hr),yke=hr.normalizePath.bind(hr),iL=hr.relativePath.bind(hr),bke=hr.resolvePath.bind(hr),Ike=hr.isAbsolutePath.bind(hr),MB=hr.isEqualAuthority.bind(hr),OB=hr.hasTrailingPathSeparator.bind(hr),Ske=hr.removeTrailingPathSeparator.bind(hr),_ke=hr.addTrailingPathSeparator.bind(hr),LB;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(u=>{let[p,f]=u.split(":");p&&f&&a.set(p,f)});let c=s.path.substring(0,s.path.indexOf(";"));return c&&a.set(o.META_DATA_MIME,c),a}o.parseMetaData=i})(LB||(LB={}));d();function Ai(r=process.platform){return/^win/.test(r)?"Windows":/^darwin/.test(r)?"OSX":/^linux/.test(r)?"Linux":"Unknown"}function CP(r,e){return r.replace(/^~(?=$|\/|\\)/,e)}function ane(){if(!_p())return sL.Uri.file(require("os").homedir())}function pt(r){let e=Ai()==="Windows";if(r){let t=Za(r);return t&&t.startsWith(Yi)&&t.length>1&&t[1]!==Yi&&e?t.slice(1):t||""}return""}function Se(r,e=[],t){t=t||ane();let n;typeof r=="string"&&(n=sL.Uri.file(r)),typeof r!="string"&&(n=r);let i=oL(n,void 0,t),o=e.find(l=>n&&EP(n,l.uri,!0));if(e.length>1&&o)return`${o.name}${Yi}${oL(n,o.uri,t)}`;let s=o?[oL(n,o.uri,t)]:[],a=i;return[i,...s].forEach(l=>{l.length<a.length&&(a=l)}),a}function oL(r,e,t){let n=Ai()==="Windows";if(r&&e&&EP(r,e,!0)){let i=iL(e,r);if(i)return n?i.replace(/\//g,"\\"):i}if(r&&t&&EP(r,t,!0)){let i=iL(t,r);if(i)return i=n?i.replace(/\//g,"\\"):i,`~${Yi}${i}`}return pt(r)}var aL="",une=3,Vm=[];function xP(r){return Vm.push(r),{dispose:()=>{Vm=Vm.filter(e=>e!==r)}}}var dne=new Map([["error",40],["warn",30],["info",20],["debug",10],["none",100],["off",100],[void 0,40]]),Qv=10;function cL(r){var e;Qv=typeof r=="number"?r:(e=dne.get(r))!=null?e:40}function KB(...r){return Qv<=5?r:r.map(t=>{if(!(t instanceof Error)||!("isJupyterError"in t))return t;let n=[`${t.name}: ${t.message}`.trim()];if("kernelConnectionMetadata"in t&&t.kernelConnectionMetadata&&typeof t.kernelConnectionMetadata=="object"&&"id"in t.kernelConnectionMetadata&&(n.push(`Kernel Id = ${t.kernelConnectionMetadata.id}`),"interpreter"in t.kernelConnectionMetadata&&t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter=="object"&&"id"in t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter.id=="string"&&n.push(`Interpreter Id = ${Se(t.kernelConnectionMetadata.interpreter.id)}`)),t.stack){let o=dt(t.stack),s=o.find(a=>a.indexOf("at ")===0);o.length===1||(o.length===1?n.push(o[0]):o.length>1&&(s!=null&&s.length)?n.push(s):n.push(o[0]))}let i=["stack","message","name","kernelConnectionMetadata","category","exitCode","isJupyterError"];return Object.keys(t).filter(o=>i.indexOf(o)===-1).forEach(o=>n.push(`${o} = ${String(t[o]).trim()}`)),n.filter(o=>o.trim().length).map((o,s)=>s===0?o:`    > ${o}`).join(`
`)})}function O(r,...e){Qv<=40&&(e=KB(...e),Vm.forEach(t=>t.traceError(r,...e)))}function ue(r,...e){Qv<=30&&(e=KB(...e),Vm.forEach(t=>t.traceWarn(r,...e)))}function De(r,...e){Qv<=20&&Vm.forEach(t=>t.traceInfo(r,...e))}function q(r,...e){Qv<=5&&Vm.forEach(t=>t.traceVerbose(r,...e))}function Ie(r,...e){if(Ni)if(typeof r=="function"){let n=r(),i="",o=[];typeof n=="string"?i=n:(i=n.shift(),o=n),De(i,...o)}else De(r,...e)}function FB(r,e=une){return pne({message:r,opts:e,level:5})}var qu=new WeakMap;function uL(r){return(e,t,n)=>{qu.has(e)||qu.set(e,new Map);let i=qu.get(e);i||qu.set(e,i=new Map),i.has(t)||i.set(t,[]),i.get(t).push({parameterIndex:n,propertyOfParameterToLog:r})}}function UB(){return(r,e,t)=>{qu.has(r)||qu.set(r,new Map);let n=qu.get(r);n||qu.set(r,n=new Map),n.has(e)||n.set(e,[]),n.get(e).push({parameterIndex:t,ignore:!0})}}function pne(r){return fB((e,t)=>vne(r,t,e),(r.opts&4)>0)}function fne(r){let{kind:e,name:t,args:n}=r;return(!e||e==="")&&(e="Function"),(!t||t==="")&&(t="<anon>"),n||(n=[]),{kind:e,name:t,args:n,methodName:r.methodName||"",target:r.target||void 0}}function mne(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function lL(r){let e=aL?r.toLowerCase().indexOf(aL):-1;return e===-1?r:`~${r.substring(e+aL.length)}`}function hne(r,e,t,n){var a;if(mne(t))return lL(t.path);if(!t)return t;let i=(a=qu.get(r))==null?void 0:a.get(e),o=i==null?void 0:i.find(l=>l.parameterIndex===n);if(!o)return typeof t=="string"?lL(t):t;if("ignore"in o&&o.ignore)return"";let s=t;return"propertyOfParameterToLog"in o&&o.propertyOfParameterToLog&&(s=t[o.propertyOfParameterToLog]),typeof s=="string"?lL(s):s}function gne(r,e,t){t=fne(t);let n=[r.message];return n.push(`${t.kind} name = ${t.name}`.trim()),e?(n.push(`completed in ${e.elapsed}ms`),n.push(`has a ${e.returnValue?"truthy":"falsy"} return value`)):n[n.length-1]=`${n[n.length-1]} (started execution)`,(r.opts&1)===1&&(r.level===5?n.push(zO(t.args.map((i,o)=>t?hne(t.target,t.methodName,i,o):i))):n.push(zO(t.args))),e&&(r.opts&2)===2&&n.push(mB(e.returnValue)),n.join(", ")}function vne(r,e,t){let n=gne(r,e,t);e?e.err===void 0?r.level&&r.level===40||(r.level?wP(r.level,n):wP(20,n)):wP(40,n,e.err):r.level&&r.level!==40&&wP(r.level,n)}function wP(r,e,...t){switch(r){case 40:O(e,...t);break;case 30:ue(e,...t);break;case 20:De(e,...t);break;case 10:q(e,...t);break;case 5:q(e,...t);break;default:break}}var Qa=require("vscode");d();var HV=require("vscode");d();var WB=Symbol("IsDevMode"),jm=Symbol("IOutputChannel"),VB=Symbol("IS_WINDOWS"),oe=Symbol("IDisposableRegistry"),wt=Symbol("IGlobalMemento"),ur=Symbol("IGlobalMemento"),Ts=Symbol("IWorkspaceMemento");var DP=Symbol("IPersistentStateFactory"),Jke=Symbol("IRandom"),Ke=Symbol("IConfigurationService"),ut=Symbol("ExtensionContext"),tl=Symbol("IExtensions"),qke=Symbol("IJupyterExtensionBanner"),PP=Symbol("IFeaturesManager"),Xv=Symbol("ICryptoUtils"),_o=Symbol("IAsyncDisposableRegistry");var Np=Symbol("IExperimentService"),Zv=Symbol("IDataScienceCommandListener"),ey=Symbol("IVariableScriptGenerator"),ty=Symbol("IDataFrameScriptGenerator");d();var Ez=require("vscode");d();var C7=z(XB()),eC=z(re());try{(0,eC.decorate)((0,eC.injectable)(),C7.EventEmitter)}catch(r){ue("Failed to decorate EventEmitter for DI (possibly already decorated by another Extension)",r)}var at=class{constructor(e){this.container=e;at._instance=this}static get instance(){return at._instance}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}};at=E([(0,eC.injectable)()],at);d();d();var Pt=require("vscode");d();var uy=Symbol("IPythonApi"),wo=Symbol("IPythonExtensionChecker");d();var C=require("vscode");d();var rt=require("vscode"),HL=60,JL=HL*60,tC=JL*24,w7=tC*7,x7=tC*30,D7=tC*365;function dy(r,e,t,n){typeof r!="number"&&(r=r.getTime());let i=Math.round((new Date().getTime()-r)/1e3);if(i<-30)return rt.l10n.t("in {0}",dy(new Date().getTime()+i*1e3,!1));if(!n&&i<30)return rt.l10n.t("now");let o;return i<HL?(o=i,e?o===1?t?rt.l10n.t("{0} second ago",o):rt.l10n.t("{0} sec ago",o):t?rt.l10n.t("{0} seconds ago",o):rt.l10n.t("{0} secs ago",o):o===1?t?rt.l10n.t("{0} second",o):rt.l10n.t("{0} sec",o):t?rt.l10n.t("{0} seconds",o):rt.l10n.t("{0} secs",o)):i<JL?(o=Math.floor(i/HL),e?o===1?t?rt.l10n.t("{0} minute ago",o):rt.l10n.t("{0} min ago",o):t?rt.l10n.t("{0} minutes ago",o):rt.l10n.t("{0} mins ago",o):o===1?t?rt.l10n.t("{0} minute",o):rt.l10n.t("{0} min",o):t?rt.l10n.t("{0} minutes",o):rt.l10n.t("{0} mins",o)):i<tC?(o=Math.floor(i/JL),e?o===1?t?rt.l10n.t("{0} hour ago",o):rt.l10n.t("{0} hr ago",o):t?rt.l10n.t("{0} hours ago",o):rt.l10n.t("{0} hrs ago",o):o===1?t?rt.l10n.t("{0} hour",o):rt.l10n.t("{0} hr",o):t?rt.l10n.t("{0} hours",o):rt.l10n.t("{0} hrs",o)):i<w7?(o=Math.floor(i/tC),e?o===1?rt.l10n.t("{0} day ago",o):rt.l10n.t("{0} days ago",o):o===1?rt.l10n.t("{0} day",o):rt.l10n.t("{0} days",o)):i<x7?(o=Math.floor(i/w7),e?o===1?t?rt.l10n.t("{0} week ago",o):rt.l10n.t("{0} wk ago",o):t?rt.l10n.t("{0} weeks ago",o):rt.l10n.t("{0} wks ago",o):o===1?t?rt.l10n.t("{0} week",o):rt.l10n.t("{0} wk",o):t?rt.l10n.t("{0} weeks",o):rt.l10n.t("{0} wks",o)):i<D7?(o=Math.floor(i/x7),e?o===1?t?rt.l10n.t("{0} month ago",o):rt.l10n.t("{0} mo ago",o):t?rt.l10n.t("{0} months ago",o):rt.l10n.t("{0} mos ago",o):o===1?t?rt.l10n.t("{0} month",o):rt.l10n.t("{0} mo",o):t?rt.l10n.t("{0} months",o):rt.l10n.t("{0} mos",o)):(o=Math.floor(i/D7),e?o===1?t?rt.l10n.t("{0} year ago",o):rt.l10n.t("{0} yr ago",o):t?rt.l10n.t("{0} years ago",o):rt.l10n.t("{0} yrs ago",o):o===1?t?rt.l10n.t("{0} year",o):rt.l10n.t("{0} yr",o):t?rt.l10n.t("{0} years",o):rt.l10n.t("{0} yrs",o))}d();d();d();d();var T7=z(re());var py=class{async createHash(e,t="SHA-256"){return ol(e,t)}};py=E([(0,T7.injectable)()],py);var lT={},P7=!1,cT;typeof window=="object"?cT=window.crypto:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?cT=self.crypto:cT=require("node:crypto").webcrypto;async function ol(r,e){let t=r.includes("/")||r.includes("\\")||r.endsWith(".interactive");if(t&&lT[r])return lT[r];let n=await cle(r,e);return t&&!P7&&(Object.keys(lT).length>1e4&&(P7=!0),lT[r]=n),n}async function cle(r,e){let t=new TextEncoder().encode(r),n=await cT.subtle.digest({name:e},t);return Array.from(new Uint8Array(n)).map(o=>o.toString(16).padStart(2,"0")).join("")}function fy(r){if(typeof r=="string")try{let[e,t,n]=`${r.trim()}...`.split(".").map(i=>parseInt(i,10));return isNaN(e)?"":isNaN(t)?e.toString():isNaN(n)?`${e}.${t}`:`${e}.${t}.${n}`}catch(e){return O(`Failed to parse version ${r}`,e),""}return r?`${r.major}.${r.minor}.${r.micro}`:""}async function Ot(r){return ol(r,"SHA-256")}var qL=z(k7());var rC=require("vscode");function sl(r){var l,c,u;let e=to(r);if(e){let p=[];typeof((l=e.version)==null?void 0:l.major)=="number"&&(p.push(e.version.major.toString()),typeof e.version.minor=="number"&&(p.push(e.version.minor.toString()),typeof e.version.micro=="number"&&p.push(e.version.micro.toString())));let f=p.length?p.join("."):"",m=((c=e.environment)==null?void 0:c.name)||(e.environment?yi((u=e.environment)==null?void 0:u.folderUri):""),h=f?`Python ${f}`:"Python";return fa(r)&&m?m:m?`${m} (${h})`:h}if(Object.keys(r).length===1&&r.id)return r.id;let t=fy($u(r)||"").trim(),n=fa(r),i=t?`Python ${t}`:"Python",o=ks(r);if(n&&o)return o;let s=[];o&&s.push(o);let a=Or(r);return a&&a!=="Unknown"&&s.push(a),[i,s.length?`(${s.join(": ")})`:""].join(" ").trim()}function ks(r){var n,i,o;let e=to(r),t=(n=e==null?void 0:e.environment)==null?void 0:n.name;return!t&&((i=e==null?void 0:e.environment)!=null&&i.folderUri)&&Or(r)==="Conda"&&(t=yi((o=e==null?void 0:e.environment)==null?void 0:o.folderUri)),t}var ple=["Unknown","Conda","PipEnv","Poetry","Pyenv","Venv","VirtualEnv","VirtualEnvWrapper"];function Or(r){let e=to(r);return e?fle(e):"Unknown"}function fle(r){var t,n;if(((t=r.environment)==null?void 0:t.type)==="Conda")return"Conda";let e=[["Conda","Conda"],["Pyenv","Pyenv"],["Pipenv","PipEnv"],["Poetry","Poetry"],["VirtualEnvWrapper","VirtualEnvWrapper"],["VirtualEnv","VirtualEnv"],["Venv","Venv"]];for(let[i,o]of e)if(r.tools.includes(i))return o;if(((n=r.environment)==null?void 0:n.type)==="VirtualEnvironment")return"VirtualEnv";for(let i of ple)if(r.tools.some(o=>o.toLowerCase()===i.toLowerCase()))return i;return"Unknown"}var Xo;function N7(r){Xo=r}function fa(r){if(!r||!Xo)return!1;let e=to(r);return e&&Or(e)==="Conda"&&!e.executable.uri}function to(r){if(r){if(!Xo)throw new Error("Python API not initialized");return Xo.environments.known.find(e=>e.id===r.id)}}async function GL(r){var n;if(!(r!=null&&r.id))return;if(Xo){let i=Xo.environments.known.find(o=>o.id===r.id);if((n=i==null?void 0:i.executable)!=null&&n.sysPrefix)return i.executable.sysPrefix}let t=await(await qL.PythonExtension.api()).environments.resolveEnvironment(r.id).then(i=>{var o;return(o=i==null?void 0:i.executable)==null?void 0:o.sysPrefix});return t||ue(`Unable to find sysPrefix for interpreter ${Se(r.id)}`),t}function R7(r){var t;if(!(r!=null&&r.id))return;if(!Xo)throw new Error("Python API not initialized");let e=Xo.environments.known.find(n=>n.id===r.id);return(t=e==null?void 0:e.executable)==null?void 0:t.sysPrefix}async function Op(r,e=!1){if(!(r!=null&&r.id))return;if(Xo&&!e){let i=Xo.environments.known.find(o=>o.id===r.id);if(i!=null&&i.version)return i.version}let n=await(await qL.PythonExtension.api()).environments.resolveEnvironment(r.id);return n!=null&&n.version||ue(`Unable to find Version for interpreter ${Se(r.id)}`),n==null?void 0:n.version}function $u(r){if(!(r!=null&&r.id))return;if(!Xo)throw new Error("Python API not initialized");let e=Xo.environments.known.find(t=>t.id===r.id);return e==null?void 0:e.version}function A7(){return Xo?Xo.environments.known:[]}function uT(r){var n,i;if(!r)return;let e,t=r.id;if(r.executable.uri)e=r.executable.uri;else if(Or(r)==="Conda")e=Ai()==="Windows"?rC.Uri.joinPath(((n=r.environment)==null?void 0:n.folderUri)||rC.Uri.file(r.path),"python.exe"):rC.Uri.joinPath(((i=r.environment)==null?void 0:i.folderUri)||rC.Uri.file(r.path),"bin","python");else{ue(`Python environment ${Se(r.id)} excluded as Uri is undefined`);return}return{id:t,uri:e}}function mle(r){return sl(r)}var Be;(I=>(I.bannerLabelYes=C.l10n.t("Yes"),I.bannerLabelNo=C.l10n.t("No"),I.canceled=C.l10n.t("Canceled"),I.cancel=C.l10n.t("Cancel"),I.ok=C.l10n.t("Ok"),I.refresh=C.l10n.t("Refresh"),I.refreshing=C.l10n.t("Refreshing..."),I.install=C.l10n.t("Install"),I.loadingExtension=C.l10n.t("Jupyter Extension loading..."),I.handleExtensionActivationError=C.l10n.t("Extension activation failed, run the 'Developer: Toggle Developer Tools' command for more information."),I.doNotShowAgain=C.l10n.t("Do not show again"),I.reload=C.l10n.t("Reload"),I.moreInfo=C.l10n.t("More Info"),I.learnMore=C.l10n.t("Learn more"),I.and=C.l10n.t("and"),I.reportThisIssue=C.l10n.t("Report this issue"),I.clickHereForMoreInfoWithHtml=S=>C.l10n.t("Click <a href='{0}'>here</a> for more info.",S)))(Be||(Be={}));var Lp;(t=>(t.notInGroup=n=>C.l10n.t("User does not belong to experiment group '{0}'",n),t.inGroup=n=>C.l10n.t("User belongs to experiment group '{0}'",n)))(Lp||(Lp={}));var dT;(e=>e.jupyter=C.l10n.t("Jupyter"))(dT||(dT={}));var M7;(e=>e.currentWorkingDirectory="cwd:")(M7||(M7={}));var O7;(e=>e.bannerMessage=C.l10n.t("Would you like shift-enter to send code to the new Interactive Window experience?"))(O7||(O7={}));var L7;(e=>e.bannerMessage=C.l10n.t("Can you please take a minute to tell us about your notebooks experience in VS Code?"))(L7||(L7={}));var K7;(t=>(t.bannerLabelYes=C.l10n.t("Yes, take survey now"),t.bannerLabelNo=C.l10n.t("No, thanks")))(K7||(K7={}));var _;(P=>(P.warnWhenSelectingKernelWithUnSupportedPythonVersion=C.l10n.t("The version of Python associated with the selected kernel is no longer supported. Please consider selecting a different kernel."),P.installingPythonExtension=C.l10n.t("Installing Python extension and locating kernels."),P.pythonExtensionRequired=C.l10n.t("The Python Extension is required to perform that task. Click Yes to open Python Extension installation page."),P.rendererExtensionRequired=C.l10n.t("The Renderer Extension is required to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),P.rendererExtension1015Required=C.l10n.t("The installed version of the Renderer Extension is outdated and requires and update to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),P.pythonExtensionInstalled=C.l10n.t("Python Extension is now installed. Some features might not be available until a notebook or interactive window session is restarted."),P.unknownPackage=C.l10n.t("unknown"),P.interactiveWindowTitleFormat=B=>C.l10n.t("Interactive - {0}",B),P.interactiveWindowModeBannerTitle=C.l10n.t({message:"Do you want to open a new Interactive Window for this file? [More Information](command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D).",args:[],comment:'The string "command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D" should not be translated. It is a command that opens the settings page with the "jupyter.interactiveWindowMode" setting selected.'}),P.interactiveWindowModeBannerSwitchYes=C.l10n.t("Yes"),P.interactiveWindowModeBannerSwitchNo=C.l10n.t("No"),P.dataExplorerTitle=C.l10n.t("Data Viewer"),P.badWebPanelFormatString=B=>C.l10n.t({message:"<html><body><h1>{0} is not a valid file name</h1></body></html>",args:[B],comment:["Only translate the text within the HTML tags"]}),P.installingMissingDependencies=C.l10n.t("Installing missing dependencies"),P.validatingKernelDependencies=C.l10n.t("Validating kernel dependencies"),P.performingExport=C.l10n.t("Performing Export"),P.exportNotebookToPython=C.l10n.t("Exporting Notebook to Python"),P.sessionDisposed=C.l10n.t("Cannot execute code, session has been disposed. Please try restarting the Kernel."),P.passwordFailure=C.l10n.t("Failed to connect to password protected server. Check that password is correct."),P.incorrectPassword=C.l10n.t("Incorrect Password."),P.exportDialogFilter=C.l10n.t("Jupyter Notebooks"),P.exportDialogComplete=B=>C.l10n.t("Notebook written to {0}",B),P.exportDialogFailed=B=>C.l10n.t("Failed to export notebook. {0}",B),P.exportOpenQuestion1=C.l10n.t("Open in editor"),P.runCellLensCommandTitle=C.l10n.t("Run Cell"),P.importDialogTitle=C.l10n.t("Import Jupyter Notebook"),P.importDialogFilter="Jupyter Notebooks",P.notebookCheckForImportNo=C.l10n.t("Later"),P.libraryRequiredToLaunchJupyterNotInstalled=B=>C.l10n.t("Running cells requires {0} package.",B),P.librariesRequiredToLaunchJupyterNotInstalled=B=>C.l10n.t("Running cells requires {0} package.",B),P.libraryRequiredToLaunchJupyterNotInstalledInterpreter=(B,tt)=>C.l10n.t("Running cells with '{0}' requires the {1} package.",B,tt),P.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter=(B,tt)=>C.l10n.t("Running cells with '{0}' requires the {1} package.",B,tt),P.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreterAndRequiresUpdate=(B,tt)=>C.l10n.t("Running cells with '{0}' requires the {1} package to be installed or requires an update.",B,tt),P.librariesRequiredToLaunchJupyterNotInstalledInterpreter=(B,tt)=>C.l10n.t("Running cells with '{0}' requires the {1} package.",B,tt),P.installPackageInstructions=(B,tt)=>C.l10n.t(`Run the following command to install '{0}' into the Python environment. 
Command: '{1}'`,B,tt),P.pythonCondaKernelsWithoutPython=C.l10n.t("The Python Runtime and IPyKernel will be automatically installed upon selecting this environment."),P.selectJupyterInterpreter=C.l10n.t("Select an Interpreter to start Jupyter"),P.jupyterInstall=C.l10n.t("Install"),P.currentlySelectedJupyterInterpreterForPlaceholder=B=>C.l10n.t("Selected Environment {0}",B),P.jupyterNotSupported=B=>C.l10n.t("Jupyter cannot be started. Error attempting to locate Jupyter: {0}",B),P.jupyterNotebookNotInstalledOrNotFound=B=>{if(B){let tt=mle(B);return C.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment '{0}'.",tt)}else return C.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment.")},P.jupyterNotSupportedBecauseOfEnvironment=(B,tt)=>C.l10n.t("Activating {0} to run Jupyter failed with {1}",B,tt),P.jupyterNbConvertNotSupported=C.l10n.t("Jupyter nbconvert is not installed"),P.jupyterLaunchTimedOut=C.l10n.t("The Jupyter notebook server failed to launch in time"),P.jupyterLaunchNoURL=C.l10n.t("Failed to find the URL of the launched Jupyter notebook server"),P.jupyterSelfCertFail=B=>C.l10n.t(`The security certificate used by server {0} was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,B),P.jupyterExpiredCertFail=B=>C.l10n.t(`The security certificate used by server {0} has expired.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,B),P.jupyterSelfCertFailErrorMessageOnly=C.l10n.t(`The security certificate used by server was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.`),P.jupyterSelfCertExpiredErrorMessageOnly=C.l10n.t(`The security certificate used by server has expired.\r
This may indicate an attempt to steal your information.`),P.jupyterSelfCertEnable=C.l10n.t("Yes, connect anyways"),P.jupyterSelfCertClose=C.l10n.t("No, close the connection"),P.pythonInteractiveHelpLink=C.l10n.t("See <https://aka.ms/pyaiinstall> for help on installing Jupyter."),P.importingFormat=B=>C.l10n.t("Importing {0}",B),P.startingJupyter=C.l10n.t("Starting Jupyter Server"),P.connectingToKernel=B=>C.l10n.t("Connecting to kernel: {0}",B),P.connectingToJupyter=C.l10n.t("Connecting to Jupyter Server"),P.exportingFormat=B=>C.l10n.t("Exporting {0}",B),P.runAllCellsLensCommandTitle=C.l10n.t("Run All Cells"),P.runAllCellsAboveLensCommandTitle=C.l10n.t("Run Above"),P.runCellAndAllBelowLensCommandTitle=C.l10n.t("Run Below"),P.restartKernelMessage=C.l10n.t("Do you want to restart the Jupyter kernel? All variables will be lost."),P.restartKernelMessageYes=C.l10n.t("Restart"),P.restartKernelMessageDontAskAgain=C.l10n.t("Don't Ask Again"),P.automaticallyReconnectingToAKernelProgressMessage=B=>C.l10n.t("Reconnecting to the kernel {0}",B),P.restartingKernelStatus=B=>C.l10n.t("Restarting Kernel {0}",B),P.interruptingKernelFailed=C.l10n.t("Kernel interrupt failed. Jupyter Server is hung. Please reload VS Code."),P.sessionStartFailedWithKernel=B=>C.l10n.t({message:`Failed to start the Kernel '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),P.failedToStartJupyter=B=>C.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),P.failedToStartJupyterWithErrorInfo=(B,tt)=>C.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
{1} 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B,tt],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),P.failedToStartJupyterDueToOutdatedTraitlets=(B,tt)=>C.l10n.t({message:`Failed to start Jupyter in the environment '{0}' possibly due to an outdated version of 'traitlets'. 
{1} 
Consider updating the 'traitlets' module to '5.1.1' or later. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B,tt],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the text 'traitlets', that is a Python module name"]}),P.failedToStartKernel=C.l10n.t("Failed to start the Kernel."),P.failedToRestartKernel=C.l10n.t("Failed to restart the Kernel."),P.failedToInterruptKernel=C.l10n.t("Failed to interrupt the Kernel."),P.rawKernelStartFailedDueToTimeout=B=>C.l10n.t({message:`Unable to start Kernel '{0}' due to a connection timeout. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),P.rawKernelStartFailedDueToTimeoutWaitingForPort=B=>C.l10n.t({message:`Unable to start Kernel '{0}' due to a timeout waiting for the ports to get used. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),P.viewJupyterLogForFurtherInfo=C.l10n.t({message:"View Jupyter [log](command:jupyter.viewOutput) for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),P.kernelDied=B=>C.l10n.t({message:"The kernel died. Error: {0}... View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),P.kernelDiedWithoutError=B=>C.l10n.t({message:"The kernel '{0}' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),P.failedToStartAnUntrustedKernelSpec=(B,tt)=>C.l10n.t({message:`The kernel '{0}' was not started as it is located in an insecure location '{1}'.  
Click [here](https://aka.ms/JupyterTrustedKernelPaths) for further details, optionally update the setting [jupyter.kernels.trusted](command:workbench.action.openSettings?["jupyter.kernels.trusted"]) to trust the kernel.`,args:[B,tt],comment:['Do not translate the text "jupyter.kernels.trusted", that is a setting in VS Code','Do not translate the text command:workbench.action.openSettings?["jupyter.kernels.trusted"], that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/JupyterTrustedKernelPaths"]}),P.kernelDiedWithoutErrorAndAutoRestarting=B=>C.l10n.t({message:"The kernel '{0}' died and is being automatically restarted by Jupyter. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),P.kernelCrashedDueToCodeInCurrentOrPreviousCell=C.l10n.t({message:`The Kernel crashed while executing code in the current cell or a previous cell. 
Please review the code in the cell(s) to identify a possible cause of the failure. 
Click <a href='https://aka.ms/vscodeJupyterKernelCrash'>here</a> for more info. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),P.kernelDisconnected=B=>C.l10n.t("Unable to connect to the kernel '{0}', please verify the Jupyter Server connection. View Jupyter [log](command:jupyter.viewOutput) for further details.",B),P.cannotRunCellKernelIsDead=B=>C.l10n.t("Cannot run cells, as the kernel '{0}' is dead.",B),P.showJupyterLogs=C.l10n.t("Show Jupyter Logs."),P.restartKernel=C.l10n.t("Restart Kernel"),P.reloadRequired=C.l10n.t("Please reload the window for new settings to take effect."),P.restartedKernelHeader=B=>C.l10n.t("Restarted {0}",B),P.connectedKernelHeader=B=>C.l10n.t("Connected to {0}",B),P.restartingKernelCustomHeader=B=>C.l10n.t("_Restarting {0}..._",B),P.restartingKernelHeader=C.l10n.t("_Restarting kernel..._"),P.startingNewKernelHeader=C.l10n.t("_Connecting to kernel..._"),P.startingNewKernelCustomHeader=B=>C.l10n.t("_Connecting to {0}..._",B),P.noKernelConnected=C.l10n.t("No kernel connected"),P.jupyterSelectUriCommandLabel=C.l10n.t("Enter the URL of the running Jupyter Server..."),P.jupyterSelectUriInputTitle=C.l10n.t("Enter the URL of the running Jupyter Server"),P.jupyterSelectUriInputPlaceholder=C.l10n.t("Enter the url of the running Jupyter Server"),P.connectToToTheJupyterServer=B=>C.l10n.t("Connect to the Jupyter Server {0}",B),P.enterOrSelectRemoteJupyterPlaceholder=C.l10n.t("Enter a remote url, or select a remote server"),P.selectRemoteJupyterPlaceholder=C.l10n.t("Select a remote server"),P.jupyterServerLastConnectionForQuickPickDescription=B=>C.l10n.t("Last connected {0}",dy(B,!0,!1,!1)),P.jupyterServerNotUsedBeforeQuickPickSeparatorTitle=C.l10n.t("Jupyter Servers"),P.jupyterSelectURIInvalidURI=C.l10n.t("Invalid URL specified"),P.jupyterSelectURIMustBeHttpOrHttps=C.l10n.t("Invalid protocol in URL specified, only HTTP or HTTPS are supported."),P.jupyterSelectLiveRemoteKernelDescription=(B,tt)=>B?tt===0?C.l10n.t("Last activity {0}",dy(B,!0,!1,!1)):tt===1?C.l10n.t("Last activity {0}, 1 connection",dy(B,!0,!1,!1)):C.l10n.t("Last activity {0}, {1} connections",dy(B,!0,!1,!1),tt.toString()):tt===0?"":tt===1?C.l10n.t("1 connection"):C.l10n.t("{0} connections",tt.toString()),P.installJupyterHub=C.l10n.t("Install the JupyterHub extension to connect to JupyterHub servers."),P.useJupyterHubExtension=C.l10n.t("Select 'Existing JupyterHub Server...' from the Kernel Picker"),P.useJupyterHubExtensionDetail=C.l10n.t("Use this option when connecting to JupyterHub servers"),P.installJupyterHubDetail=C.l10n.t("Once installed, open the Kernel Picker and select 'Existing JupyterHub Server...'"),P.jupyterSelectUserAndPasswordTitle=C.l10n.t("Enter your user name and password to connect to Jupyter Hub"),P.jupyterRenameServer=C.l10n.t("Change Server Display Name (Leave Blank To Use URL)"),P.jupyterServerUriDisplayNameInputPlaceholder=C.l10n.t("Enter a display name"),P.jupyterSelectUserPrompt=C.l10n.t("Enter your user name"),P.jupyterSelectPasswordPrompt=C.l10n.t("Enter your password"),P.jupyterSelectPasswordTitle=C.l10n.t("Enter your password for the Jupyter Server"),P.pythonNotInstalled=C.l10n.t(`Python is not installed. 
Please download and install Python in order to execute cells in this notebook. 
Once installed please reload VS Code.`),P.pleaseReloadVSCodeOncePythonHasBeenInstalled=C.l10n.t("Upon installing Python please reload VS Code."),P.jupyterNotebookFailure=B=>C.l10n.t(`Jupyter notebook failed to launch. \r
{0}`,B),P.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid=B=>C.l10n.t("The remote Jupyter Server contributed by the extension '{0}' is no longer available.",B),P.remoteJupyterConnectionFailedWithServerWithError=(B,tt)=>C.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable. ({1}).",B,tt),P.remoteJupyterConnectionFailedWithServer=B=>C.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable.",B),P.remoteJupyterConnectionFailedWithoutServerWithError=B=>C.l10n.t("Connection failure. Verify the server is running and reachable. ({0}).",B),P.remoteJupyterConnectionFailedWithoutServerWithErrorWeb=B=>C.l10n.t(`Connection failure. Verify the server is running and reachable from a browser. ({0}). 
When connecting from vscode.dev Jupyter servers must be started with specific options to connect. 
Click [here](https://aka.ms/vscjremoteweb) for more information.`,B),P.removeRemoteJupyterConnectionButtonText=C.l10n.t("Forget Connection"),P.jupyterNotebookRemoteConnectFailedWeb=B=>C.l10n.t(`Failed to connect to remote Jupyter Server.\r
Check that the Jupyter Server URL can be reached from a browser.\r
{0}. Click [here](https://aka.ms/vscjremoteweb) for more information.`,B),P.packageNotInstalledWindowsLongPathNotEnabledError=(B,tt)=>C.l10n.t(`Support for Windows Long Path has not been enabled, hence the package {0} could not be installed into the Python Environment '{1}'.
Please ensure that support for Windows Long Path is enabled.
See [here](https://pip.pypa.io/warnings/enable-long-paths) for more information.`,B,tt),P.changeRemoteJupyterConnectionButtonText=C.l10n.t("Manage Connections"),P.rawConnectionBrokenError=C.l10n.t("Direct kernel connection broken"),P.jupyterServerCrashed=B=>C.l10n.t(`Jupyter Server crashed. Unable to connect. \r
Error code from Jupyter: {0}`,B.toString()),P.jupyterKernelSpecModuleNotFound=B=>C.l10n.t(`'Kernelspec' module not installed in the selected interpreter ({0}).
 Please re-install or update 'jupyter'.`,B),P.interruptKernelStatus=B=>C.l10n.t("Interrupting Kernel {0}",B),P.exportPythonQuickPickLabel=C.l10n.t("Python Script"),P.exportHTMLQuickPickLabel=C.l10n.t("HTML"),P.exportPDFQuickPickLabel=C.l10n.t("PDF"),P.restartKernelAfterInterruptMessage=B=>C.l10n.t("Interrupting the kernel '{0}' timed out. Do you want to restart the kernel instead? All variables will be lost.",B),P.documentMismatch=B=>C.l10n.t("Cannot run cells, duplicate documents for {0} found.",B),P.jupyterGetVariablesBadResults=C.l10n.t("Failed to fetch variable info from the Jupyter Server."),C.l10n.t("Failure to create an 'Interactive' window. Try reinstalling the Python Extension."),P.jupyterGetVariablesExecutionError=B=>C.l10n.t(`Failure during variable extraction: \r
{0}`,B),P.selectKernel=C.l10n.t("Change Kernel"),P.selectDifferentKernel=C.l10n.t("Select a different Kernel"),P.kernelFilterPlaceholder=C.l10n.t("Choose the kernels that are available in the kernel picker."),P.recommendedItemCategoryInQuickPick=C.l10n.t("Recommended"),P.selectedKernelCategoryInQuickPick=C.l10n.t("Selected"),P.createPythonEnvironmentInQuickPick=C.l10n.t("Create Python Environment"),P.createPythonEnvironmentInQuickPickTooltip=C.l10n.t("Create an isolated Python Environment per workspace folder"),P.selectDifferentJupyterInterpreter=C.l10n.t("Change Interpreter"),P.pandasTooOldForViewingFormat=(B,tt)=>C.l10n.t({message:"Python package 'pandas' is version {0}. Version {1} or greater is required for viewing data.",args:[B,tt],comment:["Do not translate 'pandas' as that is a Python module name"]}),P.pandasRequiredForViewing=B=>C.l10n.t({message:"Python package 'pandas' version {0} (or above) is required for viewing data.",args:[B],comment:["Do not translate 'pandas' as that is a Python module name"]}),P.tooManyColumnsMessage=C.l10n.t("Variables with over a 1000 columns may take a long time to display. Are you sure you wish to continue?"),P.tooManyColumnsYes=C.l10n.t("Yes"),P.tooManyColumnsNo=C.l10n.t("No"),P.tooManyColumnsDontAskAgain=C.l10n.t("Don't Ask Again"),P.plotViewerTitle=C.l10n.t("Plots"),P.exportPlotTitle=C.l10n.t("Save plot image"),P.pdfFilter="PDF",P.pngFilter="PNG",P.svgFilter="SVG",P.exportImageFailed=B=>C.l10n.t("Error exporting image: {0}",B),P.jupyterDataRateExceeded=C.l10n.t({message:"Cannot view variable because data rate exceeded. Please restart your server with a higher data rate limit. For example, --NotebookApp.iopub_data_rate_limit=10000000000.0",comment:["Do not translate the text --NotebookApp.iopub_data_rate_limit=10000000000.0 as that is a command argument."]}),P.addCellBelowCommandTitle=C.l10n.t("Add cell"),P.debugCellCommandTitle=C.l10n.t("Debug Cell"),P.debugStepOverCommandTitle=C.l10n.t("Step over"),P.debugContinueCommandTitle=C.l10n.t("Continue"),P.debugStopCommandTitle=C.l10n.t("Stop"),P.runCurrentCellAndAddBelow=C.l10n.t("Run current cell and add empty cell below"),P.jupyterDebuggerNotInstalledError=B=>C.l10n.t("Pip module {0} is required for debugging cells. You will need to install it to debug cells.",B),P.jupyterDebuggerOutputParseError=B=>C.l10n.t("Unable to parse {0} output, please log an issue with https://github.com/microsoft/vscode-jupyter",B),P.cellStopOnErrorMessage=C.l10n.t("Cell was canceled due to an error in a previous cell."),P.scrollToCellTitleFormatMessage=B=>C.l10n.t("Go to [{0}]",B.toString()),P.instructionComments=B=>C.l10n.t(`# To add a new cell, type '{0}'
# To add a new markdown cell, type '{0} [markdown]'
`,B),P.exportButtonTitle=C.l10n.t("Export"),P.exportAsQuickPickPlaceholder=C.l10n.t("Export As..."),P.openExportedFileMessage=C.l10n.t("Would you like to open the exported file?"),P.openExportFileYes=C.l10n.t("Yes"),P.openExportFileNo=C.l10n.t("No"),P.exportFailedGeneralMessage=C.l10n.t({message:"Please check the 'Jupyter' [output](command:jupyter.viewOutput) panel for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),P.exportToPDFDependencyMessage=C.l10n.t(`If you have not installed xelatex (TeX), you will need to do so before you can export to PDF. For further instructions, please see https://nbconvert.readthedocs.io/en/latest/install.html#installing-tex. \r
To avoid installing xelatex (TeX), you might want to try exporting to HTML and using your browser's "Print to PDF" feature.`),P.failedExportMessage=C.l10n.t("Export failed."),P.startingJupyterLogMessage=(B,tt)=>C.l10n.t("Starting Jupyter from {0} with arguments {1}",B,tt),P.waitingForJupyterSessionToBeIdle=C.l10n.t("Waiting for Jupyter Session to be idle"),P.gettingListOfKernelsForRemoteConnection=C.l10n.t("Fetching Kernels"),P.gettingListOfKernelSpecs=C.l10n.t("Fetching Kernel specs"),P.startingJupyterNotebook=C.l10n.t("Starting Jupyter Notebook"),P.registeringKernel=C.l10n.t("Registering Kernel"),P.jupyterCommandLineReloadQuestion=C.l10n.t("Please reload the window when changing the Jupyter command line."),P.jupyterCommandLineReloadAnswer=C.l10n.t("Reload"),P.createdNewKernel=(B,tt)=>C.l10n.t("{0}: Kernel started: {1}",B,tt),P.kernelInvalid=B=>C.l10n.t("Kernel {0} is not usable. Check the Jupyter output tab for more information.",B),P.removeRemoteJupyterServerEntryInQuickPick=C.l10n.t("Remove"),P.loadClassFailedWithNoInternet=(B,tt)=>C.l10n.t("Error loading {0}:{1}. Internet connection required for loading 3rd party widgets.",B,tt),P.useCDNForWidgetsNoInformation=C.l10n.t("Widgets require us to download supporting files from a 3rd party website."),P.enableCDNForWidgetsSetting=(B,tt)=>C.l10n.t("Widgets require us to download supporting files from a 3rd party website. (Error loading {0}:{1}).",B,tt),P.enableCDNForWidgetsButton=C.l10n.t("Enable Downloads"),P.unhandledMessage=(B,tt)=>C.l10n.t("Unhandled kernel message from a widget: {0} : {1}",B,tt),P.cdnWidgetScriptNotAccessibleWarningMessage=(B,tt)=>C.l10n.t("Unable to download widget '{0}' from 3rd party website {1}, due to network access. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",B,tt),P.widgetScriptNotFoundOnCDNWidgetMightNotWork=(B,tt,Rre)=>C.l10n.t("Unable to find widget '{0}' version '{1}' from configured widget sources {2}. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",B,tt,Rre),P.insecureSessionMessage=C.l10n.t("Connecting over HTTP without a token may be an insecure connection. Do you want to connect to a possibly insecure server?"),P.insecureSessionDenied=C.l10n.t("Denied connection to insecure server."),P.selectKernelForEditor=C.l10n.t("[Select a kernel](command:_notebook.selectKernel) to run cells."),P.needIpykernel6=C.l10n.t("Ipykernel setup required for this feature"),P.setup=C.l10n.t("Setup"),P.showDataViewerFail=C.l10n.t("Failed to create the Data Viewer. Check the Jupyter tab of the Output window for more info."),P.defaultNotebookName=C.l10n.t("default"),P.recommendExtensionForNotebookLanguage=(B,tt)=>C.l10n.t("The {0} extension is recommended for notebooks targeting the language '{1}'",B,tt),P.kernelWasNotStarted=C.l10n.t("Kernel was not started. A kernel session is needed to start debugging."),P.noNotebookToDebug=C.l10n.t("No active notebook document to debug."),P.cantStartDebugging=C.l10n.t("Can't start debugging."),P.restartNotSupported=C.l10n.t("Restarting is not supported in the interactive window."),P.importingIpynb=C.l10n.t("Importing notebook file"),P.exportingToFormat=B=>C.l10n.t("Exporting to {0}",B),P.kernelCategoryForJupyterSession=C.l10n.t("Jupyter Session"),P.kernelDefaultRemoteDisplayName=C.l10n.t("Remote"),P.kernelCategoryForJupyterKernel=C.l10n.t("Jupyter Kernel"),P.kernelCategoryForRemoteJupyterKernel=C.l10n.t("Jupyter Kernel"),P.kernelCategoryForConda=C.l10n.t("Conda Env"),P.kernelCategoryForCondaWithoutPython=C.l10n.t("Conda Env Without Python"),P.kernelCategoryForPoetry=C.l10n.t("Poetry Env"),P.kernelCategoryForPipEnv=C.l10n.t("Pipenv Env"),P.kernelCategoryForPyEnv=C.l10n.t("PyEnv Env"),P.kernelCategoryForGlobal=C.l10n.t("Global Env"),P.kernelCategoryForVirtual=C.l10n.t("Virtual Env"),P.fileSeemsToBeInterferingWithKernelStartup=B=>C.l10n.t("The file '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the file and starting the kernel again.",B),P.moduleSeemsToBeInterferingWithKernelStartup=B=>C.l10n.t("The module '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the folder and starting the kernel again.",B),P.pipCondaInstallHoverWarning=(B,tt)=>C.l10n.t("'!{0} install' could install packages into the wrong environment. [More info]({1})",B,tt),P.percentPipCondaInstallInsteadOfBang=B=>C.l10n.t({message:"Use '%{0} install' instead of '!{0} install'",args:[B],comment:['Do not translate the string within quotes, such as "%{0} install" and "!{0} install" as that is a Jupyter Shell Magic command']}),P.replacePipCondaInstallCodeAction=B=>C.l10n.t("Replace with '%{0} install'",B),P.failedToStartKernelDueToMissingModule=B=>C.l10n.t("The kernel failed to start due to the missing module '{0}'. Consider installing this module.",B),P.failedToStartKernelDueToImportFailure=B=>C.l10n.t("The kernel failed to start as the module '{0}' could not be imported.",B),P.failedToStartKernelDueToImportFailureFromFile=(B,tt)=>C.l10n.t("The kernel failed to start as '{0}' could not be imported from '{1}'.",B,tt),P.failedToStartKernelDueToUnknownDllLoadFailure=C.l10n.t("The kernel failed to start as a dll could not be loaded."),P.failedToStartKernelDueToDllLoadFailure=B=>C.l10n.t("The kernel failed to start as the dll '{0}' could not be loaded.",B),P.failedToStartKernelDueToWin32APIFailure=C.l10n.t("The kernel failed to start due to an error with the Win32api module. Consider (re) installing this module."),P.failedToStartKernelDueToPyZmqFailure=C.l10n.t({message:"The kernel failed to start due to an error with the 'pyzmq' module. Consider re-installing this module.",comment:['Do not translate the string "pyzmq" as that is a Python module.']}),P.failedToStartKernelDueToOldIPython=C.l10n.t("The kernel failed to start due to an outdated version of IPython. Consider updating this module to the latest version."),P.failedToStartKernelDueToOldIPyKernel=C.l10n.t("The kernel failed to start due to an outdated version of IPyKernel. Consider updating this module to the latest version."),P.failedToStartKernelDueToMissingPythonEnv=B=>C.l10n.t("The kernel failed to start as the Python Environment '{0}' is no longer available. Consider selecting another kernel or refreshing the list of Python Environments.",B),P.matplotlibWidgetInsteadOfOther=C.l10n.t("'%matplotlib' widget works best inside of VS Code"),P.matplotlibWidgetCodeActionTitle=C.l10n.t("More info"),P.allowExtensionToUseJupyterKernelApi=(B,tt)=>C.l10n.t("Do you want to give the extension '{0}' access to the Jupyter Kernels? Clicking '{1}' would allow this extension to execute code against the Jupyter Kernels.",B,tt),P.thanksForUsingJupyterKernelApiPleaseRegisterWithUs=B=>C.l10n.t("Thank you for trying the Jupyter API. Please file an issue on our repo to allow the extension {0} to use this API in production. This would prevent us from breaking your extension when updating the API (as it is still a work in progress).",B),P.activatingPythonEnvironment=B=>C.l10n.t("Activating Python Environment '{0}'",B),P.runningKernelStartupHooksFor=B=>C.l10n.t("Running Kernel startup hooks in '{0}'",B),P.cellAtFormat=(B,tt)=>C.l10n.t("{0} Cell {1}",B,tt),P.jupyterServerConsoleOutputChannel=C.l10n.t("Jupyter Server Console"),P.kernelConsoleOutputChannel=B=>C.l10n.t("{0} Kernel Console Output",B),P.webNotSupported=C.l10n.t("Operation not supported in web version of Jupyter Extension."),P.failedToInstallPythonExtension=C.l10n.t("Failed to install the Python Extension."),P.filesPossiblyOverridingPythonModulesMayHavePreventedKernelFromStarting=B=>C.l10n.t("Some of the following files found in the working directory may have prevented the Kernel from starting. Consider renaming them.",B),P.listOfFilesWithLinksThatMightNeedToBeRenamed=B=>C.l10n.t("File(s): {0} might need to be renamed.",B),P.failedToGetVersionOfPandas=C.l10n.t("Failed to get version of Pandas to use the Data Viewer."),P.failedToInstallPandas=C.l10n.t("Failed to install Pandas to use the Data Viewer."),P.localKernelSpecs=C.l10n.t("Jupyter Kernel..."),P.localPythonEnvironments=C.l10n.t("Python Environments..."),P.quickPickTitleForSelectionOfJupyterServer=C.l10n.t("Select a Jupyter Server"),P.UserJupyterServerUrlProviderDisplayName=C.l10n.t("Existing Jupyter Server..."),P.UserJupyterServerUrlProviderDetail=C.l10n.t("Connect to an existing Jupyter Server"),P.kernelPickerSelectKernelTitle=C.l10n.t("Select Kernel"),P.kernelPickerSelectLocalKernelSpecTitle=C.l10n.t("Select a Jupyter Kernel"),P.quickPickSelectPythonEnvironmentTitle=C.l10n.t("Select a Python Environment"),P.kernelPickerSelectKernelFromRemoteTitle=B=>C.l10n.t("Select a Kernel from {0}",B),P.kernelPickerSelectKernelFromRemoteTitleWithoutName=C.l10n.t("Select a Jupyter Kernel"),P.installPythonExtensionViaKernelPickerTitle=C.l10n.t("Install Python Extension"),P.installPythonExtensionViaKernelPickerToolTip=C.l10n.t("Python Extension is required to detect and use Python environments for the execution of code cells."),P.installPythonQuickPickTitle=C.l10n.t("Install Python"),P.installPythonQuickPickToolTip=C.l10n.t("Python Environments not detected. Upon installation reload VS Code or refresh the list of Kernels."),P.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel=C.l10n.t({message:"$(error) Unable to connect to the remote server",comment:"Do not translate the string $(error) as that is a VS Code icon."}),P.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail=C.l10n.t("Ensure the server is running and reachable."),P.dataViewerDeprecationMessage=C.l10n.t("The built-in data viewer will be deprecated soon. Please install other data viewing extensions to keep the ability to inspect data."),P.dataViewerDeprecationRecommendationActionMessage=C.l10n.t("See Recommended Extensions")))(_||(_={}));var $t;(Ye=>(Ye.collapseSingle=C.l10n.t("Collapse"),Ye.expandSingle=C.l10n.t("Expand"),Ye.noRowsInDataViewer=C.l10n.t("No rows match current filter"),Ye.sliceIndexError=C.l10n.t({message:"Index {0} out of range for axis {1} with {2} elements",comment:["Do not translate the strings {0}, {1} and {2} as they are variable names and will be replaced later"]}),Ye.sliceMismatchedAxesError=C.l10n.t({message:"Expected {0} axes, got {1} in slice expression",comment:["Do not translate the strings {0} and {2} as they are variable names and will be replaced later"]}),Ye.fetchingDataViewer=C.l10n.t("Fetching data ..."),Ye.dataViewerHideFilters=C.l10n.t("Hide filters"),Ye.dataViewerShowFilters=C.l10n.t("Show filters"),Ye.refreshDataViewer=C.l10n.t("Refresh data viewer"),Ye.sliceSummaryTitle=C.l10n.t("SLICING"),Ye.sliceData=C.l10n.t("Slice Data"),Ye.sliceSubmitButton=C.l10n.t("Apply"),Ye.sliceDropdownAxisLabel=C.l10n.t("Axis"),Ye.sliceDropdownIndexLabel=C.l10n.t("Index"),Ye.variableExplorerNameColumn=C.l10n.t("Name"),Ye.variableExplorerTypeColumn=C.l10n.t("Type"),Ye.variableExplorerCountColumn=C.l10n.t("Size"),Ye.variableExplorerValueColumn=C.l10n.t("Value"),Ye.collapseVariableExplorerLabel=C.l10n.t("Variables"),Ye.variableLoadingValue=C.l10n.t("Loading..."),Ye.showDataExplorerTooltip=C.l10n.t("Show variable snapshot in data viewer"),Ye.noRowsInVariableExplorer=C.l10n.t("No variables defined"),Ye.loadingRowsInVariableExplorer=C.l10n.t("Loading variables"),Ye.previousPlot=C.l10n.t("Previous"),Ye.nextPlot=C.l10n.t("Next"),Ye.panPlot=C.l10n.t("Pan"),Ye.zoomInPlot=C.l10n.t("Zoom in"),Ye.zoomOutPlot=C.l10n.t("Zoom out"),Ye.exportPlot=C.l10n.t("Export to different formats"),Ye.deletePlot=C.l10n.t("Remove"),Ye.selectedImageListLabel=C.l10n.t("Selected Image"),Ye.selectedImageLabel=C.l10n.t("Image"),Ye.errorOutputExceedsLinkToOpenFormatString=C.l10n.t({message:"Output exceeds the <a href={0}>size limit</a>. Open the full output data <a href={1}>in a text editor</a>",comment:['Do not translate the the Hyperlink text "<a href={0}>size limit</a>" and "<a href={1}>in a text editor</a>". However the text inside those tags can be translated']})))($t||($t={}));var hy;(n=>(n.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE=C.l10n.t({message:"The setting 'python.formatting.formatOnSave' is deprecated, please use 'editor.formatOnSave'.",comment:['Do not translate the string "python.formatting.formatOnSave" as that is a setting in VS Code','Do not translate the string "editor.formatOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE=C.l10n.t({message:"The setting 'python.linting.lintOnTextChange' is deprecated, please enable 'python.linting.lintOnSave' and 'files.autoSave'.",comment:['Do not translate the string "python.linting.lintOnTextChange" as that is a setting in VS Code','Do not translate the string "python.linting.lintOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES=C.l10n.t({message:"The setting 'python.autoComplete.preloadModules' is deprecated, please consider using Pylance Language Server ('python.languageServer' setting).",comment:['Do not translate the string "python.autoComplete.preloadModules" as that is a setting in VS Code','Do not translate the string "python.languageServer" as that is a setting in VS Code']})))(hy||(hy={}));var F7;(n=>(n.noCondaOrPipInstaller=C.l10n.t("There is no Conda or Pip installer available in the selected environment."),n.noPipInstaller=C.l10n.t("There is no Pip installer available in the selected environment."),n.searchForHelp=C.l10n.t("Search for help")))(F7||(F7={}));var U7;(e=>e.installingModule=t=>C.l10n.t("Installing {0}",t))(U7||(U7={}));var La=z(re());d();d();d();var YL="Python Kernel Debug Adapter",$L="Python Interactive Window Debug Adapter";d();d();var pT=z(V7()),oC=z(j7());d();d();var vy=require("vscode");d();d();var ct=class extends Error{constructor(t,n){super(n);this.category=t;this.isJupyterError=!0}},ri=class r extends ct{constructor(t,n,i){super(i||zL(n),t);this.originalException=n;n&&(this.stack=`${new Error("").stack}

${n.stack}`)}static from(t,n){return n instanceof ct?n:new r(t,n)}static unwrap(t){return t&&(t instanceof r&&t.originalException&&t.originalException instanceof ct&&(t=t.originalException),t)}};function zL(r){return r&&r instanceof ct?r.category:"unknown"}var Kp=class extends ct{constructor(t,n,i){super("jupyterconnection",t+(n?`
${n}`:""));this.interpreter=i}};d();var sn=class extends ct{constructor(){super("sessionDisposed",_.sessionDisposed)}};function H7(r=""){let e=J7(r);return e?e[1]:void 0}function J7(r=""){if(!r)return;let e=r.trim().split(`
`).map(t=>t.trim()).filter(t=>t.trim().length).reverse();if(e.length!==0&&e[0].includes("Error"))return[e.length>1?e[1]:"",e[0]]}function q7(r){if(!r)return;let t=(Array.isArray(r)?r[0]:r).split(`
`).map(l=>l.trim().toLowerCase()).filter(l=>l.length).reverse().find(l=>l.startsWith("file ")&&l.includes(", line ")&&l.includes(".py")&&l.includes(".py"));if(!t)return;let i=(t.substring(0,t.lastIndexOf(".py"))+".py").replace(/\\/g,"/").split("/"),o=i.indexOf("site-packages"),s=o>=0&&i.length>o+1?i[o+1]:"",a=i.reverse();if(!(a.length<2))return{fileName:a[0],folderName:a[1],packageName:s}}function qm(r,e,t,n="",i=[]){let o=e instanceof ct?e.stdErr||e.stack||"":e.toString(),s=J7(o),a=o.toLowerCase();if(e instanceof sn)return{reason:"sessionDisposed",message:_.sessionDisposed,moreInfoLink:"https://aka.ms/kernelDisposedCannotRunCell",telemetrySafeTags:["deadSession"]};if(a.includes("ImportError: No module named 'win32api'".toLowerCase()))return{reason:"importWin32apiFailure",message:_.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())&&a.includes("win32api"))return{reason:"importWin32apiFailure",message:_.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["dll.load.failed","win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())){let u=s&&s[0].toLowerCase().startsWith("import")?s[0].substring(6).trim():void 0;return{reason:"dllLoadFailure",moduleName:u,message:u?_.failedToStartKernelDueToDllLoadFailure(u):_.failedToStartKernelDueToUnknownDllLoadFailure,moreInfoLink:"https://aka.ms/kernelFailuresDllLoad",telemetrySafeTags:["dll.load.failed"]}}if(a.includes("AssertionError: Couldn't find Class NSProcessInfo".toLowerCase()))return{reason:"oldIPythonFailure",message:_.failedToStartKernelDueToOldIPython,moreInfoLink:"https://aka.ms/kernelFailuresOldIPython",telemetrySafeTags:["oldipython"]};if(a.includes("NotImplementedError".toLowerCase())&&a.includes("asyncio".toLowerCase())&&a.includes("events.py".toLowerCase()))return{reason:"oldIPyKernelFailure",message:_.failedToStartKernelDueToOldIPyKernel,moreInfoLink:"https://aka.ms/kernelFailuresOldIPyKernel",telemetrySafeTags:["oldipykernel"]};{let u=[];if(a.includes("ImportError: cannot import name".toLowerCase())&&a.includes("from partially initialized module".toLowerCase())&&a.includes("zmq.backend.cython".toLowerCase())&&u.push("zmq.backend.cython"),a.includes("zmq".toLowerCase())&&a.includes("cython".toLowerCase())&&a.includes("__init__.py".toLowerCase())&&u.push("zmq.cython"),a.includes("zmq.error.ZMQError")&&u.push("zmq.error"),u.length)return{reason:"zmqModuleFailure",message:_.failedToStartKernelDueToPyZmqFailure,moreInfoLink:"https://aka.ms/kernelFailuresPyzmq",telemetrySafeTags:u}}if(s&&s[1].toLowerCase().startsWith("importerror")){let u=B7(s[1]);if(u&&n){let p=yle(u.moduleName,u.fileName,r,n);return p||{reason:"importFailure",moduleName:u.moduleName,fileName:u.fileName,message:u.fileName?_.failedToStartKernelDueToImportFailureFromFile(u.moduleName,u.fileName):_.failedToStartKernelDueToImportFailure(u.moduleName),moreInfoLink:u.fileName?"https://aka.ms/kernelFailuresModuleImportErrFromFile":"https://aka.ms/kernelFailuresModuleImportErr",telemetrySafeTags:["import.error"]}}}let l="No module named".toLowerCase(),c="is not a package".toLowerCase();if(a.includes(l)&&!c){let u=dt(o).map(f=>f.trim()).filter(f=>f.length).find(f=>f.toLowerCase().includes(l)),p=u?u.substring(u.toLowerCase().indexOf(l)+l.length).trim():"";if(u)return{reason:"moduleNotFound",moduleName:p,message:_.failedToStartKernelDueToMissingModule(p),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(a.includes(l)&&c){let u=dt(o).map(g=>g.trim()).filter(g=>g.length).find(g=>g.toLowerCase().includes(l)),p=u?u.substring(u.toLowerCase().indexOf(l)+l.length).trim():"",f="",m="";p.split("'").length>2&&(f=p.split("'").slice(-2)[0]||"",f=f?`${f}.py`:"",m=f||"",p=p.split("'")[1]||p);let h=i.filter(g=>yi(g).toLowerCase()==="__init__.py").map(g=>yi(zv(g)));return p&&f&&p!==f&&i.some(g=>yi(g).toLowerCase()===f.toLowerCase())?{reason:"overridingBuiltinModules",fileName:f,moduleName:p,message:_.fileSeemsToBeInterferingWithKernelStartup(f),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:p&&h&&p!==m&&h.some(g=>g.toLowerCase()===m.toLowerCase())?{reason:"overridingBuiltinModules",folderName:m,moduleName:p,message:_.moduleSeemsToBeInterferingWithKernelStartup(m),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:{reason:"moduleNotFound",moduleName:p,message:_.failedToStartKernelDueToMissingModule(p),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(e instanceof ct&&e.category==="invalidkernel"&&i.length){let u=yi(i[0]);return{reason:"overridingBuiltinModules",fileName:u,moduleName:yi(i[0],".py"),message:_.fileSeemsToBeInterferingWithKernelStartup(u),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}else if(s&&s[1].toLowerCase().startsWith("ModuleNotFoundError".toLowerCase())){let u=B7(s[1]);if(u)return{reason:"moduleNotFound",moduleName:u.moduleName,message:_.failedToStartKernelDueToMissingModule(u.moduleName),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}if(e instanceof Kp){let u=dt(o).map(v=>v.trim()).reverse().find(v=>v.toLowerCase().includes("error: ")),p="AttributeError: 'Namespace' object has no attribute '_flags'",f=["jupyter.startup.failure"],m,h="jupyterStartFailure",g=dt(e.message,{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: "));if(g=g||dt(e.stdErr||"",{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: ")),a.includes(p.toLowerCase())?(h="jupyterStartFailureOutdatedTraitlets",u=_.failedToStartJupyterDueToOutdatedTraitlets(t||"",g||""),f.push("outdated.traitlets"),m="https://aka.ms/kernelFailuresJupyterTrailtletsOutdated"):(u=g?_.failedToStartJupyterWithErrorInfo(t||"",g):_.failedToStartJupyter(t||""),m=void 0),u)return{reason:h,message:u,pythonError:g,moreInfoLink:m,telemetrySafeTags:f}}}function B7(r){r=r.replace(/"/g,"'");let e=r.match(/'[^\\']*(\\'[^\\']*)*'/g),t=r.match(/\((.*?)\)/g),n,i;return e&&e[0].length>2&&(n=e[0],n=n.substring(1,n.length-1)),t&&t[0].length>2&&(i=t[0],i=i.substring(1,i.length-1)),n?{moduleName:n,fileName:i}:void 0}function yle(r,e,t,n){if(n&&t.length!==0&&e&&!e.toLowerCase().startsWith(n)&&t.some(i=>e.toLowerCase().startsWith(i.uri.fsPath.toLowerCase())))return{reason:"overridingBuiltinModules",fileName:e,moduleName:r,message:_.fileSeemsToBeInterferingWithKernelStartup(Se(vy.Uri.file(e),t||[])),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}function yy(r){if(!r)return;let e=/\[([^\[\]]*)\]\((.*?)\)/gm,t;for(;(t=e.exec(r))!==null;)t.length===3&&(r=r.replace(t[0],`<a href='${t[2]}'>${t[1]}</a>`));let n=dt(r,{removeEmptyEntries:!1,trim:!1}).map(i=>`\x1B[1;31m${i}`).join(`
`);return new vy.NotebookCellOutput([vy.NotebookCellOutputItem.error({message:"",name:"",stack:n})])}var ble=[Ile,Sle];function G7(r){let e=[],t=Array.isArray(r)?r[0].toLowerCase():r.toLowerCase();ble.forEach(i=>i(t,e));let n=qm([],t,void 0);return n!=null&&n.telemetrySafeTags.length&&e.push(...n.telemetrySafeTags),Array.from(new Set(e)).join(",")}function Ile(r,e=[]){r.includes("ChildProcess.exithandler".toLowerCase())&&e.push("childproc.exit")}function Sle(r,e=[]){r.includes("KernelRestarter: restart failed".toLowerCase())&&e.push("KernelRestarter.failed")}function Y7(){return(new Error().stack||"").split(`
`).filter(r=>r.includes(Xe))}async function $7(r,e){r.failed=!0,r.failureCategory=r.failureCategory||zL(e);let t=!pT.FetchError&&(e==null?void 0:e.name)==="TypeError"&&(e==null?void 0:e.message)==="Failed to fetch",i=(t||pT.FetchError!==void 0)&&Cle(e,t?TypeError:pT.FetchError);r.failureCategory==="unknown"&&i&&(r.failureCategory="fetcherror"),r.stackTrace=_le(e),typeof e=="string"&&(r.failureSubCategory="errorisstring");let o=e.stdErr?e.stdErr:e.stack||"";if(!o)return;r.failureSubCategory=r.failureSubCategory||G7(o);let s=q7(o);s&&([r.pythonErrorFile,r.pythonErrorFolder,r.pythonErrorPackage]=await Promise.all([Promise.resolve(r.pythonErrorFile||Ot(s.fileName)),Promise.resolve(r.pythonErrorFolder||Ot(s.folderName)),Promise.resolve(r.pythonErrorPackage||Ot(s.packageName))]))}function QL(r){if(r.stack&&Array.isArray(r.stack)){let e={...r,stack:r.stack.join(`
`)};return oC.parse.call(oC,e)}return oC.parse.call(oC,r)}function _le(r){let e="";for(let t of QL(r)){let n=t.getFileName();if(n){let i=t.getLineNumber(),o=t.getColumnNumber();e+=`
	at ${Ele(t)} ${n}:${i}:${o}`}else e+=`
	at <anonymous>`}return e.trim().replace(/\\/g,"/")}function Ele(r){let e=[];return typeof r.getTypeName()=="string"&&r.getTypeName().length>0&&e.push(r.getTypeName()),typeof r.getMethodName()=="string"&&r.getMethodName().length>0&&e.push(r.getMethodName()),typeof r.getFunctionName()=="string"&&r.getFunctionName().length>0&&(e.length!==2||e.join(".")!==r.getFunctionName())&&e.push(r.getFunctionName()),e.join(".")}function Cle(r,e){return e?r instanceof e||r instanceof ri&&r.originalException instanceof e:(console.error("Error type is not defined",r),!1)}var I0=require("vscode");function afe(){try{return require("vscode")===void 0?!1:bG()!==void 0}catch(r){return!1}}function _0(){return I0.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1}function E0(r){return I0.workspace.onDidChangeConfiguration(e=>{if(!e.affectsConfiguration("telemetry"))return;let n=I0.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1;r(n)})}var S0={};function zb(r,e){let t=r;FE()&&t.startsWith("ds_")||(e===void 0?delete S0[t]:S0[t]=e)}var tW;function bG(){if(tW)return tW;let r=(gG(),iP(hG)).default;return tW=new r(rB)}function vG(r,e){let t={};return Object.getOwnPropertyNames(e).forEach(n=>{if(!(e[n]===void 0||e[n]===null))try{t[n]=typeof e[n]=="string"?e[n]:typeof e[n]=="object"?"object":e[n].toString()}catch(i){O(`Failed to serialize ${n} for ${r}`,i)}}),t}function J(r,e,t,n){Sn()||!afe()||lfe(r,e,t,n)}function lfe(r,e,t,n){let i=bG(),o={},s=r;n?(o={},Object.assign(o,S0),Object.assign(o,t||{}),$7(o,n).then(()=>{o=vG(s,o),i.sendTelemetryEvent(s,o,e)}).catch(y)):(t&&(o=vG(s,t)),Object.assign(o,S0),i.sendTelemetryEvent(s,o,e))}var yG=new Set;function Fr(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a=e||{},l=new Mt,c=`${r.toString()}${JSON.stringify(a)}`,u=!yG.has(c);yG.add(c);let p=o.apply(this,s);return p&&typeof p.then=="function"&&typeof p.catch=="function"?p.then(f=>{let m={...a};return u&&(m.firstTime=u),J(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,m),f}).catch(f=>{let m={...a};m.failed=!0,J(r,l?{duration:l==null?void 0:l.elapsedTime}:{},m,f)}):J(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,a),p},i}}function Ln(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){return J(r,void 0,e),o.apply(this,s)},i}}function cfe(){return{isInsiderExtension:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether this is the Insider version of the Jupyter extension or not. Common to all events."},isPythonExtensionInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether Python extension is installed or not. Common to all events."},rawKernelSupported:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether the raw kernel is supported or not. Common to all events."}}}function It(){return{duration:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth",isMeasurement:!0}}}function Lo(){return{resourceType:{classification:"PublicNonPersonalData",comment:"",purpose:"FeatureInsight"}}}function qc(){return{failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureSubCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFile:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFolder:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorPackage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},stackTrace:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}}function Ui(){return{properties:{actionSource:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},disableUI:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},userExecutedCell:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},resourceHash:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},pythonEnvironmentVersion:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPath:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPackages:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSessionId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelLanguage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelConnectionType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},isUsingActiveInterpreter:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},capturedEnvVars:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},newKernelPicker:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},...Lo()}}}var j6e={...It(),...qc(),...cfe()};var ufe,dfe,pfe,ffe,mfe,hfe,gfe,vfe,yfe,bfe,Ife,Sfe,_fe,Efe,Cfe,wfe,xfe,Dfe,Pfe,Tfe,kfe,Nfe,Rfe,Afe,Mfe,Ofe,Lfe,Kfe,Ffe,Ufe,Wfe,Vfe,jfe,Bfe,Hfe,Jfe,qfe,Gfe,Yfe,$fe,zfe,Qfe,Xfe,Zfe,eme,tme,rme,nme,ime,ome,sme,ame,lme,cme,ume,dme,pme,fme,mme,hme,gme,vme,yme,bme,Ime,Sme,_me,Eme,Cme,wme,xme,Dme,Pme,Tme,kme,Nme,Rme,Ame,Mme,Ome,Lme,Kme,Fme,Ume,Wme,Vme,jme,Bme,Hme,Jme,qme,Gme,Yme,$me,zme,Qme,Xme,Zme,ehe,the,rhe,nhe,ihe,ohe,she,ahe,lhe,che,uhe,dhe,phe,fhe,mhe,hhe,ghe,vhe,yhe,bhe,Ihe,She,_he,Ehe,Che,whe,xhe,Dhe,Phe,The,khe,Nhe,Rhe,Ahe,Mhe,Ohe,Lhe,Khe,Fhe,Uhe,Whe,Vhe,jhe,Bhe,Hhe,Jhe,qhe,Ghe,Yhe,$he,zhe,Qhe,Xhe,Zhe,ege,tge,rge,nge,ige,oge,sge,age,lge,cge,IG=class{constructor(){this[ufe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{totalActivateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},codeLoadingTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},workspaceFolderCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[dfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:It()};this[pfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[ffe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[mfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{hashedNamev2:{classification:"SystemMetaData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...Lo()}};this[hfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{firstTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:It()};this[gfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{mimeType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...Lo()}};this[vfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:It()};this[yfe]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[bfe]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer","VariableViewer"]};this[Ife]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[Sfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:It()};this[_fe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:It()};this[Efe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:{codeLensUpdateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},maxCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Cfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[wfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[xfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Dfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Pfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Tfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...qc(),failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Reason for failure to fetch kernel specs"},sessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},specsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSpecsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:It()};this[kfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},serverIdHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},providerExtensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},baseUrlHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelId:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelLanguage:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},isArgv0SameAsInterpreter:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Nfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{serverIdHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},baseUrlHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isLocalHost:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isJupyterHub:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},reason:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[Rfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Afe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Mfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:Ui().properties,measures:{...It()}};this[Ofe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[Lfe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[Kfe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ffe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"},cancelled:{classification:"SystemMetaData",purpose:"FeatureInsight"},successful:{classification:"SystemMetaData",purpose:"FeatureInsight"},opened:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ufe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{scope:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Wfe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Vfe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[jfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Bfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Hfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},info:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Jfe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[qfe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Gfe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Yfe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[$fe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{nbformat:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"},nbformat_minor:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"}}};this[zfe]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"User Action"};this[Qfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Xfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Zfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[eme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[tme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[rme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[nme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[ime]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[ome]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[sme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[ame]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[lme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[cme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[ume]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[dme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[pme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[fme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[mme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[hme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[gme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[vme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[yme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[bme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[Ime]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:It()};this[Sme]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[_me]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Eme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[Cme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[wme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[xme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Dme]={owner:"IanMatthewHuff",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Pme]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Tme]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[kme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"},isModulePresent:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pythonEnvType:{classification:"SystemMetaData",purpose:"FeatureInsight"},resourceHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},...Lo()},measures:It()};this[Nme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[Rme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",measures:It()};this[Ame]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rows:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0},columns:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Mme]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rowsTimer:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[Ome]={owner:"IanMatthewHuff",feature:["DataFrameViewer","VariableViewer"],source:"N/A"};this[Lme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action"};this[Kme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failedWithoutBackingFile:{classification:"SystemMetaData",purpose:"FeatureInsight"},failedWithBackingFile:{classification:"SystemMetaData",purpose:"FeatureInsight"},localHost:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Fme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ume]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},errorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},fallbackErrorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},zmqBinaries:{classification:"CallstackOrException",purpose:"FeatureInsight"}}};this[Wme]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:It()};this[Vme]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:{variableCount:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[jme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{kind:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},usesShell:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Bme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...qc(),...Lo()},measures:{...It()}};this[Hme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonPathDefined:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonEnvFound:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},isCreatedByUs:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Jme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[qme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",properties:{hasKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the kernel was known at the time of creation"},hasOwner:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the window was created for a text file"},mode:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Creation mode: multiple, perfile or single"},restored:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Was the window restored from a previous session"}},measures:{windowCount:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Number of active interactive windows the user has open",isMeasurement:!0}}};this[Gme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{cdnSearched:{classification:"SystemMetaData",purpose:"FeatureInsight"},hashedName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},modelName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Yme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{type:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:It()};this[$me]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[zme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Qme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},isOnline:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Xme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Zme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[ehe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{selection:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[the]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",measures:{totalOverheadInMs:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},numberOfMessagesWaitedOn:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},averageWaitTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},numberOfRegisteredHooks:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[rhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[nhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{msg_type:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[ihe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:{...It(),attempts:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{...Ui().properties,timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[ohe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:It()};this[she]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],measures:{...It()},properties:{...Ui().properties,...qc()}};this[ahe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Code Execution"],measures:It(),properties:{...Ui().properties,...qc(),extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[lhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],properties:{...Ui().properties,...qc()}};this[che]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],properties:{...Ui().properties,...qc()}};this[uhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:Ui().properties};this[dhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{result:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},...Lo(),...qc(),...Ui().properties},measures:{...It()}};this[phe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{...Lo(),...qc(),...Ui().properties},measures:It()};this[fhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{...Lo(),...qc(),...Ui().properties,envMissingReason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},isEmptyCondaEnv:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},pythonEnvType:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},fileExists:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[mhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...Lo(),...Ui().properties},measures:{reason:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}}};this[hhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{exitReason:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...Lo(),...Ui().properties},measures:{exitCode:{classification:"CallstackOrException",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[ghe]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...Lo(),...Ui().properties,manuallySelectedKernel:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...It(),computeCwd:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},duration:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},envVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},executeCell:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},getConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},interruptHandle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelIdle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInfo:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelReady:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},portUsage:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},postKernelStart:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},preExecuteCellTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},pythonEnvVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},sessionTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},spawn:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startupCode:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},updateConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputsByteSize:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[vhe]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...Lo(),...Ui().properties,wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...It(),callPythonApi:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},activatePython:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},discoverEnv:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},createController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},selectController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[yhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{isRequestToShutdownRestartSession:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...Lo(),...Ui().properties}};this[bhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...Lo(),...Ui().properties}};this[Ihe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[She]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{kernelSpecCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInterpreterCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelLiveCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},localKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},remoteKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[_he]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{outputType:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[Ehe]={owner:"IanMatthewHuff",feature:["InteractiveWindow"],tags:["IntelliSense"],source:"N/A",measures:It(),properties:{isResultNull:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Che]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:It()};this[whe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[xhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:It()};this[Dhe]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"N/A",measures:It()};this[Phe]={owner:"amunger",feature:"N/A",source:"N/A",properties:{command:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[The]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{newState:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[khe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:{numberOfDimensions:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Nhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{source:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Rhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},dependenciesInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ahe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Mhe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Ohe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Lhe]={owner:"roblourens",feature:["Debugger"],properties:{status:{classification:"SystemMetaData",purpose:"FeatureInsight"}},source:"N/A"};this[Khe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Fhe]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[Uhe]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[Whe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Vhe]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[jhe]={owner:"roblourens",feature:["Debugger"],source:"N/A",properties:{reason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Bhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{...It(),requestDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},timesExceededTimeout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},completionItems:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},monacoLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},completed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusAfterRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusBeforeRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Hhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Jhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[qhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"}},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Ghe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{accessAllowed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Yhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},cancelledAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestAcknowledgedAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestSentAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},...It()},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},mimeTypes:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}};this[$he]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{clientExtId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[zhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},allowed:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Qhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},providerId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}},measures:It()};this[Xhe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[Zhe]={owner:"roblourens",feature:["InteractiveWindow","Debugger"],source:"N/A"};this[ege]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...Ui().properties,...Lo()}};this[tge]={owner:"donjayamanne",source:"N/A",feature:["KernelPicker"]};this[rge]={owner:"donjayamanne",source:"User Action",feature:["KernelPicker"]};this[nge]={owner:"amunger",feature:"N/A",source:"N/A",properties:{testName:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},testResult:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},perfWarmup:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},commitHash:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},timedCheckpoints:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[ige]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{matchedReason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[oge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{requireEntryPointCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}},properties:{failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},failure:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},patternUsedToRegisterRequireConfig:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},widgetFolderNameHash:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[sge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:It()};this[age]={owner:"donjayamanne",feature:["DataFrameViewer"],source:"N/A"};this[lge]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[cge]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"}}};ufe="EXTENSION.LOAD",dfe="DS_INTERNAL.EXPERIMENT_LOAD",pfe="ENVFILE_VARIABLE_SUBSTITUTION",ffe="ENVFILE_WORKSPACE",mfe="HASHED_PACKAGE_NAME",hfe="DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",gfe="DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",vfe="DS_INTERNAL.GET_ACTIVATED_ENV_VARIABLES",yfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX",bfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",Ife="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX",Sfe="DATASCIENCE.ADD_CELL_BELOW",_fe="DS_INTERNAL.CODE_LENS_ACQ_TIME",Efe="DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",Cfe="DATASCIENCE.DEBUG_CONTINUE",wfe="DATASCIENCE.DEBUG_CURRENT_CELL",xfe="DATASCIENCE.DEBUG_STEP_OVER",Dfe="DATASCIENCE.DEBUG_STOP",Pfe="DATASCIENCE.DEBUG_FILE_INTERACTIVE",Tfe="DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",kfe="DS_INTERNAL.JUPYTER_KERNEL_SPEC",Nfe="DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",Rfe="DATASCIENCE.DISABLE_INTERACTIVE_SHIFT_ENTER",Afe="DATASCIENCE.ENABLE_INTERACTIVE_SHIFT_ENTER",Mfe="DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",Ofe="DATASCIENCE.EXPORT_PYTHON_FILE",Lfe="DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT",Kfe="DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",Ffe="DATASCIENCE.EXPORT_NOTEBOOK_AS",Ufe="DATASCIENCE.IMPORT_NOTEBOOK",Wfe="DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",Vfe="DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",jfe="DS_INTERNAL.GET_PASSWORD_FAILURE",Bfe="DS_INTERNAL.GET_PASSWORD_SUCCESS",Hfe="DS_INTERNAL.JUPYTER_HUB_PASSWORD",Jfe="DS_INTERNAL.SHOW_DATA_NO_PANDAS",qfe="DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD",Gfe="DS_INTERNAL.SHOW_DATA_PANDAS_OK",Yfe="DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED",$fe="DATASCIENCE.NATIVE.OPEN_NOTEBOOK_ALL",zfe="DATASCIENCE.OPEN_PLOT_VIEWER",Qfe="DATASCIENCE.RUN_ALL_CELLS",Xfe="DATASCIENCE.RUN_SELECTION_OR_LINE",Zfe="DATASCIENCE.RUN_CURRENT_CELL",eme="DATASCIENCE.RUN_ALL_CELLS_ABOVE",tme="DATASCIENCE.RUN_CELL_AND_ALL_BELOW",rme="DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE",nme="DATASCIENCE.RUN_FILE_INTERACTIVE",ime="DATASCIENCE.RUN_TO_LINE",ome="DATASCIENCE.RUN_FROM_LINE",sme="DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION",ame="DATASCIENCE.RUN_INSERT_CELL_BELOW",lme="DATASCIENCE.RUN_INSERT_CELL_ABOVE",cme="DATASCIENCE.RUN_DELETE_CELLS",ume="DATASCIENCE.RUN_SELECT_CELL",dme="DATASCIENCE.RUN_SELECT_CELL_CONTENTS",pme="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE",fme="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW",mme="DATASCIENCE.RUN_MOVE_CELLS_UP",hme="DATASCIENCE.RUN_MOVE_CELLS_DOWN",gme="DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN",vme="DATASCIENCE.RUN_CHANGE_CELL_TO_CODE",yme="DATASCIENCE.GOTO_NEXT_CELL_IN_FILE",bme="DATASCIENCE.GOTO_PREV_CELL_IN_FILE",Ime="DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW",Sme="DATASCIENCE.SELFCERTSMESSAGECLOSE",_me="DATASCIENCE.SELFCERTSMESSAGEENABLED",Eme="DATASCIENCE.USER_INSTALLED_JUPYTER",Cme="DATASCIENCE.USER_INSTALLED_PANDAS",wme="DATASCIENCE.USER_DID_NOT_INSTALL_JUPYTER",xme="DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS",Dme="DS_INTERNAL.PYTHON_NOT_INSTALLED",Pme="DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",Tme="DS_INTERNAL.PYTHON_EXTENSION_INSTALLED_VIA_KERNEL_PICKER",kme="DS_INTERNAL.PYTHON_MODULE_INSTALL",Nme="DS_INTERNAL.SHIFTENTER_BANNER_SHOWN",Rme="DATASCIENCE.START_SHOW_DATA_EXPLORER",Ame="DATASCIENCE.SHOW_DATA_EXPLORER",Mme="DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",Ome="DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",Lme="DATASCIENCE.REFRESH_DATA_VIEWER",Kme="DS_INTERNAL.JUPYTER_STARTED_SESSION_WITH_BACKING_FILE",Fme="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT",Ume="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT_FAILURE",Wme="DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME",Vme="DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",jme="DATASCIENCE.KERNEL_SPEC_LANGUAGE",Bme="DS_INTERNAL.KERNEL_LAUNCHER_PERF",Hme="GLOBAL_PYTHON_KERNELSPEC",Jme="DS_INTERNAL.NEW_FILE_USED_IN_INTERACTIVE",qme="DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",Gme="DS_INTERNAL.IPYWIDGET_USED_BY_USER",Yme="DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",$me="DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED",zme="DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",Qme="DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",Xme="DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",Zme="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN",ehe="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",the="DS_INTERNAL.IPYWIDGET_OVERHEAD",rhe="DS_INTERNAL.IPYWIDGET_RENDER_FAILURE",nhe="DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",ihe="DS_INTERNAL.RAWKERNEL_INFO_RESPONSE",ohe="DS_INTERNAL.RAWKERNEL_PROCESS_LAUNCH",she="DATASCIENCE.EXECUTE_CELL",ahe="DATASCIENCE.EXECUTE_CODE",lhe="DATASCIENCE.RESUME_EXECUTE_CELL",che="DATASCIENCE.NOTEBOOK_START",uhe="DS_INTERNAL.SWITCH_KERNEL",dhe="DATASCIENCE.NOTEBOOK_INTERRUPT",phe="DATASCIENCE.NOTEBOOK_RESTART",fhe="DATASCIENCE.KERNEL_START_FAILURE_MISSING_ENV",mhe="DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",hhe="DS_INTERNAL.RAWKERNEL_SESSION_KERNEL_PROCESS_EXITED",ghe="DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",vhe="DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",yhe="DS_INTERNAL.RAWKERNEL_SESSION_SHUTDOWN",bhe="DS_INTERNAL.RAWKERNEL_SESSION_DISPOSED",Ihe="DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER",She="DS_INTERNAL.KERNEL_COUNT",_he="DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",Ehe="DS_INTERNAL.INTERACTIVE_FILE_TOOLTIPS_PERF",Che="DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED",whe="DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE",xhe="DATAVIEWER.WEBVIEW_LOADED",Dhe="PLOTVIEWER.WEBVIEW_LOADED",Phe="DS_INTERNAL.COMMAND_EXECUTED",The="DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",khe="DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",Nhe="DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",Rhe="DATASCIENCE.CREATE_PYTHON_ENVIRONMENT",Ahe="DATASCIENCE.RECOMMENT_EXTENSION",Mhe="DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP",Ohe="DATASCIENCE.DEBUGGING.CLOSED_MODAL",Lhe="DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",Khe="DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE",Fhe="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE",Uhe="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_IW_JUPYTER",Whe="DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL",Vhe="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL",jhe="DATASCIENCE.DEBUGGING.ENDED_SESSION",Bhe="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",Hhe="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",Jhe="DATASCIENCE.JUPYTER_KERNEL_API_USAGE",qhe="DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",Ghe="DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",Yhe="DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",$he="DATASCIENCE.JUPYTER_API_USAGE",zhe="DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",Qhe="DATASCIENCE.JUPYTER_KERNEL_STARTUP_HOOK",Xhe="DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE",Zhe="DATASCIENCE.INTERACTIVE_WINDOW_DEBUG_SETUP_CODE_FAILURE",ege="DATASCIENCE.KERNEL_CRASH",tge="DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER",rge="DATASCIENCE.JUPYTER_KERNEL_FILTER_USED",nge="DS_INTERNAL.RUNTEST",ige="DS_INTERNAL.PREFERRED_KERNEL_EXACT_MATCH",oge="DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",sge="DS_INTERNAL.IPYWIDGET_TIME_TO_COPY_NBEXTENSIONS_DIR",age="DATASCIENCE.NO_ACTIVE_KERNEL_SESSION",lge="DATAVIEWER.USING_INTERPRETER",cge="DATAVIEWER.USING_KERNEL";d();var Kf=require("vscode");function Qb(r){let e=Gc(r.uri);return Ot(e.path)}function nW(r=Kf.Uri.file(""),e=Kf.Uri.file(""),t=Ai(),n=!1){let i=Gc(r,t,t=="Windows"||n),o=Gc(e,t,t=="Windows"||n);return i===o||ca(i,o,!0)}function Gc(r=Kf.Uri.file(""),e=Ai(),t=!1){let n=pt(r);return t&&(n=n.toLowerCase()),n.endsWith("/bin/python")?["Linux","OSX"].includes(e)?n.endsWith("/bin/python")&&n.split("/").length>4?Kf.Uri.file(n.replace("/bin/python","/python")):Kf.Uri.file(n):Kf.Uri.file(n):Kf.Uri.file(n)}d();var SG=require("vscode");var Xb=class{constructor(){this.promises=new Set;this._onStateChange=new SG.EventEmitter;this.onStateChange=this._onStateChange.event}get isComplete(){return this.promises.size===0}dispose(){this._onStateChange.dispose()}push(e){this.promises.add(e),this._onStateChange.fire(),e.finally(()=>{this.promises.delete(e),this.isComplete&&this._onStateChange.fire()}).catch(y)}};d();var C0=class extends ri{constructor(e){super("Python Extension failed to activate",e,"pythonExtension")}};d();var w0=class extends ct{constructor(){super("pythonExtension","Python Extension API not exported")}};var rY=z(_W());d();var Mg=require("vscode");var O0=class{};function FG(r,e=""){let t=r?Mg.workspace.getWorkspaceFolder(r):Mg.workspace.workspaceFolders?Mg.workspace.workspaceFolders[0]:void 0;return t?Ps(Ai()==="Windows"?t.uri.path.toUpperCase():t.uri.path):e}function sI(){let r=Array.isArray(Mg.workspace.workspaceFolders)&&Mg.workspace.workspaceFolders.length>0?Mg.workspace.workspaceFolders[0]:void 0;return r==null?void 0:r.uri}d();var Kg=require("vscode");d();d();var L0=class{constructor(){this.event=(e,t,n)=>{let i=this.add(t?e.bind(t):e);return n==null||n.push(i),i}}get size(){return this.listeners?typeof this.listeners=="function"?1:this.listeners.length:0}fire(e){if(this.listeners)if(typeof this.listeners=="function")this.listeners(e);else for(let t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?typeof this.listeners=="function"?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if(typeof this.listeners=="function"){this.listeners===e&&(this.listeners=void 0);return}let t=this.listeners.indexOf(e);t!==-1&&(this.listeners.length===2?this.listeners=t===0?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}};d();function Sr(r){let e=this,t=!1,n;return function(){return t||(t=!0,n=r.apply(e,arguments)),n}}d();var K0;(v=>{function r(I){return I&&typeof I=="object"&&typeof I[Symbol.iterator]=="function"}v.is=r;let e=Object.freeze([]);function t(){return e}v.empty=t;function*n(I){yield I}v.single=n;function i(I){return r(I)?I:n(I)}v.wrap=i;function o(I){return I||e}v.from=o;function s(I){return!I||I[Symbol.iterator]().next().done===!0}v.isEmpty=s;function a(I){return I[Symbol.iterator]().next().value}v.first=a;function l(I,S){for(let x of I)if(S(x))return!0;return!1}v.some=l;function c(I,S){for(let x of I)if(S(x))return x}v.find=c;function*u(I,S){for(let x of I)S(x)&&(yield x)}v.filter=u;function*p(I,S){let x=0;for(let D of I)yield S(D,x++)}v.map=p;function*f(...I){for(let S of I)for(let x of S)yield x}v.concat=f;function m(I,S,x){let D=x;for(let A of I)D=S(D,A);return D}v.reduce=m;function*h(I,S,x=I.length){for(S<0&&(S+=I.length),x<0?x+=I.length:x>I.length&&(x=I.length);S<x;S++)yield I[S]}v.slice=h;function g(I,S=Number.POSITIVE_INFINITY){let x=[];if(S===0)return[x,I];let D=I[Symbol.iterator]();for(let A=0;A<S;A++){let w=D.next();if(w.done)return[x,v.empty()];x.push(w.value)}return[x,{[Symbol.iterator](){return D}}]}v.consume=g})(K0||(K0={}));var F0;function WG(r){F0=r}function W0(r){return F0==null||F0.push(r),r}function he(r){if(K0.is(r)){for(let e of r)if(e)try{e.dispose()}catch(t){console.warn(`dispose() failed for ${e}`,t)}return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}var U0=class U0{constructor(...e){this._toDispose=new Set;this._isDisposed=!1;e.forEach(t=>this.add(t)),W0(this)}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{he(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?U0.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}};U0.DISABLE_DISPOSED_WARNING=!1;var Wi=U0,zr=class{constructor(...e){this._store=new Wi;this._isDisposed=!1;e.forEach(t=>this._store.add(t)),W0(this)}get isDisposed(){return this._isDisposed}dispose(){this._store.dispose(),this._isDisposed=!0}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},aI=class extends zr{constructor(){super();this._onDidDispose=new L0,this.onDidDispose=this._onDidDispose.event}dispose(){super.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose()}};var UG=class{constructor(){this._store=new Map;this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{he(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get(e){return this._store.get(e)}set(e,t,n=!1){var i;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||(i=this._store.get(e))==null||i.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}};d();d();d();var VG=z(_W());var $l=require("vscode");var qge={output_type:"stream",name:"stdout",text:""},Gge={output_type:"error",ename:"",evalue:"",traceback:[""]},Yge={output_type:"display_data",data:{},metadata:{}},$ge={output_type:"execute_result",execution_count:0,data:{},metadata:{}},N3e={stream:new Set(Object.keys(qge)),error:new Set(Object.keys(Gge)),display_data:new Set(Object.keys(Yge)),execute_result:new Set(Object.keys($ge))};function zl(r){return r&&$v(r).toLowerCase().endsWith("ipynb")?"notebook":"interactive"}function $c(r){return r=r.toLowerCase(),r.length===2&&r.endsWith("#")?`${r.substring(0,1)}sharp`:sB.get(r)||r}function _r(r){return typeof r=="string"?r===Ct||r===St:r.notebookType===Ct||r.notebookType===St}function Ma(r){var e;if(Lg()){let t=(e=r.metadata)==null?void 0:e.custom;return JSON.parse(JSON.stringify((t==null?void 0:t.metadata)||{}))}else{let t=r.metadata;return JSON.parse(JSON.stringify((t==null?void 0:t.metadata)||{}))}}async function jG(r,e){let t=new $l.WorkspaceEdit;if(Lg()){let n=JSON.parse(JSON.stringify(r.metadata||{custom:{}}));n.custom=n.custom||{},n.custom.metadata=e,t.set(r.uri,[$l.NotebookEdit.updateNotebookMetadata(B0({...r.metadata||{},custom:n.custom}))])}else t.set(r.uri,[$l.NotebookEdit.updateNotebookMetadata(B0({...r.metadata||{},metadata:e}))]);await $l.workspace.applyEdit(t)}function lI(r){return $l.workspace.notebookDocuments.find(e=>_r(e)&&e.getCells().some(t=>t.document===r))}function zc(r){if(Array.isArray(r)){let e="";for(let t=0;t<r.length;t+=1){let n=r[t];t<r.length-1&&!n.endsWith(`
`)?e=e.concat(`${n}
`):e=e.concat(n)}return e}return r.toString()}function cI(r){if(Array.isArray(r))return r;let e=r.toString();if(e.length>0){let t=e.split(`
`);return t.map((n,i)=>i<t.length-1?`${n}
`:n).filter(n=>n.length>0)}return[]}function zge(r){let e=r;do r=e,e=r.replace(/[^\n]\x08/gm,"");while(e.length<r.length);return r}function Qge(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){var e=r.match(/^(.*)\r+/m)[1],t=r.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return r}function BG(r){return Qge(zge(r))}var V0="'''",j0='"""';function Og(r,e,t){let n,i,o=0;for(let s of r){let a=s.trim(),l=a.startsWith(V0)?V0:a.startsWith(j0)?j0:void 0,c=a.includes(V0)?V0:a.includes(j0)?j0:void 0;if(i)i===c&&(i=void 0),t(s,o);else if(n)n===l&&(n=void 0),n&&e(s,o);else if(c&&!l){let u=a.indexOf(c);i=a.lastIndexOf(c)!==u?void 0:c,t(s,o)}else if(l){let u=a.indexOf(l,3);n=u>=0?void 0:l,a.length>3&&e(a.slice(3,u>=0?u:void 0),o)}else a.startsWith("#")?e(a.slice(1),o):t(s,o);o+=1}}function uI(r,e=`
`,t){return r.map((n,i)=>{let o=t?t(n):n;return i===r.length-1?`${o}`:`${o}${e}`})}function Xge(r){let e=[];return Og(r,t=>e.push(t),t=>{}),e}function H0(r){return uI(Xge(r.slice(r.length>1?1:0)))}function HG(r){let e=r.length,t=-1;return r.forEach((n,i)=>{n.trim()&&(e=i,t<0&&(t=i))}),t>=0?r.slice(t,e+1):[]}function JG(r){var t;let e=/^\s*(\d+)\.(\d+)\.(.+)\s*$/.exec(r);if(e&&e.length>2){let n=parseInt(e[1],10),i=parseInt(e[2],10),o=parseInt(e[3],10);return(t=(0,VG.parse)(`${n}.${i}.${o}`,!0))!=null?t:void 0}}function Wd(r){if(Lg()){let e=JSON.parse(JSON.stringify(r.metadata.custom||{}))||{},t=e;return t.metadata=t.metadata||{},e}else{let e=JSON.parse(JSON.stringify(r.metadata||{}))||{metadata:{}};return e.metadata=e.metadata||{},e}}function Lg(){try{let r=$l.extensions.getExtension("vscode.ipynb");if(r&&typeof r.exports.dropCustomMetadata=="boolean")return!r.exports.dropCustomMetadata}catch(r){return!0}try{return!$l.workspace.getConfiguration("jupyter",void 0).get("experimental.dropCustomMetadata",!1)}catch(r){return!0}}function B0(r){return Zge(r)}function Zge(r){return Array.isArray(r)?r.map(B0):r!=null&&typeof r=="object"&&Object.keys(r).length>0?Object.keys(r).sort().reduce((e,t)=>(e[t]=B0(r[t]),e),{}):r}var J0=new Map,CW=new Map,EW;function qG(r){EW=r}function wW(r,e){if(!r.pythonEnvironmentPath)return;let t=Me();eve({interpreterHash:r.pythonEnvironmentPath}).then(n=>{r.pythonEnvironmentPackages=n||r.pythonEnvironmentPackages,e&&(e.pythonEnvironmentPackages=n||e.pythonEnvironmentPackages)}).catch(()=>{}).finally(()=>{t.resolve()})}async function eve(r){if(!EW)return O("Python package provider is not initialized."),"{}";let e;if("interpreter"in r?e=r.interpreter:e=CW.get(r.interpreterHash),!e)return"{}";let t=await EW(e);return!t||t.size===0?"{}":JSON.stringify(Object.fromEntries(t))}async function GG(r){if(!r)return{};let e=J0.get(el(r)),t=zl(r);if(!e&&t)return{resourceType:t,resourceHash:r?await Ot(r.toString()):void 0};if(!e)return{};let n=JSON.parse(JSON.stringify(e[0]));return wW(e[0],n),n}function Rr(r,e,t,n,i){GG(r).then(o=>{Object.assign(o,n||{}),J(e,t,o,i)}).catch(y)}var Zn=!1,dI=new WeakMap,q0=new Map,Oa,$G=0;function Qc(r){var t,n;if(!r)return;if(kn(r)&&!q0.has(r.toString())){let i=Kg.workspace.notebookDocuments.find(o=>o.uri.toString()===r.toString());i&&q0.set(r.toString(),new WeakRef(i))}let e=kn(r)?(t=q0.get(r.toString()))==null?void 0:t.deref():r;if(e)return(n=dI.get(e))==null?void 0:n.tracker}function zG(r){let e=new Wi;return Oa=r,$G=r.elapsedTime,Kg.workspace.notebookDocuments.forEach(t=>dI.set(t,YG(t,!0,r))),e.add(Kg.workspace.onDidOpenNotebookDocument(t=>{!dI.has(t)&&!Zn&&dI.set(t,YG(t,!1,r))})),e.add(Kg.workspace.onDidCloseNotebookDocument(t=>{dI.delete(t),q0.delete(t.uri.toString())})),e}function QG(r){var e;(e=dI.get(r))==null||e.tracker.kernelManuallySelected()}var G0={starAfter:-1,completedAfter:-1},xW=new Map,XG=new Map,tve=new Map,ZG=Sr(()=>(G0.starAfter=Oa==null?void 0:Oa.elapsedTime,{stop:Sr(()=>{G0.completedAfter=Oa.elapsedTime})}));function eY(r,e){xW.set(r,Oa==null?void 0:Oa.elapsedTime),tve.set(r,e||"")}function tY(r){r.executable.uri&&XG.set(r.id,Oa==null?void 0:Oa.elapsedTime)}function YG(r,e,t){let n=Oa.elapsedTime,i=t.elapsedTime,o={openedAfter:i},s=c=>(c==="executeCell"&&(Zn=!0),o[`${c}StartedAfter`]=t.elapsedTime,{stop:Sr(()=>{o[`${c}CompletedAfter`]=t.elapsedTime})}),a={wasAlreadyOpen:e},l=()=>{};return{measures:o,info:a,tracker:{kernelSelected:Sr((c,u)=>{let p=xW.get(c);typeof p=="number"&&(a.wasAlreadyOpen?o.controllerCreatedAfter=xW.get(c):o.controllerCreatedAfter=n-p),o.interpreterDiscoveredAfter=XG.get(u||""),o.kernelSelectedAfter=t.elapsedTime,a.manuallySelectedKernel||ive(r,{wasAlreadyOpen:a.wasAlreadyOpen},{controllerCreatedAfter:o.controllerCreatedAfter,kernelSelectedAfter:o.kernelSelectedAfter,openedAfter:i,interpreterDiscoveredAfter:o.interpreterDiscoveredAfter})}),kernelManuallySelected:Sr(()=>a.manuallySelectedKernel=!0),cellExecutionCount:Zn?l:Sr(c=>o.executeCellCount=c),preExecuteCellTelemetry:Zn?l:Sr(()=>s("preExecuteCellTelemetry")),startKernel:Zn?l:Sr(()=>s("startKernel")),executeCell:Zn?l:Sr(()=>s("executeCell")),executeCellAcknowledged:Zn?l:Sr(()=>{o.executeCellAcknowledgedAfter=t.elapsedTime,rve(r,a,o)}),jupyterSessionTelemetry:Zn?l:Sr(()=>s("sessionTelemetry")),postKernelStartup:Zn?l:Sr(()=>s("postKernelStart")),computeCwd:Zn?l:Sr(()=>s("computeCwd")),getConnection:Zn?l:Sr(()=>s("getConnection")),updateConnection:Zn?l:Sr(()=>s("updateConnection")),kernelReady:Zn?l:Sr(()=>s("kernelReady")),portUsage:Zn?l:Sr(()=>s("portUsage")),spawn:Zn?l:Sr(()=>s("spawn")),pythonEnvVars:Zn?l:Sr(()=>s("pythonEnvVars")),envVars:Zn?l:Sr(()=>s("envVars")),interruptHandle:Zn?l:Sr(()=>s("interruptHandle")),kernelInfo:Zn?l:Sr(()=>s("kernelInfo")),kernelIdle:Zn?l:Sr(()=>s("kernelIdle"))}}}var rve=Sr(function(r,e,t){if(typeof t.preExecuteCellTelemetryStartedAfter!="number"||typeof t.preExecuteCellTelemetryCompletedAfter!="number"||typeof t.executeCellAcknowledgedAfter!="number"||typeof t.startKernelStartedAfter!="number"||typeof t.startKernelCompletedAfter!="number"||typeof t.executeCellStartedAfter!="number"||typeof t.sessionTelemetryStartedAfter!="number"||typeof t.sessionTelemetryCompletedAfter!="number"||typeof t.postKernelStartStartedAfter!="number"||typeof t.postKernelStartCompletedAfter!="number"||typeof t.kernelInfoStartedAfter!="number"||typeof t.kernelInfoCompletedAfter!="number"||typeof t.kernelIdleStartedAfter!="number"||typeof t.kernelIdleCompletedAfter!="number"||typeof t.computeCwdStartedAfter!="number"||typeof t.computeCwdCompletedAfter!="number"||typeof t.kernelReadyStartedAfter!="number"||typeof t.kernelReadyCompletedAfter!="number"||typeof t.getConnectionStartedAfter!="number"||typeof t.getConnectionCompletedAfter!="number"||typeof t.updateConnectionStartedAfter!="number"||typeof t.updateConnectionCompletedAfter!="number"||typeof t.portUsageStartedAfter!="number"||typeof t.portUsageCompletedAfter!="number"||typeof t.spawnStartedAfter!="number"||typeof t.spawnCompletedAfter!="number"||typeof t.pythonEnvVarsStartedAfter!="number"||typeof t.pythonEnvVarsCompletedAfter!="number"||typeof t.envVarsStartedAfter!="number"||typeof t.envVarsCompletedAfter!="number")return;let n={duration:0,preExecuteCellTelemetry:0,startKernel:0,executeCell:0};{let c=[{name:"preExecuteCellTelemetry",start:t.preExecuteCellTelemetryStartedAfter,end:t.preExecuteCellTelemetryCompletedAfter},{name:"startKernel",start:t.startKernelStartedAfter,end:t.startKernelCompletedAfter},{name:"executeCell",start:t.executeCellStartedAfter,end:t.executeCellAcknowledgedAfter}],u=t.executeCellAcknowledgedAfter-t.preExecuteCellTelemetryStartedAfter;n.duration=u,yx(n,c,u,t.openedAfter)}let i={sessionTelemetry:0,postKernelStart:0,computeCwd:0,getConnection:0,updateConnection:0,kernelReady:0,portUsage:0,spawn:0};{let c=[{name:"sessionTelemetry",start:t.sessionTelemetryStartedAfter,end:t.sessionTelemetryCompletedAfter},{name:"postKernelStart",start:t.postKernelStartStartedAfter,end:t.postKernelStartCompletedAfter},{name:"computeCwd",start:t.computeCwdStartedAfter,end:t.computeCwdCompletedAfter},{name:"getConnection",start:t.getConnectionStartedAfter,end:t.getConnectionCompletedAfter},{name:"updateConnection",start:t.updateConnectionStartedAfter,end:t.updateConnectionCompletedAfter},{name:"spawn",start:t.spawnStartedAfter,end:t.spawnCompletedAfter},{name:"portUsage",start:t.portUsageStartedAfter,end:t.portUsageCompletedAfter},{name:"kernelReady",start:t.kernelReadyStartedAfter,end:t.kernelReadyCompletedAfter}],u=t.startKernelCompletedAfter-t.startKernelStartedAfter;yx(i,c,u,t.openedAfter)}let o={startupCode:0,kernelInfo:0,kernelIdle:0};{let c=[{name:"startupCode",start:t.postKernelStartStartedAfter,end:t.kernelInfoStartedAfter},{name:"kernelInfo",start:t.kernelInfoStartedAfter,end:t.kernelInfoCompletedAfter},{name:"kernelIdle",start:t.kernelIdleStartedAfter,end:t.kernelIdleCompletedAfter}],u=t.postKernelStartCompletedAfter-t.postKernelStartStartedAfter;yx(o,c,u,t.openedAfter)}let s={pythonEnvVars:0,envVars:0,interruptHandle:0};{let c=[{name:"pythonEnvVars",start:t.pythonEnvVarsStartedAfter,end:t.pythonEnvVarsCompletedAfter},{name:"envVars",start:t.envVarsStartedAfter,end:t.envVarsCompletedAfter},{name:"interruptHandle",start:t.interruptHandleStartedAfter||0,end:t.interruptHandleCompletedAfter||0}],u=t.spawnCompletedAfter-t.spawnStartedAfter;yx(s,c,u,t.openedAfter)}let a=nve(r),l={...n,...i,...o,...s,...a};Rr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",l,e)});function nve(r){let e={attachmentCharLength:0,attachmentCount:0,codeCellCharLength:0,codeCellCount:0,mdCellCharLength:0,mdCellCount:0,outputCount:0,outputsByteSize:0};return r.getCells().forEach(t=>{let n=t.document.lineAt(t.document.lineCount-1).range.end,i=t.document.offsetAt(n);if(t.kind===Kg.NotebookCellKind.Markup){e.mdCellCount+=1,e.mdCellCharLength+=i;try{let s=Wd(t).attachments||{};Object.keys(s).forEach(a=>{e.attachmentCount+=1;let l=s[a];typeof l=="object"&&Object.keys(l).forEach(c=>{let u=l[c];u&&typeof u=="string"&&(e.attachmentCharLength+=u.length)})})}catch(o){ue("Error parsing attachments in cell metadata",o)}}else e.codeCellCount+=1,e.codeCellCharLength+=i,e.outputCount+=t.outputs.length,e.outputsByteSize+=t.outputs.reduce((o,s)=>o+s.items.reduce((a,l)=>a+l.data.byteLength,0),0)}),e}var ive=Sr(function(r,e,t){if(t.pythonExtensionActivationStartedAfter=G0.starAfter,t.pythonExtensionActivationCompletedAfter=G0.completedAfter,typeof t.controllerCreatedAfter=="undefined"||typeof t.interpreterDiscoveredAfter=="undefined"||typeof t.pythonExtensionActivationCompletedAfter=="undefined"||typeof t.pythonExtensionActivationStartedAfter=="undefined")return;let n=[{name:"callPythonApi",start:$G,end:t.pythonExtensionActivationStartedAfter},{name:"activatePython",start:t.pythonExtensionActivationStartedAfter,end:t.pythonExtensionActivationCompletedAfter},{name:"discoverEnv",start:t.pythonExtensionActivationCompletedAfter,end:t.interpreterDiscoveredAfter},{name:"createController",start:t.interpreterDiscoveredAfter,end:t.controllerCreatedAfter},{name:"selectController",start:t.controllerCreatedAfter,end:t.kernelSelectedAfter}],i=t.kernelSelectedAfter-t.openedAfter,o={duration:i};yx(o,n,i,t.openedAfter),Rr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",o,e)});function yx(r,e,t,n){e.sort((i,o)=>i.start-o.start).forEach(i=>{typeof n=="number"&&n>=i.start&&n<=i.end?r[i.name]=(i.end-n)*100/t:typeof n=="number"&&n>i.end?r[i.name]=0:(typeof n=="number"&&n<i.start||typeof n!="number")&&(r[i.name]=(i.end-i.start)*100/t)})}function bx(r,e){if(r){let t={...r,uri:Pt.Uri.file(r.path||""),id:e||r.id};return delete t.path,t}}function Ix(r){if(r){let e=Object.assign({},r,{path:pt(r.uri)});return delete e.uri,e}}var pI=class{constructor(e,t){this.disposables=e;this.extensionChecker=t;this.api=Me();this.didActivatePython=new Pt.EventEmitter;this._pythonExtensionHooked=Me();this.extensionChecker.isPythonExtensionInstalled||Pt.extensions.onDidChange(async()=>{this.extensionChecker.isPythonExtensionInstalled&&await this.registerHooks()},this,this.disposables),this.disposables.push(this.didActivatePython)}get onDidActivatePythonExtension(){return this.didActivatePython.event}get pythonExtensionHooked(){return this._pythonExtensionHooked.promise}get pythonExtensionVersion(){return this._pythonExtensionVersion}getApi(){return this.init().catch(y),this.api.promise}async getNewApi(){var t,n;await this.init();let e=Pt.extensions.getExtension(sa);return(t=e==null?void 0:e.packageJSON)!=null&&t.version&&(this._pythonExtensionVersion=new rY.SemVer((n=e==null?void 0:e.packageJSON)==null?void 0:n.version)),e!=null&&e.exports&&(N7(e.exports),e.exports.environments.known.forEach(i=>{tY(i)})),e==null?void 0:e.exports}setApi(e){this.api.resolved||!Pt.workspace.isTrusted||this.api.resolve(e)}async init(){if(this.initialized)return;Pt.extensions.getExtension(sa)?await this.registerHooks():await this.extensionChecker.showPythonExtensionInstallRequiredPrompt(),this.initialized=!0}async registerHooks(){var n;if(this.hooksRegistered)return;let e=Pt.extensions.getExtension(sa);if(!e)return;let t=!1;if(!e.isActive){let i=ZG();try{let o=e.activate();o.then(()=>i.stop(),()=>i.stop()),await o,t=!0}catch(o){O("Failed activating the python extension: ",o),this.api.reject(new C0(o));return}}this.hooksRegistered||(this.hooksRegistered=!0,t&&this.didActivatePython.fire(),(n=e.exports)!=null&&n.jupyter?e.exports.jupyter.registerHooks():(O("Python extension is not exporting the jupyter API"),this.api.reject(new w0)),this._pythonExtensionHooked.resolve())}};pI=E([(0,La.injectable)(),b(0,(0,La.inject)(oe)),b(1,(0,La.inject)(wo))],pI);var Ff=class{constructor(e){this.disposables=e;this.pythonExtensionInstallationStatusChanged=new Pt.EventEmitter;Pt.extensions.onDidChange(this.extensionsChangeHandler.bind(this),this,this.disposables),this.previousInstallState=this.isPythonExtensionInstalled}get onPythonExtensionInstallationStatusChanged(){return this.pythonExtensionInstallationStatusChanged.event}get isPythonExtensionInstalled(){return Pt.extensions.getExtension(sa)!==void 0}get isPythonExtensionActive(){var e;return((e=Pt.extensions.getExtension(sa))==null?void 0:e.isActive)===!0}async directlyInstallPythonExtension(){return Pt.commands.executeCommand("workbench.extensions.installExtension",sa,{context:{skipWalkthrough:!0}})}async showPythonExtensionInstallRequiredPrompt(){if(!Pt.workspace.isTrusted)return;Ff.promptDisplayed=!0;let e=Be.bannerLabelYes;J("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"displayed"}),await Pt.window.showInformationMessage(_.pythonExtensionRequired,{modal:!0},e)===e?(J("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"download"}),await this.installPythonExtension()):J("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"dismissed"})}async installPythonExtension(){Pt.commands.executeCommand("extension.open",sa).then(y,y)}async extensionsChangeHandler(){let e=this.isPythonExtensionInstalled;e!==this.previousInstallState&&(this.pythonExtensionInstallationStatusChanged.fire(e?"installed":"uninstalled"),this.previousInstallState=e)}};Ff=E([(0,La.injectable)(),b(0,(0,La.inject)(oe))],Ff);var Y0=class{constructor(e,t,n,i){this.apiProvider=e;this.extensionChecker=t;this.disposables=n;this.context=i;this.didChangeInterpreter=new Pt.EventEmitter;this.didChangeInterpreters=new Pt.EventEmitter;this._onDidEnvironmentVariablesChange=new Pt.EventEmitter;this._onDidRemoveInterpreter=new Pt.EventEmitter;this.onDidRemoveInterpreter=this._onDidRemoveInterpreter.event;this.onDidEnvironmentVariablesChange=this._onDidEnvironmentVariablesChange.event;this._status="idle";this._onDidChangeStatus=new Pt.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.refreshPromises=new Xb;this.onResumeEnvDetection=new Pt.EventEmitter;this.workspaceCachedActiveInterpreter=new Set;this.lastLoggedResourceAndInterpreterId="";this.pythonEnvHashes=new Map;this.loggedEnvsWithoutInterpreterPath=new Set;this.pendingInterpreterChangeEventTriggers=new Map;this.pendingInterpretersChangeEventTriggers=new Map;this.extensionChecker.isPythonExtensionInstalled&&!this.extensionChecker.isPythonExtensionActive&&this.apiProvider.onDidActivatePythonExtension(()=>{this.hookupOnDidChangeInterpreterEvent()},this,this.disposables),Pt.workspace.onDidGrantWorkspaceTrust(()=>this.refreshInterpreters(!0),this,this.disposables),this.disposables.push(this._onDidChangeStatus),this.disposables.push(this.refreshPromises),this.disposables.push(this.onResumeEnvDetection),this.refreshPromises.onStateChange(()=>{this.status=this.refreshPromises.isComplete?"idle":"refreshing"})}get status(){return this._status}set status(e){this._status!==e&&(this._status=e,this._onDidChangeStatus.fire())}initialize(){this.hookupOnDidChangeInterpreterEvent()}async resolveEnvironment(e){return this.getApi().then(t=>{if(!t)return;let n=typeof e=="string"?t.environments.known.find(i=>i.id===e||i.path===e):e;return t.environments.resolveEnvironment(n||e)})}get onDidChangeInterpreter(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreter.event}get onDidChangeInterpreters(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreters.event}async refreshInterpreters(e=!1){let t=(async()=>{let n=await this.getApi();if(n)try{await n.environments.refreshEnvironments({forceRefresh:e}),this.hookupOnDidChangeInterpreterEvent(),q("Refreshed Environments")}catch(i){O("Failed to refresh the list of interpreters")}})();this.refreshPromises.push(t),this.refreshPromises.push(t.then(()=>mc(1e3))),await t}async getActiveInterpreter(e){var o,s,a;if(!Pt.workspace.isTrusted)return;let t=new Mt;this.hookupOnDidChangeInterpreterEvent(),!e&&((o=Pt.workspace.workspaceFolders)==null?void 0:o.length)===1&&(e=Pt.workspace.workspaceFolders[0].uri),(s=Pt.workspace.workspaceFolders)!=null&&s.length&&(e=(e?(a=Pt.workspace.getWorkspaceFolder(e))==null?void 0:a.uri:void 0)||Pt.workspace.workspaceFolders[0].uri);let n=FG(e),i=this.getApi().then(async l=>{if(!l)return;let c=l.environments.getActiveEnvironmentPath(e),u=await l.environments.resolveEnvironment(c);return this.trackResolvedEnvironment(u)});return i.then(()=>{this.workspaceCachedActiveInterpreter.has(n)||(this.workspaceCachedActiveInterpreter.add(n),J("DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",{duration:t.elapsedTime},{firstTime:!0}))}).catch(l=>{ue(`Failed to get active interpreter from Python for workspace ${n}`,l)}),(Ni||[Pt.ExtensionMode.Development,Pt.ExtensionMode.Test].includes(this.context.extensionMode))&&i.then(l=>{let c=`${Se(e)}'-${Se(l==null?void 0:l.id)}`;if(this.lastLoggedResourceAndInterpreterId===c)return;this.lastLoggedResourceAndInterpreterId=c;let u=$u(l);De(`Active Interpreter ${e?`for '${Se(e)}' `:""}is ${Se(l==null?void 0:l.id)} (${l&&Or(l)}, '${l?ks(l):""}', ${u==null?void 0:u.major}.${u==null?void 0:u.minor}.${u==null?void 0:u.micro})`)}).catch(y),i}getInterpreterHash(e){return this.pythonEnvHashes.get(e)}async getInterpreterDetails(e,t){if(!Pt.workspace.isTrusted)throw new Error("Unable to determine active Interpreter as Workspace is not trusted");this.hookupOnDidChangeInterpreterEvent();try{return await this.getApi().then(async n=>{if(!n||t!=null&&t.isCancellationRequested)return;let i=n.environments.known.find(l=>kn(e)?nW(l.executable.uri,e):typeof e=="string"?l.id===e:nW(Pt.Uri.file(l.path),Pt.Uri.file(e.path))),o=kn(e)?Se(e):typeof e=="string"?e:Se(Pt.Uri.file(e.path));if(i){let l=await n.environments.resolveEnvironment(i),c=this.trackResolvedEnvironment(l);return Ie(`Interpreter details for ${o} from Python is ${JSON.stringify(l)} and our mapping is ${JSON.stringify(c)}`),c}let s=o;if(this.loggedEnvsWithoutInterpreterPath.has(s)||(this.loggedEnvsWithoutInterpreterPath.add(s),ue(`No interpreter with path ${o} found in Python API, will convert Uri path to string as Id ${o}`)),t!=null&&t.isCancellationRequested)return;let a=await n.environments.resolveEnvironment(kn(e)?e.fsPath:typeof e=="string"?e:e.path);return this.trackResolvedEnvironment(a)})}catch(n){ue(`Failed to get Python interpreter details from Python Extension API for ${typeof e=="string"?e:Se(kn(e)?e:Pt.Uri.file(e.path))}`,n);return}}trackResolvedEnvironment(e){if(e){let t=uT(e);return t?(Qb(t).then(n=>{this.pythonEnvHashes.set(t.id,n)}).catch(y),this.triggerEventIfAllowed("interpretersChangeEvent",t),t):void 0}}triggerEventIfAllowed(e,t){e==="interpreterChangeEvent"?this.pendingInterpreterChangeEventTriggers.set((t==null?void 0:t.id)||"",t):this.pendingInterpretersChangeEventTriggers.set((t==null?void 0:t.id)||"",t),this.triggerPendingEvents()}triggerPendingEvents(){this.pendingInterpreterChangeEventTriggers.forEach(t=>this.didChangeInterpreter.fire(t)),this.pendingInterpreterChangeEventTriggers.clear();let e=Array.from(this.pendingInterpretersChangeEventTriggers.values());if(e.length){let t=e.filter(n=>!!n);t.length!==e.length&&t.length===0?this.didChangeInterpreters.fire([]):this.didChangeInterpreters.fire(t)}this.pendingInterpretersChangeEventTriggers.clear()}async getApi(){if(this.extensionChecker.isPythonExtensionInstalled)return this.apiPromise||(this.apiPromise=this.apiProvider.getNewApi()),this.apiPromise}hookupOnDidChangeInterpreterEvent(){this.eventHandlerAdded||this.getApi().then(e=>{!this.eventHandlerAdded&&e&&(this.eventHandlerAdded=!0,e.environments.onDidEnvironmentVariablesChange(t=>{var n,i;q(`Detected changes to env file ${(i=(n=t.resource)==null?void 0:n.uri)==null?void 0:i.path} in PythonApi`),this._onDidEnvironmentVariablesChange.fire()},this,this.disposables),e.environments.onDidChangeActiveEnvironmentPath(()=>{q("Detected change in Active Python environment via Python API"),this.workspaceCachedActiveInterpreter.clear(),this.triggerEventIfAllowed("interpreterChangeEvent",void 0)},this,this.disposables),e.environments.onDidChangeEnvironments(async t=>{if(q(`Python API env change detected, ${t.type} => '${t.env.id}'`),t.type==="remove"){this.triggerEventIfAllowed("interpreterChangeEvent",void 0),this.triggerEventIfAllowed("interpretersChangeEvent",void 0),this._onDidRemoveInterpreter.fire({id:t.env.id});return}let n=uT(to(t.env));n&&(this.triggerEventIfAllowed("interpreterChangeEvent",n),this.triggerEventIfAllowed("interpretersChangeEvent",n))},this,this.disposables),this.didChangeInterpreters.fire(A7().map(uT).filter(t=>!!t).map(t=>t)))}).catch(y)}};Y0=E([(0,La.injectable)(),b(0,(0,La.inject)(uy)),b(1,(0,La.inject)(wo)),b(2,(0,La.inject)(oe)),b(3,(0,La.inject)(ut))],Y0);d();var SI=require("vscode");d();function nY(r,e){let t=r.length>0?`?token=${r}`:"";return`${e}${t}`}async function UR(r,e){let t=_.jupyterSelfCertEnable,n=_.jupyterSelfCertClose,i=await SI.window.showErrorMessage(_.jupyterSelfCertFail(e),{modal:!0},t,n);return i===t?(J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,SI.ConfigurationTarget.Workspace),!0):(i===n&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}async function WR(r,e){let t=_.jupyterSelfCertEnable,n=_.jupyterSelfCertClose,i=await SI.window.showErrorMessage(_.jupyterExpiredCertFail(e),{modal:!0},t,n);return i===t?(J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,SI.ConfigurationTarget.Workspace),!0):(i===n&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}function kV(r,e,t,n,i,o,s){var S;let a=e.baseUrl,l=e.token,c=new URL(e.baseUrl).hostname,u=e.authorizationHeader&&Object.keys((S=e==null?void 0:e.authorizationHeader)!=null?S:{}).length>0?e.authorizationHeader:void 0,p=u?()=>u:void 0,f={baseUrl:a,appUrl:"",wsUrl:a.replace("http","ws"),fetch:e.fetch,WebSocket:e.WebSocket},m=t.getRequestInit();(!(l===""||l==="null")||p)&&(f={...f,token:l,appendToken:!0});let g=i.getSettings(void 0).allowUnauthorizedRemoteConnection;if(a.startsWith("https")&&g&&n){let x=n.createHttpRequestAgent();m={...m,agent:x}}let{ServerConnection:v}=ci();return f={...f,init:m,WebSocket:e.WebSocket?t.wrapWebSocketCtor(e.WebSocket):t.getWebsocketCtor(void 0,g,p),fetch:e.fetch||t.getFetchMethod(),Request:t.getRequestCtor(void 0,g,p),Headers:t.getHeadersCtor()},{baseUrl:a,providerId:r.id,serverProviderHandle:r,token:l,hostName:c,displayName:e&&e.displayName?e.displayName:nY(l,a),dispose:()=>s==null?void 0:s.dispose(),rootDirectory:o,getAuthHeader:p,settings:v.makeSettings(f)}}async function H$(r){let e=zt(r);return ol(e,"SHA-256")}var fIe=new Set([Xe,"ms-toolsai.vscode-ai","GitHub.codespaces"].map(r=>r.toLowerCase()));function zt(r){return fIe.has(r.extensionId.toLowerCase())?`${st.REMOTE_URI}?${st.REMOTE_URI_ID_PARAM}=${r.id}&${st.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}`:`${st.REMOTE_URI}?${st.REMOTE_URI_ID_PARAM}=${r.id}&${st.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}&${st.REMOTE_URI_EXTENSION_ID_PARAM}=${encodeURI(r.extensionId)}`}async function VR(r){var e;if(!_p()&&((e=r.interpreter)!=null&&e.uri)){let t=r.interpreter.uri.fsPath,n=Gc(r.interpreter.uri).fsPath,i=r.id.replace(t,n);return Ot(i)}return Ot(r.id)}var su=class{static fromJSON(e){let t=Object.assign(e,{});switch(t.interpreter&&(t.interpreter=bx(t.interpreter,"")),e.kind){case"startUsingLocalKernelSpec":return NV.create(t);case"connectToLiveRemoteKernel":return Fx.create(t);case"startUsingRemoteKernelSpec":return Ux.create(t);case"startUsingPythonInterpreter":return Wx.create(t);default:throw new Error(`Invalid object to be deserialized into a connection, kind = ${t.kind}`)}}},Fx=class r{constructor(e){this.kind="connectToLiveRemoteKernel";this.kernelModel=e.kernelModel,this.interpreter=e.interpreter,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,jR(this)}static create(e){return new r(e)}updateModel(e){Object.assign(this.kernelModel,e)}getHashId(){return VR(this)}toJSON(){return{id:this.id,kind:this.kind,baseUrl:this.baseUrl,interpreter:Ix(this.interpreter),kernelModel:this.kernelModel,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return su.fromJSON(e)}},NV=class r{constructor(e){this.kind="startUsingLocalKernelSpec";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,jR(this)}static create(e){return new r(e)}getHashId(){return VR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:Ix(this.interpreter),kind:this.kind}}static fromJSON(e){return su.fromJSON(e)}},Ux=class r{constructor(e){this.kind="startUsingRemoteKernelSpec";this.interpreter=e.interpreter,this.kernelSpec=e.kernelSpec,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,jR(this)}static create(e){return new r(e)}getHashId(){return VR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:Ix(this.interpreter),baseUrl:this.baseUrl,kind:this.kind,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return su.fromJSON(e)}},Wx=class r{constructor(e){this.kind="startUsingPythonInterpreter";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,jR(this)}static create(e){return new r(e)}getHashId(){return VR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:Ix(this.interpreter),kind:this.kind}}updateInterpreter(e){Object.assign(this.interpreter,e)}static fromJSON(e){return su.fromJSON(e)}};function or(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"}function Ft(r){return!or(r)}var $e=Symbol("IKernelProvider"),Gg=Symbol("IThirdPartyKernelProvider");var IGe=Symbol("IJupyterServerConnector"),Vx=Symbol("IKernelSessionFactory");var _I=Symbol("IKernelDependencyService"),di=Symbol("IKernelFinder"),EI=Symbol("ITracebackFormatter");var Hd=Symbol("IStartupCodeProviders"),J$=new Set;function jR(r){var m,h;if(J$.has(r.id))return;J$.add(r.id);let e="kernelSpec"in r?r.kernelSpec:void 0,t=(e==null?void 0:e.language)||(r.kind==="startUsingPythonInterpreter"?Qe:void 0),n="",i="",o="interpreter"in r?r.interpreter:void 0,s="<#>",a;e&&Array.isArray(e.argv)&&e.argv.length>0&&(n=e.argv[0],a=n.toLowerCase()===((h=(m=o==null?void 0:o.uri)==null?void 0:m.fsPath)==null?void 0:h.toLowerCase()),sr(n)!==n&&(n=`<P>${sr(n)}`),i=e.argv.map(g=>g.includes("/")||g.includes("\\")?`<P>${sr(g)}`:g).join(s));let l="kernelSpec"in r&&r.kernelSpec.specFile?Ot(r.kernelSpec.specFile):Promise.resolve(""),c=Ot(r.id),u=Ft(r)?Ot(zt(r.serverProviderHandle)):Promise.resolve(""),p=Ft(r)?r.serverProviderHandle.extensionId:Xe,f=Ft(r)?Ot(r.baseUrl.toLowerCase()):Promise.resolve("");Promise.all([l,c,u,f]).then(([g,v,I,S])=>J("DS_INTERNAL.JUPYTER_KERNEL_SPEC",void 0,{kernelId:v,serverIdHash:I,kernelSpecHash:g,baseUrlHash:S,providerExtensionId:p,kernelConnectionType:r.kind,kernelLanguage:t,envType:o&&Or(o),isArgv0SameAsInterpreter:a,argv0:n,argv:i})).catch(y)}d();var Fn=require("vscode");d();var SIe=z(RW()),qd=require("vscode");d();var CI=class{constructor(e,t,n,i){this.specFile=t;this.interpreterPath=n;this.isRegisteredByVSC=i;this.name=e.name,this.argv=e.argv,this.language=e.language,this.executable=e.argv&&e.argv.length>0?e.argv[0]:"",this.display_name=e.display_name,this.metadata=e.metadata,this.env=e.env,this.interrupt_mode=e.interrupt_mode}};d();var pi=require("vscode"),Z$=z(RV());d();var AV=class{constructor(e,t,n,i=!1){this._impl=e;this.controllerId=t;this._endCallback=n;this.clearOutputOnStartWithTime=i;this.started=!1}get cell(){return this._impl.cell}get token(){return this._impl.token}get executionOrder(){return this._impl.executionOrder}set executionOrder(e){var t;e&&((t=Qc(this._impl.cell.notebook))==null||t.executeCellAcknowledged()),this._impl.executionOrder=e}startIfNecessary(){this.started||this._impl.start()}start(e){this.started||(this.started=!0,this._impl.start(e),this._startTime=e,this.clearOutputOnStartWithTime?(q(`Start cell ${this.cell.index} execution @ ${e} (clear output)`),this._impl.clearOutput().then(y,y)):q(`Start cell ${this.cell.index} execution @ ${e}`))}end(e,t){if(this._endCallback)try{this._impl.end(e,t,this.errorInfo),De(`Cell ${this.cell.index} completed in ${((t||0)-(this._startTime||0))/1e3}s (start: ${this._startTime}, end: ${t})`)}finally{this._endCallback(),this._endCallback=void 0}}clearOutput(e){return this.startIfNecessary(),this._impl.clearOutput(e)}replaceOutput(e,t){return this.startIfNecessary(),this._impl.replaceOutput(e,t)}appendOutput(e,t){return this.startIfNecessary(),this._impl.appendOutput(e,t)}replaceOutputItems(e,t){return this.startIfNecessary(),this._impl.replaceOutputItems(e,t)}appendOutputItems(e,t){return this.startIfNecessary(),this._impl.appendOutputItems(e,t)}},qf=class qf{static getOrCreate(e,t,n=!1){let i,o=e.document;if(i=this.get(e),!i)i=qf.create(o,e,t,n);else if(i.controllerId!==t.id){let s=i;s.end(void 0),i=qf.create(o,e,t,n),s.started&&i.start(new Date().getTime())}return i}static get(e){let t=e.document;return qf._map.get(t)}static create(e,t,n,i=!1){let o=new AV(n.createNotebookCellExecution(t),n.id,()=>{qf._map.delete(e)},i);return qf._map.set(e,o),o}};qf._map=new WeakMap;var fo=qf;d();function BR(r){return typeof Buffer!="undefined"&&typeof Buffer.from=="function"?Buffer.from(r,"base64"):Uint8Array.from(atob(r),e=>e.charCodeAt(0))}var hIe=new TextDecoder;function HR(r){if(typeof Buffer!="undefined"&&typeof Buffer.from=="function")return Buffer.from(r).toString("base64");{let e=hIe.decode(r);return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(t,n){return String.fromCharCode(Number.parseInt("0x"+n))}))}}var $$=["application/vnd.*","application/vdom.*","application/geo+json","application/x-nteract-model-debug+json","text/html","application/javascript","image/gif","text/latex","text/markdown","image/png","image/svg+xml","image/jpeg","application/json","text/plain"];function z$(r){if(r.mime.startsWith("application/vnd."))try{return new TextDecoder().decode(r.data).length===0}catch(e){}return!1}function gIe(r){return r.sort((e,t)=>{let n=(s,a)=>(s.endsWith(".*")&&(s=s.substr(0,s.indexOf(".*"))),a.startsWith(s)),i=$$.findIndex(s=>n(s,e.mime)),o=$$.findIndex(s=>n(s,t.mime));return z$(e)&&(i=-1),z$(t)&&(o=-1),i=i==-1?100:i,o=o==-1?100:o,i-o})}var Gf=class Gf{static getCellState(e){var t;return(t=Gf.cellStates.get(e))==null?void 0:t.state}static getCellStatus(e){var t;return(((t=Gf.cellStates.get(e))==null?void 0:t.stateTransition)||[]).join(", ")||""}static setCellState(e,t){var o,s;let n=((o=Gf.cellStates.get(e))==null?void 0:o.start)||new Mt,i=((s=Gf.cellStates.get(e))==null?void 0:s.stateTransition)||[];i.push(`${t} ${i.length===0?"@ start":`After ${n.elapsedTime}ms`}`),Gf.cellStates.set(e,{stateTransition:i,state:t,start:n})}};Gf.cellStates=new WeakMap;var Jd=Gf;function lt(r,e){let t=typeof e=="string"?()=>e:e;Ie(()=>{var n;return`Cell Index:${r.index}, of document ${yi(r.notebook.uri)} with state:${Jd.getCellStatus(r)}, exec: ${(n=r.executionSummary)==null?void 0:n.executionOrder}. ${t()}. called from ${Y7()}`})}var xI=new Map;xI.set("display_data",qR);xI.set("error",IIe);xI.set("execute_result",qR);xI.set("stream",vIe);xI.set("update_display_data",qR);function vs(r){let e=xI.get(r.output_type),t;return e?t=e(r):(ue(`Unable to translate cell from ${r.output_type} to NotebookCellData for VS Code.`),t=qR(r)),t}function MV(r){let e={outputType:r.output_type};switch(r.transient&&(e.transient=r.transient),r.output_type){case"display_data":case"execute_result":case"update_display_data":{e.executionCount=r.execution_count,e.metadata=r.metadata?JSON.parse(JSON.stringify(r.metadata)):{};break}default:break}return e}function Yg(r){return r.metadata}function qR(r){let e=MV(r);("image/svg+xml"in r.data||"image/png"in r.data)&&(e.__displayOpenPlotIcon=!0);let t=[];if(r.data)for(let n in r.data)t.push(bIe(n,r.data[n]));return new pi.NotebookCellOutput(gIe(t),e)}function vIe(r){let e=zc(r.text),t=r.name==="stderr"?pi.NotebookCellOutputItem.stderr:pi.NotebookCellOutputItem.stdout;return new pi.NotebookCellOutput([t(e)],MV(r))}function yIe(r){if(r.items.length>0)return r.items[0].mime==="application/vnd.code.notebook.stderr"?"stderr":"stdout"}function Q$(r){var i;let e=r.items[0];if(!e.data)return{output_type:"error",ename:"",evalue:"",traceback:[]};let t=(i=r.metadata)==null?void 0:i.originalError,n=JSON.parse(new TextDecoder().decode(e.data));return{output_type:"error",ename:n.name,evalue:n.message,traceback:(t==null?void 0:t.traceback)||cI(n.stack||n.message||"")}}var wI=new TextDecoder,ez=["text/plain","text/markdown","application/vnd.code.notebook.stderr","application/vnd.code.notebook.stdout"];function JR(r,e){if(!e)return"";try{if(r==="application/vnd.code.notebook.error"){let t=wI.decode(e);return JSON.parse(t)}else if(r.startsWith("text/")||ez.includes(r)){let t=wI.decode(e);return cI(t)}else{if(r.startsWith("image/")&&r!=="image/svg+xml")return HR(e);if(r.toLowerCase().startsWith("application/vnd.holoviews_load.v")&&r.toLowerCase().endsWith("+json")){let t=wI.decode(e);try{return t.length>0?JSON.parse(t):t}catch(n){return t}}else if(r.toLowerCase().includes("json")){let t=wI.decode(e);return t.length>0?JSON.parse(t):t}else return wI.decode(e)}}catch(t){return O(`Failed to convert ${r} output from a buffer ${typeof e}, ${e}`,t),""}}function bIe(r,e){if(!e)return pi.NotebookCellOutputItem.text("",r);try{if((r.startsWith("text/")||ez.includes(r))&&(Array.isArray(e)||typeof e=="string")){let t=Array.isArray(e)?zc(e):e;return pi.NotebookCellOutputItem.text(t,r)}else return r.startsWith("image/")&&typeof e=="string"&&r!=="image/svg+xml"?new pi.NotebookCellOutputItem(BR(e),r):typeof e=="object"&&e!==null&&!Array.isArray(e)?pi.NotebookCellOutputItem.text(JSON.stringify(e),r):(e=Array.isArray(e)?zc(e):e,pi.NotebookCellOutputItem.text(e,r))}catch(t){return O(`Failed to convert ${r} output to a buffer ${typeof e}, ${e}`,t),pi.NotebookCellOutputItem.text("")}}function X$(r){let e=[];r.items.filter(n=>n.mime==="application/vnd.code.notebook.stderr"||n.mime==="application/vnd.code.notebook.stdout").map(n=>wI.decode(n.data)).forEach(n=>{let i=n.split(`
`);e.length&&i.length&&i[0].length>0&&(e[e.length-1]=`${e[e.length-1]}${i.shift()}`);for(let o of i)e.push(o)});for(let n=0;n<e.length-1;n++)e[n]=`${e[n]}
`;return e.length&&e[e.length-1].length===0&&e.pop(),{output_type:"stream",name:yIe(r)||"stdout",text:e}}function OV(r){let e=r.metadata,t;switch(e==null?void 0:e.outputType){case"error":{t=Q$(r);break}case"stream":{t=X$(r);break}case"display_data":{t={output_type:"display_data",data:r.items.reduce((i,o)=>(i[o.mime]=JR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}case"execute_result":{t={output_type:"execute_result",data:r.items.reduce((i,o)=>(i[o.mime]=JR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{},execution_count:typeof(e==null?void 0:e.executionCount)=="number"?e==null?void 0:e.executionCount:null};break}case"update_display_data":{t={output_type:"update_display_data",data:r.items.reduce((i,o)=>(i[o.mime]=JR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}default:{let i=r.items.length===1&&r.items.every(l=>l.mime==="application/vnd.code.notebook.error"),o=r.items.every(l=>l.mime==="application/vnd.code.notebook.stderr"||l.mime==="application/vnd.code.notebook.stdout");if(i)return Q$(r);let s=(e==null?void 0:e.outputType)||(o?"stream":"display_data");J("DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",void 0,{outputType:s});let a;s==="stream"?a=X$(r):s==="display_data"?a={data:{},metadata:{},output_type:"display_data"}:a={output_type:s},e!=null&&e.metadata&&(a.metadata=e.metadata),r.items.length>0&&(a.data=r.items.reduce((l,c)=>(l[c.mime]=JR(c.mime,c.data),l),{})),t=a;break}}return t&&e&&e.transient&&(t.transient=e.transient),t}function IIe(r){return r=r||{output_type:"error",ename:"",evalue:"",traceback:[]},new pi.NotebookCellOutput([pi.NotebookCellOutputItem.error({name:(r==null?void 0:r.ename)||"",message:(r==null?void 0:r.evalue)||"",stack:((r==null?void 0:r.traceback)||[]).join(`
`)})],{...MV(r),originalError:r})}async function tz(r,e,t){var a,l,c,u,p,f,m,h,g,v,I,S,x,D,A,w;let n=!1,i;if(!r)return{changed:n,kernelId:i};(a=r==null?void 0:r.language_info)!=null&&a.name||(r.language_info=r.language_info||{name:""});let o;switch(e==null?void 0:e.kind){case"connectToLiveRemoteKernel":o=e.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":o=e.kernelSpec.language;break;case"startUsingPythonInterpreter":o=Qe;break;default:break}if(r.language_info.name!==o&&o&&(r.language_info.name=o,n=!0),t&&"language_info"in t&&t.language_info)(0,Z$.default)(r.language_info,t.language_info)||(r.language_info=JSON.parse(JSON.stringify(t.language_info)),n=!0);else{let R=Qt(e),j=R?nz(e):void 0,ne=await Op(j),N=ne?`${ne.major}.${ne.minor}.${ne.micro}`:"";j&&ne&&r&&r.language_info&&r.language_info.version!==N?(r.language_info.version=N,n=!0):!j&&(r!=null&&r.language_info)&&R&&(r.language_info=void 0,n=!0)}let s=e&&DI(e)?e.kernelModel:e&&"kernelSpec"in e?e.kernelSpec:void 0;if((e==null?void 0:e.kind)==="startUsingPythonInterpreter"){let R=e.kernelSpec,j=R.display_name||((c=(l=to(e.interpreter))==null?void 0:l.environment)==null?void 0:c.name)||"",ne="";switch($g(R)){case"registeredByOldVersionOfExt":case"registeredByNewVersionOfExt":ne="python3";break;case"registeredByNewVersionOfExtForCustomKernelSpec":{ne=((p=(u=R.metadata)==null?void 0:u.vscode)!=null&&p.originalSpecFile?sr(Ri(R.metadata.vscode.originalSpecFile)):void 0)||R.name,j=((m=(f=R.metadata)==null?void 0:f.vscode)==null?void 0:m.originalDisplayName)||j;break}default:ne=R.name;break}((h=r.kernelspec)==null?void 0:h.name)!==ne&&(n=!0,r.kernelspec={name:ne,language:Qe,display_name:j},"vscode"in r&&delete r.vscode,"interpreter"in r&&delete r.interpreter)}else if(s&&!r.kernelspec){let R=(v=(g=s.metadata)==null?void 0:g.vscode)!=null&&v.originalSpecFile?sr(Ri(s.metadata.vscode.originalSpecFile)):void 0;r.kernelspec={name:R||s.name||s.display_name||"",display_name:((S=(I=s.metadata)==null?void 0:I.vscode)==null?void 0:S.originalDisplayName)||s.display_name||s.name||""},s.language&&(r.kernelspec.language=s.language),i=s.id,n=!0}else if(s&&r.kernelspec){let j=((D=(x=s.metadata)==null?void 0:x.vscode)!=null&&D.originalSpecFile?sr(Ri(s.metadata.vscode.originalSpecFile)):void 0)||s.name||s.display_name||"",ne=((w=(A=s.metadata)==null?void 0:A.vscode)==null?void 0:w.originalDisplayName)||s.display_name||s.name||"",N=s.language||s.language||"";(r.kernelspec.name!==j||r.kernelspec.language!==N||r.kernelspec.display_name!==ne||i!==s.id)&&(n=!0,r.kernelspec.name=j,r.kernelspec.display_name=ne,r.kernelspec.language=N,i=s.id);try{delete r.kernelspec.metadata}catch(ee){}}return{changed:n,kernelId:i}}async function Yf(r,e,t,n){var s,a,l,c,u,p,f;let i=yy(t);if(!i){let m=fo.get(r);n&&(m!=null&&m.started)&&m.end(n?void 0:!1,(a=(s=r.executionSummary)==null?void 0:s.timing)==null?void 0:a.endTime);return}fo.get(r)||(n=!0);let o=fo.getOrCreate(r,e);o.started||(o.start((c=(l=r.executionSummary)==null?void 0:l.timing)==null?void 0:c.endTime),o.executionOrder=(u=r.executionSummary)==null?void 0:u.executionOrder),await o.appendOutput(i),o.end(n?void 0:!1,(f=(p=r.executionSummary)==null?void 0:p.timing)==null?void 0:f.endTime)}function rz(r,e){var s;let t=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,n=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\][^<]*<cell line:\s?(?<lineNumber>\d+)>.*/,i;for(let a of r){let l=(s=t.exec(a))!=null?s:n.exec(a);if(l&&l.groups){i=parseInt(l.groups.lineNumber);break}}let o;if(i&&i>0&&i<=e.document.lineCount){let a=e.document.lineAt(i-1),l=a.text.split("#")[0].trimEnd().length;o=new pi.Range(new pi.Position(a.lineNumber,a.firstNonWhitespaceCharacterIndex),new pi.Position(a.lineNumber,l))}return o}d();function jx(r){if(r.hasOwnProperty("text/html")){let e=r["text/html"];typeof e=="string"&&e.includes('<iframe id="tensorboard-frame-')&&(r["text/html"]=e.replace(/new URL\((.*), window.location\)/,'new URL("http://localhost")'))}return r}var _Ie="{connection_file}";var $f="-jvsc-",EIe=/^python\d*.?\d*$/;async function Hx(r,e){return CIe(await TIe(r),r,e)}function CIe(r,e,t){var s,a;let n=e?{path:pt(e.uri)}:{},i={name:r,language:"python",display_name:(e?(a=(s=to(e))==null?void 0:s.environment)==null?void 0:a.name:"")||"Python 3",metadata:{interpreter:n},argv:["python","-m","ipykernel_launcher","-f",_Ie],env:{},resources:{}},o=t&&i.name?$i(t,i.name,"kernel.json"):void 0;return new CI(i,o?pt(o):void 0,pt(e==null?void 0:e.uri),"registeredByNewVersionOfExt")}function GR(r){var t,n,i;let e=r==null?void 0:r.kernelspec;return(t=r==null?void 0:r.language_info)!=null&&t.name&&r.language_info.name!==Qe?!1:(n=e==null?void 0:e.name)!=null&&n.includes(Qe)?!0:(e==null?void 0:e.language)===Qe||((i=r==null?void 0:r.language_info)==null?void 0:i.name)===Qe}function wIe(r){var i,o,s,a,l;let e=((o=(i=r.metadata)==null?void 0:i.vscode)==null?void 0:o.originalSpecFile)||((s=r.metadata)==null?void 0:s.originalSpecFile),t=e?sr(Ri(e)):r.name||"",n=((l=(a=r.metadata)==null?void 0:a.vscode)==null?void 0:l.originalDisplayName)||r.display_name||"";return!!(t.toLowerCase().match(EIe)||n.toLowerCase()==="python 3 (ipykernel)"||n.toLowerCase()==="python 3")}function xIe(r){if(r.includes($f)){let e=/[a-f0-9]$/;if(r.substring(r.lastIndexOf($f)+$f.length).search(e)!==-1){let t=r.substring(0,r.lastIndexOf($f));return t.toLowerCase().endsWith(".ipynb")||t.toLowerCase().endsWith(".py")?t:`${t}.ipynb`}}return r}function YR(r){return r.kind!=="connectToLiveRemoteKernel"}function DI(r){return r.kind==="connectToLiveRemoteKernel"}function $R(r,e,t){var c,u,p;e=LV(r)?e:void 0;let n=r.name,i=$g(r);if(i&&n.includes(Bx)&&(n=n.substring(n.indexOf(Bx)),i==="registeredByNewVersionOfExtForCustomKernelSpec")){let f=((u=(c=r.metadata)==null?void 0:c.vscode)==null?void 0:u.originalSpecFile)||((p=r.metadata)==null?void 0:p.originalSpecFile);f&&(n=`${n}#${sr(Ri(f))}`)}let o="";LV(r)?o=r.argv.slice(1).filter(f=>!["-f","{connection_file}"].includes(f)).join("#").toLowerCase():o=r.argv.join("#").toLowerCase();let s=t?`${t}.`:"",a=pt(Gc(r.interpreterPath?qd.Uri.file(r.interpreterPath):qd.Uri.file(r.executable))),l=pt(Gc(e==null?void 0:e.uri))||"";return`${s}${r.id||""}.${n}.${a}.${l}.${o}`}function ft(r){var t,n,i,o;let e=DIe(r);if(!r)return e;switch(r.kind){case"connectToLiveRemoteKernel":{let a=xIe(((n=(t=r.kernelModel)==null?void 0:t.notebook)==null?void 0:n.path)||((o=(i=r.kernelModel)==null?void 0:i.model)==null?void 0:o.path)||"");return a?`${e} (${a})`:e}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":if(r.interpreter&&Or(r.interpreter)!=="Unknown"){let a=ks(r.interpreter);if(r.kernelSpec.language===Qe){let l=`Python ${fy($u(r.interpreter))||""}`.trim();return a?`${e} (${l})`:e}else return a?`${e} (${a})`:e}else return e;case"startUsingPythonInterpreter":let s=(fy($u(r.interpreter))||"").trim();if(r.interpreter&&Or(r.interpreter)!=="Unknown"){if(r.kernelSpec.display_name&&$g(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return r.kernelSpec.display_name;let a=fa(r.interpreter),l=s.trim()?`Python ${s}`:"Python",c=ks(r.interpreter);return a&&c?c:c?`${c} (${l})`:l}else return`Python ${s}`.trim()}return e}function DIe(r){var i,o;if(!r)return"";let e=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.display_name:(i=r.kernelSpec)==null?void 0:i.display_name,t=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(o=r.kernelSpec)==null?void 0:o.name,n=r.kind==="startUsingPythonInterpreter"?sl(r.interpreter):void 0;return[e,t,n,""].find(s=>typeof s=="string"&&s.length>0)||""}function iz(r,e=""){var t;return r?r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(t=r.kernelSpec)==null?void 0:t.name:e}function PIe(r){var n,i,o,s,a;if(!r)return;let e=DI(r)?r.kernelModel:void 0,t=YR(r)?r.kernelSpec:void 0;if(r.kind==="startUsingPythonInterpreter"||(r.kind==="startUsingRemoteKernelSpec"||r.kind==="startUsingLocalKernelSpec")&&r.kernelSpec.language===Qe){let l=((i=(n=t==null?void 0:t.metadata)==null?void 0:n.interpreter)==null?void 0:i.path)||(t==null?void 0:t.interpreterPath)||(t==null?void 0:t.executable);if(l==="/python"||l==="python"){let c=to(r.interpreter);return((o=c==null?void 0:c.environment)==null?void 0:o.folderUri)||(c?qd.Uri.file(c.path):void 0)}return l?qd.Uri.file(l):void 0}else{let l=(e==null?void 0:e.executable)||(t==null?void 0:t.executable)||((a=(s=t==null?void 0:t.metadata)==null?void 0:s.interpreter)==null?void 0:a.path)||(t==null?void 0:t.interpreterPath);return l?qd.Uri.file(l):void 0}}function KV(r,e=""){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel"){let t;if(typeof r.kernelModel.lastActivityTime=="string")try{t=new Date(r.kernelModel.lastActivityTime)}catch(n){q(`Error parsing date ${n}`)}else t=r.kernelModel.lastActivityTime;return _.jupyterSelectLiveRemoteKernelDescription(t,r.kernelModel.numberOfConnections)}return e}function oz(r,e){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel")return;let t=PIe(r),n=qd.workspace.workspaceFolders?qd.workspace.workspaceFolders:[];return t?Se(t,n,e.homeDir):""}function nz(r){var n,i,o;if(!r)return;if(r.interpreter)return r.interpreter;let e=DI(r)?r.kernelModel:void 0;if((n=e==null?void 0:e.metadata)!=null&&n.interpreter)return bx((i=e==null?void 0:e.metadata)==null?void 0:i.interpreter,"");let t=YR(r)?r.kernelSpec:void 0;return bx((o=t==null?void 0:t.metadata)==null?void 0:o.interpreter,"")}function sz(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"&&r.kernelSpec&&$g(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec"}function Qt(r){if(!r)return!1;if(r.kind==="startUsingPythonInterpreter")return!0;let e=DI(r)?r.kernelModel:void 0,t=YR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)===Qe||LV(t)}function LV(r){return((r==null?void 0:r.language)||"").toLowerCase()===Qe}function au(r){if(!r)return;if(r.kind==="startUsingPythonInterpreter")return Qe;let e=DI(r)?r.kernelModel:void 0,t=YR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)||lz(t)}function az(r){var t;if(!r)return;let e=r.kernelspec;return lz(e)||((t=r.language_info)==null?void 0:t.name)}function lz(r){return r==null?void 0:r.language}var Bx="jvsc74a57bd0";async function TIe(r){let t=(fy($u(r))||"3").replace(/\./g,""),n=r?`python${t}`:"";return r?`${n}${Bx}${await Qb(r)}`:"python3"}function $g(r){var o,s,a,l;if(r.isRegisteredByVSC)return r.isRegisteredByVSC;if(!r.name)return;let e=((s=(o=r.metadata)==null?void 0:o.vscode)==null?void 0:s.originalSpecFile)||((a=r.metadata)==null?void 0:a.originalSpecFile),t=e?sr(Ri(e)):r.name,n=wIe({...r,name:t})?Object.keys(r.env||{}).length>0:typeof e=="string"&&!e.includes(Bx);if(r.name.includes(Bx))return n?"registeredByNewVersionOfExtForCustomKernelSpec":"registeredByNewVersionOfExt";let i=/[a-f0-9]{32}$/;if((l=r.metadata)!=null&&l.interpreter&&r.name.toLowerCase().search(i)!==-1)return"registeredByOldVersionOfExt"}function cz(r,e){return!r&&!e?!0:!r&&e||r&&!e?!1:(r==null?void 0:r.id)===(e==null?void 0:e.id)}async function Ji(r,e,t){q(`Executing silently Code (${r.status}) = ${dt(e.substring(0,100)).join("\\n")}`);let n=ci(),i=r.requestExecute({code:e.replace(/\r\n/g,`
`),silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!1},!0),o=[];i.onIOPub=a=>{if(n.KernelMessage.isStreamMsg(a))if(Ie(`Got io pub message (stream), ${dt(a.content.text.substr(0,100)).join("\\n")}`),o.length>0&&o[o.length-1].output_type==="stream"&&o[o.length-1].name===a.content.name){let l=o[o.length-1];l.text+=a.content.text}else{let l={name:a.content.name,text:a.content.text,output_type:"stream"};o.push(l)}else if(n.KernelMessage.isExecuteResultMsg(a)){Ie("Got io pub message (execresult)}");let l={data:a.content.data,execution_count:a.content.execution_count,metadata:a.content.metadata,output_type:"execute_result"};o.push(l)}else if(n.KernelMessage.isDisplayDataMsg(a)){Ie("Got io pub message (displaydata)}");let l={data:a.content.data,metadata:a.content.metadata,output_type:"display_data"};o.push(l)}else if(n.KernelMessage.isErrorMsg(a)){if(Ie(`Got io pub message (error), ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join().substring(0,100)}}`),t!=null&&t.traceErrors){let c=`${t.traceErrorsMessage||"Failed to execute (silent) code against the kernel"}, 
Code = ${e}
Error details: `;O(`${c} ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join()}`)}let l={ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback,output_type:"error"};o.push(l)}else Ie(`Got io pub message (${a.header.msg_type})`)},await i.done;let s=dt(e.substring(0,100)).join("\\n");return t&&kIe(o,t,s),q(`Executing silently Code (completed) = ${s} with ${o.length} output(s)`),o}function uz(r,e,t,n){e=e.replace(/\r\n/g,`
`);let i=ci(),o=r.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!1,store_history:!1},!0),s=Sr(t);return o.onIOPub=a=>{s(),i.KernelMessage.isStreamMsg(a)?n(vs({output_type:"stream",name:a.content.name,text:a.content.text})):i.KernelMessage.isExecuteResultMsg(a)?n(vs({output_type:"execute_result",data:a.content.data,metadata:a.content.metadata,transient:a.content.transient,execution_count:a.content.execution_count})):i.KernelMessage.isDisplayDataMsg(a)?n(vs({output_type:"display_data",data:jx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isUpdateDisplayDataMsg(a)?n(vs({output_type:"display_data",data:jx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isErrorMsg(a)?n(vs({output_type:"error",ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback})):i.KernelMessage.isExecuteInputMsg(a)||i.KernelMessage.isStatusMsg(a)||ue(`Got unexpected io pub message when executing code sillenty (${a.header.msg_type})`)},o}function kIe(r,e,t){r.filter(n=>n.output_type==="error").forEach(n=>{let i=n,o=`${i.ename}: ${i.evalue} 
 ${i.traceback.map(a=>`    ${a}`).join(`
`)}`,s=`${e.traceErrorsMessage||""} ${t} ${o}`;e.traceErrors?O(s):ue(s),e.telemetryName&&J(e.telemetryName)})}d();function zg(r){return(e,t=null,n)=>{let i=!1,o;return o=r(s=>{if(!i)return o?o.dispose():i=!0,e.call(t,s)},null,n),i&&o.dispose(),o}}function FV(r,e=null,t){return new Promise(n=>zg(r)(n,e,t))}d();var zR="application/vnd.vscode.chat_message",dz=`
def __VSCODE_inject_module():

    def __VSCODE_call_function(function, callback, data=None):
        __VSCODE_send_chat_message__(function, data, callback=callback)

    def __VSCODE_send_chat_message__(function, data, callback):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        import uuid as __VSCODE_send_chat_message__uuid
        import IPython.display as __VSCODE_send_chat_message__ipython_display

        id = str(__VSCODE_send_chat_message__uuid.uuid4())
        requests[id] = callback
        data_is_none = data is None
        __VSCODE_send_chat_message__ipython_display.display({"${zR}": data}, metadata={"id":id, "function": function, "dataIsNone": data_is_none}, raw=True)

        del __VSCODE_send_chat_message__ipython_display
        del __VSCODE_send_chat_message__uuid

    def __VSCODE_on_chat_message(id, data):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        if id in requests:
            requests[id](data)
            del requests[id]
        else:
            raise NotImplementedError(f"Callback not found for message {id}")

    import sys as __VSCODE_send_chat_message__sys
    import IPython as __VSCODE_send_chat_message__IPython
    chat = type(__VSCODE_send_chat_message__IPython)("chat")
    chat.send_message = __VSCODE_send_chat_message__
    chat.call_function = __VSCODE_call_function
    chat.__on_message = __VSCODE_on_chat_message
    __VSCODE_send_chat_message__sys.modules["vscode"] = type(__VSCODE_send_chat_message__IPython)("vscode")
    __VSCODE_send_chat_message__sys.modules["vscode"].chat = chat
    del __VSCODE_send_chat_message__sys
    del __VSCODE_send_chat_message__IPython


__VSCODE_inject_module()
del __VSCODE_inject_module
`,NIe=[[new RegExp("\\\\","g"),"\\\\"],[new RegExp('"',"g"),'\\"'],[new RegExp("'","g"),"'"],[new RegExp("\\\b","g"),"\\b"],[new RegExp("\\f","g"),"\\f"],[new RegExp("\\n","g"),"\\n"],[new RegExp("\\r","g"),"\\r"],[new RegExp("\\t","g"),"\\t"]];function pz(r,e){let t=Jx(e),n=typeof t=="string"?`"${t}"`:"None";return`
import vscode as __vscode
try:
    __vscode.chat.__on_message('${r}', ${n})
finally:
    del __vscode
`}function Jx(r){if(typeof r!="string")return r;for(let[e,t]of NIe)r=r.replace(e,t);return r}d();var qx=new WeakMap;function QR(r,e,t){var a,l;let n=Yg(t),i=(a=n==null?void 0:n.transient)==null?void 0:a.display_id;if(((l=t.metadata)==null?void 0:l.outputType)!=="display_data"||!i)return;let o=qx.get(e)||new Map;qx.set(e,o);let s=o.get(r)||[];o.set(r,s),s.push(i),s.length>1e3&&s.shift()}function fz(r,e){let t=qx.get(r)||new Map;for(let n of t.values())if(n.includes(e))return!0;return!1}function mz(r,e,t){return((qx.get(e)||new Map).get(r)||[]).includes(t)}function hz(r,e){let t=qx.get(r)||new Map;for(let n of t.values()){let i=n.indexOf(e);i>=0&&n.splice(i,1)}}d();var Kn=require("vscode");var PI=new Map,gz=new Set,e1=new Kn.EventEmitter;W0(e1);function vz(r){return e1.event(r)}async function yz(r){if(!Kn.workspace.isTrusted)return{accessAllowed:!1};if(r===Xe)return{accessAllowed:!0};let e=PI.get(r);return e||(e=RIe(r),PI.set(r,e),e.then(({result:t})=>{(t==="learnMore"||t==="cancelled")&&PI.get(r)===e&&(PI.delete(r),gz.add(r))})),e.then(({result:t})=>({accessAllowed:t==="allowed"}))}async function RIe(r){var s,a;let e=await UV();if(e.get(r)===!0)return{result:"allowed"};if(e.get(r)===!1)return{result:"denied"};let t=(a=(s=Kn.extensions.getExtension(r))==null?void 0:s.packageJSON)==null?void 0:a.displayName;if(!t)return O(`Kernel API access revoked, as extension ${r} does not exist!`),{result:"denied"};let n=Kn.l10n.t("Allow"),i=Kn.l10n.t("Deny"),o=await Kn.window.showInformationMessage(Kn.l10n.t("Do you want to grant Kernel access to the extension {0} ({1})?",t,r),{modal:!0,detail:Kn.l10n.t("This allows the extension to execute code against Jupyter Kernels.")},n,Be.learnMore,i);switch(o===Be.learnMore?Kn.env.openExternal(Kn.Uri.parse("https://aka.ms/vscodeJupyterKernelApiAccess")).then(y,y):(o===n||o===i)&&await AIe(r,o===n),o){case n:return{result:"allowed"};case Be.learnMore:return{result:"learnMore"};case i:return{result:"denied"};default:return{result:"cancelled"}}}async function bz(){let r=new Set,[e]=await Promise.all([UV().then(t=>new Map(t)),...Array.from(PI.entries()).map(async([t,n])=>{(await n).result!=="allowed"&&r.add(t)})]);return r.forEach(t=>e.set(t,!1)),gz.forEach(t=>e.set(t,e.get(t)===!0)),e}var XR="API.Access",zf;async function UV(r=!1){let e=at.instance.get(ut);if(e.extensionMode===Kn.ExtensionMode.Test)return new Map;if(Sr(()=>{at.instance.get(oe).push(e.secrets.onDidChange(i=>{i.key===XR&&(zf=void 0)}))})(),zf&&!r)return zf;let t="";try{return t=await e.secrets.get(XR),!t||t.length===0?new Map:(zf=new Map(Object.entries(JSON.parse(t))),zf)}catch(n){return O(`Failed to parse API access information ${t}`,n),new Map}}var ZR=Promise.resolve();async function Iz(r){return ZR=ZR.then(async()=>{await Promise.all(Array.from(PI.entries()).map(async([t,n])=>{let i=await n;i.result=r.includes(t)===!0?"allowed":"denied"})),zf=new Map(r.map(t=>[t,!0]));let e=at.instance.get(ut);if(e.extensionMode!==Kn.ExtensionMode.Test)try{await e.secrets.store(XR,JSON.stringify(Object.fromEntries(zf))),e1.fire()}catch(t){O(`Failed to update API access information ${JSON.stringify(Object.fromEntries(zf))}`,t)}})}async function AIe(r,e){return ZR=ZR.then(async()=>{let t=at.instance.get(ut);if(t.extensionMode===Kn.ExtensionMode.Test)return;let n=await UV(!0);if(e!==n.get(r)){n.set(r,e);try{await t.secrets.store(XR,JSON.stringify(Object.fromEntries(n))),e1.fire()}catch(i){O(`Failed to store API access information ${JSON.stringify(Object.fromEntries(n))}`,i)}}})}var VV=class{constructor(e,t){var i,o;let n=((o=(i=Fn.extensions.getExtension(e))==null?void 0:i.packageJSON)==null?void 0:o.displayName)||e;this.notebook=Fn.workspace.notebookDocuments.find(s=>{var a;return s.uri.toString()===((a=t.resourceUri)==null?void 0:a.toString())}),this.controllerDisplayName=ft(t.kernelConnectionMetadata),this.title=Fn.l10n.t("Executing code in {0} from {1}",this.controllerDisplayName,n),this.eventHandler=Fn.window.onDidChangeVisibleNotebookEditors(this.showProgressImpl,this)}dispose(){var e;this.eventHandler.dispose(),(e=this.disposable)==null||e.dispose()}show(){if(this.deferred&&!this.deferred.completed){let e=this.deferred;return this.deferred=Me(),e.resolve(),this.disposable=new Fn.Disposable(()=>{var t;return(t=this.deferred)==null?void 0:t.resolve()})}return this.deferred=Me(),this.showProgress().catch(y),this.disposable=new Fn.Disposable(()=>{var e;return(e=this.deferred)==null?void 0:e.resolve()})}async showProgress(){await mc(500),!(!this.deferred||this.deferred.completed||this.displayInProgress)&&(this.shouldDisplayProgress=!0,await Promise.all([this.showProgressImpl(),this.waitUntilCompleted()]),this.shouldDisplayProgress=!1)}async showProgressImpl(){!this.notebook||!this.shouldDisplayProgress||Fn.window.visibleNotebookEditors.some(e=>e.notebook===this.notebook)&&(this.displayInProgress=!0,await Fn.window.withProgress({location:Fn.ProgressLocation.Notification,title:this.title},async()=>this.waitUntilCompleted()),this.displayInProgress=!1)}async waitUntilCompleted(){let e=this.deferred;for(;e&&!e.completed;)await e.promise,e=this.deferred}},jV=class r extends zr{constructor(t,n,i){super();this.extensionId=t;this.kernel=n;this.execution=i;this._onDidChangeStatus=this._register(new Fn.EventEmitter);this._onDidReceiveDisplayUpdate=this._register(new Fn.EventEmitter);this.progress=this._register(new VV(t,n)),this._register(zg(n.onDisposed)(()=>this.progress.dispose())),this.language=n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?Qe:n.kernelConnectionMetadata.kernelSpec.language||Qe,this._register(this.kernel.onStatusChanged(()=>this._onDidChangeStatus.fire(this.kernel.status))),this._register(i.onDidReceiveDisplayUpdate(s=>{var c,u;let a=this.kernel.session,l=Yg(s);(l==null?void 0:l.outputType)==="display_data"&&((c=l==null?void 0:l.transient)!=null&&c.display_id)&&a&&mz(this.extensionId,a,(u=l==null?void 0:l.transient)==null?void 0:u.display_id)&&this._onDidReceiveDisplayUpdate.fire(s)}));let o=this;this._api=Object.freeze({language:this.language,get status(){return o.kernel.status},onDidChangeStatus:o.onDidChangeStatus.bind(this),get onDidReceiveDisplayUpdate(){if(![Xe,tB].includes(t))throw new Error(`Proposed API is not supported for extension ${t}`);return o.onDidReceiveDisplayUpdate.bind(this)},executeCode:(s,a)=>this.executeCode(s,a),executeChatCode:(s,a,l)=>this.executeChatCode(s,a,l)})}get status(){return this.kernel.status}get onDidChangeStatus(){return this._onDidChangeStatus.event}get onDidReceiveDisplayUpdate(){return this._onDidReceiveDisplayUpdate.event}static createApiKernel(t,n,i){let o=new r(t,n,i);return at.instance.get(oe).push(o),o._api}async checkAccess(){if(this.extensionId===Xe)return;if(this.accessAllowed||(this.accessAllowed=this.doCheckAccess(),this._register(vz(()=>this.accessAllowed=void 0))),!await this.accessAllowed)throw new Error(Fn.l10n.t("Access to Jupyter Kernel has been revoked"))}async doCheckAccess(){let n=(await yz(this.extensionId)).accessAllowed;return J("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:this.extensionId,pemUsed:"getKernel",accessAllowed:n}),n}async*executeCode(t,n){await this.checkAccess();for await(let i of this.executeCodeInternal(t,void 0,n))yield i}async*executeChatCode(t,n,i){if(await this.checkAccess(),!["ms-vscode.dscopilot-agent",Xe].includes(this.extensionId.toLowerCase()))throw new Error(`Proposed API is not supported for extension ${this.extensionId}`);if(!Qt(this.kernel.kernelConnectionMetadata))throw new Error("Chat code execution is only supported for Python kernels");for await(let s of this.executeCodeInternal(t,n,i))yield s}async*executeCodeInternal(t,n={},i){var m,h;(m=this.previousProgress)==null||m.dispose();let o=!1,s={executionCount:this.execution.executionCount,requestSentAfter:0,requestAcknowledgedAfter:0,cancelledAfter:0,duration:0},a={kernelId:"",extensionId:this.extensionId,cancelled:!1,requestSent:!1,requestAcknowledged:!1,cancelledBeforeRequestSent:!1,cancelledBeforeRequestAcknowledged:!1,mimeTypes:"",failed:!1},l=new Mt,c=new Set;if(MIe(this.extensionId,this.kernel,"executeCode",s.executionCount).catch(y),this.kernel.disposed)throw a.failed=!0,WV(this.kernel,s,a).catch(y),new Error("Kernel is disposed");if(!((h=this.kernel.session)!=null&&h.kernel))throw a.failed=!0,WV(this.kernel,s,a).catch(y),this.kernel.status==="dead"||this.kernel.status==="terminating"?new Error("Kernel is dead or terminating"):new Error("Kernel connection not available to execute 3rd party code");let u=[];u.push({dispose:()=>{s.duration=l.elapsedTime,a.mimeTypes=Array.from(c).join(","),o=!0,WV(this.kernel,s,a).catch(y)}});let p=at.instance.get($e).getKernelExecution(this.kernel),f={started:new Fn.EventEmitter,executionAcknowledged:new Fn.EventEmitter};f.started.event(()=>{if(a.requestSent=!0,s.requestSentAfter=l.elapsedTime,!i.isCancellationRequested&&this.extensionId!==Xe){let g=this.previousProgress=this.progress.show();u.push(g)}},this,u),f.executionAcknowledged.event(()=>{a.requestAcknowledged=!0,s.requestAcknowledgedAfter=l.elapsedTime},this,u),i.onCancellationRequested(()=>{o||(a.cancelled=!0,s.cancelledAfter=l.elapsedTime,a.cancelledBeforeRequestSent=!a.requestSent,a.cancelledBeforeRequestAcknowledged=!a.requestAcknowledged,q(`Code execution cancelled by extension ${this.extensionId}`))},this,u);try{for await(let g of p.executeCode(t,this.extensionId,f,i))if(QR(this.extensionId,this.kernel.session,g),g.items.forEach(v=>c.add(v.mime)),n&&Sz(g))for await(let v of this.handleChatOutput(g,p,f,c,n,i))yield v;else yield g}finally{he(u)}}async*handleChatOutput(t,n,i,o,s={},a){let l=t.items.find(v=>v.mime===zR);if(!l)return;let c=(t.metadata||{}).metadata,u=c.function,p=c.id,f=c.dataIsNone?void 0:new TextDecoder().decode(l.data),m=s[u];if(!m)throw new Error(`Chat Function ${u} not found`);let h=await m(f),g=pz(p,h);for await(let v of n.executeCode(g,this.extensionId,i,a))if(v.items.forEach(I=>o.add(I.mime)),Sz(v))for await(let I of this.handleChatOutput(v,n,i,o,s,a))yield I;else yield v}};function Sz(r){return r.items.some(e=>e.mime===zR)}async function MIe(r,e,t,n){let i=await Ot(e.id);J("DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",{executionCount:n},{kernelId:i,pemUsed:t,extensionId:r})}async function WV(r,e,t){t.kernelId=await Ot(r.id),J("DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",e,t)}function t1(r,e){let t=at.instance.get($e);return jV.createApiKernel(r,e,t.getKernelExecution(e))}var _z=new WeakMap;function Cz(r){return{async getKernel(e){let t,n=at.instance.get($e),i=Ez.workspace.notebookDocuments.find(l=>l.uri.toString()===e.toString()),o=n.get(i||e);if(!o||!o.startedAtLeastOnce){J("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:r,pemUsed:"getKernel",accessAllowed:t});return}let s=n.getKernelExecution(o);if(!Ft(o.kernelConnectionMetadata)&&s.executionCount===0){J("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:r,pemUsed:"getKernel",accessAllowed:t});return}let a=_z.get(o)||t1(r,o);return _z.set(o,a),a}}}d();d();var r1=Symbol("JupyterServerHelper"),v$e=Symbol("INotebookImporter"),TI=Symbol("INotebookExporter"),wz=Symbol("IJupyterInterpreterDependencyManager"),y$e=Symbol("INbConvertInterpreterDependencyChecker"),b$e=Symbol("INbConvertExportToPythonService"),n1=Symbol("IJupyterServerProvider"),yr=Symbol("IJupyterServerUriStorage"),i1=Symbol("IJupyterKernelService"),o1=Symbol("IJupyterRequestAgentCreator"),Qg=Symbol("IJupyterRequestCreator"),I$e=Symbol("INotebookStarter"),Xg=Symbol("ILiveRemoteKernelConnectionUsageTracker"),s1=Symbol("IJupyterRemoteCachedKernelValidator"),mr=Symbol("IJupyterServerProviderRegistry"),a1=Symbol("IBackgroundThreadService");function l1(r,e,t,n,i){J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"createJupyterServerCollection"});let s=i.get(mr).createJupyterServerCollection(n,r,qv(e),t);return{dispose:()=>{s==null||s.dispose()},get id(){return r},set label(l){s.label=qv(l)},get label(){return s.label},set documentation(l){s.documentation=l},get documentation(){return s.documentation},set commandProvider(l){s.commandProvider=l},get commandProvider(){return s.commandProvider}}}d();var xz=!1;function Dz(r,e){if(xz)return;xz=!0,e.get(uy).setApi(r)}d();var em=require("vscode");d();var kI=z(re());d();var uu=z(re());d();var Qf=class extends ct{constructor(t,n){super("remotejupyterserveruriprovider",n.message||n.toString());this.serverProviderHandle=t;this.originalError=n}};d();var Hs=class extends ct{constructor(e){super("jupyterselfcert",e)}static isSelfCertsError(e){return e.message.indexOf("reason: self signed certificate")>=0}};d();var lu=class extends ct{constructor(e){super("jupyterselfexpiredcert",e)}static isSelfCertsExpiredError(e){return e.message.indexOf("reason: certificate has expired")>=0}};d();var Pn=Symbol("IDataScienceErrorHandler"),xi=class extends ct{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}},cu=class extends ri{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}};d();var mo=class extends ct{constructor(t,n,i){super("remotejupyterserverconnection",_.remoteJupyterConnectionFailedWithServerWithError(Pz(t),i.message||i.toString()));this.url=t;this.serverProviderHandle=n;this.originalError=i;this.baseUrl=Pz(t)}};function Pz(r){let e=new URL(r);return`${e.protocol}//${e.host}/`}var Gx=require("vscode");d();var Tz=require("vscode");var Xf=class r{constructor(e){this.serverSettings=e;this.kernelSpecManager=new this.jupyterlab.KernelSpecManager({serverSettings:this.serverSettings}),this.kernelManager=new this.jupyterlab.KernelManager({serverSettings:this.serverSettings}),this.sessionManager=new this.jupyterlab.SessionManager({serverSettings:this.serverSettings,kernelManager:this.kernelManager}),this.contentsManager=new this.jupyterlab.ContentsManager({serverSettings:this.serverSettings})}get isDisposed(){return this.disposed===!0}get jupyterlab(){return this._jupyterlab||(this._jupyterlab=ci()),this._jupyterlab}static create(e){return new r(e)}async dispose(){var e,t,n,i;if(!this.disposed){this.disposed=!0,q("Disposing Jupyter Lab Helper");try{this.contentsManager&&(q("SessionManager - dispose contents manager"),this.contentsManager.dispose()),this.sessionManager&&!this.sessionManager.isDisposed&&(q("ShutdownSessionAndConnection - dispose session manager"),await So(1e4,this.sessionManager.ready),this.sessionManager.dispose()),(e=this.kernelManager)!=null&&e.isDisposed||(t=this.kernelManager)==null||t.dispose(),(n=this.kernelSpecManager)!=null&&n.isDisposed||(i=this.kernelSpecManager)==null||i.dispose()}catch(o){O("Exception on Jupyter Lab Helper shutdown: ",o)}finally{q("Finished disposing Jupyter Lab Helper")}}}async getRunningSessions(){if(!this.sessionManager)return[];await So(1e4,this.sessionManager.ready).catch(y),await this.sessionManager.refreshRunning();let e=[],t=this.sessionManager.running(),n=t.next();for(;n;)e.push(n),n=t.next();return e}async getRunningKernels(){let e=await this.jupyterlab.KernelAPI.listRunning(this.serverSettings),t=new Set;return e.map(n=>{let i=n;return{id:n.id,name:n.name,lastActivityTime:i.last_activity?new Date(Date.parse(i.last_activity.toString())):new Date,numberOfConnections:i.connections?parseInt(i.connections.toString(),10):0}}).filter(n=>t.has(n.id)?!1:(t.add(n.id),!0))}async getKernelSpecs(){var e,t,n;if(!this.serverSettings||!this.sessionManager||!this.contentsManager)throw new sn;try{let i=new Mt,o=this.kernelSpecManager;if(!o)return O(`No SessionManager to enumerate kernelspecs (no specs manager). Returning a default kernel. Specs ${JSON.stringify(((t=(e=this.kernelSpecManager)==null?void 0:e.specs)==null?void 0:t.kernelspecs)||{})}.`),J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsManager"}),[await Hx()];let s={wasSessionManagerReady:this.sessionManager.isReady,wasSpecsManagerReady:o.isReady,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:o.isReady,waitedForChangeEvent:!1},a=(p={})=>o.specs&&Object.keys(o.specs.kernelspecs).length?o.specs.kernelspecs:p,l=a();await So(1e4,this.sessionManager.ready),s.sessionManagerReady=this.sessionManager.isReady,await So(1e4,o.refreshSpecs()),s.specsManagerReady=o.isReady;let c=!1;if(o&&Object.keys(((n=o.specs)==null?void 0:n.kernelspecs)||{}).length===0){let p=[],f=Me(),m=f.resolve.bind(f);o.specsChanged.connect(m),p.push(new Tz.Disposable(()=>o.specsChanged.disconnect(m)));let h=Promise.all([f.promise,o.ready,o.refreshSpecs(),this.sessionManager.ready]);await So(1e4,h),s.waitedForChangeEvent=!0,f.completed||(c=!0,J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:o.isReady,reason:o.isReady?this.sessionManager.isReady?"SpecsDidNotChangeInTime":"SessionManagerIsNotReady":"SpecManagerIsNotReady"})),he(p)}let u=a(l);if(Object.keys(u||{}).length){let p=[];return Object.entries(u).forEach(([f,m])=>{m&&p.push(new CI(m))}),J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",{duration:i.elapsedTime},s),p}else return O(`Jupyter Lab Helper cannot enumerate kernelspecs. Returning a default kernel. Specs ${JSON.stringify(u)}.`),c||J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsEventAfterRefresh"}),[await Hx()]}catch(i){return O("Jupyter Lab Helper:getKernelSpecs failure: ",i),[]}}};var bn=class{constructor(e,t,n,i,o){this.jupyterPickerRegistration=e;this.configService=t;this.errorHandler=n;this.requestAgentCreator=i;this.requestCreator=o}async createConnectionInfo(e){let t=await this.getJupyterServerUri(e);if(!t)throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`);let n={baseUrl:t.connectionInformation.baseUrl.toString(!0),displayName:t.label,token:t.connectionInformation.token||"",authorizationHeader:t.connectionInformation.headers||{},fetch:t.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:t.connectionInformation.WebSocket};return kV(e,n,this.requestCreator,this.requestAgentCreator,this.configService,Gx.Uri.file(""))}async validateRemoteUri(e,t,n){let i;if(!t){let s=await this.getJupyterServerUri(e);if(s)t={baseUrl:s.connectionInformation.baseUrl.toString(!0),displayName:s.label,token:s.connectionInformation.token||"",authorizationHeader:s.connectionInformation.headers||{},fetch:s.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:s.connectionInformation.WebSocket};else throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`)}let o=kV(e,t,this.requestCreator,this.requestAgentCreator,this.configService,Gx.Uri.file(""));try{i=Xf.create(o.settings),await Promise.all([i.getRunningKernels(),i.getKernelSpecs()])}catch(s){if(Hs.isSelfCertsError(s)){if(!await UR(this.configService,s.message))throw s}else if(lu.isSelfCertsExpiredError(s)){if(!await WR(this.configService,s.message))throw s}else throw t&&!n&&await this.errorHandler.handleError(new mo(t.baseUrl,e,s)),s}finally{o.dispose(),i&&i.dispose().catch(y)}}async getJupyterServerUri(e){let t=new Gx.CancellationTokenSource;try{let n=this.jupyterPickerRegistration.jupyterCollections.find(l=>l.extensionId===e.extensionId&&l.id===e.id)||await this.jupyterPickerRegistration.activateThirdPartyExtensionAndFindCollection(e.extensionId,e.id);if(!n)return;let i=await Promise.resolve(n.serverProvider.provideJupyterServers(t.token)),o=i==null?void 0:i.find(l=>l.id===e.handle);if(!o&&(i==null?void 0:i.length)===0)try{o=await n.serverProvider.resolveJupyterServer({id:e.handle,label:""},t.token)}catch(l){}if(!o)return;if(o.connectionInformation)return o;let s=await Promise.resolve(n.serverProvider.resolveJupyterServer(o,t.token));if(!(s!=null&&s.connectionInformation))return;let a=Object.assign({},o);return a.connectionInformation=s.connectionInformation,a}catch(n){throw n instanceof ct?n:new Qf(e,n)}finally{t.dispose()}}};bn=E([(0,uu.injectable)(),b(0,(0,uu.inject)(mr)),b(1,(0,uu.inject)(Ke)),b(2,(0,uu.inject)(Pn)),b(3,(0,uu.inject)(o1)),b(3,(0,uu.optional)()),b(4,(0,uu.inject)(Qg))],bn);var tc=class{constructor(e,t,n){this.serverUriStorage=e;this.jupyterConnection=t;this.serverProviderRegistry=n}async addJupyterServer(e){if(e.extensionId.toLowerCase()!=fc.toLowerCase())throw new Error("Deprecated API");try{await this.jupyterConnection.validateRemoteUri(e)}catch(t){O(`Error in validating the Remote Uri ${e.id}.${e.handle}`,t);return}this.serverProviderRegistry.jupyterCollections.some(t=>t.extensionId===e.extensionId)||await this.serverUriStorage.add(e)}};tc=E([(0,kI.injectable)(),b(0,(0,kI.inject)(yr)),b(1,(0,kI.inject)(bn)),b(2,(0,kI.inject)(mr))],tc);d();var kz=" (Interactive)",Ht=Symbol("IControllerRegistration");var c1=Symbol("IRemoteNotebookKernelSourceSelector"),Nz=Symbol("ILocalNotebookKernelSourceSelector"),u1=Symbol("ILocalPythonNotebookKernelSourceSelector"),NI=Symbol("IConnectionDisplayData");d();var Az=z(re()),pu=require("vscode");d();var Zf=require("vscode");function Di(r,e=!1){return typeof r!="object"||!r?!1:!!(r instanceof Zf.CancellationError||e&&(r.message.includes("Canceled")||r.message.includes(Be.canceled)))}async function Js(r,e,...t){let n;return uP(e)?(t.push(e),n=void 0):n=e,r?r.isCancellationRequested?n:new Promise((i,o)=>{if(r.isCancellationRequested)return i(n);let s=r.onCancellationRequested(()=>{s.dispose(),i(n)});Promise.race(t).then(i,o).finally(()=>s.dispose())}):await Promise.race(t)}async function ys(r,...e){if(!r)return Promise.race(e);if(r.isCancellationRequested)throw new Zf.CancellationError;return new Promise((t,n)=>{if(r.isCancellationRequested)return n(new Zf.CancellationError);let i=r.onCancellationRequested(()=>{i.dispose(),n(new Zf.CancellationError)});Promise.race(e).then(t,n).finally(()=>i.dispose())})}function Rz(...r){let e=new Zf.CancellationTokenSource,t=[];for(let i of r)i&&(i.isCancellationRequested&&e.cancel(),i.onCancellationRequested(()=>e.cancel(),void 0,t));let n=e.dispose.bind(e);return e.dispose=()=>{n(),he(t)},e}var du;(e=>{function r(t){if(t!=null&&t.isCancellationRequested)throw new Zf.CancellationError}e.throwIfCanceled=r})(du||(du={}));function Mz(r){let e=new Map,t=(a,l)=>{if(!e.has(a)){let c={id:a,label:l.displayName,connectionInformation:{baseUrl:pu.Uri.parse(l.baseUrl),token:l.token,fetch:l.fetch,headers:l.authorizationHeader,WebSocket:l.WebSocket}};e.set(a,{serverUri:l,server:c})}return e.get(a).server},n=new pu.EventEmitter,i={async provideJupyterServers(a){let l=r.getHandles?await ys(a,r.getHandles()):[];return!l||l.length===0?[]:ys(a,Promise.all(l.map(c=>r.getServerUri(c).then(u=>t(c,u)))))},resolveJupyterServer(a,l){return a},onDidChangeServers:n.event};if(!r.handleQuickPick||!r.getQuickPickEntryItems)return{serverProvider:i};let o=new Map;return{serverProvider:i,commandProvider:{async handleCommand(a,l){let c=o.get(a.label);if(!c||!r.handleQuickPick)return;let u=await ys(l,r.handleQuickPick(c,!0));if(u==="back")return;if(!u)throw new pu.CancellationError;let p=await r.getServerUri(u);return t(u,p)},async provideCommands(a,l){return r.getQuickPickEntryItems?(await ys(l,Promise.resolve(r.getQuickPickEntryItems()))).map(u=>{let p={label:qv(u.label),canBeAutoSelected:u.default,description:qv(u.description)};return o.set(p.label,u),p}):[]}}}}var BV=class extends aI{constructor(t,n,i,o){super();this.extensionId=t;this.id=n;this.label=i;this.serverProvider=o;this._onDidChangeProvider=new pu.EventEmitter;this.onDidChangeProvider=this._onDidChangeProvider.event}set commandProvider(t){this._commandProvider=t,this._onDidChangeProvider.fire()}get commandProvider(){return this._commandProvider}},RI=class extends zr{constructor(){super();this._onDidChangeCollections=new pu.EventEmitter;this._collections=new Map;at.instance.get(oe).push(this)}get onDidChangeCollections(){return this._onDidChangeCollections.event}get jupyterCollections(){return Array.from(this._collections.values())}async activateThirdPartyExtensionAndFindCollection(t,n){return await this.loadExtension(t,n).catch(y),this.jupyterCollections.find(i=>i.extensionId===t&&i.id===n)}async loadExtension(t,n){if(t===Xe)return;let i=pu.extensions.getExtension(t);if(!i)throw new Error(`Extension '${t}' that provides Jupyter Server '${n}' not found`);i.isActive||await i.activate().then(y,y)}createJupyterServerCollection(t,n,i,o){let s=`${t}#${n}`;if(this._collections.has(s)&&t!==Xe)throw new Error(`Jupyter Server Provider with id ${s} already exists`);let a=new BV(t,n,i,o);return this._collections.set(s,a),this._onDidChangeCollections.fire({added:[a],removed:[]}),this._register(a.onDidDispose(()=>{this._collections.delete(s),this._onDidChangeCollections.fire({removed:[a],added:[]})},this)),a}};RI=E([(0,Az.injectable)()],RI);d();var d1=Symbol("IExportedKernelServiceFactory");function OIe(r,e){return new Promise(t=>{e.onDidChange(n=>{for(let i of n.added)Ft(i.connection)&&i.connection.serverProviderHandle.id===r.id&&i.connection.serverProviderHandle.handle===r.handle&&t()})})}function Oz(r,e){let t=e.get(tl),n=r.id.startsWith("_builtin")?Xe:t.determineExtensionFromCallStack().extensionId;if(O(`The API registerRemoteServerProvider has being deprecated and will be removed soon, please use createJupyterServerCollection (extension ${n}).`),n.toLowerCase()!=fc.toLowerCase())throw new Error("Deprecated API");J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"registerRemoteServerProvider"});let{serverProvider:i,commandProvider:o}=Mz(r),s=l1(r.id,r.displayName||r.detail||r.id,i,n,e);return o&&(s.commandProvider=o),{dispose:()=>{s.dispose()}}}function Lz(r){return r.then(()=>void 0).catch(e=>(O("Failure during activation.",e),Promise.reject(e)))}function Kz(r){let e=r.get(tl);return J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:e.determineExtensionFromCallStack().extensionId,pemUsed:"registerRemoteServerProvider"}),r.get(d1).getService()}async function Fz(r,e,t){let n=t.get(tl);O("The API addRemoteJupyterServer has being deprecated and will be removed soon, please use createJupyterServerCollection.");let i=n.determineExtensionFromCallStack().extensionId;if(i.toLowerCase()!=fc.toLowerCase())throw new Error("Deprecated API");J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:i,pemUsed:"addRemoteJupyterServer"});let o=t.get(tc),s=t.get(Ht),a=OIe({id:r,handle:e},s);await o.addJupyterServer({id:r,handle:e,extensionId:i}),await a}async function Uz(r,e,t){var c,u,p,f,m,h;let n=t.get(tl);J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n.determineExtensionFromCallStack().extensionId,pemUsed:"openNotebook"});let i=t.get(Ht),o=typeof e=="string"?e:void 0,s=typeof e=="string"?void 0:e,a=o&&((c=i.all.find(g=>g.id===e))==null?void 0:c.id);if(!a&&s&&!_p()&&(a=(u=i.all.find(g=>g.kind==="startUsingPythonInterpreter"&&g.interpreter.id===s.id))==null?void 0:u.id,!a)){let v=await t.get(u1).getKernelConnection(s);a=v&&((p=i.all.find(I=>I.id===(v==null?void 0:v.id)))==null?void 0:p.id)}if(!a)throw new Error(`Kernel ${e} not found.`);let l=((h=(m=(f=em.window.activeNotebookEditor)==null?void 0:f.notebook)==null?void 0:m.uri)==null?void 0:h.toString())===r.toString()?em.window.activeNotebookEditor:await em.window.showNotebookDocument(await em.workspace.openNotebookDocument(r));return await em.commands.executeCommand("notebook.selectKernel",{notebookEditor:l,id:a,extension:Xe}),l.notebook}function Wz(r,e,t,n){let i=t.get(tl),o={ready:Lz(r),registerPythonApi:s=>Dz(s,t),registerRemoteServerProvider:s=>Oz(s,t),getKernelService:()=>Kz(t),addRemoteJupyterServer:(s,a)=>Fz(s,a,t),openNotebook:async(s,a)=>Uz(s,a,t),createJupyterServerCollection:(s,a,l)=>l1(s,a,l,i.determineExtensionFromCallStack().extensionId,t),get kernels(){return Cz(i.determineExtensionFromCallStack().extensionId)}};return(Sn()||n.extensionMode===HV.ExtensionMode.Development||n.extensionMode===HV.ExtensionMode.Test)&&(o.serviceContainer=t,o.serviceManager=e),o}d();var Vz=require("vscode"),jz={codeLoadingTime:0,endActivateTime:0,startActivateTime:0,totalActivateTime:0,workspaceFolderCount:0};function Bz(r,e){if(!Sn())try{r.endActivateTime=e.elapsedTime,r.totalActivateTime=e.elapsedTime,Object.assign(jz,r),Jz(r),J("EXTENSION.LOAD",r)}catch(t){O("sendStartupTelemetry() failed.",t)}}function Hz(r,e,t){try{let n={};e.endActivateTime=t.elapsedTime,e.totalActivateTime=t.elapsedTime,Object.assign(jz,e),Jz(e),J("EXTENSION.LOAD",e,n,r)}catch(n){O("sendErrorTelemetry() failed.",n)}}function Jz(r){var t,n;let e=(n=(t=Vz.workspace.workspaceFolders)==null?void 0:t.length)!=null?n:0;r.workspaceFolderCount=e}d();d();var p1=Symbol("IWorkspaceService"),ho=Symbol("IDebugManager"),AI=Symbol("IApplicationEnvironment"),TQe=Symbol("IWebviewPanelMessageListener"),kQe=Symbol("IWebviewViewMessageListener"),NQe=Symbol("IWebview"),RQe=Symbol("IWebviewView"),AQe=Symbol("IWebviewPanel"),MI=Symbol("IWebviewPanelProvider"),f1=Symbol("IWebviewViewProvider"),Yx=Symbol("IEncryptedStorage");d();var qz=z(re());d();var Pi=require("vscode");d();var Gd=require("vscode");var Zg=class Zg{constructor(e){this.jupyterConfig=e}async migrateSettings(){let e=[];for(let t of Object.keys(Zg.migratedSettings))e.push(...this.migrateSetting(t,Zg.migratedSettings[t]));e.push(this.migrateIntellisenseSettings());try{await Promise.all(e)}catch(t){OI(t)}}async migrateIntellisenseSettings(){let e="pythonCompletionTriggerCharacters",t="completionTriggerCharacters",n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t);try{if((n==null?void 0:n.globalValue)===(n==null?void 0:n.defaultValue)||!i||i!=null&&i.globalValue&&i.globalValue[Qe])return;if(typeof(n==null?void 0:n.globalValue)=="string"){let o=i.globalValue||i.defaultValue||{};o[Qe]=n.globalValue.split(""),await this.jupyterConfig.update(t,o,Gd.ConfigurationTarget.Global).then(y,OI)}}finally{n!=null&&n.globalValue&&await this.jupyterConfig.update(e,void 0,Gd.ConfigurationTarget.Global).then(y,OI)}}migrateSetting(e,t){let n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t),o=[];if((n==null?void 0:n.workspaceValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceValue,Gd.ConfigurationTarget.Workspace)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Gd.ConfigurationTarget.Workspace),OI))}if((n==null?void 0:n.workspaceFolderValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceFolderValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceFolderValue,Gd.ConfigurationTarget.WorkspaceFolder)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Gd.ConfigurationTarget.WorkspaceFolder),OI))}if((n==null?void 0:n.globalValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.globalValue)===void 0&&(s=this.jupyterConfig.update(t,n.globalValue,Gd.ConfigurationTarget.Global)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Gd.ConfigurationTarget.Global),OI))}return o}};Zg.migratedSettings={interactiveWindowMode:"interactiveWindow.creationMode",interactiveWindowViewColumn:"interactiveWindow.viewColumn",splitRunFileIntoCells:"interactiveWindow.splitRunFileIntoCells",sendSelectionToInteractiveWindow:"interactiveWindow.textEditor.executeSelection",normalizeSelectionForInteractiveWindow:"interactiveWindow.textEditor.normalizeSelection",magicCommandsAsComments:"interactiveWindow.textEditor.magicCommandsAsComments",enableAutoMoveToNextCell:"interactiveWindow.textEditor.autoMoveToNextCell",newCellOnRunLast:"interactiveWindow.textEditor.autoAddNewCell",pythonCellFolding:"interactiveWindow.textEditor.cellFolding",enableCellCodeLens:"interactiveWindow.codeLens.enable",addGotoCodeLenses:"interactiveWindow.codeLens.enableGotoCell",codeLenses:"interactiveWindow.codeLens.commands",debugCodeLenses:"interactiveWindow.codeLes.debugCommands",codeRegularExpression:"interactiveWindow.cellMarker.codeRegex",markdownRegularExpression:"interactiveWindow.cellMarker.markdownRegex",decorateCells:"interactiveWindow.cellMarker.decorateCells",defaultCellMarker:"interactiveWindow.cellMarker.default",enableExtendedKernelCompletions:"enableExtendedPythonKernelCompletions"},Zg.fullSettingIds={...Zg.migratedSettings};var $x=Zg;function OI(r){ue("Error migrating Jupyter configuration",r)}d();function LIe(r){return(e,t,n)=>{let i=null,o=null;if(typeof n.value=="function"?(i="value",o=n.value):typeof n.get=="function"&&(i="get",o=n.get),!o)throw new Error("not supported");n[i]=r(o,t)}}function m1(r,e,t){return LIe((n,i)=>{let o=`$debounce$${i}`,s=`$debounce$result$${i}`;return function(...a){this[s]||(this[s]=t?t():void 0),clearTimeout(this[o]),e&&(this[s]=e(this[s],...a),a=[this[s]]),this[o]=setTimeout(()=>{n.apply(this,a),this[s]=t?t():void 0},r)}})}var Ka=class Ka{constructor(e,t,n){this._systemVariablesCtor=t;this._type=n;this.logging={level:"error"};this.allowUnauthorizedRemoteConnection=!1;this.jupyterInterruptTimeout=1e4;this.jupyterLaunchTimeout=6e4;this.jupyterLaunchRetries=3;this.notebookFileRoot="";this.useDefaultConfigForJupyter=!1;this.sendSelectionToInteractiveWindow=!1;this.normalizeSelectionForInteractiveWindow=!0;this.splitRunFileIntoCells=!0;this.markdownRegularExpression="";this.codeRegularExpression="";this.errorBackgroundColor="";this.variableExplorerExclude="";this.decorateCells="currentCell";this.enableCellCodeLens=!1;this.askForLargeDataFrames=!1;this.enableAutoMoveToNextCell=!1;this.askForKernelRestart=!1;this.codeLenses="";this.debugCodeLenses="";this.debugpyDistPath="";this.stopOnFirstLineWhileDebugging=!1;this.magicCommandsAsComments=!1;this.pythonExportMethod="direct";this.stopOnError=!1;this.addGotoCodeLenses=!1;this.runStartupCommands=[];this.debugJustMyCode=!1;this.defaultCellMarker="";this.themeMatplotlibPlots=!1;this.disableJupyterAutoStart=!1;this.enablePythonKernelLogging=!1;this.jupyterCommandLineArguments=[];this.widgetScriptSources=[];this.interactiveWindowMode="multiple";this.pythonCellFolding=!0;this.interactiveWindowViewColumn="secondGroup";this.disableZMQSupport=!1;this.forceIPyKernelDebugger=!1;this.verboseLogging=!1;this.showVariableViewWhenDebugging=!0;this.newCellOnRunLast=!0;this.logKernelOutputSeparately=!1;this.development=!1;this.poetryPath="";this.excludeUserSitePackages=!1;this.enableExtendedPythonKernelCompletions=!1;this.formatStackTraces=!1;this._changeEmitter=new Pi.EventEmitter;this._disposables=[];this._workspaceRoot=e,this.initialize(),Pi.workspace.isTrusted===!1&&(this.disableJupyterAutoStart=!0)}get onDidChange(){return this._changeEmitter.event}static getInstance(e,t,n){let i=Ka.getSettingsUriAndTarget(e).uri,o=i?i.path:"",s=Ka.jupyterSettings.get(o);return s?s._type==="web"&&n==="node"&&(s._systemVariablesCtor=t,s._type=n):(s=new Ka(i,t,n),Ka.jupyterSettings.set(o,s)),s}static getSettingsUriAndTarget(e){let t=e?Pi.workspace.getWorkspaceFolder(e):void 0,n=t?t.uri:void 0;!n&&Array.isArray(Pi.workspace.workspaceFolders)&&Pi.workspace.workspaceFolders.length>0&&(n=Pi.workspace.workspaceFolders[0].uri);let i=n?Pi.ConfigurationTarget.WorkspaceFolder:Pi.ConfigurationTarget.Global;return{uri:n,target:i}}static dispose(){if(!Sn())throw new Error("Dispose can only be called from unit tests");Ka.jupyterSettings.forEach(e=>e&&e.dispose()),Ka.jupyterSettings.clear()}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}createSystemVariables(e){return new this._systemVariablesCtor(e,this._workspaceRoot)}toJSON(){let e={};return this.getSerializableKeys().forEach(n=>e[n]=this[n]),e}update(e,t){let n=this.createSystemVariables(void 0),i=n.resolveAny(e.get("logging"));i&&(i.level=KIe(i.level),this.logging?Object.assign(this.logging,i):this.logging=i);let o=n.resolveAny(e.get("experiments"));this.experiments?Object.assign(this.experiments,o):this.experiments=o,this.experiments=this.experiments?this.experiments:{enabled:!0,optInto:[],optOutFrom:[]};let s=(l,c)=>{let u=$x.fullSettingIds[l],p=u&&c.get(u)!==void 0?c.get(u):c.get(l),f=n.resolveAny(p);f!==void 0&&(this[l]=f)};this.getSerializableKeys().filter(l=>l!=="experiments"&&l!=="logging"&&l!=="kernelPickerType").forEach(l=>s(l,e)),t&&s("poetryPath",t)}onWorkspaceFoldersChanged(){let e=(Pi.workspace.workspaceFolders||[]).map(i=>i.uri.path),n=Array.from(Ka.jupyterSettings.keys()).filter(i=>e.indexOf(i)<0);if(n.length>0)for(let i of n)Ka.jupyterSettings.delete(i)}initialize(){let e=()=>{let i=Pi.workspace.getConfiguration("jupyter",this._workspaceRoot),o=Pi.workspace.getConfiguration("python",this._workspaceRoot);this.update(i,o),this.debounceChangeNotification()};this._disposables.push(Pi.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this)),this._disposables.push(Pi.workspace.onDidChangeConfiguration(i=>{i.affectsConfiguration("jupyter")&&e(),i.affectsConfiguration("python.poetryPath")&&e()}));let t=Pi.workspace.getConfiguration("jupyter",this._workspaceRoot),n=Pi.workspace.getConfiguration("python",this._workspaceRoot);t&&(this.update(t,n),this.migrateSettings(t).catch(y))}async migrateSettings(e){await new $x(e).migrateSettings()}debounceChangeNotification(){this._changeEmitter.fire()}fireChangeNotification(){this._changeEmitter.fire()}getSerializableKeys(){return Object.getOwnPropertyNames(this).filter(e=>!e.startsWith("_"))}};Ka.jupyterSettings=new Map,E([m1(1)],Ka.prototype,"debounceChangeNotification",1);var LI=Ka;function KIe(r){switch(r){case"info":return 20;case"warn":return 30;case"off":return"off";case"debug":return 10;case"verbose":return 5;default:return 40}}d();var fu=require("vscode");d();d();var JV={number:"number",string:"string",undefined:"undefined",object:"object",function:"function"};function qV(r){return Array.isArray?Array.isArray(r):!!(r&&typeof r.length===JV.number&&r.constructor===Array)}function h1(r){return typeof r===JV.string||r instanceof String}function GV(r){return typeof r===JV.object&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}var g1=class{resolve(e){return h1(e)?this.__resolveString(e):qV(e)?this.__resolveArray(e):GV(e)?this.__resolveLiteral(e):e}resolveAny(e){return h1(e)?this.__resolveString(e):qV(e)?this.__resolveAnyArray(e):GV(e)?this.__resolveAnyLiteral(e):e}__resolveString(e){let t=/\$\{(.*?)\}/g;return e.replace(t,(n,i)=>{let o=this[i];return h1(o)?o:n&&(n.indexOf("env.")>0||n.indexOf("env:")>0)?"":n})}__resolveLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolve(i)}),t}__resolveAnyLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolveAny(i)}),t}__resolveArray(e){return e.map(t=>this.__resolveString(t))}__resolveAnyArray(e){return e.map(t=>this.resolveAny(t))}};var v1=class extends g1{constructor(t,n){super();let i=t?fu.workspace.getWorkspaceFolder(t):void 0;this._workspaceFolder=i?i.uri.path:n||"",this._filePath=t?t.path:void 0,fu.window.activeTextEditor&&(this._lineNumber=fu.window.activeTextEditor.selection.anchor.line+1,this._selectedText=fu.window.activeTextEditor.document.getText(new fu.Range(fu.window.activeTextEditor.selection.start,fu.window.activeTextEditor.selection.end)))}get cwd(){return this.workspaceFolder}get workspaceRoot(){return this._workspaceFolder}get workspaceFolder(){return this._workspaceFolder}get file(){return this._filePath}get lineNumber(){return this._lineNumber}get selectedText(){return this._selectedText}};d();var mu=require("vscode");var y1=class{async updateSectionSetting(e,t,n,i,o){let a={uri:i,target:o||mu.ConfigurationTarget.WorkspaceFolder};e==="jupyter"&&o!==mu.ConfigurationTarget.Global&&(a=LI.getSettingsUriAndTarget(i));let l=mu.workspace.getConfiguration(e,a.uri),c=l.inspect(t);c!==void 0&&(o===mu.ConfigurationTarget.Global&&c.globalValue===n||o===mu.ConfigurationTarget.Workspace&&c.workspaceValue===n||o===mu.ConfigurationTarget.WorkspaceFolder&&c.workspaceFolderValue===n)||(await l.update(t,n,o),o&&await this.verifySetting(l,o,t,n))}async updateSetting(e,t,n,i){return this.updateSectionSetting("jupyter",e,t,n,i)}async verifySetting(e,t,n,i){if(Sn()&&!FE()){let o=0;do{let s=e.inspect(n);if(!s&&i===void 0||s&&i!==void 0&&(t===mu.ConfigurationTarget.Global?s.globalValue:t===mu.ConfigurationTarget.Workspace?s.workspaceValue:s.workspaceFolderValue)===i)break;await new Promise(a=>setTimeout(a,250)),o+=1}while(o<20)}}};var KI=class extends y1{getSettings(e){return LI.getInstance(e,v1,"web")}};KI=E([(0,qz.injectable)()],KI);d();function Gz(r){r.addSingleton(uy,pI),r.addSingleton(wo,Ff)}d();d();var om=z(re()),GQ=require("vscode"),eD=z(JQ());d();var F1=class{setSharedProperty(e,t){zb(e,t)}postEvent(e,t){let n={};t.forEach((i,o)=>{n[o]=i}),J(e,void 0,n)}};d();var wj=z(require("vscode")),U1=z(re());var BI=class{constructor(e){this.extensionContext=e}get extensionVersion(){return this.extensionContext.extension.packageJSON.version}};BI=E([(0,U1.injectable)(),b(0,(0,U1.inject)(ut))],BI);function $d(){return wj.env.appName.indexOf("Insider")>0||wj.env.appName.indexOf("Code - OSS Dev")>=0?"insiders":"stable"}var __e="VSCode.ABExp.FeatureData",xj="vscode",HI=class{constructor(e,t,n){this.configurationService=e;this.appEnvironment=t;this.globalState=n;this._optInto=[];this._optOutFrom=[];this.settings=e.getSettings(void 0);let i=this.settings.experiments.optInto,o=this.settings.experiments.optOutFrom;if(this._optInto=i.filter(l=>!l.endsWith("control")),this._optOutFrom=o.filter(l=>!l.endsWith("control")),!this.enabled)return;let s;$d()==="insiders"?s=eD.TargetPopulation.Insiders:s=eD.TargetPopulation.Public;let a=new F1;this.experimentationService=(0,eD.getExperimentationService)(Xe,this.appEnvironment.extensionVersion,s,a,this.globalState)}get enabled(){return this.settings.experiments.enabled&&!this.settings.experiments.optOutFrom.includes("All")}async activate(){this.experimentationService&&this.enabled&&(q(`Experimentation service retrieved: ${this.experimentationService}`),await this.experimentationService.initializePromise,this.getFeatures().length===0&&await this.experimentationService.initialFetch,this.logExperiments())}inExperiment(e){return!this.experimentationService||!this.enabled||this._optOutFrom.includes(e.toString())?!1:this._optInto.includes(e.toString())||this._optInto.includes("All")?(this.experimentationService.getTreatmentVariable(xj,e),!0):e==="DoNotWaitForZmqPortsToBeUsed"&&($d()==="insiders"||Uv())||e==="DataViewerContribution"&&($d()==="insiders"||Uv())?!0:this.experimentationService.getTreatmentVariable(xj,e)===!0}async getExperimentValue(e){if(!(!this.experimentationService||!this.enabled||this._optOutFrom.includes(e)))return this.experimentationService.getTreatmentVariable(xj,e)}getFeatures(){return this.globalState.get(__e,{features:[]}).features}logExperiments(){let e=GQ.workspace.getConfiguration("telemetry"),t=!1;if(e&&e.get("enableTelemetry")===!1&&(De("Telemetry is disabled"),t=!0),e&&e.get("telemetryLevel")==="off"&&(De("Telemetry level is off"),t=!0),t&&De("Experiments are disabled, only manually opted experiments are active."),this._optOutFrom.includes("All"))return;if(this._optInto.includes("All")){De(Lp.inGroup("All"));return}let n=new Set(this._optInto),i=new Set;this._optOutFrom.filter(o=>o!=="All").forEach(o=>{De(Lp.notInGroup(o))}),this._optInto.filter(o=>o!=="All").forEach(o=>{i.add(o),De(Lp.inGroup(o))}),t&&!i.has("DoNotWaitForZmqPortsToBeUsed")&&($d()==="insiders"||Uv())&&De(Lp.inGroup("DoNotWaitForZmqPortsToBeUsed")),t||this.getFeatures().forEach(o=>{o.toLowerCase().startsWith("jupyter")&&!this._optOutFrom.includes(o)&&!this._optInto.includes(o)&&(n.add(o),De(Lp.inGroup(o)))})}};HI=E([(0,om.injectable)(),b(0,(0,om.inject)(Ke)),b(1,(0,om.inject)(AI)),b(2,(0,om.inject)(wt)),b(2,(0,om.named)(ur))],HI);d();var V1=z(re()),qs=require("vscode");d();var W1=require("vscode");function JI(r){W1.env.openExternal(typeof r=="string"?W1.Uri.parse(r):r).then(y,y)}var E_e=[{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE",message:hy.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/309",setting:{setting:"formatting.formatOnSave",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE",message:hy.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/313",setting:{setting:"linting.lintOnTextChange",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES",message:hy.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/1704",setting:{setting:"autoComplete.preloadModules"}}],qI=class{constructor(e){this.persistentStateFactory=e;this._onDidChangeFeatures=new qs.EventEmitter;this.onDidChangeFeatures=this._onDidChangeFeatures.event;this._features={};this.disposables=[];this._updateFeatures(),this.disposables.push(qs.workspace.onDidChangeConfiguration(()=>{this._updateFeatures()}))}get features(){return this._features}set features(e){this._features=e,this._onDidChangeFeatures.fire()}_updateFeatures(){this.features={}}dispose(){this.disposables.forEach(e=>e.dispose())}initialize(){E_e.forEach(this.registerDeprecation.bind(this))}registerDeprecation(e){Array.isArray(e.commands)&&e.commands.forEach(t=>{this.disposables.push(qs.commands.registerCommand(t,()=>this.notifyDeprecation(e),this))}),e.setting&&this.checkAndNotifyDeprecatedSetting(e)}async notifyDeprecation(e){let t=this.persistentStateFactory.createGlobalPersistentState(e.doNotDisplayPromptStateKey,!0);if(!t.value)return;let n="Learn more",i="Never show again",o=await qs.window.showInformationMessage(e.message,n,i);if(o)switch(o){case n:{JI(e.moreInfoUrl);break}case i:{await t.updateValue(!1);break}default:throw new Error("Selected option not supported.")}}checkAndNotifyDeprecatedSetting(e){let t=!1;Array.isArray(qs.workspace.workspaceFolders)&&qs.workspace.workspaceFolders.length>0?qs.workspace.workspaceFolders.forEach(n=>{t||(t=this.isDeprecatedSettingAndValueUsed(qs.workspace.getConfiguration("jupyter",n.uri),e.setting))}):t=this.isDeprecatedSettingAndValueUsed(qs.workspace.getConfiguration("jupyter"),e.setting),t&&this.notifyDeprecation(e).catch(n=>q("Jupyter Extension: notifyDeprecation",n))}isDeprecatedSettingAndValueUsed(e,t){if(!e.has(t.setting))return!1;let n=e.get(t.setting);return!Array.isArray(t.values)||t.values.length===0?Array.isArray(n)?n.length>0:!0:!Array.isArray(t.values)||t.values.length===0?n===void 0?!1:Array.isArray(n)?n.length>0:!0:t.values.indexOf(e.get(t.setting))>=0}};qI=E([(0,V1.injectable)(),b(0,(0,V1.inject)(DP))],qI);d();var sm=z(re());var j1=class{constructor(e,t,n,i){this.storage=e;this.key=t;this.defaultValue=n;this.expiryDurationMs=i}get value(){if(this.expiryDurationMs){let e=this.storage.get(this.key,{data:this.defaultValue});return!e||!e.expiry||e.expiry<Date.now()?this.defaultValue:e.data}else return this.storage.get(this.key,this.defaultValue)}async updateValue(e){this.expiryDurationMs?await this.storage.update(this.key,{data:e,expiry:Date.now()+this.expiryDurationMs}):await this.storage.update(this.key,e)}},GI=class{constructor(e,t){this.globalState=e;this.workspaceState=t}createGlobalPersistentState(e,t,n){return new j1(this.globalState,e,t,n)}createWorkspacePersistentState(e,t,n){return new j1(this.workspaceState,e,t,n)}};GI=E([(0,sm.injectable)(),b(0,(0,sm.inject)(wt)),b(0,(0,sm.named)(ur)),b(1,(0,sm.inject)(wt)),b(1,(0,sm.named)(Ts))],GI);d();d();var YQ=z(re());var YI=class{constructor(){this.osType="Unknown"}get tempDir(){}get homeDir(){}get pathVariableName(){return""}get isWindows(){return this.osType==="Windows"}get isMac(){return this.osType==="OSX"}get isLinux(){return this.osType==="Linux"}};YI=E([(0,YQ.injectable)()],YI);d();var bs=Symbol("IPlatformService"),Tt=Symbol("IFileSystem");function $Q(r){r.addSingleton(bs,YI)}d();var zQ=z(re()),Dj=require("vscode");var $I=class{determineExtensionFromCallStack(e){if(e=e||new Error().stack,e){let t=Dj.extensions.getExtension(Xe).extensionUri.toString().toLowerCase(),n=e.split(`
`).map(i=>{let o=/\((.*)\)/.exec(i);if(o)return o[1]}).filter(i=>i&&i.toLowerCase().startsWith("http")).filter(i=>i&&!i.toLowerCase().startsWith(t));QL(new Error("Ex")).forEach(i=>{let o=i.getFileName();o&&!o.toLowerCase().startsWith(t)&&n.push(o)});for(let i of n){let o=Dj.extensions.all.find(s=>s.id!==Xe&&i.startsWith(s.extensionUri.toString()));if(o)return{extensionId:o.id,displayName:o.packageJSON.displayName}}O("Unable to determine the caller of the extension API for trace stack.",e)}return{extensionId:cP,displayName:_.unknownPackage}}};$I=E([(0,zQ.injectable)()],$I);d();var B1=z(re()),Pj=require("vscode");var zI=class{constructor(e){this.extensionContext=e;this.testingState=new Map}async store(e,t,n){if(Ni&&this.extensionContext.extensionMode!==Pj.ExtensionMode.Production){this.testingState.set(`${e}#${t}`,n||"");return}if(n)await this.extensionContext.secrets.store(`${e}.${t}`,n);else try{await this.extensionContext.secrets.delete(`${e}.${t}`)}catch(i){O(i)}}async retrieve(e,t){if(Ni&&this.extensionContext.extensionMode!==Pj.ExtensionMode.Production)return this.testingState.get(`${e}#${t}`);try{return await this.extensionContext.secrets.get(`${e}.${t}`)}catch(n){try{await this.extensionContext.secrets.delete(`${e}.${t}`);return}catch(i){O(i)}}}};zI=E([(0,B1.injectable)(),b(0,(0,B1.inject)(ut))],zI);d();var QQ=z(re());var QI=class{constructor(){this._list=[]}async dispose(){let e=this._list.map(t=>t.dispose());await Promise.all(e),this._list=[]}push(e){e&&this._list.push(e)}get list(){return this._list}};QI=E([(0,QQ.injectable)()],QI);d();var XQ=z(re()),yu=require("vscode");var am=class am extends Error{};am.back=new am("back"),am.cancel=new am("cancel"),am.resume=new am("resume");var Ze=am,tD=class{constructor(){this.steps=[]}run(e,t){return this.stepThrough(e,t)}async showQuickPick(e){return this.showLazyLoadQuickPick(e).selection}showLazyLoadQuickPick({title:e,step:t,totalSteps:n,items:i,activeItem:o,placeholder:s,buttons:a,shouldResume:l,matchOnDescription:c,matchOnDetail:u,acceptFilterBoxTextAsSelection:p,startBusy:f,stopBusy:m,validate:h,onDidTriggerItemButton:g,onDidTriggerButton:v,supportBackInFirstStep:I,onDidChangeItems:S,ignoreFocusOut:x}){let D=[],A=Me(),w=yu.window.createQuickPick();return w.title=e,w.step=t,w.totalSteps=n,w.placeholder=s,w.ignoreFocusOut=x!=null?x:!0,w.items=i,m&&(w.busy=f!=null?f:!1,m(()=>{w.enabled&&(w.busy=!1)},this,D)),S&&(w.keepScrollPosition=!0,S(R=>{w.items=R},this,D)),g&&w.onDidTriggerItemButton(R=>g(R),void 0,D),w.matchOnDescription=c||!1,w.matchOnDetail=u||!1,o?w.activeItems=[o]:w.activeItems=[],w.buttons=[...this.steps.length>1||I?[yu.QuickInputButtons.Back]:[],...a||[]],D.push(w.onDidTriggerButton(R=>{R===yu.QuickInputButtons.Back?A.reject(Ze.back):v?v(R):A.resolve(R)}),w.onDidChangeSelection(async R=>{let j=R.length?R[0].label:"",ne=!!j;if(j&&h&&R.length){w.enabled=!1,w.busy=!0;let N=await h(R[0]);N&&(ne=!1,await yu.window.showErrorMessage(N,{modal:!0})),w.enabled=!0,w.busy=!1}ne&&A.resolve(R[0])}),w.onDidHide(()=>{(async()=>{A.reject(l&&await l()?Ze.resume:Ze.cancel)})().catch(A.reject)})),p&&D.push(w.onDidAccept(async()=>{if(!w.busy){let R=h?await h(w):void 0;R?(w.enabled=!1,w.busy=!0,await yu.window.showErrorMessage(R),w.enabled=!0,w.busy=!1):A.resolve(w.value)}})),this.current&&this.current.dispose(),this.current=w,this.current.show(),A.promise.finally(()=>he(D)).catch(y),{quickPick:w,selection:A.promise}}async showInputBox({title:e,step:t,totalSteps:n,value:i,prompt:o,validate:s,password:a,buttons:l,shouldResume:c,validationMessage:u}){let p=[];try{return await new Promise((f,m)=>{let h=yu.window.createInputBox();h.title=e,h.step=t,h.totalSteps=n,h.password=!!a,h.value=i||"",h.prompt=o,h.validationMessage=u||"",h.ignoreFocusOut=!0,h.validationMessage=u||"",h.buttons=[...this.steps.length>1?[yu.QuickInputButtons.Back]:[],...l||[]],p.push(h.onDidTriggerButton(g=>{g===yu.QuickInputButtons.Back?m(Ze.back):f(g)}),h.onDidAccept(async()=>{let g=h.value;h.enabled=!1,h.busy=!0;let v=await s(g);v?(h.validationMessage=v,h.show()):(h.validationMessage="",f(g)),h.enabled=!0,h.busy=!1}),h.onDidChangeValue(async()=>{h.validationMessage=""}),h.onDidHide(()=>{(async()=>{h.busy||m(c&&await c()?Ze.resume:Ze.cancel)})().catch(m)})),this.current&&this.current.dispose(),this.current=h,this.current.show()})}finally{p.forEach(f=>f.dispose())}}async stepThrough(e,t){let n=e;for(;n;){this.steps.push(n),this.current&&(this.current.enabled=!1,this.current.busy=!0);try{n=await n(this,t)}catch(i){if(i===Ze.back)this.steps.pop(),n=this.steps.pop();else if(i===Ze.resume)n=this.steps.pop();else if(i===Ze.cancel)n=void 0;else throw i;if(!n)return i}}this.current&&this.current.dispose()}},H1=Symbol("IMultiStepInputFactory"),XI=class{create(){return new tD}};XI=E([(0,XQ.injectable)()],XI);d();var ZQ=z(re()),Bo=require("vscode");var zd=class{get activeDebugConsole(){return Bo.debug.activeDebugConsole}get activeDebugSession(){var e;return Ie(`Getting active debug session, ${(e=Bo.debug.activeDebugSession)==null?void 0:e.name}`),Bo.debug.activeDebugSession}get breakpoints(){return Bo.debug.breakpoints}get onDidChangeActiveDebugSession(){return Bo.debug.onDidChangeActiveDebugSession}get onDidStartDebugSession(){return Bo.debug.onDidStartDebugSession}get onDidReceiveDebugSessionCustomEvent(){return Bo.debug.onDidReceiveDebugSessionCustomEvent}get onDidTerminateDebugSession(){return Bo.debug.onDidTerminateDebugSession}get onDidChangeBreakpoints(){return Bo.debug.onDidChangeBreakpoints}registerDebugConfigurationProvider(e,t){return Bo.debug.registerDebugConfigurationProvider(e,t)}registerDebugAdapterTrackerFactory(e,t){return Bo.debug.registerDebugAdapterTrackerFactory(e,t)}startDebugging(e,t,n){return Bo.debug.startDebugging(e,t,n)}addBreakpoints(e){Bo.debug.addBreakpoints(e)}removeBreakpoints(e){Bo.debug.removeBreakpoints(e)}};zd.instance=new zd,zd=E([(0,ZQ.injectable)()],zd);d();var rD=z(re());var tX=z(J1());var eX="_VSCODE_getDataFrame",q1=tX.default`
                            try:
                                del _VSCODE_getDataFrame
                            except:
                                pass
                            `,bu=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetDataFrameInfo(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${eX}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:q1}:{code:`${t}

${i}

${q1}`}}async generateCodeToGetDataFrameRows(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${eX}("rows", ${n}, ${e.variableName}, ${e.startIndex}, ${e.endIndex})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:q1}:{code:`${t}

${i}

${q1}`}}async getContentsOfDataFrameScript(){if(bu.contentsOfDataFrameScript)return bu.contentsOfDataFrameScript;let e=$i(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","dataframes","vscodeDataFrame.py"),t=await this.fs.readFile(e);return bu.contentsOfDataFrameScript=t,t}};bu=E([(0,rD.injectable)(),b(0,(0,rD.inject)(Tt)),b(1,(0,rD.inject)(ut))],bu);d();var nD=z(re());var Nj=z(J1());var kj="_VSCODE_getVariable",ZI=Nj.default`
                            try:
                                del _VSCODE_getVariable
                            except:
                                pass
                            `,Gs=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetVariableInfo(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${kj}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:ZI}:{code:`${t}

${i}

${ZI}`}}async generateCodeToGetVariableProperties(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${kj}("properties", ${n}, ${e.variableName}, ${e.stringifiedAttributeNameList})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:ZI}:{code:`${t}

${i}

${ZI}`}}async generateCodeToGetAllVariableDescriptions(e){let t=await this.getContentsOfVariablesScript();return e?t=t+`

return _VSCODE_getAllChildrenDescriptions('${e.root}', ${JSON.stringify(e.propertyChain)}, ${e.startIndex})`:t=t+`

variables= %who_ls
return _VSCODE_getVariableDescriptions(variables)`,t}async generateCodeToGetVariableTypes(e){let n=`${await this.getContentsOfScript()}

_VSCODE_rwho_ls = %who_ls
`,i=e.isDebugging?"True":"False",o=Nj.default`
        try:
            del _VSCODE_rwho_ls
        except:
            pass
        `,s=`${kj}("types", ${i}, _VSCODE_rwho_ls)`;return e.isDebugging?{initializeCode:n,code:s,cleanupCode:`${ZI}
${o}`}:{code:`${n}${s}

${ZI}
${o}`}}async generateCodeToGetVariableValueSummary(e){let t=await this.getContentsOfVariablesScript();return t=t+`

variables= %who_ls
return _VSCODE_getVariableSummary(${e})`,t}async getContentsOfScript(){if(Gs.contentsOfScript)return Gs.contentsOfScript;let e=$i(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariableInfo.py"),t=await this.fs.readFile(e);return Gs.contentsOfScript=t,t}async getContentsOfVariablesScript(){if(Gs.contentsOfVariablesScript)return Gs.contentsOfVariablesScript;let e=$i(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariablesForProvider.py"),t=await this.fs.readFile(e);return Gs.contentsOfVariablesScript=t,t}};Gs=E([(0,nD.injectable)(),b(0,(0,nD.inject)(Tt)),b(1,(0,nD.inject)(ut))],Gs);d();var G1=Symbol("IExtensionActivationManager"),He=Symbol("IExtensionSyncActivationService");d();var iD=require("vscode");var Iu=z(re());var rX=["currentServerHash","connectToLocalKernelsOnly","JUPYTER_LOCAL_KERNELSPECS","JUPYTER_LOCAL_KERNELSPECS_V1","JUPYTER_LOCAL_KERNELSPECS_V2","JUPYTER_LOCAL_KERNELSPECS_V3","JUPYTER_REMOTE_KERNELSPECS","JUPYTER_REMOTE_KERNELSPECS_V1","JUPYTER_REMOTE_KERNELSPECS_V2","JUPYTER_REMOTE_KERNELSPECS_V3","JUPYTER_LOCAL_KERNELSPECS_V4","JUPYTER_REMOTE_KERNELSPECS_V4-","LOCAL_KERNEL_SPECS_CACHE_KEY_V_2022_10","LOCAL_KERNEL_PYTHON_AND_RELATED_SPECS_CACHE_KEY_V_2022_10","user-jupyter-server-uri-list-v2","REGISTRATION_ID_EXTENSION_OWNER_MEMENTO_KEY","jupyter.jupyterServer.uriList"],eS=class{constructor(e,t,n,i){this.globalState=e;this.crypto=t;this.workspaceState=n;this.extensionContext=i}activate(){this.removeOldCachedItems().then(y,y)}async removeOldCachedItems(){await Promise.all([await this.getUriAccountKey()].concat(rX).filter(t=>this.globalState.get(t,void 0)!==void 0).map(t=>this.globalState.update(t,void 0).then(y,y)));let e=this.workspaceState.keys().filter(t=>t.startsWith("LAST_EXECUTED_CELL_")&&!t.startsWith("LAST_EXECUTED_CELL_V2_"));await Promise.all(e.map(t=>this.workspaceState.update(t,void 0))),await Promise.all(rX.map(t=>this.globalState.keys().filter(n=>n.startsWith(t)).map(n=>this.globalState.update(n,void 0).then(y,y))).flat()),await this.extensionContext.secrets.delete(`${gi.JupyterServerRemoteLaunchService}.remote-uri-list`).then(y,y)}async getUriAccountKey(){let e=sI();return e?this.crypto.createHash(pt(e),"SHA-512"):iD.workspace.workspaceFile?this.crypto.createHash(pt(iD.workspace.workspaceFile),"SHA-512"):iD.env.machineId}};eS=E([(0,Iu.injectable)(),b(0,(0,Iu.inject)(wt)),b(0,(0,Iu.named)(ur)),b(1,(0,Iu.inject)(Xv)),b(2,(0,Iu.inject)(wt)),b(2,(0,Iu.named)(Ts)),b(3,(0,Iu.inject)(ut))],eS);function nX(r){r.addSingletonInstance(VB,!1),r.addSingleton(Np,HI),r.addSingleton(PP,qI),r.addSingleton(DP,GI),r.addSingleton(tl,$I),r.addSingleton(Xv,py),r.addSingleton(Yx,zI),r.addSingleton(ho,zd),r.addSingleton(_o,QI),r.addSingleton(H1,XI),r.addSingleton(ty,bu),r.addSingleton(ey,Gs),r.addSingleton(He,eS),$Q(r)}d();d();var Y1=z(re()),Qd=require("vscode");var Xd=class{constructor(e){this.disposables=[];this._onDidChange=new Qd.EventEmitter;e.push(this),Tn()||Qd.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.kernels.excludePythonEnvironments")&&this._onDidChange.fire()},this,this.disposables)}get onDidChange(){return this._onDidChange.event}dispose(){this._onDidChange.dispose(),he(this.disposables)}isPythonEnvironmentExcluded(e){if(Tn())return!1;let t=this.getExcludedPythonEnvironments(),n=w_e(e,t),i="uri"in e?e.uri:e.executable.uri;return n&&(J("DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER"),q(`Python Env hidden via filter: ${Se(i)}`)),n}getExcludedPythonEnvironments(){if(!Qd.workspace.workspaceFolders||Qd.workspace.workspaceFolders.length===0)return Qd.workspace.getConfiguration("jupyter",void 0).get("kernels.excludePythonEnvironments",[]);let e=[];return Qd.workspace.workspaceFolders.forEach(t=>{e.push(...Qd.workspace.getConfiguration("jupyter",t.uri).get("kernels.excludePythonEnvironments",[]))}),e}};Xd=E([(0,Y1.injectable)(),b(0,(0,Y1.inject)(oe))],Xd);function w_e(r,e){var o;let t="uri"in r?r.envPath:(o=r.environment)==null?void 0:o.folderUri,n="uri"in r?r.uri:r.executable.uri;return!n&&!t?!1:e.some(s=>{let a=Se(s.trim()).toLowerCase().replace(/\\/g,"/");if(s=s.trim().toLowerCase().replace(/\\/g,"/"),s.length===0||a.length===0)return!1;let l=Se(n).toLowerCase().replace(/\\/g,"/"),c=n?n.fsPath.toLowerCase().replace(/\\/g,"/"):"";if(s===l||a===l||s===c||a===c)return!0;let u=Se(t||"").toLowerCase().replace(/\\/g,"/"),p=Se(t||"").toLowerCase().replace(/\\/g,"/");return s===u||a===u||s===p||a===p})}d();var iX=z(re()),go=require("vscode");var tS=class{activate(){this.migrateFilters().catch(y)}async migrateFilters(){let e=Array.isArray(go.workspace.workspaceFolders)?go.workspace.workspaceFolders:[];await this.migrateWorkspaceFilters(go.workspace.getConfiguration("jupyter",void 0),go.ConfigurationTarget.Global),e.length===0?await this.migrateWorkspaceFilters(go.workspace.getConfiguration("jupyter",void 0),go.ConfigurationTarget.Global):e.length===1?await this.migrateWorkspaceFilters(go.workspace.getConfiguration("jupyter",e[0].uri),go.ConfigurationTarget.WorkspaceFolder):(await this.migrateWorkspaceFilters(go.workspace.getConfiguration("jupyter",void 0),go.ConfigurationTarget.Workspace),await Promise.all(e.map(t=>this.migrateWorkspaceFilters(go.workspace.getConfiguration("jupyter",t.uri),go.ConfigurationTarget.WorkspaceFolder))))}async migrateWorkspaceFilters(e,t){let n=e.inspect("kernels.filter"),i=[];switch(t){case go.ConfigurationTarget.Global:i=(n==null?void 0:n.globalValue)||[];break;case go.ConfigurationTarget.Workspace:i=(n==null?void 0:n.workspaceValue)||[];break;default:i=(n==null?void 0:n.workspaceFolderValue)||[]}let o=i.filter(s=>s.type==="pythonEnvironment").map(s=>s.path);i.length&&await e.update("kernels.filter",void 0,t),o.length&&await e.update("kernels.excludePythonEnvironments",Array.from(new Set(o)),t)}};tS=E([(0,iX.injectable)()],tS);d();var $1=z(re());var Rj=require("vscode");var rS=class{constructor(e){this.disposables=e}activate(){this.disposables.push(Rj.commands.registerCommand("jupyter.filterKernels",()=>Rj.commands.executeCommand("workbench.action.openSettings","jupyter.kernels.excludePythonEnvironments").then(y,y),this))}};rS=E([(0,$1.injectable)(),b(0,(0,$1.inject)(oe))],rS);function oX(r){r.addSingleton(He,tS),r.addSingleton(He,rS),r.addSingleton(Xd,Xd)}d();var uX=z(re()),nS=require("vscode");d();var aX=new Set;function lX(r){aX.add(r)}function sX(r){try{aX.forEach(e=>e.report(r))}catch(e){O("Failed to report progress",e)}}function cX(r){return function(e,t,n){let i=n.value;n.value=async function(...o){return sX({action:r,phase:"started"}),i.apply(this,o).finally(()=>{sX({action:r,phase:"completed"})})}}}d();d();var D_e={JupyterSessionWaitForIdleSession:_.waitingForJupyterSessionToBeIdle,KernelsGetKernelForRemoteConnection:_.gettingListOfKernelsForRemoteConnection,KernelsGetKernelSpecs:_.gettingListOfKernelSpecs,KernelsRegisterKernel:_.registeringKernel,NotebookConnect:_.connectingToJupyter,NotebookStart:_.startingJupyterNotebook,InstallingMissingDependencies:_.installingMissingDependencies,ExportNotebookToPython:_.exportNotebookToPython,PerformingExport:_.performingExport};function z1(r){return D_e[r]}var rc=class{constructor(){this.progressReporters=[];this.actionPhases=new Map;this.currentActions=[];lX(this)}get currentAction(){return this.currentActions.length===0?void 0:this.currentActions[this.currentActions.length-1]}createProgressIndicator(e,t=!1){let n=new nS.CancellationTokenSource,i=Me(),o={location:nS.ProgressLocation.Notification,cancellable:t,title:e};return nS.window.withProgress(o,async(s,a)=>{a.onCancellationRequested(()=>{a.isCancellationRequested&&n.cancel(),i.resolve()}),n.token.onCancellationRequested(()=>{i.resolve()}),this.progressReporters.push(s),await i.promise}).then(y,y),{token:n.token,dispose:()=>i.resolve()}}report(e){if(this.progressReporters.length!==0&&(this.actionPhases.set(e.action,e.phase),e.phase==="started"&&this.currentActions.push(e.action),!!this.currentAction)){for(;this.actionPhases.get(this.currentAction)&&this.actionPhases.get(this.currentAction)!=="started";)this.actionPhases.delete(this.currentAction),this.currentActions.pop();this.updateProgressMessage()}}updateProgressMessage(){if(!this.currentAction||this.progressReporters.length===0)return;let e=z1(this.currentAction);e&&this.progressReporters.forEach(t=>t.report({message:e}))}};rc=E([(0,uX.injectable)()],rc);d();var dX=z(re());var pX=require("vscode");var iS=class extends O0{async computeWorkingDirectory(e){var t;if(e){let n=pt(e);return n.includes(".")?pt(zv(e)):n}return e=(e?(t=pX.workspace.getWorkspaceFolder(e))==null?void 0:t.uri:void 0)||sI(),e?pt(e):"."}};iS=E([(0,dX.injectable)()],iS);d();var ev=z(re());var fX=require("vscode");var oS=class{constructor(e,t){this.jupyterOutput=e;this.disposableRegistry=t}register(){this.disposableRegistry.push(fX.commands.registerCommand(X.ViewJupyterOutput,this.viewJupyterOutput,this))}viewJupyterOutput(){this.jupyterOutput.show(!0)}};oS=E([(0,ev.injectable)(),b(0,(0,ev.inject)(jm)),b(0,(0,ev.named)(Vv)),b(1,(0,ev.inject)(oe))],oS);d();var IX=z(re()),lm=z(require("vscode"));d();var sS=z(require("vscode")),Aj;(l=>{let r=sS.FileSystemError.FileNotFound().name,e=sS.FileSystemError.FileExists().name,t=sS.FileSystemError.FileIsADirectory().name,n=sS.FileSystemError.FileNotADirectory().name,i=sS.FileSystemError.NoPermissions().name,o=[r,e,t,n,i];function s(c,u){if(o.includes(c.name))return c.name===u}function a(c){return s(c,r)}l.isFileNotFound=a})(Aj||(Aj={}));function P_e(r,e){let t=r.code;if(t)return t===e}function mX(r){let e=Aj.isFileNotFound(r);return e!==void 0?e:P_e(r,"ENOENT")}d();var yX=z(vX()),bX=require("vscode"),Su=class{constructor(e=yX.fetch){this.fetchImplementation=e;this.requestOptions={};let t=bX.workspace.getConfiguration("http").get("proxy","");t&&(this.requestOptions={headers:{proxy:t}})}async downloadFile(e){return this.fetchImplementation(e,this.requestOptions)}async exists(e){try{return(await this.downloadFile(e)).status===200}catch(t){return q(`HttpClient - Failure checking for file ${e}: ${t}`),!1}}};var lS=class{constructor(){this.vscfs=lm.workspace.fs}arePathsSame(e,t){return ca(e,t)}async getFiles(e){return(await this.vscfs.readDirectory(e)).filter(n=>n[1]===lm.FileType.File).map(n=>lm.Uri.file(n[0]))}async copy(e,t,n){await this.vscfs.copy(e,t,n)}async createDirectory(e){await this.vscfs.createDirectory(e)}async delete(e){await this.vscfs.delete(e)}async readFile(e){let t=await this.vscfs.readFile(e);return new TextDecoder().decode(t)}async stat(e){return this.vscfs.stat(e)}async writeFile(e,t){return this.vscfs.writeFile(e,typeof t=="string"?new TextEncoder().encode(t):t)}async exists(e,t){if(e.scheme.toLowerCase()==="http"||e.scheme.toLowerCase()==="https")return new Su().exists(e.toString());let n;try{n=await this.stat(e)}catch(i){return mX(i)||O(`stat() failed for "${e}"`,i),!1}return t===void 0?!0:t===lm.FileType.Unknown?n.type===lm.FileType.Unknown:(n.type&t)===t}async getFileHash(e){let t=await this.stat(e),n=`${t.ctime}-${t.mtime}`;return ol(n,"SHA-512")}};lS=E([(0,IX.injectable)()],lS);d();var X1=z(re()),_u=require("vscode");var Jt=class{constructor(e){this.kernelResourceProgressReporter=new Map;e.push(this),Jt.instance=this}activate(){}dispose(){he(Array.from(Jt.disposables))}static createProgressReporter(e,t,n){if(!Jt.instance)return new _u.Disposable(y);let i=e?el(e):"";return Jt.instance.kernelResourceProgressReporter.has(i)?Jt.reportProgress(e,t):Jt.createProgressReporterInternal(i,t,n)}static wrapAndReportProgress(e,t,n){let i=e?el(e):"";if(!Jt.instance)return n();let o=Jt.reportProgressInternal(i,t);return n().finally(()=>o==null?void 0:o.dispose())}static reportProgress(e,t){let n=z1(t)||t,i=e?el(e):"";return n?Jt.reportProgressInternal(i,n||""):new _u.Disposable(()=>y)}static reportProgressInternal(e,t){if(!Jt.instance)return new _u.Disposable(y);let n=Jt.instance.kernelResourceProgressReporter.get(e);if(n||(n={title:t,pendingProgress:[],progressList:[],dispose:y},Jt.instance.kernelResourceProgressReporter.set(e,n)),n.reporter)n.progressList.push(t),n.reporter.report({message:t});else{if(n.progressList.includes(t))return new _u.Disposable(y);n.pendingProgress.push(t)}return{dispose:()=>{try{if(!n)return;let i=n.progressList.findIndex(o=>o===t);if(i>=0&&n.progressList.splice(i),n.progressList.length>0){let o=n.progressList[n.progressList.length-1];n.reporter&&n.reporter.report({message:o===n.title&&n.reporter?"":o})}else Jt.instance.kernelResourceProgressReporter.delete(e),n.dispose()}catch(i){O(`Failed to dispose Progress reporter for ${e}`,i)}}}}static createProgressReporterInternal(e,t,n){let i=Me(),o=new _u.Disposable(()=>i.resolve()),s=Jt.instance.kernelResourceProgressReporter.get(e)||{title:t,pendingProgress:[],progressList:[],tokenSources:[],dispose:()=>{o.dispose()}},a=!1,l=()=>{a||(a=!0,_u.window.withProgress({location:_u.ProgressLocation.Notification,title:t},async(c,u)=>{let p=Jt.instance.kernelResourceProgressReporter.get(e);if(p){for(p.reporter=c;p.pendingProgress.length>0;){let f=p.pendingProgress.shift();f===t?p.progressList.push(f):f!==t&&f&&(p.progressList.push(f),c.report({message:f}))}await Js(u,i.promise),Jt.instance.kernelResourceProgressReporter.get(e)===p&&Jt.instance.kernelResourceProgressReporter.delete(e),Jt.disposables.delete(o)}}).then(y,y))};return Jt.instance.kernelResourceProgressReporter.set(e,{...s,dispose:()=>o.dispose(),show:l}),Jt.disposables.add(o),s.pendingProgress.push(t),n||l(),{dispose:()=>o.dispose(),show:l}}};Jt.disposables=new Set,Jt=E([(0,X1.injectable)(),b(0,(0,X1.inject)(oe))],Jt);d();var dS=z(re()),Z1=require("vscode");d();var SX=require("vscode");var cS=class{constructor(e,t,n,i=[]){this.fs=e;this.disposableRegistry=t;this.options=n;this.loadFailedEmitter=new SX.EventEmitter;let o={enableScripts:!0,localResourceRoots:[this.options.rootPath,this.options.cwd,...i]};n.webviewHost?(this.webviewHost=n.webviewHost,this.webviewHost.webview.options=o):this.webviewHost=this.createWebview(o),this.loadPromise=this.load()}get loadFailed(){return this.loadFailedEmitter.event}asWebviewUri(e){var t;if(!((t=this.webviewHost)!=null&&t.webview))throw new Error("WebView not initialized, too early to get a Uri");return this.webviewHost.webview.asWebviewUri(e)}postMessage(e){var t,n;(t=this.webviewHost)!=null&&t.webview&&((n=this.webviewHost)==null||n.webview.postMessage(e))}async generateLocalReactHtml(){var o;if(!((o=this.webviewHost)!=null&&o.webview))throw new Error("WebView not initialized, too early to get a Uri");let e=this.webviewHost.webview.asWebviewUri(this.options.cwd).toString(),t=this.options.scripts.map(s=>this.webviewHost.webview.asWebviewUri(s)),n=this.webviewHost.webview.asWebviewUri(this.options.rootPath).toString(),i="false";return`<!doctype html>
        <html lang="en">
            <head>
                <meta charset="utf-8">
                <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
                <meta http-equiv="Content-Security-Policy" content="img-src 'self' data: https: http: blob: ${this.webviewHost.webview.cspSource}; default-src 'unsafe-inline' 'unsafe-eval' data: https: http: blob: ${this.webviewHost.webview.cspSource};">
                <meta name="theme-color" content="#000000">
                <meta name="theme" content="${st.GeneratedThemeName}"/>
                <title>VS Code Python React UI</title>
                <base href="${e}${e.endsWith("/")?"":"/"}"/>
                </head>
            <body>
                <noscript>You need to enable JavaScript to run this app.</noscript>
                <div id="root"></div>
                <script type="text/javascript">
                    // Public path that will be used by webpack.
                    window.__PVSC_Public_Path = "${n}/";
                    function resolvePath(relativePath) {
                        if (relativePath && relativePath[0] == '.' && relativePath[1] != '.') {
                            return "${e}" + relativePath.substring(1);
                        }

                        return "${e}" + relativePath;
                    }
                    function forceTestMiddleware() {
                        return ${i};
                    }
                <\/script>
                ${t.map(s=>`<script type="text/javascript" src="${s}"><\/script>`).join(`
`)}
            </body>
        </html>`}async load(){var e;try{(e=this.webviewHost)!=null&&e.webview&&((await Promise.all(this.options.scripts.map(n=>this.fs.exists(n)))).every(n=>n===!0)?(this.webviewHost.webview.html=await this.generateLocalReactHtml(),this.postLoad(this.webviewHost)):this.webviewHost.webview.html=_.badWebPanelFormatString(this.options.scripts.join(", ")))}catch(t){O(`Error Loading WebviewPanel: ${t}`),this.loadFailedEmitter.fire()}}};var Mj=class extends cS{get panel(){return this.webviewHost}get panelOptions(){return this.options}constructor(e,t,n,i=[]){super(e,t,n,i)}async show(e){await this.loadPromise,this.panel&&(e?this.panel.visible||this.panel.reveal(this.panel.viewColumn,e):this.panel.active||this.panel.reveal(this.panel.viewColumn,e))}close(){this.panel&&this.panel.dispose()}get viewColumn(){var e;return(e=this.panel)==null?void 0:e.viewColumn}isVisible(){return this.panel?this.panel.visible:!1}isActive(){return this.panel?this.panel.active:!1}setTitle(e){this.panelOptions.title=e,this.panel&&(this.panel.title=e)}createWebview(e){return Z1.window.createWebviewPanel(this.panelOptions.title.toLowerCase().replace(" ",""),this.panelOptions.title,{viewColumn:this.panelOptions.viewColumn,preserveFocus:!0},{retainContextWhenHidden:!0,enableFindWidget:!0,...e})}postLoad(e){this.disposableRegistry.push(e.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose().catch(y)})),this.disposableRegistry.push(e.webview.onDidReceiveMessage(t=>{this.panelOptions.listener.onMessage(t.type,t.payload)})),this.disposableRegistry.push(e.onDidChangeViewState(t=>{this.panelOptions.listener.onChangeViewState(this)})),this.panelOptions.listener.onChangeViewState(this)}},uS=class{constructor(e,t,n){this.disposableRegistry=e;this.fs=t;this.context=n}async create(e){let t=[Z1.Uri.file(JE(this.context.extensionPath,"temp"))];return Array.isArray(e.additionalPaths)&&t.push(...e.additionalPaths),new Mj(this.fs,this.disposableRegistry,e,t)}};uS=E([(0,dS.injectable)(),b(0,(0,dS.inject)(oe)),b(1,(0,dS.inject)(Tt)),b(2,(0,dS.inject)(ut))],uS);d();var oD=z(re()),_X=require("vscode");var Oj=class extends cS{constructor(t,n,i,o=[]){super(t,n,i,o);this.panelOptions=i;this._onDidChangeVisibility=new _X.EventEmitter}get visible(){return this.webviewHost?this.webviewHost.visible:!1}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}createWebview(t){throw new Error("Webview Views must be passed in an initial view")}postLoad(t){this.disposableRegistry.push(t.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose().catch(y)})),this.disposableRegistry.push(t.webview.onDidReceiveMessage(n=>{this.panelOptions.listener.onMessage(n.type,n.payload)})),this.disposableRegistry.push(t.onDidChangeVisibility(()=>{this._onDidChangeVisibility.fire()})),this._onDidChangeVisibility.fire()}},pS=class{constructor(e,t){this.disposableRegistry=e;this.fs=t}async create(e){return new Oj(this.fs,this.disposableRegistry,e)}};pS=E([(0,oD.injectable)(),b(0,(0,oD.inject)(oe)),b(1,(0,oD.inject)(Tt))],pS);d();var fS=z(re());d();var Jnt=Symbol("IReservedPythonNamedProvider"),qnt=Symbol("IInterpreterPackages"),EX=Symbol("IWorkspaceInterpreterTracker");var nc=class{constructor(e){this.workspaceInterpreterTracker=e;nc.isActiveWorkspaceInterpreter=this.isActiveWorkspaceInterpreterImpl.bind(this)}activate(){var e;(e=this.workspaceInterpreterTracker)==null||e.activate()}isActiveWorkspaceInterpreterImpl(e,t){var n,i;return(i=(n=this.workspaceInterpreterTracker)==null?void 0:n.isActiveWorkspaceInterpreter(e,t))!=null?i:!1}};nc.isActiveWorkspaceInterpreter=()=>!1,nc=E([(0,fS.injectable)(),b(0,(0,fS.inject)(EX)),b(0,(0,fS.optional)())],nc);function CX(r){r.addSingleton(Tt,lS),r.addSingleton(p1,iS),r.addSingleton(AI,BI),r.addSingleton(Ke,KI),r.addSingleton(Zv,oS),r.addSingleton(rc,rc),nX(r),Gz(r),oX(r),r.addSingleton(He,Jt),r.addSingleton(He,nc),r.add(f1,pS),r.add(MI,uS)}d();d();var yit=Symbol("IKernelLauncher"),ep=Symbol("IRawNotebookSupportedService"),wX=Symbol("IRawKernelSessionFactory");d();var sD=z(re()),Lj=require("vscode");var tv=class{constructor(e,t){this.disposableRegistry=e;this.kernelProvider=t;this.lastExecutedCellPerKernel=new WeakMap;this.kernelsStartedSuccessfully=new WeakSet}activate(){this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this,this.disposableRegistry),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry)}onDidStartKernel(e){this.kernelsStartedSuccessfully.add(e),this.kernelProvider.getKernelExecution(e).onPreExecute(t=>this.lastExecutedCellPerKernel.set(e,t),this,this.disposableRegistry)}async onKernelStatusChanged({kernel:e}){this.kernelsStartedSuccessfully.has(e)&&(e.disposed||e.disposing||!e.session||(e.session.kind==="localRaw"&&e.status==="dead"&&(Lj.window.showErrorMessage(_.kernelDiedWithoutError(ft(e.kernelConnectionMetadata))).then(y,y),await this.endCellAndDisplayErrorsInCell(e)),e.session.kind!=="localRaw"&&e.status==="autorestarting"&&(Lj.window.showErrorMessage(_.kernelDiedWithoutErrorAndAutoRestarting(ft(e.kernelConnectionMetadata))).then(y,y),await this.endCellAndDisplayErrorsInCell(e))))}async endCellAndDisplayErrorsInCell(e){let t=this.lastExecutedCellPerKernel.get(e);if(Rr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),!!t)return Yf(t,e.controller,_.kernelCrashedDueToCodeInCurrentOrPreviousCell,!1)}};E([_n()],tv.prototype,"onKernelStatusChanged",1),tv=E([(0,sD.injectable)(),b(0,(0,sD.inject)(oe)),b(1,(0,sD.inject)($e))],tv);d();d();var kX=z(re());d();var Ua=z(re());d();var cm=class extends ct{constructor(e){super("jupyterinstall",e)}};var Vr=require("vscode");d();var eA=class extends xi{constructor(e){super("timeout",_.rawKernelStartFailedDueToTimeout(ft(e)),e)}};d();var mS=class extends cu{constructor(t,n,i,o){super(t,i,o);this.stdErr=n}};d();var tA=class extends xi{constructor(e){super("timeout",_.rawKernelStartFailedDueToTimeoutWaitingForPort(ft(e)),e)}};d();var hS=class extends xi{constructor(t=-1,n,i){super("kerneldied",_.kernelDied(n.trim()),i);this.exitCode=t;this.stdErr=n}};d();d();var tot=Symbol("IModuleInstaller"),rot=Symbol("IPythonInstallation"),not=Symbol("IInstallationChannelManager"),iot=Symbol("IProductService"),oot=Symbol("IProductPathService");var sot=Symbol("IInstaller");function Kj(r){switch(r){case 18:return"jupyter";case 20:return"notebook";case 23:return"pandas";case 19:return"ipykernel";case 22:return"nbconvert";case 21:return"kernelspec";case 27:return"pip";case 28:return"ensurepip";default:throw new Error(`Product ${r} cannot be installed as a Python Module.`)}}d();var Ti=new Map;Ti.set(18,"jupyter");Ti.set(20,"notebook");Ti.set(19,"ipykernel");Ti.set(22,"nbconvert");Ti.set(21,"kernelspec");Ti.set(23,"pandas");Ti.set(27,"pip");Ti.set(28,"ensurepip");d();var aD=class extends xi{constructor(t,n){super("noipykernel",_.kernelInvalid(ft(n)),n);this.reason=t}};d();var um=class extends cu{constructor(e){super(_.kernelDiedWithoutError(ft(e)),void 0,e)}};d();var xX=require("vscode"),Er=class{constructor(e){this._event=new xX.EventEmitter;this._disableUI=e}get disableUI(){return this._disableUI}set disableUI(e){let t=this._disableUI!==e;this._disableUI=e,t&&this._event.fire()}get onDidChangeDisableUI(){return this._event.event}dispose(){this._event.dispose()}};d();var nA=class extends ct{constructor(e){super("jupyterexpiredcert",e)}};d();var dm=class extends ct{constructor(t){super("invalidremotejupyterserverurihandle","Server handle not in list of known handles");this.serverProviderHandle=t}};d();var pm=Symbol("IInterpreterService");d();var iA=class extends ct{constructor(t,n,i){super("windowsLongPathNotEnabled",i);this.product=t;this.interpreter=n;this.originalMessage=i}};d();var lD=class extends ct{constructor(t,n,i){super("jupyternotebooknotinstalled",t+(n?`
${n}`:""));this.interpreter=i}};d();var DX=new Map;function oA(r,e){DX.set(zt(r),e)}function gS(r,e,t){let n=e.jupyterCollections.find(i=>i.extensionId===r.extensionId&&i.id===r.id);return DX.get(zt(r))||(n==null?void 0:n.label)||t||`${r.id}:${r.handle}`}var yS=class{constructor(e,t,n,i,o,s,a){this.dependencyManager=e;this.configuration=t;this.kernelDependency=n;this.serverUriStorage=i;this.jupyterUriProviderRegistration=o;this.fs=s;this.interpreterService=a;this.handledErrors=new WeakSet;this.handledKernelErrors=new WeakSet}async handleError(e){var t;if(ue("DataScience Error",e),e=ri.unwrap(e),!this.handledErrors.has(e)){if(this.handledErrors.add(e),e instanceof cm)await((t=this.dependencyManager)==null?void 0:t.installMissingDependencies(e));else if(e instanceof Hs)await UR(this.configuration,e.message);else if(e instanceof nA)await WR(this.configuration,e.message);else if(!Di(e))if(e instanceof eA||e instanceof tA)Vr.window.showErrorMessage(e.message).then(y,y);else if(e instanceof mS||e instanceof hS||e instanceof lD||e instanceof Kp)Vr.window.showErrorMessage(vS(e)).then(y,y);else if(e instanceof mo&&Tn())Vr.window.showErrorMessage(_.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl)).then(y,y);else if(e instanceof mo){let n=await this.handleJupyterServerConnectionError(e,void 0);Vr.window.showErrorMessage(n).then(y,y)}else if(e instanceof Qf){let n=await this.handleJupyterServerUriProviderError(e,void 0);Vr.window.showErrorMessage(n).then(y,y)}else{let n=TX(e.message||e.toString());Vr.window.showErrorMessage(n).then(y,y)}}}async getErrorMessageForDisplayInCell(e,t,n){var i;if(e=ri.unwrap(e),Di(e)||O("Error in execution (get message for cell)",e),e instanceof um)return"";if(e instanceof aD)return Fj(e.kernelConnectionMetadata)||e.message;if(e instanceof cm)return N_e(e)||e.message;if(e instanceof mo&&!Tn())return e.message;if(e instanceof mo&&Tn())return _.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl);if(Di(e))return"";if(e instanceof iA){let o=typeof e.product=="string"?e.product:Ti.get(e.product)||`${e.product}`,s=sl(e.interpreter)||e.interpreter.id||"",a=to(e.interpreter),l=Se(a==null?void 0:a.executable.uri),c=s?` ${s} (${l})`:l;return _.packageNotInstalledWindowsLongPathNotEnabledError(o,c)}else{if((e instanceof mS||e instanceof hS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&!await this.fs.exists(e.kernelConnectionMetadata.interpreter.uri))return _.failedToStartKernelDueToMissingPythonEnv(sl(e.kernelConnectionMetadata.interpreter)||ks(e.kernelConnectionMetadata.interpreter)||Se(e.kernelConnectionMetadata.interpreter.uri));if((e instanceof mS||e instanceof hS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(e.kernelConnectionMetadata,void 0,!0))return Fj(e.kernelConnectionMetadata)||e.message;if(e instanceof xi||e instanceof cu){let[o,s]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(n),GL(e.kernelConnectionMetadata.interpreter)]),a=qm(Vr.workspace.workspaceFolders||[],e,ft(e.kernelConnectionMetadata),s,o.map(l=>l.uri));if(a){if(a.reason==="moduleNotFound"&&["ipykernel_launcher","ipykernel"].includes(a.moduleName))return Fj(e.kernelConnectionMetadata)||e.message;let l=[a.message];return a.moreInfoLink&&l.push(Be.clickHereForMoreInfoWithHtml(a.moreInfoLink)),or(e.kernelConnectionMetadata)&&a.reason==="moduleNotFound"&&!["ipykernel_launcher","ipykernel"].includes(a.moduleName)&&await this.addErrorMessageIfPythonArePossiblyOverridingPythonModules(l,n),l.join(`
`)}}else{if(e instanceof mo)return this.handleJupyterServerConnectionError(e,t);if(e instanceof Qf)return this.handleJupyterServerUriProviderError(e,t);if(e instanceof dm){let o=((i=Vr.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:i.packageJSON.displayName)||e.serverProviderHandle.extensionId;return vS(_.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(o),t)}}}return vS(e,t)}async handleJupyterServerUriProviderError(e,t){var o;let n=await gS(e.serverProviderHandle,this.jupyterUriProviderRegistration),i=((o=e.originalError)==null?void 0:o.message)||e.message;return vS(_.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerConnectionError(e,t){let n=await gS(e.serverProviderHandle,this.jupyterUriProviderRegistration,e.baseUrl),i=e.originalError.message||"";return vS(_.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerProviderConnectionError(e,t){let n=new Vr.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i&&(i.find(o=>o.id===e.handle)||await this.serverUriStorage.remove(e).catch(y)),!0}catch(i){return!1}finally{n.dispose()}}async handleKernelError(e,t,n,i,o){var s,a;if(Di(e)||ue(`Kernel Error, context = ${t}`,e),e=ri.unwrap(e),Di(e))return this.sendKernelTelemetry(e,t,i,"cancelled"),1;if(e instanceof aD)if(ue(`Jupyter Kernel Dependency Error, reason=${e.reason}`,e),this.sendKernelTelemetry(e,t,i,e.category),e.reason===4&&this.kernelDependency){let l=new Vr.CancellationTokenSource;try{let c=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new Er(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:c})}finally{l.dispose()}}else return e.reason;else{if((t==="start"||t==="restart")&&e instanceof cm)return this.sendKernelTelemetry(e,t,i,e.category),(this.dependencyManager?await this.dependencyManager.installMissingDependencies(e):2)===0?0:1;if(e instanceof mo||e instanceof Qf||e instanceof dm){this.sendKernelTelemetry(e,t,i,e.category);let l=e instanceof dm?"":e instanceof mo?e.originalError.message||"":((s=e.originalError)==null?void 0:s.message)||e.message,c=e.serverProviderHandle.extensionId,u=e.serverProviderHandle.id,p=this.jupyterUriProviderRegistration.jupyterCollections.find(I=>I.extensionId===c&&I.id==u);if(!p||await this.handleJupyterServerProviderConnectionError(e.serverProviderHandle,p))return 3;let f=e instanceof mo?e.baseUrl:"",m=gS(e.serverProviderHandle,this.jupyterUriProviderRegistration,f),h=e instanceof dm?((a=Vr.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:a.packageJSON.displayName)||e.serverProviderHandle.extensionId:"",g=o==="jupyterExtension"?[_.selectDifferentKernel]:[];switch(await Vr.window.showErrorMessage(e instanceof dm?_.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(h):_.remoteJupyterConnectionFailedWithServer(m),{detail:l,modal:!0},_.removeRemoteJupyterConnectionButtonText,_.changeRemoteJupyterConnectionButtonText,...g)){case _.removeRemoteJupyterConnectionButtonText:return await this.serverUriStorage.remove(e.serverProviderHandle).catch(y),1;case _.changeRemoteJupyterConnectionButtonText:return 1;case _.selectDifferentKernel:return 3}return 1}else if(e instanceof Hs){this.sendKernelTelemetry(e,t,i,e.category);let l=_.jupyterSelfCertEnable,c=_.jupyterSelfCertClose;return Vr.window.showErrorMessage(_.jupyterSelfCertFail(e.message),l,c).then(u=>{u===l?(J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),this.configuration.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Vr.ConfigurationTarget.Workspace).catch(y)):u===c&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE")}).then(y,y),2}else{if((t==="start"||t==="restart")&&n.kind==="startUsingPythonInterpreter"&&this.interpreterService&&!await this.fs.exists(n.interpreter.uri))return this.interpreterService.getInterpreterDetails(n.interpreter.id).then(async l=>{let c=await this.fs.exists(n.interpreter.uri);l?Rr(i,"DATASCIENCE.KERNEL_START_FAILURE_MISSING_ENV",void 0,{envMissingReason:"Unknown",isEmptyCondaEnv:fa(l),pythonEnvType:Or(l),fileExists:c}):Rr(i,"DATASCIENCE.KERNEL_START_FAILURE_MISSING_ENV",void 0,{envMissingReason:"EmptyEnvDetailsFromPython",isEmptyCondaEnv:fa(n.interpreter),pythonEnvType:Or(n.interpreter),fileExists:c})}).catch(async()=>{let l=await this.fs.exists(n.interpreter.uri);Rr(i,"DATASCIENCE.KERNEL_START_FAILURE_MISSING_ENV",void 0,{envMissingReason:"FailedToGetEnvDetailsFromPython",isEmptyCondaEnv:fa(n.interpreter),pythonEnvType:Or(n.interpreter),fileExists:l})}).catch(y),this.sendKernelTelemetry(e,t,i,"pythonEnvironmentMissing"),Vr.window.showErrorMessage(_.failedToStartKernelDueToMissingPythonEnv(sl(n.interpreter)||ks(n.interpreter)||Se(n.interpreter.uri))).then(y,y),this.interpreterService.refreshInterpreters(!0).catch(y),2;if((t==="start"||t==="restart")&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(n,void 0,!0)){this.sendKernelTelemetry(e,t,i,"noipykernel");let l=new Vr.CancellationTokenSource;try{let c=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new Er(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:c})}finally{l.dispose()}}else{let[l,c]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(i),GL(n.interpreter)]),u=qm(Vr.workspace.workspaceFolders||[],e,ft(n),c,l.map(p=>p.uri));return this.sendKernelTelemetry(e,t,i,u==null?void 0:u.reason),u?this.showMessageWithMoreInfo(u.message,u==null?void 0:u.moreInfoLink).catch(y):this.showMessageWithMoreInfo(vS(e,t)).catch(y),2}}}}sendKernelTelemetry(e,t,n,i){this.handledKernelErrors.has(e)||(this.handledKernelErrors.add(e),t==="start"&&Rr(n,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:!1,failureCategory:i},e))}async showMessageWithMoreInfo(e,t){e.includes(X.ViewJupyterOutput)||(e=`${e} 
${_.viewJupyterLogForFurtherInfo}`);let n=t?[Be.learnMore]:[];await Vr.window.showErrorMessage(e,...n).then(i=>{i===Be.learnMore&&t&&Vr.env.openExternal(Vr.Uri.parse(t))})}};yS=E([b(0,(0,Ua.inject)(wz)),b(0,(0,Ua.optional)()),b(1,(0,Ua.inject)(Ke)),b(2,(0,Ua.inject)(_I)),b(2,(0,Ua.optional)()),b(3,(0,Ua.inject)(yr)),b(4,(0,Ua.inject)(mr)),b(5,(0,Ua.inject)(Tt)),b(6,(0,Ua.inject)(pm)),b(6,(0,Ua.optional)())],yS);var T_e={restart:_.failedToRestartKernel,start:_.failedToStartKernel,interrupt:_.failedToInterruptKernel,execution:""};function vS(r,e){r=typeof r=="string"?r:ri.unwrap(r);let t=e?T_e[e]:"",n="";return r instanceof lD?n=_.jupyterNotebookNotInstalledOrNotFound(r.interpreter):r instanceof ct?n=H7(r.stdErr)||r.stdErr||r.message:n=typeof r=="string"?r:r.message,TX(t,n)}function k_e(r){var t,n;return((n=(t=new RegExp(/\[([^\[]+)\]\((.*)\)/).exec(r))==null?void 0:t.length)!=null?n:0)>0}function TX(r="",e=""){r&&e.startsWith(r.substring(0,r.length-1))&&(r="");let t=[r,e].map(n=>n.trim()).filter(n=>n.length>0).join(` 
`);return!k_e(t)&&t.length&&t.indexOf("command:jupyter.viewOutput")===-1?`${t.endsWith(".")?t:t+"."} 
${_.viewJupyterLogForFurtherInfo}`:t}function Fj(r){var a,l,c,u;if(r.kind==="connectToLiveRemoteKernel"||r.kind==="startUsingRemoteKernelSpec"||!r.interpreter)return;let e=sl(r.interpreter)||pt(r.interpreter.uri),t=Ti.get(19),n=Kj(19),i=`${QO(pt(r.interpreter.uri))} -m pip install ${n} -U --force-reinstall`;if(r.interpreter&&Or(r.interpreter)==="Conda"){let p=to(r.interpreter);(a=p==null?void 0:p.environment)!=null&&a.name?i=`conda install -n ${(l=p==null?void 0:p.environment)==null?void 0:l.name} ${n} --update-deps --force-reinstall`:(c=p==null?void 0:p.environment)!=null&&c.folderUri&&(i=`conda install -p ${pt((u=p==null?void 0:p.environment)==null?void 0:u.folderUri)} ${n} --update-deps --force-reinstall`)}else r.interpreter&&Or(r.interpreter)==="Unknown"&&(i=`${QO(pt(r.interpreter.uri))} -m pip install ${n} -U --user --force-reinstall`);let o=_.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter(e,Ti.get(19)),s=_.installPackageInstructions(t,i);return o+`
`+s}function N_e(r){let e=`${Ti.get(18)} ${Be.and} ${Ti.get(20)}`,t=[18,20].map(Kj).join(" "),n=`python -m pip install ${t} -U
or
conda install ${t} -U`,i=_.installPackageInstructions(e,n);return r.message+`
`+i+`
`+Be.clickHereForMoreInfoWithHtml("https://aka.ms/installJupyterForVSCode")}var bS=class extends yS{async addErrorMessageIfPythonArePossiblyOverridingPythonModules(e,t){}async getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(e){return[]}};bS=E([(0,kX.injectable)()],bS);d();var NX=z(re());var rv=class{async ensureKernelIsUsable(e,t,n,i,o){q("Check if a kernel is usable")}};E([b(1,uL("id")),b(2,uL("disableUI")),b(3,UB())],rv.prototype,"ensureKernelIsUsable",1),rv=E([(0,NX.injectable)()],rv);d();var cD=z(re());var RX=require("vscode");var IS=class{constructor(e,t){this.liveKernelConnectionTracker=e;this.providerRegistration=t}async isValid(e){if(!this.liveKernelConnectionTracker.wasKernelUsed(e))return!1;let t=await this.providerRegistration.jupyterCollections.find(i=>i.extensionId===e.serverProviderHandle.extensionId&&i.id===e.serverProviderHandle.id);if(!t)return ue(`Extension ${e.serverProviderHandle.extensionId} may have been uninstalled for provider ${e.serverProviderHandle.id}, handle ${e.serverProviderHandle.handle}`),!1;let n=new RX.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i?i.map(o=>o.id).includes(e.serverProviderHandle.handle)?!0:(ue(`Hiding remote kernel ${e.id} for ${t.id} as the remote Jupyter Server ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}:${e.serverProviderHandle.handle} is no longer available`),!1):!1}catch(i){return ue(`Failed to fetch remote servers from ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}`,i),!1}finally{n.dispose()}}};IS=E([(0,cD.injectable)(),b(0,(0,cD.inject)(Xg)),b(1,(0,cD.inject)(mr))],IS);d();var AX=z(re());var SS=class{async getOrStartServer(e){throw new Error("Invalid Operation in Web")}};SS=E([(0,AX.injectable)()],SS);d();var Eu=require("vscode"),nv=z(re());var _S=class extends zr{constructor(t,n){super();this._onDidLoad=this._register(new Eu.EventEmitter);this._onDidChangeUri=this._register(new Eu.EventEmitter);this._onDidRemoveUris=this._register(new Eu.EventEmitter);this._onDidAddUri=this._register(new Eu.EventEmitter);this._all=[];n.push(this),this.newStorage=this._register(new Uj(t))}get onDidLoad(){return this._onDidLoad.event}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}get all(){return this.updateStore(),this._all}hookupStorageEvents(){this.storageEventsHooked||(this.storageEventsHooked=!0,this._register(this.newStorage.onDidAdd(t=>this._onDidAddUri.fire(t),this)),this._register(this.newStorage.onDidChange(t=>this._onDidChangeUri.fire(t),this)),this._register(this.newStorage.onDidRemove(t=>this._onDidRemoveUris.fire(t),this)))}updateStore(){this.hookupStorageEvents();let t=this._all;return this._all=this.newStorage.getAll(),(t.length!==this._all.length||JSON.stringify(this._all)!==JSON.stringify(t))&&this._onDidLoad.fire(),this._all}async clear(){this.hookupStorageEvents(),await this.newStorage.clear(),this._all=[],this._onDidLoad.fire()}async add(t,n){var o;this.hookupStorageEvents(),Ie(`setUri: ${t.id}.${t.handle}`);let i={time:(o=n==null?void 0:n.time)!=null?o:Date.now(),displayName:"",provider:t};await this.newStorage.add(i),this.updateStore()}async update(t){this.hookupStorageEvents(),await this.newStorage.update(t),this.updateStore()}async remove(t){this.hookupStorageEvents(),await this.newStorage.remove(t),this.updateStore()}};_S=E([(0,nv.injectable)(),b(0,(0,nv.inject)(wt)),b(0,(0,nv.named)(ur)),b(1,(0,nv.inject)(oe))],_S);var Uj=class{constructor(e){this.memento=e;this._onDidChangeUri=new Eu.EventEmitter;this._onDidRemoveUris=new Eu.EventEmitter;this._onDidAddUri=new Eu.EventEmitter;this.updatePromise=Promise.resolve();this.mementoKey=`MEMENTO_KEY_FOR_STORING_USED_JUPYTER_PROVIDERS_${Eu.env.machineId}`}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}dispose(){this._onDidAddUri.dispose(),this._onDidChangeUri.dispose(),this._onDidRemoveUris.dispose()}async add(e){return this.updatePromise=this.updatePromise.then(async()=>{let t=this.getAll(),n=t.find(a=>zt(a.provider)===zt(e.provider)),o=[{displayName:e.displayName||(n==null?void 0:n.displayName)||zt(e.provider),serverHandle:e.provider,time:e.time}].concat(t.sort((a,l)=>l.time-a.time).filter(a=>zt(a.provider)!==zt(e.provider)).map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}))),s=o.splice(gi.JupyterServerUriListMax);if(await this.memento.update(this.mementoKey,o),n||this._onDidAddUri.fire(e),s.length){let a=s.map(l=>({provider:l.serverHandle,time:l.time,displayName:l.displayName||""}));this._onDidRemoveUris.fire(a.map(l=>l.provider))}this._onDidChangeUri.fire()}).catch(y)}async update(e){let n=this.getAll().find(o=>o.provider.id===e.id&&o.provider.handle===e.handle),i={provider:e,time:Date.now(),displayName:(n==null?void 0:n.displayName)||""};await this.add(i)}async remove(e){await(this.updatePromise=this.updatePromise.then(async()=>{let t=!1;try{let n=this.getAll();if(n.length===0)return;let i=n.filter(s=>s.provider.id!==e.id||s.provider.handle!==e.handle),o=n.filter(s=>s.provider.id===e.id&&s.provider.handle===e.handle);if(i.length===0)await this.clear();else if(o.length){let s=i.map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}));t=!0,await this.memento.update(this.mementoKey,s),this._onDidRemoveUris.fire(o.map(a=>a.provider))}}finally{t||this._onDidRemoveUris.fire([e])}}).catch(t=>O(`Failed to remove Server handle ${JSON.stringify(e)}`,t)))}getAll(){let e=this.memento.get(this.mementoKey,[]),t=[];return e.forEach(async n=>{let i=zt(n.serverHandle),o={time:n.time,displayName:n.displayName||i,provider:n.serverHandle};t.push(o)}),t}async clear(){let e=this.getAll();await this.memento.update(this.mementoKey,[]),e.length&&this._onDidRemoveUris.fire(e.map(t=>t.provider))}};d();var fm=z(re());var sA="removeKernelUrisAndSessionsUsedByResources",ES=class{constructor(e,t,n){this.disposables=e;this.uriStorage=t;this.memento=n;this.usedRemoteKernelServerIdsAndSessions={}}activate(){this.usedRemoteKernelServerIdsAndSessions=this.memento.get(sA,{}),this.uriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}wasKernelUsed(e){let t=zt(e.serverProviderHandle);return t in this.usedRemoteKernelServerIdsAndSessions&&typeof e.kernelModel.id=="string"&&e.kernelModel.id in this.usedRemoteKernelServerIdsAndSessions[t]}trackKernelIdAsUsed(e,t,n){let i=zt(t);this.usedRemoteKernelServerIdsAndSessions[i]=this.usedRemoteKernelServerIdsAndSessions[i]||{},this.usedRemoteKernelServerIdsAndSessions[i][n]=this.usedRemoteKernelServerIdsAndSessions[i][n]||[];let o=this.usedRemoteKernelServerIdsAndSessions[i][n];o.includes(e.toString())||(o.push(e.toString()),this.memento.update(sA,this.usedRemoteKernelServerIdsAndSessions).then(y,y))}trackKernelIdAsNotUsed(e,t,n){let i=zt(t);if(!(i in this.usedRemoteKernelServerIdsAndSessions)||!(n in this.usedRemoteKernelServerIdsAndSessions[i]))return;let o=this.usedRemoteKernelServerIdsAndSessions[i][n];!Array.isArray(o)||!o.includes(e.toString())||(o.splice(o.indexOf(e.toString()),1),o.length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i][n],Object.keys(this.usedRemoteKernelServerIdsAndSessions[i]).length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i],this.memento.update(sA,this.usedRemoteKernelServerIdsAndSessions).then(y,y))}onDidRemoveServers(e){e.forEach(t=>{let n=zt(t);delete this.usedRemoteKernelServerIdsAndSessions[n],this.memento.update(sA,this.usedRemoteKernelServerIdsAndSessions).then(y,y)})}};ES=E([(0,fm.injectable)(),b(0,(0,fm.inject)(oe)),b(1,(0,fm.inject)(yr)),b(2,(0,fm.inject)(wt)),b(2,(0,fm.named)(ur))],ES);d();var KX=z(re()),FX=z(OX());d();var LX=require("vscode");function Wj(r){return class extends r{constructor(...n){super(...n);this._onAnyMessage=new LX.EventEmitter;this.onAnyMessage=this._onAnyMessage.event;this.msgChain=Promise.resolve(),this.sendChain=Promise.resolve(),this.receiveHooks=[],this.sendHooks=[]}patchSuperEmit(n){super.emit=n}send(n,i){this.sendHooks?this.sendChain=this.sendChain.then(()=>Promise.all(this.sendHooks.map(o=>o(n,i)))).then(()=>super.send(n,i)):super.send(n,i)}handleEvent(n,i,...o){return i==="message"&&this.receiveHooks.length?(this.msgChain=this.msgChain.then(()=>Promise.all(this.receiveHooks.map(s=>s(o[0])))).then(()=>n(i,...o)).catch(s=>O(`Exception while handling messages: ${s}`)),!0):n(i,...o)}emit(n,...i){return this.handleEvent((o,...s)=>super.emit(o,...s),n,...i)}addReceiveHook(n){this.receiveHooks.push(n)}removeReceiveHook(n){this.receiveHooks=this.receiveHooks.filter(i=>i!==n)}addSendHook(n){this.sendHooks.push(n)}removeSendHook(n){this.sendHooks=this.sendHooks.filter(i=>i!==n)}}}d();var Ys=new Map;var wS=class{getRequestCtor(e,t,n){class i extends Request{constructor(s,a){super(s,a);let l=this.headers;if(n){let c=n();Object.keys(c).forEach(f=>l.append(f,c[f].toString())),l.set("Content-Type","application/json");let p=l.append.bind(l);l.append=(f,m)=>{f.toLowerCase()!=="authorization"&&p(f,m)}}e&&this.headers.append("Cookie",e)}}return i}wrapWebSocketCtor(e){class t extends Wj(e){constructor(o,s){super(o,s);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let a,l=/.*\/kernels\/(.*)\/.*/.exec(o);l&&l.length>1&&(this.kernelId=l[1]),this.kernelId?(Ys.set(this.kernelId,this),this.onclose=()=>{a&&this.timer!==a&&clearInterval(a),Ys.get(this.kernelId)===this&&Ys.delete(this.kernelId)}):O("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener&&this.addEventListener("open",this.boundOpenHandler)}openHandler(){let o=this.onmessage;this.onmessage=s=>{this.handleEvent((a,...l)=>{let c={data:l[0],type:a.toString(),target:this};return o(c),!0},"message",s.data)},this.removeEventListener("open",this.boundOpenHandler)}}return t}getWebsocketCtor(e,t,n){class i extends Wj(FX.default){constructor(a,l){super(a,l);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let c,u=/.*\/kernels\/(.*)\/.*/.exec(a);u&&u.length>1&&(this.kernelId=u[1]),this.kernelId?(Ys.set(this.kernelId,this),this.onclose=()=>{c&&this.timer!==c&&clearInterval(c),Ys.get(this.kernelId)===this&&Ys.delete(this.kernelId)}):O("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener("open",this.boundOpenHandler)}openHandler(){let a=this.onmessage;this.onmessage=l=>{this.handleEvent((c,...u)=>{let p={data:u[0],type:c.toString(),target:this};return a(p),!0},"message",l.data)},this.removeEventListener("open",this.boundOpenHandler)}}return i}getFetchMethod(){return fetch}getHeadersCtor(){return Headers}getRequestInit(){return{cache:"no-store"}}};wS=E([(0,KX.injectable)()],wS);d();var zs=z(re());d();var $s=require("vscode");d();var R_e=["/bin/sh","/bin/bash","/bin/zsh"];function UX(r,e){let t=(r.argv||[]).some(n=>(n=n.toLowerCase(),R_e.some(i=>n.includes(i))));J("DATASCIENCE.KERNEL_SPEC_LANGUAGE",void 0,{language:r.language,kind:e,usesShell:t})}d();d();var xS="remoteKernelSpecCache.json";var A_e=2e3,lA=class extends aI{constructor(t,n,i,o,s,a,l,c,u,p){super();this.id=t;this.displayName=n;this.env=i;this.cachedRemoteKernelValidator=o;this.kernelProvider=a;this.serverProviderHandle=l;this.jupyterConnection=c;this.fs=u;this.context=p;this._status="idle";this._onDidChangeStatus=new $s.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.promiseMonitor=new Xb;this.kernelIdsToHide=new Set;this.kind="remote";this.cache=[];this._onDidChangeKernels=new $s.EventEmitter;this.onDidChangeKernels=this._onDidChangeKernels.event;this._onDidChange=new $s.EventEmitter;this.onDidChange=this._onDidChange.event;this.cacheFile=$s.Uri.joinPath(p.globalStorageUri,xS),this.cacheKey=zt(l),this._register(s.registerKernelFinder(this)),this._register(this._onDidChangeKernels.event(()=>this._onDidChange.fire(),this)),this._register(this._onDidChangeKernels),this._register(this._onDidChange),this._register(this._onDidChangeStatus),this._register(this.promiseMonitor)}get status(){return this._status}set status(t){this._status!==t&&(this._status=t,this._onDidChangeStatus.fire())}get lastError(){return this._lastError}get kernels(){return this.cache}get items(){return this.kernels}get title(){return this.displayName}dispose(){var t,n;super.dispose(),(t=this._cacheUpdateCancelTokenSource)==null||t.dispose(),(n=this.kernelDisposeDelayTimer)==null||n.dispose()}async activate(){this.promiseMonitor.onStateChange(()=>{this.status=this.promiseMonitor.isComplete?"idle":"discovering"}),this.loadCache().then(y,y),this._register(this.kernelProvider.onDidStartKernel(t=>{Ft(t.kernelConnectionMetadata)&&this.updateCache().then(y,y)},this)),this._register(this.kernelProvider.onDidDisposeKernel(t=>{var n;if(t&&Ft(t.kernelConnectionMetadata)){(n=this.kernelDisposeDelayTimer)==null||n.dispose();let i=setTimeout(()=>{this.updateCache().then(y,y)},A_e);return this.kernelDisposeDelayTimer=new $s.Disposable(()=>clearTimeout(i)),i}},this))}async refresh(){await this.loadCache(!0,!0)}getListOfKernelsWithCachedConnection(t,n=!1){return(!this.cachedConnection||n)&&(this.cachedConnection=this.getRemoteConnectionInfo(t)),this.cachedConnection.then(i=>i?(this.cachedConnection=Promise.resolve(i),this.listKernelsFromConnection(i)):Promise.resolve([])).catch(i=>this.isDisposed?Promise.reject(i):n?(this.cachedConnection=void 0,Promise.reject(i)):this.getListOfKernelsWithCachedConnection(t,!0))}async loadCache(t=!1,n=!1){Ie(`Remote Kernel Finder load cache Server: ${this.id}`);let i=(async()=>{let o=t?[]:await this.getFromCache(),s=[];if(!t&&Array.isArray(o)&&o.length>0)s=o,this.updateCache().then(y,y),this.loadCache(!0).then(y,y);else try{s=await this.getListOfKernelsWithCachedConnection(n),this._lastError=void 0}catch(a){a instanceof $s.CancellationError||(O("UniversalRemoteKernelFinder: Failed to get kernels without cache",a),this._lastError=a,this._onDidChange.fire())}await this.writeToCache(s)})();this.promiseMonitor.push(i),await i}async updateCache(){let t=(async()=>{var o;let n=[];(o=this._cacheUpdateCancelTokenSource)==null||o.dispose();let i=new $s.CancellationTokenSource;this._cacheUpdateCancelTokenSource=i;try{n=await this.getListOfKernelsWithCachedConnection(!1)}catch(s){ue(`Could not fetch kernels from the ${this.kind} server, falling back to cache: ${s}`),n=await this.getFromCache(i.token),n=n.filter(a=>a.kind==="connectToLiveRemoteKernel")}i.token.isCancellationRequested||await this.writeToCache(n)})();this.promiseMonitor.push(t),await t}async getRemoteConnectionInfo(t=!0){let n=[];return t&&n.push(Jt.createProgressReporter(void 0,_.connectingToJupyter)),this.jupyterConnection.createConnectionInfo(this.serverProviderHandle).finally(()=>he(n))}async getFromCache(t){try{if(t!=null&&t.isCancellationRequested)throw new $s.CancellationError;let n=this.cache;(!n||n.length===0)&&(n=await this.getCacheContents());let i=[],o=Promise.all(n.map(async s=>{await this.isValidCachedKernel(s)&&i.push(s)}));return await Js(t,o),i}catch(n){O("UniversalRemoteKernelFinder: Failed to get from cache",n)}return[]}async getCacheContents(){try{let t=await this.fs.readFile(this.cacheFile),n=JSON.parse(t);if(n.extensionVersion!==this.env.extensionVersion)return[];let i=n.data[this.cacheKey]||[];return Array.isArray(i)?i.map(o=>su.fromJSON(o)):[]}catch(t){return[]}}async listKernelsFromConnection(t){let n=[];try{let i=Xf.create(t.settings);n.push(i);let[o,s,a,l]=await Promise.all([i.getRunningKernels(),i.getKernelSpecs(),i.getRunningSessions(),H$(t.serverProviderHandle)]),c=s.map(f=>(UX(f,"remote"),Ux.create({kernelSpec:f,id:$R(f,void 0,l),baseUrl:t.baseUrl,serverProviderHandle:t.serverProviderHandle})));return[...a.map(f=>{var x,D;let m=f.kernel,h=m.last_activity?new Date(Date.parse(m.last_activity.toString())):new Date,g=m.connections?parseInt(m.connections.toString(),10):0,v=o.find(A=>{var w;return A.id===((w=f.kernel)==null?void 0:w.id)})||{},I=s.find(A=>{var w;return A.name===((w=f.kernel)==null?void 0:w.name)})||{};return Fx.create({kernelModel:{...f.kernel,...I,...v,name:((x=f.kernel)==null?void 0:x.name)||"",lastActivityTime:h,numberOfConnections:g,model:f},baseUrl:t.baseUrl,id:((D=f.kernel)==null?void 0:D.id)||"",serverProviderHandle:t.serverProviderHandle})}).filter(f=>!this.kernelIdsToHide.has(f.kernelModel.id||"")),...c]}catch(i){throw O(`Error fetching kernels from ${t.baseUrl} (${t.displayName}):`,i),i}finally{await Promise.all(n.map(i=>i.dispose().catch(y)))}}async writeToCache(t){try{q(`UniversalRemoteKernelFinder: Writing ${t.length} remote kernel connection metadata to cache`);let n=this.cache,i=new Map(n.map(f=>[f.id,f])),o=new Map(t.map(f=>[f.id,f])),s=t.filter(f=>!i.has(f.id)),a=t.filter(f=>i.has(f.id)&&!pB(f,i.get(f.id))),l=n.filter(f=>!o.has(f.id)),c=this.cacheKey;this.cache=n.filter(f=>o.has(f.id)).concat(s),this.cache.forEach(f=>{let m=o.get(f.id);f!==m&&m.kind==="connectToLiveRemoteKernel"&&f.kind==="connectToLiveRemoteKernel"&&f.updateModel(m.kernelModel)});let u=t.map(f=>f.toJSON()),p={extensionVersion:this.env.extensionVersion,data:{}};try{let f=await this.fs.readFile(this.cacheFile),m=JSON.parse(f);m.extensionVersion===this.env.extensionVersion&&(p=m)}catch(f){}p.data[c]=u,await this.fs.createDirectory(this.context.globalStorageUri).then(()=>this.fs.writeFile(this.cacheFile,JSON.stringify(p))).catch(f=>{O("Failed to cache the remote kernels.",f)}),(s.length||a.length||l.length)&&this._onDidChangeKernels.fire({removed:l})}catch(n){O("UniversalRemoteKernelFinder: Failed to write to cache",n)}}async isValidCachedKernel(t){switch(t.kind){case"startUsingRemoteKernelSpec":return!1;case"connectToLiveRemoteKernel":return this.cachedRemoteKernelValidator.isValid(t)}}};var cA=require("vscode");var tp=class{constructor(e,t,n,i,o,s,a,l,c,u){this.serverUriStorage=e;this.env=t;this.cachedRemoteKernelValidator=n;this.kernelFinder=i;this.kernelProvider=o;this.jupyterConnection=s;this.disposables=a;this.fs=l;this.context=c;this.jupyterServerProviderRegistry=u;this.serverFinderMapping=new Map;this.handledProviders=new WeakSet;this.mappedProviders=new WeakSet;this.mappedServers=new Set}activate(){this.serverUriStorage.onDidAdd(e=>this.validateAndCreateFinder(e),this,this.disposables),this.serverUriStorage.onDidChange(this.buildListOfFinders,this,this.disposables),this.serverUriStorage.onDidLoad(this.handleProviderChanges,this,this.disposables),this.serverUriStorage.onDidLoad(this.buildListOfFinders,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderHandleChanges,this,this.disposables),this.serverUriStorage.onDidRemove(this.urisRemoved,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderChanges,this,this.disposables),this.buildListOfFinders(),this.handleProviderChanges().catch(y)}buildListOfFinders(){this.serverUriStorage.all.map(e=>this.validateAndCreateFinder(e).catch(y))}handleProviderHandleChanges(){this.jupyterServerProviderRegistry.jupyterCollections.forEach(e=>{this.handledProviders.has(e)||(this.handledProviders.add(e),e.serverProvider.onDidChangeServers&&e.serverProvider.onDidChangeServers(this.buildListOfFinders,this,this.disposables))}),this.buildListOfFinders()}async handleProviderChanges(){if(!this.serverUriStorage.all.length)return;let e=new cA.CancellationTokenSource;this.disposables.push(e),await Promise.all(this.jupyterServerProviderRegistry.jupyterCollections.map(t=>{let n=t.serverProvider;if(!(!n||this.mappedProviders.has(n)))return this.mappedProviders.add(n),n!=null&&n.onDidChangeServers&&(n==null||n.onDidChangeServers(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables)),this.serverUriStorage.onDidLoad(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables),this.lookForServersInCollectionAndRemoveOldServers(t).catch(y)})),e.dispose()}async lookForServersInCollectionAndRemoveOldServers(e){if(!this.serverUriStorage.all.length)return;let t=new Set(this.serverUriStorage.all.map(o=>zt(o.provider))),n=e.serverProvider;if(!n)return;let i=new cA.CancellationTokenSource;try{let o=await Promise.resolve(n.provideJupyterServers(i.token)),s=new Set;(o||[]).forEach(a=>{let l={extensionId:e.extensionId,handle:a.id,id:e.id},c=zt(l);s.add(c),oA(l,a.label),!(this.mappedServers.has(c)||!t.has(c))&&(this.mappedServers.add(c),this.createRemoteKernelFinder(l,a.label))}),this.serverFinderMapping.forEach((a,l)=>{a.serverProviderHandle.extensionId===e.extensionId&&a.serverProviderHandle.id===e.id&&!s.has(zt(a.serverProviderHandle))&&(a.dispose(),this.serverFinderMapping.delete(l))})}catch(o){O(`Failed to get servers for Collection ${e.id} in ${e.extensionId}`,o)}finally{i.dispose()}}async validateAndCreateFinder(e){let t=zt(e.provider);if(this.serverFinderMapping.has(t))return;let n=new cA.CancellationTokenSource,i=async()=>{var c;let s=this.jupyterServerProviderRegistry.jupyterCollections.find(u=>u.extensionId===e.provider.extensionId&&u.id===e.provider.id);if(!s||!s.serverProvider)return;let a=await Promise.resolve(s.serverProvider.provideJupyterServers(n.token)),l=(c=a==null?void 0:a.find(u=>u.id===e.provider.handle))==null?void 0:c.label;l&&this.createRemoteKernelFinder(e.provider,l)},o=async()=>{var a;let s=await((a=this.jupyterServerProviderRegistry.jupyterCollections.find(l=>l.extensionId===e.provider.extensionId&&l.extensionId===fc&&l.id===e.provider.id))==null?void 0:a.label);s&&this.createRemoteKernelFinder(e.provider,s)};await Promise.all([i().catch(y),o().catch(y)]),n.dispose()}getOrCreateRemoteKernelFinder(e,t){let n=zt(e);if(!this.serverFinderMapping.has(n)){let i=new lA(`remote-${n}`,t,this.env,this.cachedRemoteKernelValidator,this.kernelFinder,this.kernelProvider,e,this.jupyterConnection,this.fs,this.context);this.disposables.push(i),this.serverFinderMapping.set(n,i),i.activate().then(y,y)}return this.serverFinderMapping.get(n)}createRemoteKernelFinder(e,t){this.getOrCreateRemoteKernelFinder(e,t)}urisRemoved(e){e.forEach(t=>{let n=zt(t),i=this.serverFinderMapping.get(n);i&&i.dispose(),this.serverFinderMapping.delete(n)})}dispose(){this.serverFinderMapping.forEach(e=>e.dispose())}};E([_n("Handle Jupyter Provider Changes")],tp.prototype,"handleProviderChanges",1),E([_n("Check Servers in Jupyter Server Provider")],tp.prototype,"lookForServersInCollectionAndRemoveOldServers",1),E([_n("Failed to create a Remote Kernel Finder")],tp.prototype,"validateAndCreateFinder",1),tp=E([(0,zs.injectable)(),b(0,(0,zs.inject)(yr)),b(1,(0,zs.inject)(AI)),b(2,(0,zs.inject)(s1)),b(3,(0,zs.inject)(di)),b(4,(0,zs.inject)($e)),b(5,(0,zs.inject)(bn)),b(6,(0,zs.inject)(oe)),b(7,(0,zs.inject)(Tt)),b(8,(0,zs.inject)(ut)),b(9,(0,zs.inject)(mr))],tp);d();var mm=z(re());d();var PS=require("vscode");var vA=z(iv());var wu=z(re());d();var uA=class extends ct{constructor(t){super("localjupyterserverconnection",_.jupyterNotebookFailure(t.message||t.toString()));this.originalError=t}};d();function qX(r){if(Sn()){let e=r;if(e&&e._futures){let t=e._futures;t.forEach&&t.forEach(n=>{n._status!==void 0&&(n._status|=4)})}e&&e._reconnectLimit&&(e._reconnectLimit=0)}}var DS=class extends ri{constructor(e){super(e.message,e)}};d();var pD=require("vscode");d();var ov=class extends xi{constructor(e){super("invalidkernel",_.kernelInvalid(ft(e)),e)}};d();var dA=class extends xi{constructor(e){super("timeout",_.jupyterLaunchTimedOut,e)}};async function pA(r,e,t,n,i){var a;if(!t.kernel)throw new ov(r);let o=Jt.reportProgress(e,_.waitingForJupyterSessionToBeIdle),s=[];o&&s.push(o);try{q(`Waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`);let l=Me();i.onCancellationRequested(()=>l.reject(new pD.CancellationError),void 0,s);let c=(m,h)=>{q(`Got status ${h} in waitForIdleOnSession`),h=="idle"&&l.resolve(h)};(a=t.kernel.statusChanged)==null||a.connect(c),s.push(new pD.Disposable(()=>aa(()=>{var m,h;return(h=(m=t.kernel)==null?void 0:m.statusChanged)==null?void 0:h.disconnect(c)}))),t.kernel.status=="idle"&&l.resolve(t.kernel.status);let u=Me(),p=()=>u.resolve("");t.disposed.connect(p,u),s.push(new pD.Disposable(()=>aa(()=>t.disposed.disconnect(p,u)))),u.promise.catch(y),l.promise.catch(y);let f=await So(n,"",l.promise,u.promise);if(t.isDisposed)throw O("Session disposed while waiting for session to be idle."),new ov(r);if(q(`Finished waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),f=="idle")return;throw O(`Shutting down after failing to wait for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),new dA(r)}catch(l){throw Ie("Error waiting for idle",l),l}finally{he(s)}}d();var gA=require("vscode");d();var Cu=z(Vi()),fA=require("vscode");var mA=class{constructor(e,t){this.kind=e;this.session=t;this.propertyChanged=new Cu.Signal(this);this.kernelChanged=new Cu.Signal(this);this.statusChanged=new Cu.Signal(this);this.connectionStatusChanged=new Cu.Signal(this);this.iopubMessage=new Cu.Signal(this);this.unhandledMessage=new Cu.Signal(this);this.anyMessage=new Cu.Signal(this);this.disposables=[];this.disposed=new Cu.Signal(this);this._disposed=new fA.EventEmitter;this.didShutdown=new fA.EventEmitter;this._onDidKernelSocketChange=new fA.EventEmitter;t.propertyChanged.connect(this.onPropertyChanged,this),t.kernelChanged.connect(this.onKernelChanged,this),t.statusChanged.connect(this.onStatusChanged,this),t.connectionStatusChanged.connect(this.onConnectionStatusChanged,this),t.iopubMessage.connect(this.onIOPubMessage,this),t.unhandledMessage.connect(this.onUnhandledMessage,this),t.anyMessage.connect(this.onAnyMessage,this),this.disposables.push({dispose:()=>{this.didShutdown.dispose(),this._disposed.dispose(),this.session.propertyChanged.disconnect(this.onPropertyChanged,this),this.session.kernelChanged.disconnect(this.onKernelChanged,this),this.session.statusChanged.disconnect(this.onStatusChanged,this),this.session.connectionStatusChanged.disconnect(this.onConnectionStatusChanged,this),this.session.iopubMessage.disconnect(this.onIOPubMessage,this),this.session.unhandledMessage.disconnect(this.onUnhandledMessage,this),this.session.anyMessage.disconnect(this.onAnyMessage,this)}})}get id(){return this.session.id}get path(){return this.session.path}get name(){return this.session.name}get type(){return this.session.type}get serverSettings(){return this.session.serverSettings}get model(){return this.session.model}get kernel(){return this.isDisposed||!this.session.kernel?null:this.session.kernel}get isDisposed(){return this._isDisposed===!0}get onDidDispose(){return this._disposed.event}get onDidShutdown(){return this.didShutdown.event}get kernelId(){var e,t;return((t=(e=this.session)==null?void 0:e.kernel)==null?void 0:t.id)||""}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}async disposeAsync(){this.dispose()}dispose(){var e;this.disposeInvoked||(this.statusChanged.emit("dead"),this._disposed.fire(),this.disposed.emit(),(e=this.previousAnyMessageHandler)==null||e.dispose(),he(this.disposables),Cu.Signal.disconnectAll(this))}async restart(){var e,t,n;await((e=this.session.kernel)==null?void 0:e.restart()),this.initializeKernelSocket(),De(`Restarted ${(n=(t=this.session)==null?void 0:t.kernel)==null?void 0:n.id}`)}initializeKernelSocket(){var t,n,i,o,s,a,l;if(!this.session.kernel)throw new Error("Kernel not initialized in Session");let e={kernel:this.session.kernel,options:{clientId:this.session.kernel.clientId,id:this.session.kernel.id,model:{...this.session.kernel.model},userName:this.session.kernel.username},socket:Ys.get(this.session.kernel.id)};JSON.stringify((t=this.previousKernelSocketInformation)==null?void 0:t.kernel.model)===JSON.stringify(e.kernel.model)&&((n=this.previousKernelSocketInformation)==null?void 0:n.kernel)===e.kernel&&((i=this.previousKernelSocketInformation)==null?void 0:i.kernel.id)===e.kernel.id&&((o=this.previousKernelSocketInformation)==null?void 0:o.socket)===e.socket||(this.previousKernelSocketInformation=e,(s=this.previousAnyMessageHandler)==null||s.dispose(),(a=this.session.kernel)==null||a.connectionStatusChanged.disconnect(this.onKernelConnectionStatusHandler,this),(l=this.session.kernel)==null||l.connectionStatusChanged.connect(this.onKernelConnectionStatusHandler,this),this._onDidKernelSocketChange.fire())}onPropertyChanged(e,t){this.propertyChanged.emit(t)}onKernelChanged(e,t){this.kernelChanged.emit(t)}onStatusChanged(e,t){this.statusChanged.emit(t);let n=this.status;Ie(`Server Status = ${n}`)}onConnectionStatusChanged(e,t){this.connectionStatusChanged.emit(t)}onIOPubMessage(e,t){this.iopubMessage.emit(t)}onUnhandledMessage(e,t){ue(`Unhandled message found: ${t.header.msg_type}`),this.unhandledMessage.emit(t)}onAnyMessage(e,t){this.anyMessage.emit(t)}setPath(e){return this.session.setPath(e)}setName(e){return this.session.setName(e)}setType(e){return this.session.setType(e)}changeKernel(e){return this.session.changeKernel(e)}onKernelConnectionStatusHandler(e,t){Ie(`Server Kernel Status = ${t}`)}};var hA=class extends mA{constructor(t,n,i,o,s){super(or(i)?"localJupyter":"remoteJupyter",t);this.resource=n;this.kernelConnectionMetadata=i;this.kernelService=o;this.creator=s;this.initializeKernelSocket()}get status(){var t,n;return this.isDisposed?"dead":(t=this.session)!=null&&t.kernel?this.session.kernel.status:(Ie(`Kernel status not started because real session is ${this.session?"defined":"undefined"} & real kernel is ${(n=this.session)!=null&&n.kernel?"defined":"undefined"}`),"unknown")}dispose(){var t,n;(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!1).catch(y)}async disposeAsync(){await this.shutdownImplementation(!1).catch(y),await super.disposeAsync()}async waitForIdle(t,n){try{await pA(this.kernelConnectionMetadata,this.resource,this.session,t,n)}catch(i){throw Ie("Error waiting for idle",i),await this.shutdown().catch(y),i}}async restart(){let t=[],n=new gA.CancellationTokenSource;this.restartToken=n;let i=new Er(!1);t.push(i),t.push(n);try{await this.validateLocalKernelDependencies(n.token,i),await super.restart()}finally{he(t)}}async validateLocalKernelDependencies(t,n){var i;if(!(!((i=this.kernelConnectionMetadata)!=null&&i.interpreter)||!or(this.kernelConnectionMetadata)||!this.kernelService)){if(t.isCancellationRequested)throw new gA.CancellationError;await this.kernelService.ensureKernelIsUsable(this.resource,this.kernelConnectionMetadata,n,t,this.creator==="3rdPartyExtension")}}async shutdown(){var t,n;return(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!0)}async shutdownImplementation(t){var o;if(this._isDisposed)return;this._isDisposed=!0;let n=(new Error().stack||"").split(`
`).filter(s=>s.includes(Xe));q(`Shutdown session - current session, called from 
 ${n.map(s=>`    ${s}`).join(`
`)}`);let i=`${(o=this.session.kernel)==null?void 0:o.id}, ${this.kernelConnectionMetadata.id}`;q(`shutdownSession ${i} - start`);try{if(t||this.canShutdownSession())try{q(`Session can be shutdown ${this.kernelConnectionMetadata.id}`),qX(this.session.kernel),this.session.isDisposed||await So(1e3,this.session.shutdown().catch(y))}catch(s){try{this.session.isDisposed||this.session.dispose()}catch(a){ue("Failures in disposing the session",a)}}finally{this.didShutdown.fire()}else q(`Session cannot be shutdown ${this.kernelConnectionMetadata.id}`);try{this.session.isDisposed||this.session.dispose()}catch(s){ue("Failures in disposing the session",s)}super.dispose(),q("Shutdown session -- complete")}catch(s){ue("Failures in disposing the session",s)}q(`shutdownSession ${i} - shutdown complete`)}canShutdownSession(){return or(this.kernelConnectionMetadata)?!0:this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?!1:this.resource&&zl(this.resource)==="interactive"?!0:!(this.resource&&zl(this.resource)==="notebook"&&Ft(this.kernelConnectionMetadata))}};var rp=class{constructor(e,t,n,i,o){this.jupyterNotebookProvider=e;this.jupyterConnection=t;this.asyncDisposables=n;this.kernelService=i;this.configService=o}async create(e){let t=[],n,i=()=>{e.ui.disableUI||n||(n=Jt.createProgressReporter(e.resource,Ft(e.kernelConnection)?_.connectingToJupyter:_.startingJupyter),t.push(n))};e.ui.disableUI&&e.ui.onDidChangeDisableUI(i,this,t),i();let o,s=[],a=this.configService.getSettings(e.resource).jupyterLaunchTimeout;try{o=Ft(e.kernelConnection)?await ys(e.token,this.jupyterConnection.createConnectionInfo(e.kernelConnection.serverProviderHandle)):await this.jupyterNotebookProvider.getOrStartServer({resource:e.resource,token:e.token,ui:e.ui}),await ys(e.token,this.validateLocalKernelDependencies(e));let l=Xf.create(o.settings);this.asyncDisposables.push(l),s.push(new PS.Disposable(()=>l.dispose().catch(y))),await ys(e.token,this.validateRemoteServer(e,l));let c=await this.connectToOrCreateSession({...e,contentsManager:l.contentsManager,sessionManager:l.sessionManager,kernelManager:l.kernelManager,kernelSpecManager:l.kernelSpecManager,idleTimeout:a,connection:o});e.token.isCancellationRequested&&(await c.shutdown().catch(y),aa(()=>c.dispose())),du.throwIfCanceled(e.token),De(`Started session for kernel ${e.kernelConnection.kind}:${e.kernelConnection.id}`);let u=new hA(c,e.resource,e.kernelConnection,this.kernelService,e.creator),p=c.disposed,f=()=>{l.dispose().catch(y),p.disconnect(f)};this.asyncDisposables.push({dispose:()=>u.shutdown().finally(()=>u.dispose())}),c.disposed.connect(f);let m=u.onDidDispose(f);return this.asyncDisposables.push(m),u}catch(l){throw he(s),Ft(e.kernelConnection)?o?Hs.isSelfCertsError(l)?new Hs(o.baseUrl):lu.isSelfCertsExpiredError(l)?new lu(o.baseUrl):new mo(o.baseUrl,e.kernelConnection.serverProviderHandle,l):l:l instanceof ct?l:new uA(l)}finally{he(t)}}async validateRemoteServer(e,t){if(t.isDisposed)throw new sn;if(!or(e.kernelConnection))try{await Promise.all([t.getRunningKernels(),t.getKernelSpecs()])}catch(n){throw O("Failed to fetch running kernels from remote server, connection may be outdated or remote server may be unreachable",n),new mo(e.kernelConnection.baseUrl,e.kernelConnection.serverProviderHandle,n)}}async validateLocalKernelDependencies(e){var t;if(e.token.isCancellationRequested)throw new PS.CancellationError;(t=e.kernelConnection)!=null&&t.interpreter&&or(e.kernelConnection)&&this.kernelService&&await this.kernelService.ensureKernelIsUsable(e.resource,e.kernelConnection,e.ui,e.token,e.creator==="3rdPartyExtension")}async connectToOrCreateSession(e){var n;if(e.token.isCancellationRequested)throw new PS.CancellationError;let t;try{if(e.kernelConnection&&e.kernelConnection.kind==="connectToLiveRemoteKernel"&&e.kernelConnection.kernelModel.id&&e.kernelConnection.kernelModel.model){if(!e.kernelConnection.kernelModel.model)throw new Error("Kernel model not defined when connecting to an existing session");t=e.sessionManager.connectTo({...e.kernelConnection.kernelModel,model:e.kernelConnection.kernelModel.model}),await ys(e.token,dP(async()=>{var i;return((i=t.kernel)==null?void 0:i.connectionStatus)==="connected"||e.token.isCancellationRequested},e.idleTimeout,100))}else q(`createNewKernelSession ${(n=e.kernelConnection)==null?void 0:n.id}`),t=await this.createNewSession(e),await pA(e.kernelConnection,e.resource,t,e.idleTimeout,e.token).catch(y);if(e.token.isCancellationRequested)throw new PS.CancellationError;return t}catch(i){let o=e.ui.disableUI?q:O;throw i instanceof ct?(o("Failed to change kernel, re-throwing",i),i):(o("Failed to change kernel",i),new ov(e.kernelConnection))}}async createNewSession(e){var a,l,c,u,p,f;let t=(e.connection,e.resource,void 0),n=t==null?void 0:t.path,i=(u=(c=iz(e.kernelConnection))!=null?c:(l=(a=e.kernelSpecManager)==null?void 0:a.specs)==null?void 0:l.default)!=null?u:"",o;if(t!=null&&t.name)o=t.name;else{let m=e.resource?$v(e.resource):"";o=`${e.resource?yi(e.resource,m):""}-${(0,vA.default)()}${m}`}let s={path:n||W_e(e.resource),kernel:{name:i},name:o,type:(((p=e.resource)==null?void 0:p.path)||"").toLowerCase().endsWith(".ipynb")?"notebook":"console"};try{let m=await ys(e.token,e.sessionManager.startNew(s,{kernelConnectionOptions:{handleComms:!0}}));if(!m.kernel)throw new DS(new Error("No kernel created"));return De(_.createdNewKernel(e.connection.baseUrl,((f=m==null?void 0:m.kernel)==null?void 0:f.id)||"")),m}catch(m){throw m instanceof DS?m:new DS(m)}}};rp=E([(0,wu.injectable)(),b(0,(0,wu.inject)(n1)),b(1,(0,wu.inject)(bn)),b(2,(0,wu.inject)(_o)),b(3,(0,wu.inject)(i1)),b(3,(0,wu.optional)()),b(4,(0,wu.inject)(Ke))],rp);function U_e(){return`${$f}${(0,vA.default)()}`}function W_e(r){let e=`${U_e()}${(0,vA.default)()}.ipynb`;return r?`${yi(r,".ipynb")}${e}`:`${_.defaultNotebookName}${e}`}var TS=class{constructor(e,t,n){this.rawKernelSupported=e;this.newRawKernelSessionFactory=t;this.newJupyterSessionFactory=n}async create(e){let t=e.kernelConnection;return this.rawKernelSupported.isSupported&&or(t)&&this.newRawKernelSessionFactory?this.newRawKernelSessionFactory.create({...e,kernelConnection:t}):this.newJupyterSessionFactory.create(e)}};TS=E([(0,mm.injectable)(),b(0,(0,mm.inject)(ep)),b(1,(0,mm.inject)(wX)),b(1,(0,mm.optional)()),b(2,(0,mm.inject)(rp))],TS);d();var fD=Symbol("RemoteKernelFinderController");function GX(r,e){r.addSingleton(tc,tc),r.addSingleton(i1,rv),r.addSingleton(yr,_S),r.addSingleton(Vx,TS),r.addSingleton(rp,rp),r.addSingleton(n1,SS),r.addSingleton(Qg,wS),r.addSingleton(bn,bn),r.addSingleton(Xg,ES),r.addBinding(Xg,He),r.addSingleton(s1,IS),r.addSingleton(Pn,bS),r.addSingleton(fD,tp),r.addBinding(fD,He),r.addSingleton(mr,RI)}var uZ=z(re());d();var In=z(re());d();var qi=require("vscode");var yA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.executions=new WeakMap;this.kernelsByNotebook=new WeakMap;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new qi.EventEmitter;this._onDidStartKernel=new qi.EventEmitter;this._onDidCreateKernel=new qi.EventEmitter;this._onDidDisposeKernel=new qi.EventEmitter;this._onKernelStatusChanged=new qi.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),qi.workspace.onDidCloseNotebookDocument(n=>this.disposeOldKernel(n),this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel)}get kernels(){let e=new Set;return qi.workspace.notebookDocuments.forEach(t=>{let n=this.get(t);n&&e.add(n)}),Array.from(e)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get(e){var t,n;if(kn(e)){let i=qi.workspace.notebookDocuments.find(o=>o.uri.toString()===e.toString());return i?this.get(i):void 0}else return typeof e=="string"?(t=this.kernelsById.get(e))==null?void 0:t.kernel:(n=this.kernelsByNotebook.get(e))==null?void 0:n.kernel}getKernelExecution(e){return this.executions.get(e)}getInternal(e){return this.kernelsByNotebook.get(e)}async dispose(){Ie("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByNotebook.set(e,{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e){e.onDisposed(()=>{this.get(e.notebook)===e&&(this.kernelsByNotebook.delete(e.notebook),this.kernelsById.delete(e.id),q(`Kernel got disposed, hence there is no longer a kernel associated with ${Se(e.uri)}`)),this.pendingDisposables.delete(e)},this,this.disposables)}disposeOldKernel(e){let t=this.kernelsByNotebook.get(e);t&&(q(`Disposing kernel associated with ${Se(e.uri)}, isClosed=${e.isClosed}`),this.kernelsById.delete(t.kernel.id),this.pendingDisposables.add(t.kernel),t.kernel.dispose().catch(n=>ue("Failed to dispose old kernel",n)).finally(()=>this.pendingDisposables.delete(t.kernel)).catch(y)),this.kernelsByNotebook.delete(e)}handleServerRemoval(e){qi.workspace.notebookDocuments.forEach(t=>{let n=this.kernelsByNotebook.get(t);if(n){let i=n.options.metadata;(i.kind==="connectToLiveRemoteKernel"||i.kind==="startUsingRemoteKernelSpec")&&e.find(s=>s.id===i.serverProviderHandle.id&&s.handle===i.serverProviderHandle.handle)&&(this.kernelsByNotebook.delete(t),this.kernelsById.delete(n.kernel.id))}})}},bA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.kernelsByUri=new Map;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new qi.EventEmitter;this._onDidStartKernel=new qi.EventEmitter;this._onDidCreateKernel=new qi.EventEmitter;this._onDidDisposeKernel=new qi.EventEmitter;this._onKernelStatusChanged=new qi.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),qi.workspace.onDidCloseNotebookDocument(n=>{q(`Notebook document ${Se(n.uri)} got closed`),this.disposeOldKernel(n.uri)},this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel)}get kernels(){return Array.from(this.kernelsByUri.values()).map(e=>e.kernel)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get(e){var t,n;return((t=this.kernelsByUri.get(e.toString()))==null?void 0:t.kernel)||((n=this.kernelsById.get(e.toString()))==null?void 0:n.kernel)}getInternal(e){return this.kernelsByUri.get(e.toString())}async dispose(){Ie("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByUri.set(e.toString(),{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e,t){t.onDisposed(()=>{this.get(e)===t&&(this.kernelsByUri.delete(e.toString()),this.kernelsById.delete(t.id),q(`Kernel got disposed, hence there is no longer a kernel associated with ${Se(e)}`)),this.pendingDisposables.delete(t)},this,this.disposables)}disposeOldKernel(e){let t=this.kernelsByUri.get(e.toString());t&&(Ie(`Disposing kernel associated with ${Se(e)}`),this.kernelsById.delete(t.kernel.id),this.pendingDisposables.add(t.kernel),t.kernel.dispose().catch(n=>ue("Failed to dispose old kernel",n)).finally(()=>this.pendingDisposables.delete(t.kernel)).catch(y)),this.kernelsByUri.delete(e.toString())}};d();var Jj=z(iv()),Ur=require("vscode");d();async function mD(r,e){if(!r)return;let t=el(r),[n,i]=J0.get(t)||[{resourceType:zl(r),resourceHash:r?await Ot(r.toString()):void 0,kernelSessionId:await Ot(Date.now().toString()),capturedEnvVars:void 0,userExecutedCell:void 0,disableUI:void 0,kernelLanguage:void 0,kernelId:void 0,kernelSpecHash:void 0,isUsingActiveInterpreter:void 0,pythonEnvironmentType:void 0,pythonEnvironmentPath:void 0,pythonEnvironmentVersion:void 0,kernelConnectionType:void 0},{previouslySelectedKernelConnectionId:""}];typeof e.capturedEnvVars=="boolean"&&(n.capturedEnvVars=e.capturedEnvVars),e.userExecutedCell&&(n.userExecutedCell=!0),typeof e.disableUI=="boolean"&&(n.disableUI=e.disableUI);let o=e.kernelConnection;if(o){let s=o.id;i.previouslySelectedKernelConnectionId!==s&&(n.userExecutedCell=e.userExecutedCell,n.disableUI=e.disableUI),i.previouslySelectedKernelConnectionId&&i.previouslySelectedKernelConnectionId!==s&&(n.kernelSessionId=await Ot(Date.now().toString()));let a;switch(o.kind){case"connectToLiveRemoteKernel":a=o.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":a=o.kernelSpec.language;break;case"startUsingPythonInterpreter":a=Qe;break;default:break}let l="kernelSpec"in o&&o.kernelSpec.specFile?Ot(o.kernelSpec.specFile):Promise.resolve("");n.kernelLanguage=a,[n.kernelId,n.kernelSpecHash]=await Promise.all([Ot(o.id),l]),i.previouslySelectedKernelConnectionId=o.id;let c=o.interpreter;if(c){n.isUsingActiveInterpreter=nc.isActiveWorkspaceInterpreter(r,c),n.pythonEnvironmentType=Or(c);let[u,p]=await Promise.all([Ot(pt(Gc(c.uri))),Op(c)]);n.pythonEnvironmentPath=u,CW.set(n.pythonEnvironmentPath,c),p?n.pythonEnvironmentVersion=`${p.major}.${p.minor}.${p.micro}`:n.pythonEnvironmentVersion=void 0,wW(n)}n.kernelConnectionType=n.kernelConnectionType||(o==null?void 0:o.kind)}else i.previouslySelectedKernelConnectionId="";J0.set(t,[n,i])}async function Wa(r,e){await mD(r,{kernelConnection:e,userExecutedCell:!0})}var zX=z(J1());d();var Hj="KERNEL_INFO",V_e=1e3*60*60*24*2;async function $X(r,e,t){var a;let n=[],i={banner:"",help_links:[],implementation:"",implementation_version:"",language_info:{name:"",version:""},protocol_version:"",status:"ok"};if(!r.kernel)return;(a=r.kernel)!=null&&a.info&&(n.push(r.kernel.info),r.kernel.info.then(l=>YX(t,e,l)).catch(y));let o=r.kernel.requestKernelInfo().then(l=>l==null?void 0:l.content);if(n.push(o),o.then(l=>YX(t,e,l)).catch(y),e.kind==="connectToLiveRemoteKernel"){let l=j_e(t,e);l?n.push(Promise.resolve(l)):n.push(mc(5e3).then(()=>i))}let s=await Promise.race(n);return s===i?ue("Failed to Kernel info in a timely manner, defaulting to empty info!"):q("Got Kernel info"),s}async function YX(r,e,t){if(!t||!Ft(e))return;let n=r.get(Hj,[]).filter(i=>Date.now()-i.age<V_e).filter(i=>i.id!==e.id);n.push({id:e.id,age:Date.now(),info:t}),await r.update(Hj,n)}function j_e(r,e){var t;if(Ft(e))return(t=r.get(Hj,[]).find(n=>n.id===e.id))==null?void 0:t.info}d();var IA=class extends xi{constructor(e){super("kernelpromisetimeout",_.interruptingKernelFailed,e)}};var SA="e976ee50-99ed-4aba-9b6b-9dcd5634d07d:IPyWidgets:";function wA(r){let e=typeof r=="string"?r:"";return typeof r!="string"&&"content"in r&&"code"in r.content&&typeof r.content.code=="string"&&(e=r.content.code),!e.includes(SA)}function xA(r){var e,t,n,i;return r.status==="dead"||r.status==="terminating"&&!r.disposed&&!r.disposing||!r.disposed&&!r.disposing&&(((e=r.session)==null?void 0:e.status)=="unknown"||((n=(t=r.session)==null?void 0:t.kernel)==null?void 0:n.status)=="unknown")&&(((i=r.session.kernel)==null?void 0:i.isDisposed)||r.session.isDisposed)}function QX(r){var e,t;return r.status==="dead"||r.status==="terminating"&&!r.isDisposed||!r.isDisposed&&(r.status=="unknown"||((e=r.kernel)==null?void 0:e.status)=="unknown")&&(((t=r.kernel)==null?void 0:t.isDisposed)||r.isDisposed)}var _A=class{constructor(e,t,n,i,o,s,a,l,c){this.id=e;this.uri=t;this.resourceUri=n;this.kernelConnectionMetadata=i;this.sessionCreator=o;this.kernelSettings=s;this.startupCodeProviders=a;this._creator=l;this.workspaceMemento=c;this.disposables=[];this._onIPyWidgetVersionResolved=new Ur.EventEmitter;this._onDidKernelSocketChange=new Ur.EventEmitter;this._onStatusChanged=new Ur.EventEmitter;this._onRestarted=new Ur.EventEmitter;this._onStarted=new Ur.EventEmitter;this._onDisposed=new Ur.EventEmitter;this.hookedSessionForEvents=new WeakSet;this.hooks=new Map;this.startCancellation=new Ur.CancellationTokenSource;this.startupUI=new Er(!0);this.disposables.push(this._onStatusChanged),this.disposables.push(this._onRestarted),this.disposables.push(this._onStarted),this.disposables.push(this._onDisposed),this.disposables.push(this._onIPyWidgetVersionResolved),this.disposables.push(this._onDidKernelSocketChange),mD(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,disableUI:this.startupUI.disableUI}).catch(y),this.startupUI.onDidChangeDisableUI(()=>{this.startupUI.disableUI||mD(this.resourceUri,{disableUI:!1}).catch(y)},this.disposables)}get ipywidgetsVersion(){return this._ipywidgetsVersion}get onIPyWidgetVersionResolved(){return this._onIPyWidgetVersionResolved.event}get onStatusChanged(){return this._onStatusChanged.event}get onRestarted(){return this._onRestarted.event}get onStarted(){return this._onStarted.event}get onDisposed(){return this._onDisposed.event}get creator(){return this._creator}get startedAtLeastOnce(){return this._startedAtLeastOnce}get info(){return this._info}get status(){var e,t;return this._jupyterSessionPromise&&!this._session?"starting":(t=(e=this._session)==null?void 0:e.status)!=null?t:this.isKernelDead?"dead":"unknown"}get disposed(){var e;return this._disposed===!0||((e=this._session)==null?void 0:e.isDisposed)===!0}get disposing(){return this._disposing===!0}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}get session(){return this._session}get restarting(){return this._restartPromise||Promise.resolve()}addHook(e,t,n,i){let o=this.hooks.get(e)||new Set;this.hooks.set(e,o),t=n?t.bind(n):t,o.add(t);let s={dispose:()=>{o.delete(t)}};return i&&i.push(s),s}async start(e){return this.startCancellation.token.isCancellationRequested&&(this.startCancellation.dispose(),this.startCancellation=new Ur.CancellationTokenSource),this.startJupyterSession(e)}async interrupt(){let e=Promise.all(Array.from(this.hooks.get("willInterrupt")||new Set).map(n=>n()));De(`Interrupt requested ${Se(this.resourceUri||this.uri)}`);let t;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;De("Interrupt kernel execution"),n?(t=this._interruptPromise?await this._interruptPromise:await(this._interruptPromise=this.interruptExecution(n,e)),this._interruptPromise=void 0):(De("No kernel session to interrupt"),this._interruptPromise=void 0,t="success")}finally{await Promise.all(Array.from(this.hooks.get("interruptCompleted")||new Set).map(n=>n())).catch(y)}if(De(`Interrupt requested & sent for ${Se(this.uri)} in notebookEditor.`),t==="timeout"){let n=_.restartKernelAfterInterruptMessage(ft(this.kernelConnectionMetadata)),i=_.restartKernelMessageYes;await Ur.window.showInformationMessage(n,{modal:!0},i)===i&&await this.restart()}}async dispose(){if(De(`Dispose Kernel '${Se(this.uri)}' associated with '${Se(this.resourceUri)}'`),this._disposing=!0,this.disposingPromise)return this.disposingPromise;this._ignoreJupyterSessionDisposedErrors=!0,this.startCancellation.cancel();let e=async()=>{let t=[];t.push(Promise.all(Array.from(this.hooks.get("willCancel")||new Set).map(n=>n())).then(y).catch(y)),this._session=this._session?this._session:this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0,this._jupyterSessionPromise=void 0,this._session&&(t.push(this._session.disposeAsync().catch(y)),this._session=void 0),this._disposed=!0,this._onDisposed.fire(),this._onStatusChanged.fire("dead");try{await Promise.all(t)}finally{this.startCancellation.dispose(),he(this.disposables)}};this.disposingPromise=e(),await this.disposingPromise}async restart(){try{let e=zl(this.resourceUri);De(`Restart requested ${Se(this.uri)}`),await Promise.all(Array.from(this.hooks.get("willRestart")||new Set).map(n=>n(this._jupyterSessionPromise))),this.startCancellation.cancel(),this.startCancellation.dispose();let t=new Mt;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;n?(this._restartPromise||(this._restartPromise=n.restart(),this._restartPromise.finally(()=>this._restartPromise=void 0).catch(y)),await this._restartPromise,this.startCancellation=new Ur.CancellationTokenSource):await this.start(new Er(!1)),Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},{resourceType:e})}catch(n){O(`Restart failed ${Se(this.uri)}`,n),this._ignoreJupyterSessionDisposedErrors=!0;let i=this._session;throw this._session=void 0,this._jupyterSessionPromise=void 0,Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},void 0,n),await(i==null?void 0:i.disposeAsync().catch(y)),this._ignoreJupyterSessionDisposedErrors=!1,n}await this.initializeAfterStart(this._session),this._onRestarted.fire()}catch(e){throw O(`Failed to restart kernel ${Se(this.uri)}`,e),e}finally{Promise.all(Array.from(this.hooks.get("restartCompleted")||new Set).map(e=>e())).catch(y)}}async startJupyterSession(e=new Er(!1)){this._startedAtLeastOnce=!0,e.disableUI||(this.startupUI.disableUI=!1),e.onDidChangeDisableUI(()=>{!e.disableUI&&this.startupUI.disableUI&&(this.startupUI.disableUI=!1)});let t=Ur.workspace.notebookDocuments.find(n=>n.uri.toString()===this.uri.toString());if(this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||Wa(this.resourceUri,this.kernelConnectionMetadata).catch(y)},this,this.disposables),this.disposing)throw new Ur.CancellationError;if(du.throwIfCanceled(this.startCancellation.token),!this._jupyterSessionPromise){let n=new Mt,i=async()=>{var s;let o=t?(s=Qc(t))==null?void 0:s.jupyterSessionTelemetry():void 0;if(await mD(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,userExecutedCell:!this.startupUI.disableUI}),this.disposing)throw new Ur.CancellationError;o==null||o.stop(),du.throwIfCanceled(this.startCancellation.token)};this._jupyterSessionPromise=i().then(()=>this.createJupyterSession()).then(o=>(Rr(this.resourceUri,"DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",{duration:n.elapsedTime}),o)).catch(o=>{throw Ie(`Failed to create Jupyter Session in Kernel.startNotebook for ${Se(this.uri)}`),this.startCancellation.cancel(),this._jupyterSessionPromise=void 0,o})}return this._jupyterSessionPromise.finally(()=>this.sendKernelStartedTelemetry()).catch(y),this._jupyterSessionPromise}async interruptExecution(e,t){let n=Me(),i=new Mt,o=[],s=c=>{(c==="restarting"||c==="autorestarting")&&(ue("Kernel restarting during interrupt"),n.resolve(!0))},a=(c,u)=>s(u);return e.statusChanged.connect(a),o.push(new Ur.Disposable(()=>aa(()=>e.statusChanged.disconnect(a)))),e&&e.kernel&&(De(`Interrupting kernel: ${e.kernel.name}`),await Hv(this.kernelSettings.interruptTimeout,new IA(this.kernelConnectionMetadata),e.kernel.interrupt()).catch(c=>{ue(`Error during interrupt: ${c}`),n.resolve(!0)})),(async()=>{let c=Me();this.status==="busy"&&(this.onDisposed(()=>c.resolve("dead"),this,o),this.onStatusChanged(()=>this.status==="dead"?c.resolve("dead"):void 0,this,o));try{return await So(this.kernelSettings.interruptTimeout,"timeout",t.then(()=>"success"),n.promise.then(()=>"restart"),c.promise)}catch(u){if(n.completed)return"restart";throw Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},void 0,u),u}finally{he(o)}})().then(c=>(Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},{result:c}),c))}async createJupyterSession(){if(this.disposing)throw new Ur.CancellationError;du.throwIfCanceled(this.startCancellation.token);let e=[];try{let t="",n=this.kernelConnectionMetadata.interpreter;if(n){let o=[];o.push(`Python Path: ${Se(n.uri)}`),o.push(n?Or(n):""),o.push(sl(n)||"");let s=$u(n);s&&o.push(`${s.major}.${s.minor}.${s.micro}`),t=` (${o.filter(a=>a).join(", ")})`}De(`Starting Kernel ${this.kernelConnectionMetadata.kind}, ${this.kernelConnectionMetadata.id} ${t} for '${Se(this.uri)}' (disableUI=${this.startupUI.disableUI})`),this.createProgressIndicator(e),this.isKernelDead=!1,this._onStatusChanged.fire("starting");let i=await this.sessionCreator.create({resource:this.resourceUri,ui:this.startupUI,kernelConnection:this.kernelConnectionMetadata,token:this.startCancellation.token,creator:this.creator});if(this.disposing)throw new Ur.CancellationError;if(du.throwIfCanceled(this.startCancellation.token),await this.initializeAfterStart(i),this.disposing)throw new Ur.CancellationError;return this.sendKernelStartedTelemetry(),this._session=i,this._onStarted.fire(),i}catch(t){if(this.startupUI.disableUI?q(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,t):!this.startCancellation.token&&!Di(t)&&O(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,t),du.throwIfCanceled(this.startCancellation.token),t instanceof Kp)throw t;let n=_.sessionStartFailedWithKernel(ft(this.kernelConnectionMetadata));throw ri.from(n+" "+("message"in t?t.message:t.toString()),t)}finally{he(e)}}sendKernelStartedTelemetry(){this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent&&this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent===this.startupUI.disableUI||this.startTelemetrySent&&!this.startupUI.disableUI||(this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent=this.startupUI.disableUI===!0,this.startTelemetrySent=!0,Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:this.startupUI.disableUI}))}createProgressIndicator(e){let t=Jt.createProgressReporter(this.resourceUri,_.connectingToKernel(ft(this.kernelConnectionMetadata)),this.startupUI.disableUI);e.push(t),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||t.show&&t.show()},this,e)}async initializeAfterStart(e){var o;let t=Ur.workspace.notebookDocuments.find(s=>s.uri.toString()===this.uri.toString()),n=Qc(t),i=t?n==null?void 0:n.postKernelStartup():void 0;try{if(await Promise.all(Array.from(this.hooks.get("didStart")||new Set).map(l=>l(e,this.startCancellation.token).catch(y))),q(`Started running kernel initialization for ${Se(this.uri)}`),!e){q("Not running kernel initialization");return}if(!this.hookedSessionForEvents.has(e)){this.hookedSessionForEvents.add(e),e.onDidKernelSocketChange(c=>this._onDidKernelSocketChange.fire(c)),e.onDidDispose(()=>{if(Ie(`Kernel got disposed as a result of session.onDisposed (1) ${Se(this.resourceUri||this.uri)}`),!this._ignoreJupyterSessionDisposedErrors){De(`Kernel got disposed as a result of session.onDisposed ${Se(this.resourceUri||this.uri)} & _ignoreJupyterSessionDisposedErrors = false.`);let c=this._session===e;this._jupyterSessionPromise=void 0,this._session=void 0,c&&(this.isKernelDead=!0,this._onStatusChanged.fire("dead"))}});let l=(c,u)=>this._onStatusChanged.fire(u);e.statusChanged.connect(l),this.disposables.push(new Ur.Disposable(()=>aa(()=>e.statusChanged.disconnect(l))))}if((o=e.kernel)==null||o.registerCommTarget(st.DefaultCommTarget,y),this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel")this.determineVersionOfIPyWidgets(e).catch(l=>O("Failed to determine IPyWidget version",l)),this.gatherInternalStartupCode().then(l=>this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"})).catch(l=>O("Failed to execute internal startup code",l));else{await this.determineVersionOfIPyWidgets(e);let l=await this.gatherInternalStartupCode();await this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"}),await this.executeSilently(e,this.getUserStartupCommands(),{traceErrors:!1})}i==null||i.stop();let s=n==null?void 0:n.kernelInfo();try{q("Requesting Kernel info"),this._info=await $X(e,this.kernelConnectionMetadata,this.workspaceMemento)}catch(l){ue("Failed to request KernelInfo",l)}s==null||s.stop();let a=n==null?void 0:n.kernelIdle();this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&(q("End running kernel initialization, now waiting for idle"),await e.waitForIdle(this.kernelSettings.launchTimeout,this.startCancellation.token),q("End running kernel initialization, session is idle")),a==null||a.stop()}finally{i==null||i.stop()}}async determineVersionOfIPyWidgets(e){var n;if(!Qt(this.kernelConnectionMetadata)){this._ipywidgetsVersion==WE,this._onIPyWidgetVersionResolved.fire(WE);return}let t=async()=>{let i=zX.default`
        try:
            import ipywidgets as _VSCODE_ipywidgets
            print("${SA}" + _VSCODE_ipywidgets.__version__)
            del _VSCODE_ipywidgets
        except:
            pass
        `,o=await this.executeSilently(e,[i]).catch(s=>O("Failed to determine version of IPyWidgets",s));if(Array.isArray(o)){let s=o.some(c=>{var u;return(u=c.text||"")==null?void 0:u.toString().includes(`${SA}8.`)}),a=o.some(c=>{var u;return(u=c.text||"")==null?void 0:u.toString().includes(`${SA}7.`)}),l=this._ipywidgetsVersion=a?7:s?8:void 0;q(`Determined IPyWidgets Version as ${l}`),this._ipywidgetsVersion==l,this._onIPyWidgetVersionResolved.fire(l)}else ue("Failed to determine IPyKernel Version",JSON.stringify(o))};if(await t(),!this._ipywidgetsVersion&&((n=this.session)!=null&&n.kernel)){let i=(o,s)=>{var l;if(s.direction==="send")return;let a=s.msg;a.content&&"data"in a.content&&a.content.data&&(a.content.data[Io]||"target_name"in a.content&&a.content.target_name===st.DefaultCommTarget)&&(this._ipywidgetsVersion||(t().catch(y),(l=this.session)!=null&&l.kernel&&this.session.kernel.anyMessage.disconnect(i,this)))};this.session.kernel.anyMessage.connect(i,this)}}async gatherInternalStartupCode(){let e=[],t=await Promise.all(this.startupCodeProviders.sort((n,i)=>i.priority-n.priority).map(n=>n.getCode(this)));for(let n of t)e.push(...n);if(Qt(this.kernelConnectionMetadata)&&this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"){let n=pt(this.resourceUri);n&&e.push(`__vsc_ipynb_file__ = "${n.replace(/\\/g,"\\\\")}"`),this.kernelSettings.enableExtendedPythonKernelCompletions||e.push(OE.DisableJedi),e.push(...B_e(this.getMatplotLibInitializeCode(),"Failed to initialize matplotlib startup code. Matplotlib might be missing."))}return e}getMatplotLibInitializeCode(){let e=[];if(this.kernelSettings.themeMatplotlibPlots){Ie(`Initialize config for plots for ${Se(this.resourceUri||this.uri)}`);let t=OE.MatplotLibInit;q(`Initialize matplotlib for ${Se(this.resourceUri||this.uri)}`),e.push(...dt(t,{trim:!1}));let n=Ur.window.activeColorTheme.kind===Ur.ColorThemeKind.Dark;e.push(n?"matplotlib.style.use('dark_background')":`matplotlib.rcParams.update(${st.MatplotLibDefaultParams})`)}return e}getUserStartupCommands(){let e=this.kernelSettings.runStartupCommands;if(Array.isArray(e)&&(e=e.join(`
`)),e){let t=e.replace(/\\n/g,`
`);return dt(t,{trim:!1})}return[]}async executeSilently(e,t,n){if(t.join("").trim().length!==0){if(!e.kernel){q(`Not executing startup as there is no session, code: ${t}`);return}return Ji(e.kernel,t.join(`
`),n)}}},EA=class extends _A{get creator(){return"3rdPartyExtension"}constructor(e,t,n,i,o,s,a){super(`3rdPartyKernel_${(0,Jj.default)()}`,e,t,n,i,o,s,"3rdPartyExtension",a)}},CA=class extends _A{constructor(t,n,i,o,s,a,l,c){super((0,Jj.default)(),n.uri,t,i,o,s,l,"jupyterExtension",c);this.notebook=n;this.controller=a}get creator(){return"jupyterExtension"}};function B_e(r,e){return!r||r.length===0||(r=r.map(t=>`    ${t}`),r.unshift("try:"),r.push("except:",`    print('${e}')`)),r}d();function qj(r,e){return{get enableExtendedPythonKernelCompletions(){return r.getSettings(e).enableExtendedPythonKernelCompletions},get interruptTimeout(){return r.getSettings(e).jupyterInterruptTimeout},get launchTimeout(){return r.getSettings(e).jupyterLaunchTimeout},get runStartupCommands(){return r.getSettings(e).runStartupCommands},get themeMatplotlibPlots(){return r.getSettings(e).themeMatplotlibPlots}}}d();var Qs=require("vscode");d();var ic=require("vscode");d();var Gj=z(RV()),Wr=require("vscode");d();var DA=z(re()),XX=require("vscode");var pn=class{static dispose(){he(pn.disposables)}constructor(e){e.push({dispose:()=>{pn.dispose()}})}activate(){XX.workspace.onDidChangeNotebookDocument(e=>{_r(e.notebook)&&e.cellChanges.filter(t=>{var n;return((n=t.outputs)==null?void 0:n.length)===0}).map(t=>{var i;let n=pn.cellToDisplayIdMapping.get(t.cell);n&&(pn.cellToDisplayIdMapping.delete(t.cell),(i=pn.displayIdCellOutputMappingPerDocument.get(e.notebook))==null||i.delete(n))})})}static trackOutputByDisplayId(e,t,n,i){let o=pn.displayIdCellOutputMappingPerDocument.get(e.notebook);o||(o=new Map,pn.displayIdCellOutputMappingPerDocument.set(e.notebook,o)),o.set(t,{outputContainer:n,cell:e,outputItems:i}),pn.cellToDisplayIdMapping.set(e,t)}static getMappedOutput(e,t){let n=pn.displayIdCellOutputMappingPerDocument.get(e);if(!n)return;let i=n.get(t);return i!=null&&i.cell.document.isClosed?void 0:i}};pn.displayIdCellOutputMappingPerDocument=new WeakMap,pn.cellToDisplayIdMapping=new WeakMap,pn.disposables=[],pn=E([(0,DA.injectable)(),b(0,(0,DA.inject)(oe))],pn);var kS=new WeakMap;function np(r){if(r.parent_header&&"msg_id"in r.parent_header)return r.parent_header.msg_id}var xu=class xu{constructor(e,t,n,i,o,s,a,l){this.cell=e;this.controller=t;this.context=n;this.formatters=i;this.kernel=o;this.request=s;this._onErrorHandlingIOPubMessage=new Wr.EventEmitter;this.onErrorHandlingExecuteRequestIOPubMessage=this._onErrorHandlingIOPubMessage.event;this.outputsAreSpecificToAWidget=[];this.commIdsMappedToParentWidgetModel=new Map;this.disposables=[];this.prompts=new Set;this.ownedCommIds=new Set;this.commIdsMappedToWidgetOutputModels=new Set;this.ownedRequestMsgIds=new Set;this._completed=Me();this.gotIdleIOPubStatus=!1;this.gotShellReply=!1;this.streamsReAttachedToExecutingCell=!1;this._completed.promise.catch(y),this.executeRequestMessageId=l,this.ownedRequestMsgIds.add(l),Wr.workspace.onDidChangeNotebookDocument(c=>{var p;if(!_r(c.notebook))return;let u=c.cellChanges.find(({cell:f})=>f===this.cell);u&&((p=u.outputs)==null?void 0:p.length)===0&&(this.clearLastUsedStreamOutput(),this.cellHasErrorsInOutput=!1)},this,this.disposables),this.execution=a,this.kernel.anyMessage.connect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.connect(this.onKernelIOPubMessage,this),s&&(s.onIOPub=()=>{this.cell.document.isClosed&&!this.completedExecution&&s.dispose()},s.onReply=c=>{if(this.cell.document.isClosed){s.dispose();return}this.handleReply(c)},s.onStdin=this.handleInputRequest.bind(this),s.done.finally(()=>{this.completedExecution=!0,this.endCellExecution()}).catch(y))}get hasErrorOutput(){return this.cellHasErrorsInOutput===!0}get completed(){return this._completed.promise}dispose(){this.disposed||(this.disposed=!0,lt(this.cell,"Execution Message Handler disposed"),he(this.disposables),this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this.kernel.anyMessage.disconnect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.disconnect(this.onKernelIOPubMessage,this),this._onErrorHandlingIOPubMessage.dispose())}endCellExecution(){this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this._completed.resolve()}onKernelAnyMessage(e,{direction:t,msg:n}){if(this.cell.document.isClosed)return this.endCellExecution();let i=ci();if(!this.request&&t==="recv"){let o=np(n);i.KernelMessage.isStatusMsg(n)&&n.content.execution_state==="idle"&&o===this.executeRequestMessageId&&(this.gotIdleIOPubStatus=!0),n.channel==="shell"&&o===this.executeRequestMessageId&&(this.gotShellReply=!0);let s=i.KernelMessage.isStatusMsg(n)&&n.content.execution_state!=="idle"&&o!==this.executeRequestMessageId;typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type;let a=o?o!==this.executeRequestMessageId&&!s:!1,l=typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type==="interrupt_request",c=this.gotIdleIOPubStatus&&this.gotShellReply,u=["kernel_info_reply","execute_input","execute_reply"],p="msg_type"in n&&typeof n.msg_type=="string"&&u.includes(n.msg_type);if(!this.completedExecution&&c)return this.completedExecution=!0,this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endCellExecution();if(!this.completedExecution&&(p||a)){this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=setTimeout(()=>(this.completedExecution=!0,this.endAbnormallyTimeout=void 0,this.endCellExecution()),l?1e3:100),this.disposables.push(new Wr.Disposable(()=>{clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=void 0}));return}}t!=="send"||!this.completedExecution||i.KernelMessage.isCommMsgMsg(n)&&this.ownedCommIds.has(n.content.comm_id)&&this.ownedRequestMsgIds.add(n.header.msg_id)}onKernelIOPubMessage(e,t){if(this.cell.document.isClosed)return this.endCellExecution();if(!(!t.parent_header||!("msg_id"in t.parent_header)||!this.ownedRequestMsgIds.has(t.parent_header.msg_id)||t.channel!=="iopub"))try{this.handleIOPub(t)}catch(n){O("Failed to handle iopub message as a result of some comm message",t,n),!this.completedExecution&&!this.cell.document.isClosed&&this._onErrorHandlingIOPubMessage.fire(n)}}clearLastUsedStreamOutput(){this.lastUsedStreamOutput=void 0}createTemporaryTask(){var t,n;if(this.cell.document.isClosed)return;let e=kS.get(this.cell.notebook);return e||(this.previousResultsToRestore={...this.cell.executionSummary||{}},this.temporaryExecution=fo.getOrCreate(this.cell,this.controller),(t=this.temporaryExecution)==null||t.start(),(n=this.previousResultsToRestore)!=null&&n.executionOrder&&this.execution&&(this.execution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution)}endTemporaryTask(){var e,t,n;(e=this.previousResultsToRestore)!=null&&e.executionOrder&&this.execution&&(this.execution.executionOrder=this.previousResultsToRestore.executionOrder),this.previousResultsToRestore&&this.temporaryExecution?(this.previousResultsToRestore.executionOrder&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution.end(this.previousResultsToRestore.success,(t=this.previousResultsToRestore.timing)==null?void 0:t.endTime)):(n=this.temporaryExecution)==null||n.end(void 0),this.previousResultsToRestore=void 0,this.temporaryExecution=void 0}handleIOPub(e){var n;this.startTime||(this.startTime=new Date().getTime(),(n=this.execution)==null||n.start(this.startTime),q(`Kernel acknowledged execution of cell ${this.cell.index} @ ${this.startTime}`));let t=ci();if(t.KernelMessage.isCommOpenMsg(e))this.handleCommOpen(e);else if(t.KernelMessage.isExecuteResultMsg(e))this.handleExecuteResult(e);else if(t.KernelMessage.isExecuteInputMsg(e))this.handleExecuteInput(e);else if(t.KernelMessage.isStatusMsg(e)){let i=e;this.handleStatusMessage(i)}else t.KernelMessage.isStreamMsg(e)?this.handleStreamMessage(e):t.KernelMessage.isDisplayDataMsg(e)?this.handleDisplayData(e):t.KernelMessage.isUpdateDisplayDataMsg(e)?this.handleUpdateDisplayDataMessage(e):t.KernelMessage.isClearOutputMsg(e)?this.handleClearOutput(e):t.KernelMessage.isErrorMsg(e)?this.handleError(e):t.KernelMessage.isCommOpenMsg(e)||(t.KernelMessage.isCommMsgMsg(e)?this.handleCommMsg(e):t.KernelMessage.isCommCloseMsg(e)||ue(`Unknown message ${e.header.msg_type} : hasData=${"data"in e.content}`));"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleCommOpen(e){var n;this.ownedCommIds.add(e.content.comm_id);let t=((n=e.content.data)==null?void 0:n.state)||void 0;e.content.target_name===st.DefaultCommTarget&&t&&t._model_module==="@jupyter-widgets/output"&&this.commIdsMappedToWidgetOutputModels.add(e.content.comm_id)}handleCommMsg(e){let t=e.content.data;if(!(!t||t.method!=="update"||typeof t.state!="object")){if("msg_id"in t.state&&typeof t.state.msg_id=="string"){let n="msg_id"in e.parent_header?e.parent_header:void 0;(this.ownedRequestMsgIds.has(e.content.comm_id)||n&&this.ownedRequestMsgIds.has(n.msg_id))&&(t.state.msg_id?this.outputsAreSpecificToAWidget.push({handlingCommId:e.content.comm_id,msgIdsToSwallow:t.state.msg_id}):this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId===e.content.comm_id&&this.outputsAreSpecificToAWidget.pop())}else if("children"in t.state&&Array.isArray(t.state.children)&&this.ownedCommIds.has(e.content.comm_id)){let n="IPY_MODEL_";t.state.children.forEach(i=>{if(typeof i!="string")return ue("Came across a comm update message a child that isn't a string",i);if(!i.startsWith(n))return ue(`Came across a comm update message a child that start start with ${n}`,i);let o=i.substring(n.length);this.ownedCommIds.add(o),this.commIdsMappedToParentWidgetModel.set(o,e.content.comm_id)})}}}clearOutputIfNecessary(e){return this.clearOutputOnNextUpdateToOutput?(lt(this.cell,"Clear cell output"),this.clearLastUsedStreamOutput(),e==null||e.clearOutput().then(y,y),this.clearOutputOnNextUpdateToOutput=!1,{previousValueOfClearOutputOnNextUpdateToOutput:!0}):{previousValueOfClearOutputOnNextUpdateToOutput:!1}}addToCellData(e,t){var l,c;if(e.data&&typeof e.data=="object"&&Io in e.data){let u=e.data[Io];if(u&&this.context.extensionMode===Wr.ExtensionMode.Test&&(u._vsc_test_cellIndex=this.cell.index),u&&"model_id"in u){let p=xu.modelIdsOwnedByCells.get(this.cell)||new Set;p.add(u.model_id),xu.modelIdsOwnedByCells.set(this.cell,p)}}let n=vs(e),i="transient"in e&&typeof e.transient=="object"&&e.transient&&"display_id"in e.transient&&typeof((l=e.transient)==null?void 0:l.display_id)=="string"?(c=e.transient)==null?void 0:c.display_id:void 0;if(this.cell.document.isClosed)return;lt(this.cell,()=>`Update output with mimes ${n.items.map(u=>u.mime).toString()}`);let o=this.execution||this.createTemporaryTask();this.clearOutputIfNecessary(o),i&&pn.trackOutputByDisplayId(this.cell,i,n,n.items),this.clearLastUsedStreamOutput(),lt(this.cell,"Append output in addToCellData");let s=!0,a=np(t);if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a&&n.items.every(u=>this.canMimeTypeBeRenderedByWidgetManager(u)))s=!1;else if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a){let u=this.updateJupyterOutputWidgetWithOutput({commId:this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId,outputToAppend:n},o);u!=null&&u.outputAdded&&(s=!1)}s&&(o==null||o.appendOutput([n]).then(y,y)),this.endTemporaryTask()}canMimeTypeBeRenderedByWidgetManager(e){let t=e.mime;if(t=="application/vnd.code.notebook.stderr"||t=="application/vnd.code.notebook.stdout"||t=="application/vnd.code.notebook.error")return!0;if(t===Io){let n=JSON.parse(new TextDecoder().decode(e.data));return!(typeof n.model_id=="string"&&this.commIdsMappedToWidgetOutputModels.has(n.model_id))}return!t.startsWith("application/vnd")}updateJupyterOutputWidgetWithOutput(e,t){let n=this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId:void 0,i="commId"in e?e.commId:n;if(!i)return;let o="outputToAppend"in e?e.outputToAppend:void 0,s=this.commIdsMappedToParentWidgetModel.get(i)||i,a=this.cell.notebook.getCells().find(v=>{var I;return(I=xu.modelIdsOwnedByCells.get(v))==null?void 0:I.has(s)});if(!a){ue(`Unable to find a cell that owns the model ${s}`);return}let l=a.outputs.find(v=>v.items.find(I=>{if(I.mime!==Io)return!1;try{return JSON.parse(new TextDecoder().decode(I.data)).model_id===s}catch(S){ue("Failed to deserialize the widget data",S)}return!1}));if(!l)return;let c=xu.outputsOwnedByWidgetModel.get(s)||new Set,p=("clearOutput"in e?e.clearOutput:!1)||(this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput===!0:!1);this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!1);let f=a.outputs.slice().filter(v=>p?!c.has(v.id):!0),m=f.slice(0,f.indexOf(l)+1),h=f.slice(f.indexOf(l)+1);xu.outputsOwnedByWidgetModel.set(s,c),o&&c.add(o.id);let g=o?m.concat(o).concat(h):m.concat(h);return h.length===0&&o?t==null||t.appendOutput(o,a).then(y,y):p&&!o&&h.length===0||t==null||t.replaceOutput(g,a).then(y,y),{outputAdded:!0}}async handleInputRequest(e){if(e.content&&"prompt"in e.content){let t=new Wr.CancellationTokenSource;this.prompts.add(t);let n=e.content.password!==null&&e.content.password;await Wr.window.showInputBox({prompt:e.content.prompt?e.content.prompt.toString():"",ignoreFocusOut:!0,password:n},t.token).then(i=>{this.kernel.sendInputReply({value:i||"",status:"ok"})},y),this.prompts.delete(t)}}handleExecuteResult(e){this.addToCellData({output_type:"execute_result",data:e.content.data,metadata:e.content.metadata,transient:e.content.transient,execution_count:e.content.execution_count},e)}handleExecuteReply(e){let t=e.content;t.payload&&t.payload.forEach(n=>{n.source&&n.source==="set_next_input"&&"text"in n&&"replace"in n&&this.handleSetNextInput(n),n.data&&n.data.hasOwnProperty("text/plain")&&this.addToCellData({output_type:"stream",text:n.data["text/plain"].toString(),name:"stdout",metadata:{},execution_count:t.execution_count},e)})}handleSetNextInput(e){let t=new Wr.WorkspaceEdit;if(e.replace)t.replace(this.cell.document.uri,new Wr.Range(this.cell.document.lineAt(0).range.start,this.cell.document.lineAt(this.cell.document.lineCount-1).range.end),e.text);else{lt(this.cell,"Create new cell after current");let n=new Wr.NotebookCellData(Wr.NotebookCellKind.Code,e.text,this.cell.document.languageId);n.outputs=[],n.metadata={};let i=Wr.NotebookEdit.insertCells(this.cell.index+1,[n]);t.set(this.cell.notebook.uri,[i])}Wr.workspace.applyEdit(t).then(y,y)}handleExecuteInput(e){e.content.execution_count&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleStatusMessage(e){lt(this.cell,`Kernel switching to ${e.content.execution_state}`)}handleStreamMessage(e){var o;if(np(e)&&this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow==np(e))return;lt(this.cell,`Update streamed output, new output '${e.content.text.substring(0,100)}'`);let t=this.execution||this.createTemporaryTask(),n=e.content.name==="stdout"?Wr.NotebookCellOutputItem.stdout("").mime:Wr.NotebookCellOutputItem.stderr("").mime;!this.request&&!this.streamsReAttachedToExecutingCell&&!this.lastUsedStreamOutput&&this.cell.outputs.length&&this.cell.outputs[this.cell.outputs.length-1].items.length>=1&&this.cell.outputs[this.cell.outputs.length-1].items.every(s=>s.mime===n)&&(this.lastUsedStreamOutput={output:this.cell.outputs[0],stream:e.content.name}),this.streamsReAttachedToExecutingCell=!0;let{previousValueOfClearOutputOnNextUpdateToOutput:i}=this.clearOutputIfNecessary(t);if(((o=this.lastUsedStreamOutput)==null?void 0:o.stream)===e.content.name){let s=vs({output_type:"stream",name:e.content.name,text:e.content.text});lt(this.cell,`Append output items '${e.content.text.substring(0,100)}`),t==null||t.appendOutputItems(s.items,this.lastUsedStreamOutput.output).then(y,y)}else if(i){let s=zc(e.content.text),a=vs({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},lt(this.cell,`Replace output with '${s.substring(0,100)}'`),t==null||t.replaceOutput([a]).then(y,y)}else{let s=BG(zc(e.content.text)),a=vs({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},lt(this.cell,`Append new output '${s.substring(0,100)}'`),t==null||t.appendOutput([a]).then(y,y)}this.endTemporaryTask()}handleDisplayData(e){let t={output_type:"display_data",data:jx(e.content.data),metadata:e.content.metadata,transient:e.content.transient};this.addToCellData(t,e)}handleClearOutput(e){if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===np(e)){if(e.content.wait)this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!0);else{let t=this.execution||this.createTemporaryTask();this.updateJupyterOutputWidgetWithOutput({clearOutput:!0},t),this.endTemporaryTask()}return}if(e.content.wait)this.clearOutputOnNextUpdateToOutput=!0;else{let t=this.execution||this.createTemporaryTask();this.clearLastUsedStreamOutput(),t==null||t.clearOutput().then(y,y),this.endTemporaryTask()}}handleError(e){let t=e.content.traceback;Ie(`Traceback for error ${t}`),this.formatters.forEach(i=>{t=i.format(this.cell,t)}),Ie(`Traceback for error after formatting ${t}`);let n={output_type:"error",ename:e.content.ename,evalue:e.content.evalue,traceback:t};if(this.cell.notebook.notebookType!=="interactive"){let i=fo.get(this.cell);i&&e.content.ename!=="KeyboardInterrupt"&&(i.errorInfo={message:`${e.content.ename}: ${e.content.evalue}`,location:rz(e.content.traceback,this.cell),uri:this.cell.document.uri,stack:e.content.traceback.join(`
`)})}this.addToCellData(n,e),this.cellHasErrorsInOutput=!0}handleReply(e){ci().KernelMessage.isExecuteReplyMsg(e)&&(this.handleExecuteReply(e),"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count))}handleUpdateDisplayDataMessage(e){let t=e.content.transient.display_id;if(!t){ue("Update display data message received, but no display id",e.content);return}let n=pn.getMappedOutput(this.cell.notebook,t);if(!n){q("Update display data message received, but no output found to update",e.content);return}if(n.cell.document.isClosed){ue("Update display data message received, but output cell is closed",e.content);return}let i=OV(new Wr.NotebookCellOutput(n.outputItems,n.outputContainer.metadata)),o=vs({...i,data:e.content.data,metadata:e.content.metadata});if(n.outputItems.length===0&&o.items.length===0){q("Update display data message received, but no output to update",e.content);return}let s=!1;if(n.outputItems.length===o.items.length){let l=!0;if((0,Gj.default)(n.outputContainer.metadata||{},o.metadata||{})||(s=!0,l=!1),l){for(let c=0;c<n.outputItems.length;c++)if(!(0,Gj.default)(n.outputItems[c],o.items[c])){l=!1;break}}if(l){q("Update display data message received, but no output to update (data is the same)",e.content);return}}let a=this.execution||this.createTemporaryTask();if(lt(this.cell,`Replace output items in display data ${o.items.length}`),s){let l=n.cell.outputs.map(c=>{let u=OV(c);return u.output_type==="display_data"&&"transient"in u&&u.transient&&typeof u.transient=="object"&&"display_id"in u.transient&&typeof u.transient.display_id=="string"&&u.transient.display_id===t?o:c});a==null||a.replaceOutput(l,n.cell).then(y,y),pn.trackOutputByDisplayId(n.cell,t,o,o.items)}else a==null||a.replaceOutputItems(o.items,n.outputContainer).then(y,y),pn.trackOutputByDisplayId(n.cell,t,n.outputContainer,o.items);this.endTemporaryTask()}};xu.modelIdsOwnedByCells=new WeakMap,xu.outputsOwnedByWidgetModel=new Map,E([_n()],xu.prototype,"handleReply",1);var hD=xu;d();var hm=class extends Error{constructor(t){super(t.evalue||t.ename);this.ename=t.ename,this.evalue=t.evalue,this.traceback=t.traceback}};var PA=class{constructor(e,t){this.controller=e;this.requestListener=t}create(e,t,n,i){return Yj.fromCell(e,t,n,this.controller,this.requestListener,i)}},Yj=class r{constructor(e,t,n,i,o,s){this.cell=e;this.codeOverride=t;this.kernelConnection=n;this.controller=i;this.requestListener=o;this.resumeExecution=s;this.type="cell";this._result=Me();this.cancelHandled=!1;this.disposables=[];this._preExecuteEmitter=new ic.EventEmitter;if(ic.workspace.onDidCloseTextDocument(a=>{var l;if(a===this.cell.document){De(`Disposing request as the cell (${this.cell.index}) was deleted ${Se(this.cell.notebook.uri)}`);try{(l=this.request)==null||l.dispose()}catch(c){O(`Error during cell execution dispose: ${c}`)}this.started&&!this._completed&&this.completedDueToCancellation()}},this,this.disposables),Jd.setCellState(e,ic.NotebookCellExecutionState.Idle),this.canExecuteCell())this.execution=fo.getOrCreate(e,this.controller,!(s!=null&&s.msg_id)),Jd.setCellState(e,ic.NotebookCellExecutionState.Pending);else{let a=fo.get(e);a&&(a.start(),a.end(void 0))}}get result(){return this._result.promise}get preExecute(){return this._preExecuteEmitter.event}static fromCell(e,t,n,i,o,s){return new r(e,t,n,i,o,s)}async start(e){var t,n,i,o;if(this.session=e,(t=this.resumeExecution)!=null&&t.msg_id)return this.resume(e,this.resumeExecution);if(this.cancelHandled){lt(this.cell,"Not starting as it was cancelled");return}if(lt(this.cell,"Start execution"),Ie(`Cell Exec contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return e.kind==="remoteJupyter"&&e.status==="unknown"&&(!e.kernel||e.kernel.isDisposed||e.isDisposed)?((i=this.execution)==null||i.start(),(o=this.execution)==null||o.clearOutput().then(y,y),this.completedWithErrors(new sn),this.result):this.started?(lt(this.cell,"Cell has already been started yet CellExecution.Start invoked again"),O(`Cell has already been started yet CellExecution.Start invoked again ${this.cell.index}`),this.result):(this.started=!0,kS.set(this.cell.notebook,this.execution),Jd.setCellState(this.cell,ic.NotebookCellExecutionState.Executing),this.execute(this.codeOverride||this.cell.document.getText().replace(/\r\n/g,`
`),e).catch(s=>this.completedWithErrors(s)).catch(y),this.result)}async resume(e,t){var n,i;if(this.cancelHandled){lt(this.cell,"Not resuming as it was cancelled");return}if(!e.kernel)throw new Error("Kernel not available to resume execution");if(lt(this.cell,"Start resuming execution"),Ie(`Cell Exec (resuming) contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return this.started?(O(`Cell has already been started yet CellExecution.resume invoked again ${this.cell.index}`),this.result):(this.started=!0,kS.set(this.cell.notebook,this.execution),(i=this.execution)==null||i.start(t.startTime),t.executionCount&&this.execution&&(this.execution.executionOrder=t.executionCount),Jd.setCellState(this.cell,ic.NotebookCellExecutionState.Executing),this.cellExecutionHandler=this.requestListener.registerListenerForResumingExecution(this.cell,{kernel:e.kernel,cellExecution:this.execution,msg_id:t.msg_id}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(o=>{O(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,o),this.completedWithErrors(o.error)},this,this.disposables),this.cellExecutionHandler.completed.finally(()=>this.completedSuccessfully()).catch(y),this.result)}async cancel(e=!1){var t;if(!this.cancelHandled){if(this.cancelRequested=!0,this.started&&!e&&((t=this.execution)!=null&&t.started)){lt(this.cell,"Cell is already running, waiting for it to finish or kernel to start"),await this.result.catch(y);return}this.cancelHandled||this._completed||(lt(this.cell,"Execution cancelled"),this.cancelHandled=!0,this.completedDueToCancellation(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,lt(this.cell,"Execution disposed"),he(this.disposables))}completedWithErrors(e,t,n=!0){var i,o;if(!this.cancelHandled){if(!this.disposed&&!this.cancelRequested?ue("Cell completed with errors",e):ue(`Cell completed with errors (${this.disposed?"disposed":"cancelled"})`),lt(this.cell,"Completed with errors"),n){let s,a;if(e&&!(e instanceof ct)&&((i=e.message)!=null&&i.includes("Canceled future for execute_request message before replies were done"))&&this.session&&QX(this.session)&&(e=new sn),e)if(!(e instanceof ct))s=e.message||e.name||e.stack;else{let l=qm(ic.workspace.workspaceFolders||[],e,ft(this.kernelConnection),R7(this.kernelConnection.interpreter));s=l==null?void 0:l.message}a=yy(s||""),a&&((o=this.execution)==null||o.appendOutput(a).then(y,y))}this.endCellTask("failed",t),lt(this.cell,"Completed with errors, & resolving"),this._result.reject(e)}}get isEmptyCodeCell(){return this.cell.document.getText().trim().length===0}completedSuccessfully(e){lt(this.cell,"Completed successfully");let t="success";this.endCellTask("success",e),lt(this.cell,`Completed successfully & resolving with status = ${t}`),this._result.resolve()}endCellTask(e,t=new Date().getTime()){var n,i,o,s;if(!this._completed){if(this._completed=!0,this.isEmptyCodeCell)this.execution&&(this.execution.executionOrder=void 0),(n=this.execution)==null||n.end(void 0);else if(e==="success"||e==="failed")this.endTime=t,(i=this.execution)==null||i.end(e==="success",this.endTime);else{try{(o=this.request)==null||o.dispose()}catch(a){}(s=this.execution)==null||s.end(void 0)}kS.get(this.cell.notebook)===this.execution&&kS.set(this.cell.notebook,void 0),Jd.setCellState(this.cell,ic.NotebookCellExecutionState.Idle),this.execution=void 0}}completedDueToCancellation(){lt(this.cell,"Completed due to cancellation"),this.endCellTask("cancelled"),lt(this.cell,"Cell cancelled & resolving"),this._result.resolve()}canExecuteCell(){return this.cell.document.languageId==="raw"?!1:!this.cell.document.isClosed}async execute(e,t){var o,s,a,l;if(!t.kernel)throw new Error("No kernel available to execute code");if(lt(this.cell,"Send code for execution"),e.trim().length===0||this.cell.document.isClosed)return e.trim().length===0&&((s=this.execution)==null||s.start((o=this.resumeExecution)==null?void 0:o.startTime),(l=(a=this.execution)==null?void 0:a.clearOutput())==null||l.then(y,y)),lt(this.cell,"Empty cell execution"),this.completedSuccessfully();let n={cellId:this.cell.document.uri.toString(),...Wd(this.cell).metadata},i=t.kernel;try{this._preExecuteEmitter.fire(this.cell),q(`Cell Index:${this.cell.index} sent to kernel`),this.request=i.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!0},!1,n),this.request.done.then(y,y)}catch(c){return O(`Cell execution failed without request, for cell Index ${this.cell.index}`,c),this.completedWithErrors(c)}this.cellExecutionHandler=this.requestListener.registerListenerForExecution(this.cell,{kernel:i,cellExecution:this.execution,request:this.request}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(c=>{O(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,c),this.completedWithErrors(c.error)},this,this.disposables);try{lt(this.cell,"Wait for jupyter execution");let c=await this.request.done,u=new Date().getTime();lt(this.cell,"Jupyter execution completed"),c.content.status==="error"?this.completedWithErrors(new hm(c.content),u,!1):this.completedSuccessfully(u),lt(this.cell,"Executed successfully in executeCell")}catch(c){if(this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&O("Error in waiting for cell to complete",c),lt(this.cell,"Some other execution error"),c&&c instanceof Error&&Di(c,!0)?this.completedWithErrors({message:c.message}):this.completedWithErrors(c)}}};d();var ZX=require("vscode");var TA=class{constructor(e,t,n,i){this.controller=e;this.context=t;this.formatters=n;this.notebook=i;this.disposables=[];this.messageHandlers=new WeakMap;ZX.workspace.onDidChangeNotebookDocument(o=>{o.notebook===this.notebook&&o.contentChanges.forEach(s=>s.removedCells.forEach(a=>{var l;return(l=this.messageHandlers.get(a))==null?void 0:l.dispose()}))},this,this.disposables)}dispose(){he(this.disposables),this.notebook&&this.notebook.getCells().forEach(e=>{var t;return(t=this.messageHandlers.get(e))==null?void 0:t.dispose()})}registerListenerForExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new hD(e,this.controller,this.context,this.formatters,t.kernel,t.request,t.cellExecution,t.request.msg.header.msg_id);return this.messageHandlers.set(e,n),n}registerListenerForResumingExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new hD(e,this.controller,this.context,this.formatters,t.kernel,void 0,t.cellExecution,t.msg_id);return this.messageHandlers.set(e,n),n}};d();var $j=require("vscode");d();var kA=require("vscode");function Du(r,e,t){r!==Xe&&q(`Execution Id:${e}. ${t}.`)}var eZ=new Map,NS=class r{constructor(e,t){this.code=e;this.extensionId=t;this.type="code";this._onDidEmitOutput=new kA.EventEmitter;this.onDidEmitOutput=this._onDidEmitOutput.event;this._onRequestSent=new kA.EventEmitter;this.onRequestSent=this._onRequestSent.event;this._onRequestAcknowledge=new kA.EventEmitter;this.onRequestAcknowledged=this._onRequestAcknowledge.event;this._done=Me();this.cancelHandled=!1;this.disposables=[];let n=eZ.get(t)||0;n+=1,eZ.set(t,n),this.executionId=`${t}-${n}`,this.disposables.push(this._onDidEmitOutput)}get done(){return this._done.promise}get result(){return this._done.promise}static fromCode(e,t){return new r(e,t)}async start(e){if(this.session=e,this.cancelHandled){Du(this.extensionId,this.executionId,"Not starting as it was cancelled");return}if(Du(this.extensionId,this.executionId,"Start Code execution"),Ie(`Code Exec contents ${this.code.substring(0,50)}...`),!e.kernel||e.kernel.isDisposed||e.isDisposed){this._done.reject(new sn);return}if(this.started)return Du(this.extensionId,this.executionId,"Code has already been started yet CodeExecution.Start invoked again"),O(`Code has already been started yet CodeExecution.Start invoked again ${this.executionId}`),this.done;await this.execute(this.code.replace(/\r\n/g,`
`),e).catch(y)}async cancel(){var e,t,n;if(!(this.cancelHandled||this._completed)){if(this.cancelRequested=!0,this.started){Du(this.extensionId,this.executionId,"Code is already running, interrupting and waiting for it to finish or kernel to start");let i=(e=this.session)==null?void 0:e.kernel;i&&this.extensionId!==Xe&&await i.interrupt().catch(y),(t=this.request)==null||t.dispose(),await((n=this.request)==null?void 0:n.done.catch(y))}this.cancelHandled||this._completed||(Du(this.extensionId,this.executionId,"Execution cancelled"),this.cancelHandled=!0,this._done.resolve(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,this._completed||Du(this.extensionId,this.executionId,"Execution disposed"),he(this.disposables))}async execute(e,t){if(!t.kernel){let i=new Error("No kernel available to execute code");throw this._done.resolve(),i}Du(this.extensionId,this.executionId,"Send code for execution");let n=t.kernel;try{this.started=!0,this._onRequestSent.fire(),Du(this.extensionId,this.executionId,"Execution Request Sent to Kernel"),this.request=uz(n,e,()=>this._onRequestAcknowledge.fire(),i=>this._onDidEmitOutput.fire(i)),this.request.done.then(y,y)}catch(i){O(`Code execution failed without request, for exec ${this.executionId}`,i),this._completed=!0,this._done.reject(i);return}try{let i=await this.request.done;this._completed=!0,i.content.status==="error"?(Du(this.extensionId,this.executionId,"Executed with errors"),this._done.reject(new hm(i.content))):(Du(this.extensionId,this.executionId,"Executed successfully"),this._done.resolve())}catch(i){if(this._completed=!0,this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&O(`Error in waiting for code ${this.executionId} to complete`,i),this._done.reject(i)}}};var NA=class{constructor(e,t,n,i){this.session=e;this.executionFactory=t;this.metadata=n;this.resourceUri=i;this.queueOfItemsToExecute=[];this.cancelledOrCompletedWithErrors=!1;this.startedRunningCells=!1;this._onPreExecute=new $j.EventEmitter;this._onPostExecute=new $j.EventEmitter;this.disposables=[]}get queueOfCellsToExecute(){return this.queueOfItemsToExecute.filter(e=>e.type==="cell").map(e=>e)}get isEmpty(){return this.queueOfItemsToExecute.length===0}get failed(){return this.cancelledOrCompletedWithErrors}get queue(){return this.queueOfCellsToExecute.map(e=>e.cell)}dispose(){var e;this.disposables.forEach(t=>t.dispose()),(e=this.lastCellExecution)==null||e.dispose()}get onPreExecute(){return this._onPreExecute.event}get onPostExecute(){return this._onPostExecute.event}queueCell(e,t){this.enqueue({cell:e,codeOverride:t})}queueCode(e,t,n){return this.enqueue({code:e,extensionId:t,token:n})}enqueue(e){let t;if("cell"in e){let{cell:n,codeOverride:i}=e,o=this.queueOfCellsToExecute.find(a=>a.cell===n);if(o)return lt(n,"Use existing cell execution"),o;let s=this.executionFactory.create(n,i,this.metadata);t=s,this.disposables.push(s),s.preExecute(a=>this._onPreExecute.fire(a),this,this.disposables),this.queueOfItemsToExecute.push(s),lt(n,"User queued cell for execution")}else{let{code:n,extensionId:i,token:o}=e,s=NS.fromCode(n,i);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),this.disposables.push(zg(o.onCancellationRequested)(()=>s.cancel()))}return this.startExecutingCells(),t}resumeCell(e,t){if(this.queueOfCellsToExecute.find(o=>o.cell===e)){lt(e,"Use existing cell execution");return}let i=this.executionFactory.create(e,"",this.metadata,t);this.disposables.push(i),this.queueOfItemsToExecute.push(i),lt(e,"User queued cell for execution"),this.startExecutingCells()}async cancel(e){var t;this.cancelledOrCompletedWithErrors=!0,q("Cancel pending cells"),await Promise.all(this.queueOfItemsToExecute.map(n=>n.cancel(e))),(t=this.lastCellExecution)==null||t.dispose(),this.queueOfItemsToExecute.splice(0,this.queueOfItemsToExecute.length)}async cancelQueuedCells(){var e,t;this.cancelledOrCompletedWithErrors=!0,q("Cancel pending cells"),await Promise.all(this.queueOfCellsToExecute.map(n=>n.cancel())),((e=this.lastCellExecution)==null?void 0:e.type)==="cell"&&((t=this.lastCellExecution)==null||t.dispose()),this.queueOfItemsToExecute.push(...this.queueOfItemsToExecute.filter(n=>n.type==="code"))}async waitForCompletion(e){let t=e?this.queueOfCellsToExecute.filter(n=>e===n.cell):this.queueOfItemsToExecute;await Promise.all(t.map(n=>n.result))}startExecutingCells(){this.startedRunningCells||this.start().catch(y),this.startedRunningCells=!0}async start(){try{await this.executeQueuedCells()}catch(e){O("Failed to execute cells in CellExecutionQueue",e),this.cancelledOrCompletedWithErrors=!0,await this.cancelQueuedCells()}}async executeQueuedCells(){var n,i,o;let e,t=await this.session;for(this.queueOfItemsToExecute.forEach(s=>s.type==="cell"&&lt(s.cell,"Ready to execute"));this.queueOfItemsToExecute.length;){(n=this.lastCellExecution)==null||n.dispose();let s=this.queueOfItemsToExecute[0];this.lastCellExecution=s,s.type==="cell"&&lt(s.cell,"Before Execute individual cell");let a=!0;try{s.type==="cell"&&s.cell.notebook.isClosed?e=!0:s.type==="cell"&&this.cancelledOrCompletedWithErrors||(a=await s.start(t).then(()=>!0).catch(()=>!1))}finally{s.type==="cell"&&lt(s.cell,`After Execute individual cell ${a}`);let c=this.queueOfItemsToExecute.indexOf(s);c>=0&&this.queueOfItemsToExecute.splice(c,1),s.type==="cell"&&this._onPostExecute.fire(s.cell)}let l=!1;if(s.type==="cell"&&((o=(i=Wd(s.cell).metadata)==null?void 0:i.tags)!=null&&o.includes("raises-exception"))&&(l=!0),e||this.cancelledOrCompletedWithErrors||!a&&!l){this.cancelledOrCompletedWithErrors=!0;let c=[];if(this.cancelledOrCompletedWithErrors&&c.push("cancellation or failure in execution"),e&&c.push("Notebook being closed"),typeof a=="number"&&!a&&c.push("failure in cell execution"),c.length===0&&c.push("an unknown reason"),this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length===this.queueOfItemsToExecute.length){ue(`Cancel all remaining cells due to ${c.join(" or ")}`),await this.cancel();break}else if(this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length!==this.queueOfItemsToExecute.length)ue(`Cancel all remaining cells due to ${c.join(" or ")}`),await this.cancelQueuedCells();else if(e){ue(`Cancel all remaining cells due to ${c.join(" or ")}`),await this.cancel();break}}if(t.status==="dead"||t.status==="terminating"){this.cancelledOrCompletedWithErrors=!0,ue("Cancel all remaining cells due to dead kernel"),await this.cancel();break}}}};var RA=class{constructor(e,t,n,i){this.kernel=e;this.notebook=i;this.disposables=[];this._visibleExecutionCount=0;this._onPreExecute=new Qs.EventEmitter;this.onPreExecute=this._onPreExecute.event;this._onPostExecute=new Qs.EventEmitter;this.onPostExecute=this._onPostExecute.event;this.documentExecutions=new WeakMap;this._onDidReceiveDisplayUpdate=new Qs.EventEmitter;this.onDidReceiveDisplayUpdate=this._onDidReceiveDisplayUpdate.event;this.hookedSesions=new WeakSet;let o=new TA(e.controller,t,n,i);this.disposables.push(o),this.executionFactory=new PA(e.controller,o),Qs.notebooks.onDidChangeNotebookCellExecutionState(s=>{var a;s.cell.notebook===e.notebook&&s.state===Qs.NotebookCellExecutionState.Idle&&(a=s.cell.executionSummary)!=null&&a.executionOrder&&(this._visibleExecutionCount=Math.max(this._visibleExecutionCount,s.cell.executionSummary.executionOrder))}),e.onRestarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.onStarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.addHook("willInterrupt",this.onWillInterrupt,this,this.disposables),e.addHook("willCancel",this.onWillCancel,this,this.disposables),e.addHook("willRestart",s=>this.onWillRestart(s),this,this.disposables),e.onStatusChanged(this.hookupIOPubHandler,this,this.disposables),e.onRestarted(this.hookupIOPubHandler,this,this.disposables),this.hookupIOPubHandler(),this.disposables.push(this._onPreExecute)}get executionCount(){return this._visibleExecutionCount}hookupIOPubHandler(){let e=this.kernel.session;if(!e||this.hookedSesions.has(e))return;this.hookedSesions.add(e);let t=(n,i)=>{var l;if(i.header.msg_type!=="update_display_data"&&i.header.msg_type!=="display_data")return;let o=i,s=(l=o.content.transient)==null?void 0:l.display_id;if(!s||!fz(e,s))return;let a=vs({output_type:"display_data",data:o.content.data,metadata:o.content.metadata,transient:o.content.transient});this._onDidReceiveDisplayUpdate.fire(a)};e.iopubMessage.connect(t),this.disposables.push({dispose:()=>{e==null||e.iopubMessage.disconnect(t)}})}get pendingCells(){var e;return((e=this.documentExecutions.get(this.notebook))==null?void 0:e.queue)||[]}async resumeCellExecution(e,t){if(lt(e,`NotebookKernelExecution.resumeCellExecution (start), ${Se(e.notebook.uri)}`),e.kind==Qs.NotebookCellKind.Markup)return;await Wa(this.kernel.resourceUri,this.kernel.kernelConnectionMetadata),Rr(this.kernel.resourceUri,"DATASCIENCE.RESUME_EXECUTE_CELL");let n=this.kernel.start(new Er(!1)),i=this.getOrCreateCellExecutionQueue(e.notebook,n);i.resumeCell(e,t);let o=await i.waitForCompletion(e).then(()=>!0).catch(()=>!1);lt(e,`NotebookKernelExecution.resumeCellExecution (completed), ${Se(e.notebook.uri)}`),q(`Cell ${e.index} executed ${o?"successfully":"with an error"}`)}async executeCell(e,t){lt(e,`NotebookKernelExecution.executeCell (1), ${Se(e.notebook.uri)}`);let n=new Mt;if(e.kind==Qs.NotebookCellKind.Markup)return;lt(e,`NotebookKernelExecution.executeCell, ${Se(e.notebook.uri)}`),await Wa(this.kernel.resourceUri,this.kernel.kernelConnectionMetadata);let i=this.kernel.start(new Er(!1));await this.kernel.restarting,lt(e,`NotebookKernelExecution.executeCell (2), ${Se(e.notebook.uri)}`);let o=this.getOrCreateCellExecutionQueue(e.notebook,i);o.queueCell(e,t);let s=!0;try{await o.waitForCompletion(e)}catch(a){throw s=!1,a}finally{lt(e,`NotebookKernelExecution.executeCell completed (3), ${Se(e.notebook.uri)}`),q(`Cell ${e.index} executed ${s?"successfully":"with an error"}`),Rr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CELL",{duration:n.elapsedTime})}}async*executeCode(e,t,n,i){let o=new Mt;await Wa(this.kernel.resourceUri,this.kernel.kernelConnectionMetadata);let s=this.kernel.start(new Er(!1));await this.kernel.restarting;let a=this.getOrCreateCellExecutionQueue(this.notebook,s),l;t===Xe?(l=NS.fromCode(e,t),s.then(h=>l.start(h))):l=a.queueCode(e,t,i),t!==Xe&&q(`Queue code ${l.executionId} from ${t} after ${o.elapsedTime}ms:
${e}`);let c=!1,u=[];l.result.finally(()=>{c=!0,!i.isCancellationRequested&&De(`Execution of code ${l.executionId} completed in ${o.elapsedTime}ms`),t!==Xe&&Rr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CODE",{duration:o.elapsedTime},{extensionId:t}),he(u)}).catch(y);let p=Ju(l.result),f=[],m=Me();for(u.push(l.onRequestSent(()=>n.started.fire())),u.push(l.onRequestAcknowledged(()=>n.executionAcknowledged.fire())),l.onDidEmitOutput(h=>{f.push(h),m.resolve(),m=Me()},this,u),i.onCancellationRequested(()=>{c||q(`Code execution cancelled by extension ${t}`)},this,u);;){await Promise.race([m.promise,p.promise]),c&&(m=Me());let h=this.kernel.session;for(;f.length;){let g=f.shift();h&&QR(t,h,g),yield g}if(p.completed)break}}executeHidden(e){return this.kernel.start().then(n=>n.kernel?Ji(n.kernel,e):Promise.reject(new sn))}async onWillInterrupt(){let e=this.documentExecutions.get(this.notebook);!e&&this.kernel.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||(De("Interrupt kernel execution"),e&&(await e.cancel(),await e.waitForCompletion().catch(y)))}async onWillCancel(){let e=this.documentExecutions.get(this.notebook);e&&await e.cancel(!0)}async onWillRestart(e){let t=this.documentExecutions.get(this.notebook),n=e?await e.catch(()=>{}):void 0,i=t?t.cancel(!0).then(()=>t.waitForCompletion().catch(y)):Promise.resolve();n||(De("No kernel session to interrupt"),await i)}getOrCreateCellExecutionQueue(e,t){let n=this.documentExecutions.get(e);if(n&&!n.isEmpty&&!n.failed)return n;let i=new NA(t,this.executionFactory,this.kernel.kernelConnectionMetadata,this.kernel.resourceUri);return this.disposables.push(i),Qs.workspace.onDidCloseNotebookDocument(async o=>{o===e&&(q(`Cancel executions after closing notebook ${Se(o.uri)}`),(!i.failed||!i.isEmpty)&&await i.cancel(!0))},this,this.disposables),i.onPreExecute(o=>this._onPreExecute.fire(o),this,this.disposables),i.onPostExecute(o=>this._onPostExecute.fire(o),this,this.disposables),this.documentExecutions.set(e,i),i}};var RS=class extends yA{constructor(t,n,i,o,s,a,l,c,u){super(t,n);this.sessionCreator=i;this.configService=o;this.context=s;this.formatters=l;this.startupCodeProviders=c;this.workspaceStorage=u;n.push(a.onDidRemove(this.handleServerRemoval.bind(this)))}getOrCreate(t,n){var c;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;this.disposeOldKernel(t);let o=(t==null?void 0:t.notebookType)===St?n.resourceUri:t.uri,s=qj(this.configService,o),a=t.uri.path.endsWith(".interactive")||(c=n.resourceUri)!=null&&c.path.endsWith(".interactive")?St:Ct,l=new CA(o,t,n.metadata,this.sessionCreator,s,n.controller,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(u=>this._onKernelStatusChanged.fire({kernel:l,status:u}),this,this.disposables),this.executions.set(l,new RA(l,this.context,this.formatters,t)),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(l),l}};RS=E([(0,In.injectable)(),b(0,(0,In.inject)(_o)),b(1,(0,In.inject)(oe)),b(2,(0,In.inject)(Vx)),b(3,(0,In.inject)(Ke)),b(4,(0,In.inject)(ut)),b(5,(0,In.inject)(yr)),b(6,(0,In.multiInject)(EI)),b(7,(0,In.inject)(Hd)),b(8,(0,In.inject)(wt)),b(8,(0,In.named)(Ts))],RS);var AS=class extends bA{constructor(t,n,i,o,s,a){super(t,n);this.sessionCreator=i;this.configService=o;this.startupCodeProviders=s;this.workspaceStorage=a}getOrCreate(t,n){var c;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;this.disposeOldKernel(t);let o=t,s=qj(this.configService,o),a=t.path.endsWith(".interactive")||(c=n.resourceUri)!=null&&c.path.endsWith(".interactive")?St:Ct,l=new EA(t,o,n.metadata,this.sessionCreator,s,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(u=>this._onKernelStatusChanged.fire({kernel:l,status:u}),this,this.disposables),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(t,l),l}};AS=E([(0,In.injectable)(),b(0,(0,In.inject)(_o)),b(1,(0,In.inject)(oe)),b(2,(0,In.inject)(Vx)),b(3,(0,In.inject)(Ke)),b(4,(0,In.inject)(Hd)),b(5,(0,In.inject)(wt)),b(5,(0,In.named)(Ts))],AS);d();var AA=z(re()),OS=require("vscode");var MS=class extends zr{constructor(t){super();this._onDidChangeRegistrations=this._register(new OS.EventEmitter);this.onDidChangeRegistrations=this._onDidChangeRegistrations.event;this._finders=[];this.connectionFinderMapping=new Map;this._onDidChangeKernels=this._register(new OS.EventEmitter);this.onDidChangeKernels=this._onDidChangeKernels.event;this._status="idle";this._onDidChangeStatus=this._register(new OS.EventEmitter);t.push(this),this._register(this._onDidChangeStatus),this._register(this._onDidChangeRegistrations)}get status(){return this._status}set status(t){this._status!=t&&(this._status=t,this._onDidChangeStatus.fire())}get onDidChangeStatus(){return this._onDidChangeStatus.event}registerKernelFinder(t){this._finders.push(t);let n=()=>{this.status=this._finders.every(s=>s.status==="idle")?"idle":"discovering"};n();let i=this._register(new Wi),o=()=>{let s=this._finders.findIndex(a=>a===t);s>=0&&this._finders.splice(s,1),i.dispose(),n(),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[],removed:[t]})};return i.add(t.onDidChangeStatus(n,this)),i.add(t.onDidChangeKernels(()=>this._onDidChangeKernels.fire())),i.add(t.onDidDispose(()=>o())),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[t],removed:[]}),new OS.Disposable(()=>o())}get kernels(){let t=[];this.connectionFinderMapping.clear();let n=new Set;this._finders.filter(o=>o.kind==="localPythonEnvironment").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.add(s.kernelSpec.specFile),t.push(s),this.connectionFinderMapping.set(s.id,o)})}),this._finders.filter(o=>o.kind==="localKernelSpec").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.has(s.kernelSpec.specFile)||(t.push(s),this.connectionFinderMapping.set(s.id,o))})});let i=this._finders.filter(o=>o.kind==="remote");for(let o of i){let s=o.kernels;s.forEach(a=>{this.connectionFinderMapping.set(a.id,o)}),t.push(...s)}return t}getFinderForConnection(t){return this.connectionFinderMapping.get(t.id)}get registered(){return this._finders}};MS=E([(0,AA.injectable)(),b(0,(0,AA.inject)(oe))],MS);d();var sv=z(re());var zj="Active_Kernel_Id_List",H_e=100,Xs=class{constructor(e,t){this.globalMemento=e;this.crypto=t}async getPreferredRemoteKernelId(e){let t=this.globalMemento.get(zj,[]);if(t.length){let n=e.uri,i=await this.crypto.createHash(n.toString()),o=t.find(s=>s.fileHash===i);return q(`Preferred Remote kernel for ${Se(n)} is ${o==null?void 0:o.kernelId}`),o==null?void 0:o.kernelId}}async clearPreferredRemoteKernelId(e){await this.updatePreferredRemoteKernelIdInternal(e)}async storePreferredRemoteKernelId(e,t){await this.updatePreferredRemoteKernelIdInternal(e,t)}async updatePreferredRemoteKernelIdInternal(e,t){let n=!1,i=JSON.parse(JSON.stringify(this.globalMemento.get(zj,[]))),o=await this.crypto.createHash(e.toString()),s=i.findIndex(a=>a.fileHash===o);for(s>=0&&(n=!0,i.splice(s,1)),t&&(n=!0,i.push({fileHash:o,kernelId:t}),q(`Storing Preferred remote kernel for ${Se(e)} is ${t}`));i.length>H_e;)n=!0,i.shift();n&&await this.globalMemento.update(zj,i)}};Xs=E([(0,sv.injectable)(),b(0,(0,sv.inject)(wt)),b(0,(0,sv.named)(ur)),b(1,(0,sv.inject)(Xv))],Xs);d();var vo=Symbol("IJupyterVariables"),MA=Symbol("IKernelVariableRequester");d();var ip=z(re()),OA=require("vscode");d();function Pu(r){if(typeof r!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof r}\``);var e=rZ();let t=e;return t.default&&(t=t.default),r.replace(t(),"")}var J_e=/Type:\s*(\w+)/,q_e=/Value:\s*(.*)/,G_e=/String form:\s*([\s\S]+?)\n/,Y_e=/Docstring:\s*(.*)/,$_e=/Length:\s+(.*)/,z_e=/^\s+\[(\d+) rows x (\d+) columns\]/m,Q_e=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]),LS=class{constructor(e,t,n,i){this.configService=e;this.disposables=n;this.kernelProvider=i;this.variableRequesters=new Map;this.cachedVariables=new Map;this.refreshEventEmitter=new OA.EventEmitter;this.variableRequesters.set(Qe,t)}get refreshRequired(){return this.refreshEventEmitter.event}async getAllVariableDiscriptions(e,t,n,i){let o=au(e.kernelConnectionMetadata)||Qe,s=this.variableRequesters.get(o);return s?s.getAllVariableDiscriptions(e,t,n,i):[]}async getVariables(e,t){return this.getVariablesBasedOnKernel(t,e)}async getMatchingVariable(e,t,n){let i=this.cachedVariables.get(t.uri.toString());if(i){let o=i.variables.find(s=>s.name===e);return o&&!o.value&&(o=await this.getVariableValueFromKernel(o,t,n)),o}else{let o=await this.getVariableNamesAndTypesFromKernel(t,n);if(o){let s=o.find(a=>a.name===e);if(s)return this.getVariableValueFromKernel({name:e,value:void 0,supportsDataExplorer:!1,type:s.type,size:0,count:0,shape:"",truncated:!0},t,n)}}}async getVariableValueSummary(e,t,n){if(!t)return;let i=au(t==null?void 0:t.kernelConnectionMetadata)||Qe,o=this.variableRequesters.get(i);if(o)return o.getVariableValueSummary(e,t,n)}async getDataFrameInfo(e,t,n,i){if(!t)return e;let o=au(t==null?void 0:t.kernelConnectionMetadata)||Qe,s=this.variableRequesters.get(o);if(s){i&&(e=await this.getFullVariable(e,t));let a=e.name;return n&&(a=`${e.name}${n}`),s.getDataFrameInfo(e,t,a)}return e}async getDataFrameRows(e,t,n,i,o){let s=au(i==null?void 0:i.kernelConnectionMetadata)||Qe,a=this.variableRequesters.get(s);if(a){let l=e.name;return o&&(l=`${e.name}${o}`),a.getDataFrameRows(t,n,i,l)}return{data:[]}}async getFullVariable(e,t,n){let i=au(t==null?void 0:t.kernelConnectionMetadata)||Qe,o=this.variableRequesters.get(i);return o?o.getFullVariable(e,t,n):e}async getVariablesBasedOnKernel(e,t){var l;let n=this.cachedVariables.get(e.uri.toString()),i=this.kernelProvider.getKernelExecution(e).pendingCells.length>0,o=this.kernelProvider.getKernelExecution(e);(!n||!i&&(n.currentExecutionCount!==t.executionCount||n.currentExecutionCount!==o.executionCount))&&(n={currentExecutionCount:o.executionCount,variables:(await this.getVariableNamesAndTypesFromKernel(e)).map(c=>({name:c.name,value:void 0,supportsDataExplorer:!1,type:c.type,size:0,shape:"",count:0,truncated:!0,fileName:e.notebook.uri}))});let s=this.configService.getSettings(e.resourceUri).variableExplorerExclude?(l=this.configService.getSettings().variableExplorerExclude)==null?void 0:l.split(";"):[],a={executionCount:o.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(n){let c=t.sortColumn,u=(m,h)=>{let g=m[c]?m[c]:"",v=h[c]?h[c]:"";return t.sortAscending?g.localeCompare(v,void 0,{sensitivity:"base"}):v.localeCompare(g,void 0,{sensitivity:"base"})};n.variables.sort(u);let p=t.startIndex?t.startIndex:0,f=t.pageSize?t.pageSize:100;a.pageStartIndex=p;for(let m=p;m<p+f&&m<n.variables.length;){if(s&&s.indexOf(n.variables[m].type)>=0){n.variables.splice(m,1);continue}let h=typeof n.variables[m].value=="string"?n.variables[m]:await this.getVariableValueFromKernel(n.variables[m],e);n.variables[m]=h,a.pageResponse.push(h),m+=1}this.cachedVariables.set(e.uri.toString(),n),a.totalCount=n.variables.length}return a}async getVariableProperties(e,t,n){let i=await this.getMatchingVariable(e,t,n),o=au(t.kernelConnectionMetadata)||Qe,s=this.variableRequesters.get(o);return s?s.getVariableProperties(e,n,i):{}}async getVariableNamesAndTypesFromKernel(e,t){let n=au(e.kernelConnectionMetadata)||Qe,i=this.variableRequesters.get(n);return i?i.getVariableNamesAndTypesFromKernel(e,t):[]}inspect(e,t,n=0,i){let o=Me();try{e.requestInspect({code:t,cursor_pos:n,detail_level:0}).then(s=>{s&&s.content.status==="ok"?o.resolve(s.content.data):o.resolve(void 0)}).catch(s=>{o.reject(s)})}catch(s){o.reject(s)}return i&&this.disposables.push(i.onCancellationRequested(()=>o.reject(new OA.CancellationError))),o.promise}async getVariableValueFromKernel(e,t,n){var o;let i={...e};if(!t.disposed&&((o=t.session)!=null&&o.kernel)){let s=await this.inspect(t.session.kernel,e.name,0,n);if(s&&s.hasOwnProperty("text/plain")){let a=Pu(s["text/plain"].toString()),l=J_e.exec(a),c=$_e.exec(a),u=z_e.exec(a);l&&(i.type=l[1]),i.value=[q_e,G_e,Y_e].reduce((p,f)=>{var m;return p||((m=f.exec(a))==null?void 0:m[1])||""},""),c&&(i.count=parseInt(c[1],10)),u&&(i.shape=`(${u[1]}, ${u[2]})`)}s&&s.type&&(i.type=s.type.toString()),s&&s.value&&(i.value=s.value.toString()),Q_e.has(i.type)&&(i.supportsDataExplorer=!0)}return i.type&&i.count&&!i.shape&&Qt(t.kernelConnectionMetadata)&&i.supportsDataExplorer&&i.type!=="list"&&(i=await this.getFullVariable(i,t)),i}};LS=E([(0,ip.injectable)(),b(0,(0,ip.inject)(Ke)),b(1,(0,ip.inject)(MA)),b(1,(0,ip.named)(st.PYTHON_VARIABLES_REQUESTER)),b(2,(0,ip.inject)(oe)),b(3,(0,ip.inject)($e))],LS);d();var op=z(re()),nZ=require("vscode");var av=class{constructor(e,t,n){this.kernelVariables=t;this.debuggerVariables=n;this.refreshEventEmitter=new nZ.EventEmitter;e.push(n.refreshRequired(this.fireRefresh.bind(this))),e.push(t.refreshRequired(this.fireRefresh.bind(this)))}get refreshRequired(){return this.refreshEventEmitter.event}getAllVariableDiscriptions(e,t,n,i){return this.variableHandler.getAllVariableDiscriptions(e,t,n,i)}async getVariables(e,t){return this.variableHandler.getVariables(e,t)}async getFullVariable(e,t){return this.variableHandler.getFullVariable(e,t)}async getMatchingVariable(e,t,n){return this.variableHandler.getMatchingVariable(e,t,n)}async getDataFrameInfo(e,t,n,i){return this.variableHandler.getDataFrameInfo(e,t,n,i)}async getVariableValueSummary(e,t,n){return this.variableHandler.getVariableValueSummary(e,t,n)}async getDataFrameRows(e,t,n,i,o){return this.variableHandler.getDataFrameRows(e,t,n,i,o)}get variableHandler(){return this.debuggerVariables.active?this.debuggerVariables:this.kernelVariables}fireRefresh(){this.refreshEventEmitter.fire()}};E([Fr("DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME")],av.prototype,"getVariables",1),av=E([(0,op.injectable)(),b(0,(0,op.inject)(oe)),b(1,(0,op.inject)(vo)),b(1,(0,op.named)(st.KERNEL_VARIABLES)),b(2,(0,op.inject)(vo)),b(2,(0,op.named)(st.DEBUGGER_VARIABLES))],av);d();var US=z(re());d();var KS=class extends ct{constructor(){super("unknown",_.jupyterDataRateExceeded)}};function Qj(r){let e=r.index,t=r.columns;return{data:r.data.map((o,s)=>{let a={index:e[s]};return t.forEach((l,c)=>{a[l]=o[c]}),a})}}async function LA(r,{code:e,initializeCode:t,cleanupCode:n},i){var o;if(r.disposed||r.disposing||!((o=r.session)!=null&&o.kernel)||!r.session.kernel||r.session.isDisposed)return[];try{return t&&await Ji(r.session.kernel,t,i),await Ji(r.session.kernel,e,i)}catch(s){if(s instanceof sn)return[];throw s}finally{n&&await Ji(r.session.kernel,n,i)}}var FS=class{constructor(e,t,n){this.varScriptGenerator=e;this.dfScriptGenerator=t;this.backgroundThreadService=n}async getDataFrameInfo(e,t,n){var c;let{code:i,cleanupCode:o,initializeCode:s}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!1,variableName:n}),a=await LA(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameInfo",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"}),l=((c=t.notebook)==null?void 0:c.uri)||t.resourceUri||t.uri;return{...e,...this.deserializeJupyterResult(a),fileName:l}}async getDataFrameRows(e,t,n,i){let{code:o,cleanupCode:s,initializeCode:a}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!1,variableName:i,startIndex:e,endIndex:t}),l=await LA(n,{code:o,cleanupCode:s,initializeCode:a},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameRows",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return l.length===0?{data:[]}:Qj(this.deserializeJupyterResult(l))}async getVariableProperties(e,t,n){let i={};return n&&n.value&&(i[`${e}`]=n.value),i}async getVariableValueSummary(e,t,n){let i=await this.varScriptGenerator.generateCodeToGetVariableValueSummary(e.name);try{let o=await this.backgroundThreadService.execCodeInBackgroundThread(t,i.split(/\r?\n/),n);return o==null?void 0:o.summary}catch(o){ue(`Exception when getting variable summary for variable "${e.name}": ${o.message}`);return}}async getAllVariableDiscriptions(e,t,n,i){if(!e.session)return[];let o=t?{root:t.root,propertyChain:t.propertyChain,startIndex:n}:void 0,s=await this.varScriptGenerator.generateCodeToGetAllVariableDescriptions(o),a=await this.backgroundThreadService.execCodeInBackgroundThread(e,s.split(/\r?\n/),i);if(e.disposed||e.disposing||i!=null&&i.isCancellationRequested||!a)return[];try{return a}catch(l){return O(l),[]}}async getVariableNamesAndTypesFromKernel(e,t){if(e.session){let{code:n,cleanupCode:i,initializeCode:o}=await this.varScriptGenerator.generateCodeToGetVariableTypes({isDebugging:!1}),s=await LA(e,{code:n,cleanupCode:i,initializeCode:o},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getVariableNamesAndTypesFromKernel",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});if(e.disposed||e.disposing)return[];let a=this.deserializeJupyterResult(s),l=[];for(let[c,u]of Object.entries(a)){let p={name:c,value:void 0,supportsDataExplorer:!1,type:u||"",size:0,shape:"",count:0,truncated:!0};l.push(p)}return l}return[]}async getFullVariable(e,t,n){let{code:i,cleanupCode:o,initializeCode:s}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!1,variableName:e.name}),a=await LA(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getFullVariable",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return{...e,...this.deserializeJupyterResult(a)}}extractJupyterResultText(e){if(e.length>0){let t=e[0];if(t&&t.output_type==="stream"&&t.name==="stderr"&&t.hasOwnProperty("text")){let n=t.text;if(n.includes("iopub_data_rate_limit"))throw new KS;{let i=_.jupyterGetVariablesExecutionError(n);throw O(i),new Error(i)}}if(t&&t.output_type==="execute_result"){let n=t.data;if(n&&n.hasOwnProperty("text/plain"))return n["text/plain"]}if(t&&t.output_type==="stream"&&t.hasOwnProperty("text"))return t.text;if(t&&t.output_type==="error"&&t.hasOwnProperty("traceback")){let i=t.traceback.map(Pu).join(`\r
`),o=_.jupyterGetVariablesExecutionError(i);throw O(o),new Error(o)}}throw new Error(_.jupyterGetVariablesBadResults)}deserializeJupyterResult(e){let t=this.extractJupyterResultText(e);return JSON.parse(t)}};FS=E([(0,US.injectable)(),b(0,(0,US.inject)(ey)),b(1,(0,US.inject)(ty)),b(2,(0,US.inject)(a1))],FS);d();var lv=z(re()),Zs=require("vscode");var WS=class{constructor(e,t,n,i){this.disposableRegistry=e;this.kernelProvider=t;this.serverUriStorage=n;this.jupyterUriProviderRegistration=i;this.kernelsStartedSuccessfully=new WeakSet;this.kernelConnectionToKernelMapping=new WeakMap;this.kernelsRestarting=new WeakSet;this.kernelReconnectProgress=new WeakMap;this.lastExecutedCellPerKernel=new WeakMap}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry),this.disposableRegistry.push(this.kernelProvider.onDidDisposeKernel(e=>{var t;(t=this.kernelReconnectProgress.get(e))==null||t.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(this.kernelProvider.onDidRestartKernel(e=>{var t;(t=this.kernelReconnectProgress.get(e))==null||t.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(Zs.notebooks.onDidChangeNotebookCellExecutionState(e=>{if(!_r(e.cell.notebook)||e.state!==Zs.NotebookCellExecutionState.Idle)return;let t=this.kernelProvider.get(e.cell.notebook);!t||this.lastExecutedCellPerKernel.get(t)!==e.cell||this.lastExecutedCellPerKernel.delete(t)}))}onDidStartKernel(e){var t,n,i;if(!this.kernelsStartedSuccessfully.has(e)){if(this.kernelProvider.getKernelExecution(e).onPreExecute(o=>this.lastExecutedCellPerKernel.set(e,o),this,this.disposableRegistry),!((t=e.session)!=null&&t.kernel))return;this.kernelsStartedSuccessfully.add(e),this.kernelConnectionToKernelMapping.set(e.session.kernel,e),(i=(n=e.session)==null?void 0:n.kernel)==null||i.connectionStatusChanged.connect(this.onKernelStatusChanged,this),e.onDisposed(()=>{var o;(o=this.kernelReconnectProgress.get(e))==null||o.dispose(),this.kernelReconnectProgress.delete(e)},this,this.disposableRegistry),e.addHook("willRestart",async()=>{var o;(o=this.kernelReconnectProgress.get(e))==null||o.dispose(),this.kernelReconnectProgress.delete(e),this.kernelsRestarting.add(e)},this,this.disposableRegistry),e.onRestarted(()=>this.kernelsRestarting.delete(e),this,this.disposableRegistry)}}onKernelStatusChanged(e,t){var i,o,s,a;let n=this.kernelConnectionToKernelMapping.get(e);if(n&&!this.kernelsRestarting.has(n))switch(t){case"connected":{(i=this.kernelReconnectProgress.get(n))==null||i.dispose(),this.kernelReconnectProgress.delete(n);return}case"disconnected":{this.kernelReconnectProgress.has(n)&&((o=this.kernelReconnectProgress.get(n))==null||o.dispose(),this.kernelReconnectProgress.delete(n),(s=this.onKernelDisconnected(n))==null||s.catch(y));return}case"connecting":this.kernelReconnectProgress.has(n)||(a=this.onKernelConnecting(n))==null||a.catch(y);return;default:return}}async onKernelConnecting(e){let t=Me(),n=new Zs.Disposable(()=>t.resolve());if(this.kernelReconnectProgress.set(e,n),Ft(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata))return;let i=_.automaticallyReconnectingToAKernelProgressMessage(ft(e.kernelConnectionMetadata));Zs.window.withProgress({location:Zs.ProgressLocation.Notification,title:i},async()=>t.promise).then(y,y),this.disposableRegistry.push(n)}async onKernelDisconnected(e){var n;if(e.disposed||e.disposing||(Rr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),Ft(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata)))return;let t=or(e.kernelConnectionMetadata)?_.kernelDisconnected(ft(e.kernelConnectionMetadata)):_.remoteJupyterConnectionFailedWithServer(e.kernelConnectionMetadata.baseUrl);Zs.window.showErrorMessage(t).then(y,y);try{let i=this.lastExecutedCellPerKernel.get(e);if(!i||i.document.isClosed||i.notebook.isClosed||((n=i.executionSummary)==null?void 0:n.success)===!1)return;await Yf(i,e.controller,t,!1)}finally{await e.dispose()}}async handleRemoteServerShutdown(e,t){var o;let n=this.jupyterUriProviderRegistration.jupyterCollections.find(s=>s.extensionId===t.serverProviderHandle.extensionId&&s.id===t.serverProviderHandle.id);if(!n)return!1;let i=new Zs.CancellationTokenSource;try{return(await Promise.resolve(n.serverProvider.provideJupyterServers(i.token))||[]).map(l=>l.id).includes(t.serverProviderHandle.handle)?!1:(await this.serverUriStorage.remove(t.serverProviderHandle),(o=this.kernelReconnectProgress.get(e))==null||o.dispose(),this.kernelReconnectProgress.delete(e),!0)}catch(s){return!1}finally{i.dispose()}}};WS=E([(0,lv.injectable)(),b(0,(0,lv.inject)(oe)),b(1,(0,lv.inject)($e)),b(2,(0,lv.inject)(yr)),b(3,(0,lv.inject)(mr))],WS);d();var iZ=z(re());var VS=class{isTrusted(e){return!0}};VS=E([(0,iZ.injectable)()],VS);d();var jS=Symbol("ITrustedKernelPaths");d();var gD=z(re());var oZ=require("vscode");var BS=class{constructor(e,t){this.kernelProvider=e;this.disposables=[];this.restartProgress=new WeakMap;this.interruptProgress=new WeakMap;t.push(this)}dispose(){he(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables)}onDidCreateKernel(e){e.addHook("willRestart",async()=>{var n;(n=this.restartProgress.get(e))==null||n.dispose();let t=Jt.createProgressReporter(e.resourceUri,_.restartingKernelStatus(`: ${ft(e.kernelConnectionMetadata)}`));this.restartProgress.set(e,t)},this,this.disposables),e.addHook("restartCompleted",async()=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables),e.addHook("willInterrupt",async()=>{let t=new Wi,n=setTimeout(()=>{t.isDisposed||t.add(Jt.createProgressReporter(e.resourceUri,_.interruptKernelStatus(ft(e.kernelConnectionMetadata))))},1e3);t.add(new oZ.Disposable(()=>clearTimeout(n))),this.interruptProgress.set(e,t)},this,this.disposables),e.addHook("interruptCompleted",async()=>{var t;return(t=this.interruptProgress.get(e))==null?void 0:t.dispose()},this,this.disposables)}};BS=E([(0,gD.injectable)(),b(0,(0,gD.inject)($e)),b(1,(0,gD.inject)(oe))],BS);d();var vD=z(re()),Xj=require("vscode");var HS=class{constructor(e,t){this.kernelFinder=t;this.disposables=[];e.push(this)}dispose(){he(this.disposables)}activate(){this.startRefresh()}startRefresh(){if(!this.refreshedOnceBefore){if(this.kernelFinder.status==="discovering")return this.displayProgressIndicator();this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="discovering"&&this.displayProgressIndicator()},this,this.disposables)}}displayProgressIndicator(){let e=Date.now().toString();q(`Start refreshing Kernel Picker (${e})`);let t=Xj.notebooks.createNotebookControllerDetectionTask(Ct),n=Xj.notebooks.createNotebookControllerDetectionTask(St);this.disposables.push(t),this.disposables.push(n),this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="idle"&&(q(`End refreshing Kernel Picker (${e})`),t.dispose(),n.dispose())},this,this.disposables)}};HS=E([(0,vD.injectable)(),b(0,(0,vD.inject)(oe)),b(1,(0,vD.inject)(di))],HS);d();var qS=z(re()),Zj=require("vscode");var X_e=1e3,JS=class{constructor(e,t,n){this.serverStorage=e;this.kernelProvider=t;this.disposables=[];this.monitoredKernels=new WeakSet;this.timeouts=new Set;n.push(this)}dispose(){he(this.disposables),he(Array.from(this.timeouts.values()))}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables),this.kernelProvider.onDidRestartKernel(this.onDidStartKernel,this,this.disposables)}onDidStartKernel(e){let t=e.kernelConnectionMetadata;if(!Ft(t)||this.monitoredKernels.has(e))return;this.monitoredKernels.add(e);let n=[];this.disposables.push(new Zj.Disposable(()=>he(n)));let i=()=>{if(he(n),e.disposed||e.disposing)return;let o=setTimeout(()=>{this.serverStorage.update(t.serverProviderHandle).catch(y)},X_e);n.push(new Zj.Disposable(()=>clearTimeout(o)))};this.kernelProvider.getKernelExecution(e).onPreExecute(i,this,this.disposables),i()}};JS=E([(0,qS.injectable)(),b(0,(0,qS.inject)(yr)),b(1,(0,qS.inject)($e)),b(2,(0,qS.inject)(oe))],JS);d();var sZ=z(re());var GS=class{async installMissingDependencies(e){return 1}async areDependenciesInstalled(e,t,n){return!1}};GS=E([(0,sZ.injectable)()],GS);d();var aZ=z(re());var YS=class{constructor(){this.providers=new Map}getProviders(e){return(this.providers.get(e)||[]).slice()}register(e,t){this.providers.set(t,this.providers.get(t)||[]),this.providers.get(t).push(e)}};YS=E([(0,aZ.injectable)()],YS);d();var cv=z(re());var cZ=require("vscode");var lZ=1e3*60*60*24*2,oc=class extends zr{constructor(t,n,i,o){super();this.serverStorage=n;this.context=i;this.fs=o;this.executedCells=new WeakMap;this.chainedPromises=Promise.resolve();i.globalStorageUri,t.push(this),this.storageFile=cZ.Uri.joinPath(this.context.globalStorageUri,"lastExecutedRemoteCell.json")}activate(){this._register(this.serverStorage.onDidRemove(this.onDidRemoveServers,this))}async getLastTrackedCellExecution(t,n){var s;if(t.isUntitled||!Ft(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;if(this.staleState&&this.staleState[t.uri.toString()])return this.staleState[t.uri.toString()];let i=await this.getStorageFile(),o={};try{let a=await this.fs.readFile(i);o=JSON.parse(a.toString()),this.staleState=o}catch(a){return}return o[t.uri.toString()]}trackCellExecution(t,n){if(!Ft(n.kernelConnectionMetadata)||t.document.isUntitled)return;this.executedCells.delete(t);let i=[],o=(a,l)=>{var c,u;if(l.direction==="send"){let p=l.msg;if(p.header.msg_type==="execute_request"&&p.metadata&&typeof p.metadata=="object"&&p.metadata&&"cellId"in p.metadata&&typeof p.metadata.cellId=="string"&&p.metadata.cellId===t.document.uri.toString()){let f=p.header.msg_id;this.executedCells.set(t,{msg_id:f,kernelId:((u=(c=n.session)==null?void 0:c.kernel)==null?void 0:u.id)||"",cellIndex:t.index})}}else if(l.direction==="recv"){let p=l.msg,f=this.executedCells.get(t);if(f!=null&&f.msg_id&&np(p)===f.msg_id){if(!f.startTime){f.startTime=new Date().getTime();try{f.startTime=new Date(p.header.date).getTime()}catch(m){}this.executedCells.set(t,f)}"execution_count"in p.content&&typeof p.content.execution_count=="number"&&!f.executionCount&&f.executionCount!==p.content.execution_count&&(f.executionCount=p.content.execution_count,this.executedCells.set(t,f),this.trackLastExecution(t,n,f),he(i))}}},s=()=>{let a=n.session;a&&(a.anyMessage.connect(o),i.push({dispose:()=>aa(()=>{var l;return(l=a.anyMessage)==null?void 0:l.disconnect(o)})}))};n.onStarted(()=>s(),i),n.session&&s()}deleteTrackedCellExecution(t,n){var i;t.notebook.isUntitled||!Ft(n.kernelConnectionMetadata)||!((i=n.session)!=null&&i.id)||(this.chainedPromises=this.chainedPromises.finally(async()=>{let o={};try{let a=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));o=JSON.parse(a.toString())}catch(a){return}let s=t.notebook.uri.toString();o[s].cellIndex===t.index&&(delete o[s],this.staleState=o,await this.fs.writeFile(this.storageFile,JSON.stringify(o)))}))}getStorageFile(){return this.ensureStorageExistsPromise=this.ensureStorageExistsPromise||(async()=>(await this.fs.createDirectory(this.context.globalStorageUri),this.storageFile))(),this.ensureStorageExistsPromise}trackLastExecution(t,n,i){var s,a,l,c;if(!i.executionCount||!i.msg_id||!i.startTime||!Ft(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;let o={cellIndex:t.index,executionCount:i.executionCount,kernelId:((l=(a=n.session)==null?void 0:a.kernel)==null?void 0:l.id)||"",msg_id:i.msg_id,serverId:zt(n.kernelConnectionMetadata.serverProviderHandle),sessionId:(c=n.session)==null?void 0:c.id,startTime:i.startTime};this.chainedPromises=this.chainedPromises.finally(async()=>{let u={};try{let f=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));u=JSON.parse(f.toString())}catch(f){}let p=t.notebook.uri.toString();u[p]=o,this.removeOldItems(u),this.staleState=u,await this.fs.writeFile(this.storageFile,JSON.stringify(u))})}onDidRemoveServers(t){t.length!==0&&(this.chainedPromises=this.chainedPromises.finally(async()=>{await this.getStorageFile();let n={};try{let s=await this.fs.readFile(this.storageFile);n=JSON.parse(s.toString())}catch(s){}let i=!1,o=new Set(t.map(s=>zt(s)));Object.keys(n).forEach(s=>{let a=n[s];(o.has(a.serverId)||Date.now()-a.startTime>lZ)&&(delete n[s],i=!0)}),i&&(this.removeOldItems(n),this.staleState=n,await this.fs.writeFile(this.storageFile,JSON.stringify(n)))}))}removeOldItems(t){Object.keys(t).forEach(n=>{let i=t[n];i&&Date.now()-i.startTime>lZ&&delete t[n]})}};oc=E([(0,cv.injectable)(),b(0,(0,cv.inject)(oe)),b(1,(0,cv.inject)(yr)),b(2,(0,cv.inject)(ut)),b(3,(0,cv.inject)(Tt))],oc);d();var zS=z(re());var yD=require("vscode");var $S=class{constructor(e,t,n){this.serverUriStorage=e;this.registrations=t;this.disposables=n}activate(){this.disposables.push(yD.commands.registerCommand(X.ClearSavedJupyterUris,async()=>{await this.serverUriStorage.clear().catch(y),await Promise.all(this.registrations.jupyterCollections.filter(e=>e.id.startsWith("_builtin")||e.extensionId===Xe).map(async e=>{if(!e.serverProvider||!e.serverProvider.removeJupyterServer)return;let t=new yD.CancellationTokenSource,n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await Promise.all((n||[]).map(i=>e.serverProvider.removeJupyterServer(i).catch(y)))})).catch(y),await yD.commands.executeCommand("dataScience.ClearUserProviderJupyterServerCache").then(y,y)},this))}};$S=E([(0,zS.injectable)(),b(0,(0,zS.inject)(yr)),b(1,(0,zS.inject)(mr)),b(2,(0,zS.inject)(oe))],$S);d();var KA=z(re());var QS=class{constructor(e){this.registry=e;this.priority=0}activate(){this.registry.register(this,Ct),this.registry.register(this,St)}async getCode(e){return Qt(e.kernelConnectionMetadata)?[dz]:[]}};QS=E([(0,KA.injectable)(),b(0,(0,KA.inject)(Hd))],QS);var bD=class{constructor(){this.isSupported=!1}};bD=E([(0,uZ.injectable)()],bD);function dZ(r,e){r.addSingleton(ep,bD),zb("isInsiderExtension",Uv()?"true":"false");let t=r.get(wo);zb("isPythonExtensionInstalled",t.isPythonExtensionInstalled?"true":"false");let n=r.get(ep);zb("rawKernelSupported",n.isSupported?"true":"false"),r.addSingleton(Hd,YS),r.addSingleton(MA,FS,st.PYTHON_VARIABLES_REQUESTER),r.addSingleton(vo,av,st.ALL_VARIABLES),r.addSingleton(vo,LS,st.KERNEL_VARIABLES),r.addSingleton(He,tv),r.addSingleton(He,HS),r.addSingleton(He,BS),r.addSingleton(He,WS),r.addSingleton(He,JS),r.addSingleton($e,RS),r.addSingleton(jS,VS),r.addSingleton(Gg,AS),r.addSingleton(Xs,Xs),r.addSingleton(di,MS),r.addSingleton(_I,GS),r.addSingleton(He,$S),r.addSingleton(oc,oc),r.addBinding(oc,He),GX(r,e),r.addSingleton(He,pn),r.addSingleton(He,QS)}d();d();var XS=z(re()),dv=require("vscode");var uv=class{constructor(e,t,n){this.disposables=e;this.controllerRegistration=t;this.preferredRemoteKernelIdProvider=n}activate(){dv.workspace.onDidOpenNotebookDocument(this.onDidOpenNotebook,this,this.disposables),dv.workspace.notebookDocuments.forEach(e=>this.onDidOpenNotebook(e))}async onDidOpenNotebook(e){if(!_r(e))return;let t=await this.preferredRemoteKernelIdProvider.getPreferredRemoteKernelId(e);if(!t)return;let n=()=>{let o=this.controllerRegistration.getSelected(e),s=this.controllerRegistration.registered.find(a=>a.id===t);return s&&(o==null?void 0:o.id)!==s.id?(this.switchKernel(e,s.connection).catch(y),!0):!1};if(n())return;let i=this.controllerRegistration.onDidChange(o=>{o.added.length&&n()&&i.dispose()},this,this.disposables);this.controllerRegistration.onControllerSelected(o=>{o.notebook===e&&i.dispose()},this,this.disposables)}async switchKernel(e,t){q(`Using notebook.selectKernel to force remote kernel for ${Se(e.uri)} to ${t.id}`),await dv.commands.executeCommand("notebook.selectKernel",{id:t.id,extension:Xe}),await dP(async()=>{var i;if(((i=dv.window.activeNotebookEditor)==null?void 0:i.notebook)===e){let o=this.controllerRegistration.getSelected(e);if((o==null?void 0:o.connection.id)===t.id)return o.restoreConnection(e).catch(y),!0}return!1},2e3,100)?q(`Successfully switched remote kernel for ${Se(e.uri)} to ${t.id}`):ue(`Failed to switch remote kernel for ${Se(e.uri)} to ${t.id}`)}};E([_n()],uv.prototype,"onDidOpenNotebook",1),uv=E([(0,XS.injectable)(),b(0,(0,XS.inject)(oe)),b(1,(0,XS.inject)(Ht)),b(2,(0,XS.inject)(Xs))],uv);d();var ZS=z(re()),vm=require("vscode");d();var pZ=Symbol("IServiceManager"),jr=Symbol("IServiceContainer");d();var Ss=require("vscode");d();d();var SD=z(re()),yZ=require("vscode");d();var e9=z(iv()),hZ=require("vscode");d();function fZ(r){if(!r||!Array.isArray(r)||r.length===0)return;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=Array.apply(null,new Uint8Array(n.buffer));e.push({...n,byteLength:n.byteLength,byteOffset:n.byteOffset,buffer:i})}else e.push([...new Uint8Array(n)])}return e}function mZ(r){if(!Array.isArray(r)||r.length===0)return r;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=new Uint8Array(n.buffer).buffer,o=new DataView(i,n.byteOffset,n.byteLength);e.push(o)}else{let i=new Uint8Array(n).buffer;e.push(i)}}return e}var ID=new WeakMap;function gZ(r,e){let t=ID.get(r);t&&(t.targets.add(e),t.registerCommTarget(e))}function vZ(r,e){var t,n,i;(i=(n=(t=ID.get(r))==null?void 0:t.targets)==null?void 0:n.delete)==null||i.call(n,e)}var FA=class{constructor(e,t){this.kernelProvider=e;this.document=t;this.commTargetsRegistered=new Set;this.pendingTargetNames=new Set;this._postMessageEmitter=new hZ.EventEmitter;this.messageHooks=new Map;this.pendingHookRemovals=new Map;this.messageHookRequests=new Map;this.disposables=[];this.disposed=!1;this.pendingMessages=[];this.subscribedToKernelSocket=!1;this.waitingMessageIds=new Map;this.totalWaitTime=0;this.totalWaitedMessages=0;this.hookCount=0;this.outputWidgetIds=new Set;this.isUsingIPyWidgets=!1;this.pendingTargetNames.add("jupyter.widget"),e.onDidStartKernel(i=>{i.notebook===t&&this.initialize()},this,this.disposables),this.mirrorSend=this.mirrorSend.bind(this),this.onKernelSocketMessage=this.onKernelSocketMessage.bind(this);let n=eV();this.deserialize=n.deserialize}get postMessage(){return this._postMessageEmitter.event}dispose(){for(this.sendOverheadTelemetry(),this.disposed=!0;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}receiveMessage(e){switch(e.message){case"IPyWidgets_logMessage":{let t=e.payload;t.category==="error"?O(`Widget Error: ${t.message}`):q(`Widget Message: ${t.message}`);break}case"IPyWidgets_Ready":this.sendKernelOptions(),this.initialize();break;case"IPyWidgets_msg":this.sendRawPayloadToKernelSocket(e.payload);break;case"IPyWidgets_binary_msg":this.sendRawPayloadToKernelSocket(mZ(e.payload)[0]);break;case"IPyWidgets_msg_received":this.onKernelSocketResponse(e.payload);break;case"IPyWidgets_registerCommTarget":this.registerCommTarget(e.payload);break;case"IPyWidgets_RegisterMessageHook":this.registerMessageHook(e.payload);break;case"IPyWidgets_RemoveMessageHook":this.possiblyRemoveMessageHook(e.payload);break;case"IPyWidgets_MessageHookResult":this.handleMessageHookResponse(e.payload);break;case"IPyWidgets_iopub_msg_handled":this.iopubMessageHandled(e.payload);break;default:break}}sendRawPayloadToKernelSocket(e){this.pendingMessages.push(e),this.sendPendingMessages()}registerCommTarget(e){this.pendingTargetNames.add(e),this.initialize()}initialize(){this.jupyterLab||(this.jupyterLab=ci());let e=this.getKernel();e&&(this.subscribeToKernelSocket(e),this.registerCommTargets(e))}raisePostMessage(e,t){this._postMessageEmitter.fire({message:e,payload:t})}subscribeToKernelSocket(e){var n;if(this.subscribedToKernelSocket||!e.session)return;this.subscribedToKernelSocket=!0,this.subscribeToKernelSocketImpl(e);let t=(n=e.session.kernel)==null?void 0:n.id;e.session.onDidKernelSocketChange(()=>{var i,o;this.subscribeToKernelSocketImpl(e,t),t=((o=(i=e.session)==null?void 0:i.kernel)==null?void 0:o.id)||""})}subscribeToKernelSocketImpl(e,t){var s,a,l,c,u;let n=t?Ys.get(t):void 0;if(n==null||n.removeReceiveHook(this.onKernelSocketMessage),n==null||n.removeSendHook(this.mirrorSend),this.kernelWasConnectedAtLeastOnce){for(;this.pendingMessages.length;)this.pendingMessages.shift();this.waitingMessageIds.forEach(p=>p.resultPromise.resolve()),this.waitingMessageIds.clear(),this.messageHookRequests.forEach(p=>p.resolve(!1)),this.messageHookRequests.clear(),this.messageHooks.clear(),this.sendRestartKernel()}if(!((a=(s=e.session)==null?void 0:s.kernel)!=null&&a.id)||!Ys.get((c=(l=e.session)==null?void 0:l.kernel)==null?void 0:c.id))return;ID.has(e.session.kernel)||ID.set(e.session.kernel,{targets:new Set,registerCommTarget:p=>{this.raisePostMessage("IPyWidgets_registerCommTarget",p)}}),this.kernelWasConnectedAtLeastOnce=!0;let i=(u=e.session.kernel)==null?void 0:u.id,o=i?Ys.get(i):void 0;o==null||o.addReceiveHook(this.onKernelSocketMessage),o==null||o.addSendHook(this.mirrorSend),this.sendKernelOptions(),this.registerCommTargets(e),this.sendPendingMessages()}sendKernelOptions(){var e,t,n,i,o,s,a,l,c,u,p,f,m,h;(t=(e=this.kernel)==null?void 0:e.session)!=null&&t.kernel&&this.raisePostMessage("IPyWidgets_kernelOptions",{id:((o=(i=(n=this.kernel)==null?void 0:n.session)==null?void 0:i.kernel)==null?void 0:o.id)||"",clientId:((l=(a=(s=this.kernel)==null?void 0:s.session)==null?void 0:a.kernel)==null?void 0:l.clientId)||"",userName:((p=(u=(c=this.kernel)==null?void 0:c.session)==null?void 0:u.kernel)==null?void 0:p.username)||"",model:((h=(m=(f=this.kernel)==null?void 0:f.session)==null?void 0:m.kernel)==null?void 0:h.model)||{id:"",name:""}})}async mirrorSend(e,t){if(typeof e=="string"&&e.includes("shell")&&e.includes("execute_request")){let n=Date.now(),i=this.deserialize(e);if(i.channel==="shell"&&i.header.msg_type==="execute_request"){if(!wA(i))return;let o=this.mirrorExecuteRequest(i);this.isUsingIPyWidgets&&await o,this.totalWaitTime=Date.now()-n,this.totalWaitedMessages+=1}}}sendRestartKernel(){this.raisePostMessage("IPyWidgets_onRestartKernel",void 0)}mirrorExecuteRequest(e){let t=Me();return this.waitingMessageIds.set(e.header.msg_id,{startTime:Date.now(),resultPromise:t}),this.raisePostMessage("IPyWidgets_mirror_execute",{id:e.header.msg_id,msg:e}),t.promise}messageNeedsFullHandle(e){var t,n,i,o;return e.channel==="iopub"&&((t=e.header)==null?void 0:t.msg_type)==="comm_msg"&&((i=(n=e.content)==null?void 0:n.data)==null?void 0:i.method)==="update"&&this.outputWidgetIds.has((o=e.content)==null?void 0:o.comm_id)}iopubMessageHandled(e){let t=e.id;this.fullHandleMessage&&this.fullHandleMessage.id===t&&(this.fullHandleMessage.promise.resolve(),this.fullHandleMessage=void 0)}async onKernelSocketMessage(e){var o,s,a,l,c,u,p,f,m;let t=(0,e9.default)(),n=Me();if(this.waitingMessageIds.set(t,{startTime:Date.now(),resultPromise:n}),typeof e=="string"?wA(e)&&this.raisePostMessage("IPyWidgets_msg",{id:t,data:e}):this.raisePostMessage("IPyWidgets_binary_msg",{id:t,data:fZ([e])}),typeof e!="string"||e.includes(Io)||e.includes(st.DefaultCommTarget)||e.includes("comm_open")||e.includes("comm_close")||e.includes("comm_msg")){let h=this.deserialize(e);if(!wA(h))return;h&&h.content&&h.content.data&&(h.content.data[Io]||h.content.target_name===st.DefaultCommTarget)&&(this.isUsingIPyWidgets=!0);let g=((o=h.header)==null?void 0:o.msg_type)==="comm_open"&&((l=(a=(s=h.content)==null?void 0:s.data)==null?void 0:a.state)==null?void 0:l._model_module)==="@jupyter-widgets/output"&&((p=(u=(c=h.content)==null?void 0:c.data)==null?void 0:u.state)==null?void 0:p._model_name)==="OutputModel",v=((f=h.header)==null?void 0:f.msg_type)==="comm_close"&&this.outputWidgetIds.has((m=h.content)==null?void 0:m.comm_id);g?this.outputWidgetIds.add(h.content.comm_id):v?this.outputWidgetIds.delete(h.content.comm_id):this.messageNeedsFullHandle(h)&&(this.fullHandleMessage={id:h.header.msg_id,promise:Me()},await n.promise,await this.fullHandleMessage.promise.promise,this.fullHandleMessage=void 0)}}onKernelSocketResponse(e){let t=this.waitingMessageIds.get(e.id);t&&(this.waitingMessageIds.delete(e.id),this.totalWaitTime+=Date.now()-t.startTime,this.totalWaitedMessages+=1,t.resultPromise.resolve())}sendPendingMessages(){var e,t,n;if((t=(e=this.kernel)==null?void 0:e.session)!=null&&t.kernel)for(;this.pendingMessages.length;)try{let i=this.pendingMessages[0],o=typeof i=="string"?JSON.parse(i):this.deserialize(i);(n=o.buffers)!=null&&n.length&&(o.buffers=o.buffers.map(s=>s instanceof DataView?s.buffer:s)),o.channel==="control"?this.kernel.session.kernel.sendControlMessage(o):this.kernel.session.kernel.sendShellMessage(o),this.pendingMessages.shift()}catch(i){O("Failed to send message to Kernel",i);return}}registerCommTargets(e){var t,n,i;for(;this.pendingTargetNames.size>0;){let s=Array.from([...this.pendingTargetNames.values()]).shift();if(s){if(this.commTargetsRegistered.has(s))return;q(`Registering commtarget ${s}`),this.commTargetsRegistered.add(s),this.pendingTargetNames.delete(s),(t=e.session)!=null&&t.kernel&&s!==st.DefaultCommTarget&&!((i=(n=ID.get(e.session.kernel))==null?void 0:n.targets)!=null&&i.has(s))&&e.session.kernel.registerCommTarget(s,y)}}}getKernel(){var e,t;return this.document&&!((e=this.kernel)!=null&&e.session)&&(this.kernel=this.kernelProvider.get(this.document),(t=this.kernel)==null||t.onDisposed(()=>this.kernel=void 0)),this.kernel&&!this.kernelRestartHandlerAttached&&(this.kernelRestartHandlerAttached=!0,this.disposables.push(this.kernel.onRestarted(this.handleKernelRestarts,this))),this.kernel}async handleKernelRestarts(){var e;this.disposed||this.commTargetsRegistered.size===0||!((e=this.kernel)!=null&&e.session)||(Array.from(this.commTargetsRegistered.keys()).forEach(t=>{this.commTargetsRegistered.delete(t),this.pendingTargetNames.add(t)}),this.subscribeToKernelSocket(this.kernel),this.registerCommTargets(this.kernel))}registerMessageHook(e){var t,n;try{if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&!this.messageHooks.has(e)){this.hookCount+=1;let i=this.messageHookCallback.bind(this);this.messageHooks.set(e,i),this.kernel.session.kernel.registerMessageHook(e,i)}}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e,type:"IPyWidgets_RegisterMessageHook"})}}possiblyRemoveMessageHook(e){try{e.lastHookedMsgId?this.pendingHookRemovals.set(e.lastHookedMsgId,e.hookMsgId):this.removeMessageHook(e.hookMsgId)}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e.hookMsgId,type:"IPyWidgets_RemoveMessageHook"})}}removeMessageHook(e){var t,n;if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&this.messageHooks.has(e)){let i=this.messageHooks.get(e);this.messageHooks.delete(e),this.kernel.session.kernel.removeMessageHook(e,i)}}async messageHookCallback(e){let t=Me(),n=(0,e9.default)(),i=e.parent_header.msg_id;if(this.messageHooks.has(i)?(this.messageHookRequests.set(n,t),this.raisePostMessage("IPyWidgets_MessageHookCall",{requestId:n,parentId:i,msg:e})):t.resolve(!0),this.pendingHookRemovals.has(e.header.msg_id)){let o=this.pendingHookRemovals.get(e.header.msg_id);this.pendingHookRemovals.delete(e.header.msg_id),this.removeMessageHook(o)}return t.promise}handleMessageHookResponse(e){let t=this.messageHookRequests.get(e.requestId);t&&(this.messageHookRequests.delete(e.requestId),t.resolve(e.msgType.includes("comm")?!0:e.result))}sendOverheadTelemetry(){J("DS_INTERNAL.IPYWIDGET_OVERHEAD",{totalOverheadInMs:this.totalWaitTime,numberOfMessagesWaitedOn:this.totalWaitedMessages,averageWaitTime:this.totalWaitTime/this.totalWaitedMessages,numberOfRegisteredHooks:this.hookCount})}};var t9=class{constructor(e,t){this.baseMulticaster=e;this.oldMessages=t;this._postMessageEmitter=new yZ.EventEmitter;this.disposables=[];e.postMessage(this.raisePostMessage,this,this.disposables)}get postMessage(){return this._postMessageEmitter.event}dispose(){for(;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}initialize(){return this.baseMulticaster.initialize()}receiveMessage(e){this.baseMulticaster.receiveMessage(e)}raisePostMessage(e){this.oldMessages.forEach(t=>{this._postMessageEmitter.fire(t)}),this.oldMessages=[],this._postMessageEmitter.fire(e)}},sp=class{constructor(e,t){this.kernelProvider=t;this.messageDispatchers=new WeakMap;this.messagesPerNotebook=new WeakMap;this.disposed=!1;this.disposables=[];e.push(this),t.onDidDisposeKernel(this.trackDisposingOfKernels,this,e)}dispose(){var e;for(this.disposed=!0;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}create(e){let t=this.messageDispatchers.get(e);t||(t=new FA(this.kernelProvider,e),this.messageDispatchers.set(e,t),this.disposables.push(t.postMessage(o=>this.onMessage(o,e),this)));let n=[];e&&this.messagesPerNotebook.get(e)&&(n=this.messagesPerNotebook.get(e)||[]);let i=new t9(t,n);return this.disposables.push(i),i}trackDisposingOfKernels(e){if(this.disposed)return;let t=e.notebook,n=this.messageDispatchers.get(t);this.messageDispatchers.delete(t),n==null||n.dispose()}onMessage(e,t){t&&(this.messagesPerNotebook.set(t,this.messagesPerNotebook.get(t)||[]),(e.message==="IPyWidgets_kernelOptions"||e.message==="IPyWidgets_registerCommTarget")&&this.messagesPerNotebook.get(t).push(e))}};sp=E([(0,SD.injectable)(),b(0,(0,SD.inject)(oe)),b(1,(0,SD.inject)($e))],sp);d();var SZ=require("vscode");d();var bZ=require("vscode");var pv=class pv extends zr{constructor(t,n,i,o,s,a){super();this.kernel=t;this.localResourceUriConverter=n;this.configurationSettings=i;this.sourceProviderFactory=o;this.isWebViewOnline=s;this.cdnScriptProvider=a;this.id="all";this.scriptProviders=this.sourceProviderFactory.getProviders(this.kernel,this.localResourceUriConverter),this.scriptProviders.forEach(l=>this._register(l)),this.monitorKernel()}get configuredScriptSources(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}async getBaseUrl(){let t=this.scriptProviders.find(n=>n.getBaseUrl);if(t)return t.getBaseUrl()}async getWidgetScriptSources(){let t=[];return await Promise.all(this.scriptProviders.map(async n=>{n.getWidgetScriptSources&&t.push(...await n.getWidgetScriptSources())})),t}async getWidgetScriptSource(t,n){let i=await this.isWebViewOnline,o=this.scriptProviders.slice(),s={moduleName:t};for(;o.length;){let a=o.shift();if(!a)continue;let l=await a.getWidgetScriptSource(t,n,i);if(l.scriptUri){s=l;break}else ue(`Widget Script Source not found for ${t}@${n} from ${a.id}`)}return this.sendTelemetryForWidgetModule(t,n,"",s.source).catch(y),s.scriptUri?q(`Script source for Widget ${t}@${n} was found from source ${s.source} and ${s.scriptUri}`):O(`Script source for Widget ${t}@${n} not found in ${this.scriptProviders.map(a=>a.id).join(", ")}`),s}async sendTelemetryForWidgetModule(t,n,i,o){let s=`${t}.${t}@${n}`;if(pv.trackedWidgetModuleNames.has(s))return;pv.trackedWidgetModuleNames.add(s);let a=t.toLowerCase().startsWith("@jupyter-widgets"),l=o==="cdn"||a||await this.cdnScriptProvider.isOnCDN(t),c=l?t.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0,u=l?i.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0;J("DS_INTERNAL.IPYWIDGET_USED_BY_USER",void 0,{hashedName:await Ot(t),moduleName:c,modelName:u,source:o,moduleVersion:l?n:void 0,cdnSearched:this.configuredScriptSources.length>0})}monitorKernel(){this.hookKernelEvents(),this._register(this.kernel.onStarted(this.hookKernelEvents,this)),this._register(this.kernel.onRestarted(this.hookKernelEvents,this)),this._register(this.kernel.onDidKernelSocketChange(()=>this.hookKernelEvents(),this))}hookKernelEvents(){var n;let t=(n=this.kernel.session)==null?void 0:n.kernel;t&&(t.anyMessage.connect(this.onAnyMessage,this),this._register(new bZ.Disposable(()=>t.anyMessage.disconnect(this.onAnyMessage,this))))}onAnyMessage(t,n){var i,o,s,a;if(n.direction==="recv"&&n.msg.header.msg_type==="comm_open"){let c=n.msg.content.data;(i=c.state)!=null&&i._model_module&&c.state._model_name&&this.sendTelemetryForWidgetModule((o=c.state)==null?void 0:o._model_module,((s=c.state)==null?void 0:s._model_module_version)||"",(a=c.state)==null?void 0:a._model_name).catch(y)}}};pv.trackedWidgetModuleNames=new Set,E([_n()],pv.prototype,"sendTelemetryForWidgetModule",1),E([_n()],pv.prototype,"onAnyMessage",1);var WA=pv;d();var VA=class{constructor(e,t){this.isWebExtension=e;this.converter=t}async asWebviewUri(e){return this.isWebExtension?e:this.converter(e)}};d();var r9=class{constructor(e,t){this.uri=e;this.value=t}};function eEe(r){return Array.isArray(r)}var tEe,fv=class fv{constructor(e,t){this[tEe]="ResourceMap";if(e instanceof fv)this.map=new Map(e.map),this.toKey=t!=null?t:fv.defaultToKey;else if(eEe(e)){this.map=new Map,this.toKey=t!=null?t:fv.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e!=null?e:fv.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new r9(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t!="undefined"&&(e=e.bind(t));for(let[,n]of this.map)e(n.value,n.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(tEe=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}};fv.defaultToKey=e=>e.toString();var Tu=fv,rEe,jA=class{constructor(e,t){this[rEe]="ResourceSet";!e||typeof e=="function"?this._map=new Tu(e):(this._map=new Tu(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(rEe=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var nEe,IZ=class{constructor(){this[nEe]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[(nEe=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};var BA=class{constructor(e,t,n,i,o,s){this.document=e;this.kernelProvider=t;this.configurationSettings=i;this.sourceProviderFactory=o;this.cdnScriptProvider=s;this.postEmitter=new SZ.EventEmitter;this.disposables=[];this.isWebViewOnline=Me();this.widgetSources=new Map;this.pendingModuleRequests=new Map;this.uriTranslationRequests=new Tu;this.uriConverter=new VA(Tn(),a=>(this.uriTranslationRequests.has(a)||this.uriTranslationRequests.set(a,Me()),this.postEmitter.fire({message:"ConvertUriForUseInWebViewRequest",payload:a}),this.uriTranslationRequests.get(a).promise)),this.isWebViewOnline.promise.catch(y),n.push(this),this.kernelProvider.onDidStartKernel(a=>{a.notebook===this.document&&this.initialize()},this,this.disposables)}get postMessage(){return this.postEmitter.event}dispose(){var e;for(;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}onMessage(e,t){if(e==="ConvertUriForUseInWebViewResponse"){let n=t;n&&this.uriTranslationRequests.has(n.request)&&this.uriTranslationRequests.get(n.request).resolve(n.response)}else if(e==="IPyWidgets_Ready")this.sendBaseUrl(),this.sendWidgetScriptSources().catch(y);else if(e==="IPyWidgets_IsOnline"){let n=t.isOnline;this.isWebViewOnline.resolve(n)}else e==="IPyWidgets_WidgetScriptSourceRequest"&&t&&this.onRequestWidgetScript(t).catch(y)}initialize(){var e;this.jupyterLab||(this.jupyterLab=ci()),this.kernel||(this.kernel=this.kernelProvider.get(this.document)),(e=this.kernel)!=null&&e.session&&(this.scriptProvider&&!this.scriptProvider.isDisposed||(this.scriptProvider=new WA(this.kernel,this.uriConverter,this.configurationSettings,this.sourceProviderFactory,this.isWebViewOnline.promise,this.cdnScriptProvider),this.kernel.onDisposed(()=>this.dispose()),this.handlePendingRequests(),this.sendBaseUrl(),q("IPyWidgetScriptSource.initialize")))}sendBaseUrl(){this.scriptProvider&&this.scriptProvider.getBaseUrl().then(e=>{e&&this.postEmitter.fire({message:"IPyWidgets_BaseUrl_Response",payload:e.toString()})}).catch(e=>O("Failed to get baseUrl",e))}async sendWidgetScriptSources(){if(this.scriptProvider&&!this.allWidgetScriptsSent)try{(await this.scriptProvider.getWidgetScriptSources()).forEach(t=>{var n;((n=this.widgetSources.get(t.moduleName))==null?void 0:n.source)!=="cdn"&&this.widgetSources.set(t.moduleName,t),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:t})})}catch(e){ue("Failed to fetch script sources",e)}finally{this.allWidgetScriptsSent=!0}}async onRequestWidgetScript(e){let{moduleName:t,moduleVersion:n,requestId:i}=e;if(De(`\x1B[32mFetch Script for ${JSON.stringify(e)}`),await this.sendWidgetSource(t,n,i).catch(o=>O("Failed to send widget sources upon ready",o)),this.scriptProvider&&!this.allWidgetScriptsSent)try{await this.sendWidgetScriptSources()}finally{this.sendWidgetSource(t,n,i).catch(O.bind(void 0,"Failed to send widget sources upon ready"))}}async sendWidgetSource(e,t="*",n){var o;if(!e||e.startsWith("@jupyter"))return;if(!this.kernel||!this.scriptProvider){this.pendingModuleRequests.set(e,{moduleVersion:t,requestId:n});return}let i={moduleName:e,requestId:n};try{De(`\x1B[32mFetch Script for ${e}`),i=await this.scriptProvider.getWidgetScriptSource(e,t),((o=this.widgetSources.get(i.moduleName))==null?void 0:o.source)!=="cdn"&&this.widgetSources.set(i.moduleName,i)}catch(s){O("Failed to get widget source due to an error",s),J("DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED")}finally{De(`\x1B[32mScript for ${e}, is ${i.scriptUri} from ${i.source}`),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:i})}}handlePendingRequests(){let e=Array.from(this.pendingModuleRequests.keys());for(;e.length;){let t=e.shift();if(t){let{moduleVersion:n,requestId:i}=this.pendingModuleRequests.get(t);this.pendingModuleRequests.delete(t),this.sendWidgetSource(t,n,i).catch(O.bind(`Failed to send WidgetScript for ${t}`))}}}};d();var JA=Symbol("IWidgetScriptSourceProviderFactory"),_Z=Symbol("INbExtensionsPathProvider"),qA=Symbol("IIPyWidgetScriptManagerFactory"),Fbt=Symbol("IIPyWidgetScriptManager");d();var mv=z(re()),Is=require("vscode");var wZ="https://unpkg.com/",i9="https://cdn.jsdelivr.net/npm/",GA="IPYWidgetCDNConfigured",EZ="IPYWidgetNotFoundOnCDN",CZ="IPYWidgetNoNetWorkAccess";function iEe(r,e,t){let n=e,i="index",o=e.indexOf("/");return o!==-1&&e[0]==="@"&&(o=e.indexOf("/",o+1)),o!==-1&&(i=e.substr(o+1),n=e.substr(0,o)),r===i9&&(t.startsWith("^")&&(t=t.slice(1)),i.endsWith(".js")||(i=i.concat(".js"))),`${r}${n}@${t}/dist/${i}`}function oEe(r){switch(r){case"unpkg.com":return wZ;case"jsdelivr.com":return i9;default:break}}var sc=class{constructor(e,t){this.globalMemento=e;this.configurationSettings=t;this.id="cdn";this.cache=new Map;this.isOnCDNCache=new Map;this.notifiedUserAboutWidgetScriptNotFound=new Set}get cdnProviders(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}dispose(){this.cache.clear()}async isOnCDN(e){let t=`MODULE_VERSION_ON_CDN_${e}`;if(this.isOnCDNCache.has(t))return this.isOnCDNCache.get(t);if(this.globalMemento.get(t,!1))return!0;let n=(async()=>{let i=new Su,o=Ju(i.exists(`${wZ}${e}`)),s=Ju(i.exists(`${i9}${e}`));return await Promise.race([o.promise,s.promise]),o.value||s.value?!0:(await Promise.all([o.promise,s.promise]),!!(o.value||s.value))})();return n.then(i=>{if(i)return this.globalMemento.update(t,!0)}).then(y,y),this.isOnCDNCache.set(t,n),n}async getWidgetScriptSource(e,t,n){if(n===!1)return Ie(`Webview is offline, cannot use CDN for ${e}`),this.warnIfNoAccessToInternetFromWebView(e).catch(y),{moduleName:e};if(this.cdnProviders.length===0&&this.globalMemento.get(GA,!1))return Ie("No CDN providers and user configured CDN"),{moduleName:e};let i=this.getModuleKey(e,t);return this.cache.get(i)||this.cache.set(i,this.getWidgetScriptSourceImplementation(e,t)),this.cache.get(i)}async generateDownloadUri(e,t,n){let i=oEe(n);if(i)return iEe(i,e,t)}getModuleKey(e,t){return`${e}${t}`}async getWidgetScriptSourceImplementation(e,t){if(De(`\x1B[32mSearching for Widget Script ${e}#${t} using cdns ${this.cdnProviders.join(" ")}`),await this.configureWidgets(),this.cdnProviders.length===0)return{moduleName:e};let i=(await Promise.all(this.cdnProviders.map(o=>this.getValidUri(e,t,o)))).find(o=>o);return i?(De(`\x1B[32mWidget Script ${e}#${t} found at URI: ${i}`),{moduleName:e,scriptUri:i,source:"cdn"}):(O(`Widget Script ${e}#${t} was not found on on any cdn`),this.handleWidgetSourceNotFound(e,t).catch(y),{moduleName:e})}async getValidUri(e,t,n){try{let i=await this.generateDownloadUri(e,t,n),o=new Su;if(i&&await o.exists(i))return i}catch(i){q(`Failed downloading ${e}:${t} from ${n}`);return}}async warnIfNoAccessToInternetFromWebView(e){if(this.globalMemento.get(CZ,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await Is.window.showWarningMessage(_.cdnWidgetScriptNotAccessibleWarningMessage(e,JSON.stringify(this.cdnProviders)),Be.ok,Be.doNotShowAgain,Be.moreInfo)){case Be.doNotShowAgain:return this.globalMemento.update(CZ,!0);case Be.moreInfo:return Is.env.openExternal(Is.Uri.parse("https://aka.ms/PVSCIPyWidgets"));default:}}async configureWidgets(){if(this.cdnProviders.length!==0||this.globalMemento.get(GA,!1))return;if(this.configurationPromise)return this.configurationPromise.promise;this.configurationPromise=Me(),J("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN");let e=await Is.window.showInformationMessage(_.useCDNForWidgetsNoInformation,{modal:!0},Be.ok,Be.doNotShowAgain,Be.moreInfo),t="dismissed";switch(e){case Be.ok:{t="ok",await Promise.all([this.updateScriptSources(["jsdelivr.com","unpkg.com"]),this.globalMemento.update(GA,!0)]);break}case Be.doNotShowAgain:{t="doNotShowAgain",await Promise.all([this.updateScriptSources([]),this.globalMemento.update(GA,!0)]);break}case Be.moreInfo:{Is.env.openExternal(Is.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break}default:t=e===Be.cancel?"cancel":"dismissed";break}J("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",void 0,{selection:t}),this.configurationPromise.resolve()}async updateScriptSources(e){let t="widgetScriptSources";await this.configurationSettings.updateSetting(t,e,void 0,Is.ConfigurationTarget.Global)}async handleWidgetSourceNotFound(e,t){if(this.globalMemento.get(EZ,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await Is.window.showWarningMessage(_.widgetScriptNotFoundOnCDNWidgetMightNotWork(e,t,JSON.stringify(this.cdnProviders)),Be.ok,Be.doNotShowAgain,Be.reportThisIssue)){case Be.doNotShowAgain:return this.globalMemento.update(EZ,!0);case Be.reportThisIssue:return Is.env.openExternal(Is.Uri.parse("https://aka.ms/CreatePVSCDataScienceIssue"));default:}}};sc=E([(0,mv.injectable)(),b(0,(0,mv.inject)(wt)),b(0,(0,mv.named)(ur)),b(1,(0,mv.inject)(Ke))],sc);var _D=class{constructor(e,t){this.document=e;this.serviceContainer=t;this.cachedMessages=[];this.postEmitter=new Ss.EventEmitter;this.attachedWebviews=new WeakSet;this.modulesForWhichWeHaveDisplayedWidgetErrorMessage=new Set;this.queuedMessages=[];this.disposables=this.serviceContainer.get(oe),this.jupyterOutput=this.serviceContainer.get(jm,Vv),this.configService=this.serviceContainer.get(Ke),this.initialize()}get postMessage(){return this.listeningToPostMessageEvent=!0,this.postEmitter.event}dispose(){var e,t;this.cachedMessages=[],(e=this.ipyWidgetMessageDispatcher)==null||e.dispose(),(t=this.ipyWidgetScriptSource)==null||t.dispose()}attach(e){if(this.attachedWebviews.has(e))return;this.attachedWebviews.add(e),this.postMessage(i=>{if(Ie(`\x1B[32mWidget Coordinator sent ${i.message}`),i.message==="ConvertUriForUseInWebViewRequest")this.onMessage(e,"ConvertUriForUseInWebViewResponse",{request:i.payload,response:e.asWebviewUri(i.payload)});else{if(!this.readyMessageReceived){this.queuedMessages.push({type:i.message,payload:i.payload});return}this.sendPendingWebViewMessages(e),e.postMessage({type:i.message,payload:i.payload}).then(y,y)}},this,this.disposables);let t=Me(),n=async()=>{let i=new Mt;if(!t.completed){let s=[],a=this.serviceContainer.get($e),l=Me();a.get(this.document)?l.resolve(a.get(this.document)):a.onDidCreateKernel(u=>{u.notebook===this.document&&l.resolve(u)},this,s);let c=await l.promise;c&&(Qt(c.kernelConnectionMetadata)?c.ipywidgetsVersion?t.completed||t.resolve(c.ipywidgetsVersion):c.onIPyWidgetVersionResolved(()=>{c.ipywidgetsVersion&&(t.completed||t.resolve(c.ipywidgetsVersion),he(s))},this,s):t.completed||t.resolve(WE)),s.length&&this.disposables.push(...s)}let o=await t.promise;q(`Version of IPyWidgets ${o} determined after ${i.elapsedTime/1e3}s`),e.postMessage({type:"IPyWidgets_Reply_Widget_Version",payload:o}).then(y,y)};e.onDidReceiveMessage(async i=>{Ie(`\x1B[32mWidget Coordinator received ${i.type}`),this.onMessage(e,i.type,i.payload),i.type==="IPyWidgets_Request_Widget_Version"&&await n(),i.type==="IPyWidgets_Window_Alert"&&Ss.window.showInformationMessage(i.message),i.type==="IPyWidgets_Window_Open"&&Ss.env.openExternal(Ss.Uri.parse(i.url)),i.type==="IPyWidgets_Ready"&&(q("Web view is ready to receive widget messages"),this.readyMessageReceived=!0,this.sendPendingWebViewMessages(e))},this,this.disposables),e.postMessage({type:"IPyWidgets_IsReadyRequest",payload:void 0}).then(y,y),n().catch(y)}onMessage(e,t,n){t==="ipywidget_load_success"?this.sendLoadSucceededTelemetry(n).catch(y):t==="ipywidget_load_failure"?this.handleWidgetLoadFailure(e,n).catch(y):t==="ipywidget_widget_version_not_supported"?this.sendUnsupportedWidgetVersionFailureTelemetry(n).catch(y):t==="ipywidget_render_failure"?this.sendRenderFailureTelemetry(n):t==="ipywidget_unhandled_kernel_message"&&this.handleUnhandledMessage(n),this.getIPyWidgetMessageDispatcher().receiveMessage({message:t,payload:n}),this.getIPyWidgetScriptSource().onMessage(t,n)}sendPendingWebViewMessages(e){if(this.readyMessageReceived)for(;this.queuedMessages.length;)e.postMessage(this.queuedMessages.shift()).then(y,y)}initialize(){this.getIPyWidgetScriptSource().initialize(),this.getIPyWidgetMessageDispatcher().initialize()}async sendLoadSucceededTelemetry(e){try{J("DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",0,{moduleHash:await Ot(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}async handleWidgetLoadFailure(e,t){try{let n=t.error.toString(),i=this.configService.getSettings(void 0).widgetScriptSources,o=i.length>0,s=`${t.moduleName}:${t.moduleVersion}`;if(!t.isOnline)n=_.loadClassFailedWithNoInternet(t.moduleName,t.moduleVersion),Ss.window.showErrorMessage(n).then(y,y);else if(!o&&!this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.has(s)){this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.add(s);let a=Be.moreInfo,l=_.enableCDNForWidgetsButton;n=_.enableCDNForWidgetsSetting(t.moduleName,t.moduleVersion),Ss.window.showErrorMessage(n,{modal:!0},l,a).then(c=>{switch(c){case a:Ss.env.openExternal(Ss.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break;case l:this.enableCDNForWidgets(e).catch(y);break;default:break}},y)}O(`Widget load failure ${n}`,i,t),J("DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",0,{isOnline:t.isOnline,moduleHash:await Ot(t.moduleName),moduleVersion:t.moduleVersion,timedout:t.timedout})}catch(n){}}async enableCDNForWidgets(e){await Ss.commands.executeCommand(X.EnableLoadingWidgetsFrom3rdPartySource),await e.postMessage({type:"IPyWidgets_AttemptToDownloadFailedWidgetsAgain"})}async sendUnsupportedWidgetVersionFailureTelemetry(e){try{J("DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",0,{moduleHash:await Ot(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}sendRenderFailureTelemetry(e){try{O("Error rendering a widget: ",e),J("DS_INTERNAL.IPYWIDGET_RENDER_FAILURE")}catch(t){}}handleUnhandledMessage(e){if(e.header.msg_type!=="status")try{if(e.header.msg_type==="error"){let t=e;t.content.traceback=t.content.traceback.map(Pu)}De(`Unhandled widget kernel message: ${e.header.msg_type} ${e.content}`),this.jupyterOutput.appendLine(_.unhandledMessage(e.header.msg_type,JSON.stringify(e.content))),J("DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",void 0,{msg_type:e.header.msg_type})}catch(t){}}getIPyWidgetMessageDispatcher(){return this.ipyWidgetMessageDispatcher||(this.ipyWidgetMessageDispatcher=this.serviceContainer.get(sp).create(this.document),this.disposables.push(this.ipyWidgetMessageDispatcher.postMessage(this.cacheOrSend,this))),this.ipyWidgetMessageDispatcher}getIPyWidgetScriptSource(){return this.ipyWidgetScriptSource||(this.ipyWidgetScriptSource=new BA(this.document,this.serviceContainer.get($e),this.serviceContainer.get(oe),this.serviceContainer.get(Ke),this.serviceContainer.get(JA),this.serviceContainer.get(sc)),this.disposables.push(this.ipyWidgetScriptSource.postMessage(this.cacheOrSend,this))),this.ipyWidgetScriptSource}cacheOrSend(e){if(!this.listeningToPostMessageEvent){Ie("\x1B[32mQueuing messages (no listeners)"),this.cachedMessages.push(e);return}this.cachedMessages.forEach(t=>this.postEmitter.fire(t)),this.cachedMessages=[],this.postEmitter.fire(e)}};E([_n()],_D.prototype,"enableCDNForWidgets",1);var o9=class{constructor(e,t){this.editor=e;this.pendingMessages=[];this.disposables=[];this._onDidReceiveMessage=new vm.EventEmitter;this.changeController(t)}get controller(){if(!this._controller)throw new Error("No controller defined");return this._controller.controller}changeController(e){var t,n;((t=this._controller)==null?void 0:t.id)!==e.id&&((n=this.controllerMessageHandler)==null||n.dispose(),this._controller=e,this.controllerMessageHandler=e.onDidReceiveMessage(i=>{var o;i.editor===this.editor&&((o=this.controller)==null?void 0:o.id)===e.id&&(this.eventHandlerListening?(this.sendPendingMessages(),this._onDidReceiveMessage.fire(i.message)):this.pendingMessages.push(i.message))},this,this.disposables))}dispose(){he(this.disposables)}get onDidReceiveMessage(){return this.eventHandlerListening=!0,setTimeout(()=>this.sendPendingMessages(),0),this._onDidReceiveMessage.event}postMessage(e){return this.controller.postMessage(e,this.editor)}asWebviewUri(e){return this.controller.asWebviewUri(e)}sendPendingMessages(){if(this.pendingMessages.length){let e=this.pendingMessages.shift();for(;e;)this._onDidReceiveMessage.fire(e),e=this.pendingMessages.shift()}}},gm=class{constructor(e,t,n){this.serviceContainer=e;this.disposableRegistry=t;this.controllerManager=n;this.messageCoordinators=new WeakMap;this.notebookDisposables=new WeakMap;this.notebookCommunications=new WeakMap;this.notebookEditors=new WeakMap}activate(){vm.window.onDidChangeVisibleNotebookEditors(this.onDidChangeVisibleNotebookEditors,this,this.disposableRegistry),vm.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebookDocument,this,this.disposableRegistry),this.controllerManager.onControllerSelected(this.onDidSelectController,this,this.disposableRegistry)}onDidSelectController(e){let t=this.messageCoordinators.get(e.notebook);t&&(this.messageCoordinators.delete(e.notebook),vm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>{let i=this.notebookCommunications.get(n);this.notebookCommunications.delete(n),i&&i.controller!==e.controller.controller&&(this.notebookCommunications.delete(n),i&&i.dispose())}),t==null||t.dispose()),vm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>this.initializeNotebookCommunication(n,e.controller))}initializeNotebookCommunication(e,t){if(e.notebook.isClosed||!_r(e.notebook))return;let n=e.notebook;if(!t){q(`No controller, hence notebook communications cannot be initialized for editor ${Se(e.notebook.uri)}`);return}if(this.notebookCommunications.has(e))return;let i=new o9(e,t);this.addNotebookDisposables(n,[i]),this.notebookCommunications.set(e,i);let o=this.messageCoordinators.get(n);o||(o=new _D(n,this.serviceContainer),this.messageCoordinators.set(n,o)),o.attach(i)}addNotebookDisposables(e,t){let n=this.notebookDisposables.get(e)||[];n.push(...t),this.notebookDisposables.set(e,n)}async onDidChangeVisibleNotebookEditors(e){e.forEach(t=>{let n=this.controllerManager.getSelected(t.notebook);this.initializeNotebookCommunication(t,n)})}onDidCloseNotebookDocument(e){var n;let t=this.notebookEditors.get(e)||[];he(this.notebookDisposables.get(e)||[]),t.forEach(i=>{var o;return(o=this.notebookCommunications.get(i))==null?void 0:o.dispose()}),(n=this.messageCoordinators.get(e))==null||n.dispose(),this.messageCoordinators.delete(e)}};gm=E([(0,ZS.injectable)(),b(0,(0,ZS.inject)(jr)),b(1,(0,ZS.inject)(oe)),b(2,(0,ZS.inject)(Ht))],gm);d();var ym=z(re());var e_=class{constructor(e,t,n,i,o){this.disposables=e;this.kernelProvider=t;this.controllers=n;this.liveKernelTracker=i;this.preferredRemoteKernelIdProvider=o}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables),this.controllers.onControllerSelectionChanged(this.onNotebookControllerSelectionChanged,this,this.disposables)}onNotebookControllerSelectionChanged({selected:e,notebook:t,controller:n}){t.isClosed||(n.connection.kind==="connectToLiveRemoteKernel"&&n.connection.kernelModel.id&&(e?this.liveKernelTracker.trackKernelIdAsUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id):this.liveKernelTracker.trackKernelIdAsNotUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id)),or(n.connection)&&this.preferredRemoteKernelIdProvider.clearPreferredRemoteKernelId(t.uri).catch(y))}onDidStartKernel(e){if(!e.resourceUri)return;let t=e.resourceUri;if(e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")return;let n=e.kernelConnectionMetadata.serverProviderHandle,i=()=>{var s,a;let o=(a=(s=e.session)==null?void 0:s.kernel)==null?void 0:a.id;!e.disposed&&!e.disposing&&o&&(q(`Updating preferred kernel for remote notebook ${o}`),this.preferredRemoteKernelIdProvider.storePreferredRemoteKernelId(t,o).catch(y),this.liveKernelTracker.trackKernelIdAsUsed(t,n,o))};i(),e.onDidKernelSocketChange(i,this,this.disposables)}};e_=E([(0,ym.injectable)(),b(0,(0,ym.inject)(oe)),b(1,(0,ym.inject)($e)),b(2,(0,ym.inject)(Ht)),b(3,(0,ym.inject)(Xg)),b(4,(0,ym.inject)(Xs))],e_);d();var gv=z(re());var xZ=require("vscode");var hv=class{constructor(e,t,n,i){this.disposables=e;this.uriStorage=t;this.controllers=n;this.serverProviderRegistry=i;this.handledServerProviderChanges=new WeakSet}activate(){this.serverProviderRegistry.jupyterCollections.forEach(e=>this.checkExpiredServersInJupyterCollection(e)),this.serverProviderRegistry.onDidChangeCollections(({added:e,removed:t})=>{e.forEach(n=>this.checkExpiredServersInJupyterCollection(n)),t.forEach(n=>this.removeControllersBelongingToDisposedProvider(n.extensionId,n.id))},this,this.disposables)}async checkExpiredServersInJupyterCollection(e){!this.handledServerProviderChanges.has(e.serverProvider)&&e.serverProvider.onDidChangeServers&&(this.handledServerProviderChanges.add(e.serverProvider),e.serverProvider.onDidChangeServers(()=>this.checkExpiredServersInJupyterCollection(e).catch(y),this,this.disposables));let t=new xZ.CancellationTokenSource;this.disposables.push(t);try{let n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await this.removeControllersAndUriStorageBelongingToInvalidServers(e.extensionId,e.id,(n||[]).map(i=>i.id))}finally{t.dispose()}}async removeControllersAndUriStorageBelongingToInvalidServers(e,t,n){let i=this.uriStorage.all;await Promise.all(i.filter(o=>o.provider.extensionId===e&&o.provider.id===t).map(async o=>{n.includes(o.provider.handle)||await this.uriStorage.remove(o.provider)})),this.controllers.registered.forEach(o=>{let s=o.connection;or(s)||s.serverProviderHandle.extensionId!==e||s.serverProviderHandle.id!==t||n.includes(s.serverProviderHandle.handle)||(ue(`Deleting controller ${o.id} as it is associated with a server Id that has been removed`),o.dispose())})}removeControllersBelongingToDisposedProvider(e,t){this.controllers.registered.forEach(n=>{let i=n.connection;or(i)||i.serverProviderHandle.extensionId!==e||i.serverProviderHandle.id!==t||(ue(`Deleting controller ${n.id} as it is associated with a Provider Id that has been removed`),n.dispose())})}};E([_n("Failed to check what servers were shutdown in Controller Watcher")],hv.prototype,"checkExpiredServersInJupyterCollection",1),hv=E([(0,gv.injectable)(),b(0,(0,gv.inject)(oe)),b(1,(0,gv.inject)(yr)),b(2,(0,gv.inject)(Ht)),b(3,(0,gv.inject)(mr))],hv);d();d();var r_=z(re());d();var DZ=require("vscode");var YA=class{constructor(e,t,n,i,o,s){this.label=e;this._description=t;this.detail=n;this.category=i;this.serverDisplayName=o;this.getDescription=s;this._onDidChange=new DZ.EventEmitter;this.onDidChange=this._onDidChange.event}get description(){var e;return((e=this.getDescription)==null?void 0:e.call(this))||this._description}set description(e){this._description=e}dispose(){this._onDidChange.dispose()}triggerChange(){this._onDidChange.fire(this)}};function PZ(r){switch(r.kind){case"connectToLiveRemoteKernel":return _.kernelCategoryForJupyterSession;case"startUsingRemoteKernelSpec":return _.kernelCategoryForRemoteJupyterKernel;default:return s9(r)}}function s9(r){switch(r.kind){case"startUsingLocalKernelSpec":return _.kernelCategoryForJupyterKernel;case"startUsingPythonInterpreter":{if($g(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return _.kernelCategoryForJupyterKernel;switch(Or(r.interpreter)){case"Conda":return fa(r.interpreter)?_.kernelCategoryForCondaWithoutPython:_.kernelCategoryForConda;case"PipEnv":return _.kernelCategoryForPipEnv;case"Poetry":return _.kernelCategoryForPoetry;case"Pyenv":return _.kernelCategoryForPyEnv;case"Venv":case"VirtualEnv":case"VirtualEnvWrapper":return _.kernelCategoryForVirtual;default:return _.kernelCategoryForGlobal}}default:return""}}var t_=class{constructor(e,t,n){this.platform=e;this.jupyterUriProviderRegistration=t;this.disposables=n;this.details=new Map}getDisplayData(e){if(!this.details.get(e.id)){let i=ft(e),o=oz(e,this.platform);e.kind==="connectToLiveRemoteKernel"&&(o=KV(e));let s=e.kind==="connectToLiveRemoteKernel"?()=>KV(e):void 0,a=s9(e),l=new YA(i,o,"",a,void 0,s);this.disposables.push(l),this.details.set(e.id,l)}let t=this.details.get(e.id);if(this.details.set(e.id,t),e.kind==="connectToLiveRemoteKernel"||e.kind==="startUsingRemoteKernelSpec"){let i=gS(e.serverProviderHandle,this.jupyterUriProviderRegistration,_.kernelDefaultRemoteDisplayName);t.serverDisplayName!==i&&(t.serverDisplayName=i,t.triggerChange())}let n=PZ(e);return t.category!==n&&(t.category=n,t.triggerChange()),t}};t_=E([(0,r_.injectable)(),b(0,(0,r_.inject)(bs)),b(1,(0,r_.inject)(mr)),b(2,(0,r_.inject)(oe))],t_);d();var ap=z(re()),lp=require("vscode");d();var bm=z(re()),NZ=require("vscode");d();var TZ=require("vscode");function $A(r){var e;try{return az(Ma(r))||((e=r.getCells().find(n=>n.kind===TZ.NotebookCellKind.Code))==null?void 0:e.document.languageId)}catch(t){ue("Failed to determine language of first cell",t)}}var kZ="DATASCIENCE.LAST_SAVED_CELL_LANGUAGE",ea=class{constructor(e,t,n){this.disposables=e;this.globalMemento=t;this.pythonExtensionChecker=n}getPreferredLanguage(e){var i,o;let t=((i=e==null?void 0:e.language_info)==null?void 0:i.name)||((o=e==null?void 0:e.kernelspec)==null?void 0:o.language)||this.lastSavedNotebookCellLanguage,n=this.pythonExtensionChecker.isPythonExtensionInstalled?Qe:"plaintext";return $c(t||n)}activate(){NZ.workspace.onDidSaveNotebookDocument(this.onDidSaveNotebookDocument,this,this.disposables)}getSupportedLanguages(e){if(Qt(e))return oB;{let t=$c(au(e)||"");return t&&aB.includes(t.toLowerCase())?[t,"raw"]:[]}}get lastSavedNotebookCellLanguage(){return this.globalMemento.get(kZ)}async onDidSaveNotebookDocument(e){if(!_r(e))return;let t=$A(e);t&&t!==this.lastSavedNotebookCellLanguage&&await this.globalMemento.update(kZ,t)}};E([_n("Saving last saved cell language")],ea.prototype,"onDidSaveNotebookDocument",1),ea=E([(0,bm.injectable)(),b(0,(0,bm.inject)(oe)),b(1,(0,bm.inject)(wt)),b(1,(0,bm.named)(ur)),b(2,(0,bm.inject)(wo))],ea);d();function RZ(r){let e={kernelSpecCount:0,localKernelSpecCount:0,remoteKernelSpecCount:0,kernelInterpreterCount:0,kernelLiveCount:0};r.forEach(t=>{switch(t.kind){case"connectToLiveRemoteKernel":e.kernelLiveCount+=1;break;case"startUsingRemoteKernelSpec":e.localKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingLocalKernelSpec":e.remoteKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingPythonInterpreter":{e.kernelInterpreterCount+=1;break}default:break}}),J("DS_INTERNAL.KERNEL_COUNT",{...e})}d();var qt=require("vscode");d();var ku=require("vscode");d();async function AZ(r,e,t){let n=`${await Qb({uri:t})}#${Ti.get(e)}`;await r.update(n,void 0)}d();var Ho=Symbol("INotebookEditorProvider");d();var MZ=require("vscode");async function OZ(r,e){let t=e==null?void 0:e.findNotebookEditor(r);return t?MZ.commands.executeCommand("notebook.selectKernel",{notebookEditor:t}):(O("Unable to select kernel as the Notebook document could not be identified"),!1)}d();var LZ=require("vscode");var zA=class extends cu{constructor(e){super(_.failedToStartAnUntrustedKernelSpec(ft(e),e.kernelSpec.specFile?Se(LZ.Uri.file(e.kernelSpec.specFile)):""),void 0,e)}};var Qr=class Qr{static async switchController(e,t){let i=t.get(Ho).findNotebookEditor(e),o=t.get(Ht),s,a=Me(),l=o.onControllerSelected(u=>a.resolve(u.controller));return await OZ(e,t.get(Ho))&&i&&(s=await a.promise),l.dispose(),s?{controller:s.controller,metadata:s.connection}:void 0}static async notifyAndRestartDeadKernel(e){let t=await ku.window.showErrorMessage(_.cannotRunCellKernelIsDead(ft(e.kernelConnectionMetadata)),{modal:!0},_.showJupyterLogs,_.restartKernel),n=!1;switch(t){case _.restartKernel:{await e.restart(),n=!0;break}case _.showJupyterLogs:ku.commands.executeCommand(X.ViewJupyterOutput).then(y,y)}return n}static async handleKernelError(e,t,n,i,o,s,a,l){let c=e.get(wt,ur),u=e.get(Pn);a.interpreter&&n==="start"&&AZ(c,19,a.interpreter.uri).catch(y);let p=await u.handleKernelError(t,n,a,i,l),f=or(a),m=e.tryGet(ep);switch((m==null?void 0:m.isSupported)&&f&&n==="start"&&Rr(i,"DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",{reason:p}),o.dispose().catch(y),p){case 1:case 2:throw t;case 3:{let g=await Qr.switchController(i,e);if(!g)throw t;s=g.controller,a=g.metadata;break}}return{controller:s,metadata:a}}static convertContextToFunction(e,t){switch(e){case"start":case"execution":return n=>n.start(t);case"interrupt":return n=>n.interrupt();case"restart":return n=>n.restart()}}static async verifyKernelState(e,t,n,i,o,s,a){let{kernel:l,deadKernelAction:c}=await i;if(xA(l)){if(this.deleteKernelInfo(t,i),c==="deadKernelWasNoRestarted")throw new um(l.kernelConnectionMetadata);return c==="deadKernelWasRestarted"?l:Qr.wrapKernelMethod(l.kernelConnectionMetadata,"start",o,e,t,n,a,s)}return l}static async wrapKernelMethod(e,t,n,i,o,s,a,l=()=>void 0){var f,m,h,g;let c=this.getKernelInfo(o);if(!s.disableUI&&(c!=null&&c.options.disableUI)&&(c.options.disableUI=!1),!s.disableUI&&(c!=null&&c.kernel.resolved)&&((m=(f=c==null?void 0:c.kernel.value)==null?void 0:f.kernel)!=null&&m.disposed||(g=(h=c==null?void 0:c.kernel.value)==null?void 0:h.kernel)!=null&&g.disposing)&&(this.deleteKernelInfo(o),c=void 0),c&&t!=="restart"&&t!=="interrupt")return Qr.verifyKernelState(i,o,s,c.kernel.promise,n,l,a);q(`${t} the kernel, options.disableUI=${s.disableUI} for ${Se("notebook"in o?o.notebook.uri:o.resource)}`);let u=Qr.wrapKernelMethodImpl(e,t,i,o,s,n,l),p=Ju(u);return p.promise.catch(y),u.then(v=>{v.kernel.onDisposed(()=>{this.deleteKernelInfo(o,p.promise)},void 0,a)}).catch(()=>{this.deleteKernelInfo(o,p.promise)}),this.setKernelInfo(o,p,s),Qr.verifyKernelState(i,o,s,p.promise,n,l,a)}static getKernelInfo(e){return"notebook"in e?Qr.connectionsByNotebook.get(e.notebook):Qr.connectionsByUri.get(e.resource.toString())}static setKernelInfo(e,t,n){"notebook"in e?Qr.connectionsByNotebook.set(e.notebook,{kernel:t,options:n}):Qr.connectionsByUri.set(e.resource.toString(),{kernel:t,options:n})}static deleteKernelInfo(e,t){var n,i;if(!t){"notebook"in e?Qr.connectionsByNotebook.delete(e.notebook):Qr.connectionsByUri.delete(e.resource.toString());return}"notebook"in e&&((n=Qr.connectionsByNotebook.get(e.notebook))==null?void 0:n.kernel.promise)===t?Qr.connectionsByNotebook.delete(e.notebook):e.resource&&((i=Qr.connectionsByUri.get(e.resource.toString()))==null?void 0:i.kernel.promise)===t&&Qr.connectionsByUri.delete(e.resource.toString())}static verifyWeCanStartKernel(e,t){if(!or(e)||!e.kernelSpec.specFile)return;if(!t.get(jS).isTrusted(ku.Uri.file(e.kernelSpec.specFile)))throw new zA(e)}static async wrapKernelMethodImpl(e,t,n,i,o,s,a){let l=n.get($e),c=n.get(Gg),u,p=Qr.convertContextToFunction(t,o),f=t,m="controller"in i?i.controller:void 0;for(t==="start"&&Qr.verifyWeCanStartKernel(e,n);u===void 0;){if("notebook"in i&&i.notebook.isClosed)throw new ku.CancellationError;u="notebook"in i?l.getOrCreate(i.notebook,{metadata:e,controller:m||i.controller,resourceUri:i.resource}):c.getOrCreate(i.resource,{metadata:e,resourceUri:i.resource});try{if(t!=="restart"&&xA(u)&&!o.disableUI){let h=await Qr.notifyAndRestartDeadKernel(u);return{kernel:u,deadKernelAction:h?"deadKernelWasRestarted":"deadKernelWasNoRestarted"}}else{if(a(f,u),await p(u),"notebook"in i&&i.notebook.isClosed)throw new ku.CancellationError;xA(u)&&!o.disableUI&&f!=="interrupt"&&await Qr.notifyAndRestartDeadKernel(u)}}catch(h){if(Di(h)||ue(`Error occurred while trying to ${f} the kernel, options.disableUI=${o.disableUI}`,h),o.disableUI)throw h;if("notebook"in i&&i.notebook.isClosed)throw new ku.CancellationError;let g=await Qr.handleKernelError(n,h,f,i.resource,u,m,e,s);if(m=g.controller,e=g.metadata,p=v=>v.start(o),f="start",s==="3rdPartyExtension")throw h;u=void 0}}return{kernel:u}}static async connectToNotebookKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return Qr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}static async connectToKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return Qr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}};Qr.connectionsByNotebook=new WeakMap,Qr.connectionsByUri=new Map;var Va=Qr;d();var vv=class{constructor(e){this.controller=e}get id(){return this.controller.id}createNotebookCellExecution(e){return this.controller.createNotebookCellExecution(e)}};d();var XA=require("vscode");var QA=class extends zr{constructor(t,n,i){super();this.kernel=t;this.controller=n;this.notebook=i}initialize(){let t=this.kernel,n=this.controller,i=this.notebook;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||t.status!=="busy"&&t.status!=="unknown"||!n.createNotebookExecution)return;this._register(XA.workspace.onDidCloseNotebookDocument(s=>{s===i&&this.dispose()},this)),this._register(n.onDidChangeSelectedNotebooks(s=>{s.notebook===i&&s.selected===!1&&this.dispose()},this)),this._register(t.onStatusChanged(s=>{s!=="busy"&&s!=="unknown"&&this.dispose()},this));let o=n.createNotebookExecution(i);o.start(),this._register(new XA.Disposable(()=>o.end()))}};d();var UZ=require("vscode");d();var ZA=class{constructor(){this.cache=new Map;this.executionCount=0}getResults(e,t){return this.executionCount!==e&&(this.cache.clear(),this.executionCount=e),this.cache.get(t)}setResults(e,t,n){if(this.executionCount<e)this.cache.clear(),this.executionCount=e;else if(this.executionCount>e)return;this.cache.set(t,n)}},KZ=ZA,FZ=ZA;var eM=class{constructor(e,t,n,i){this.variables=e;this.kernelProvider=t;this.controllerId=n;this.variableResultCache=new KZ;this.variableSummaryCache=new FZ;this.runningKernels=new Set;this._onDidChangeVariables=new UZ.EventEmitter;this.onDidChangeVariables=this._onDidChangeVariables.event;i.push(this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this))}onKernelStatusChanged({kernel:e}){if(e.controller.id!==this.controllerId)return;let t=this.runningKernels.has(e.notebook.uri.toString());e.status==="idle"&&!t?this.runningKernels.add(e.notebook.uri.toString()):e.status!=="busy"&&e.status!=="idle"&&t&&(this.runningKernels.delete(e.notebook.uri.toString()),this._onDidChangeVariables.fire(e.notebook))}_getVariableResultCacheKey(e,t,n){let i="",o=t;return o&&(i=`${o.name}.${o.propertyChain.join(".")}[[${n}`),`${e}:${i}`}async*provideVariables(e,t,n,i,o){if(o.isCancellationRequested)return;let s=this.kernelProvider.get(e);if(!s||s.status==="dead"||s.status==="terminating")return;let a=this.kernelProvider.getKernelExecution(s).executionCount,l=this._getVariableResultCacheKey(e.uri.toString(),t,i),c=this.variableResultCache.getResults(a,l);if(t){let u=t;if(!c&&u.getChildren)c=(await u.getChildren(i,o)).map(f=>this.createVariableResult(f,s)),this.variableResultCache.setResults(a,l,c);else if(!c)return;for(let p of c)yield p;if(n===2&&u.count&&c.length>0&&u.count>i+c.length)for await(let p of this.provideVariables(e,t,n,i+c.length,o))yield p}else{c||(c=(await this.variables.getAllVariableDiscriptions(s,void 0,i,o)).map(p=>this.createVariableResult(p,s)),this.variableResultCache.setResults(a,l,c));for(let u of c)yield u}}_getVariableSummaryCacheKey(e,t){return`${e}:${t.name}`}async*provideVariablesWithSummarization(e,t,n,i,o){var l;let s=this.kernelProvider.get(e),a=this.provideVariables(e,t,n,i,o);for await(let c of a)if(s&&s.status!=="dead"&&s.status!=="terminating"){let u=this._getVariableSummaryCacheKey(e.uri.toString(),c.variable),p=this.kernelProvider.getKernelExecution(s).executionCount,f=this.variableSummaryCache.getResults(p,u);f==null&&c.variable.type==="pandas.core.frame.DataFrame"&&(f=await this.variables.getVariableValueSummary({name:c.variable.name,value:c.variable.value,supportsDataExplorer:!1,type:(l=c.variable.type)!=null?l:"",size:0,count:0,shape:"",truncated:!0},s,o),this.variableSummaryCache.setResults(p,u,f!=null?f:null)),yield{hasNamedChildren:c.hasNamedChildren,indexedChildrenCount:c.indexedChildrenCount,variable:{name:c.variable.name,value:c.variable.value,expression:c.variable.expression,type:c.variable.type,language:c.variable.language,summary:f!=null?f:""}}}}createVariableResult(e,t){var s;let n=(s=e.count)!=null?s:0,i=!!e.hasNamedChildren,o={getChildren:(a,l)=>this.getChildren(o,a,t,l),expression:sEe(e.root,e.propertyChain),...e};return{variable:o,hasNamedChildren:i,indexedChildrenCount:n}}async getChildren(e,t,n,i){let o=e;return await this.variables.getAllVariableDiscriptions(n,o,t,i)}};function sEe(r,e){let t=r;for(let n of e)typeof n=="string"?t+=`.${n}`:t+=`[${n}]`;return t}var tM=class r{constructor(e,t,n,i,o,s,a,l,c,u,p,f){this.kernelConnection=e;this._viewType=n;this.kernelProvider=i;this.context=o;this.languageService=a;this.configuration=l;this.extensionChecker=c;this.serviceContainer=u;this.displayDataProvider=p;this._onNotebookControllerSelectionChanged=new qt.EventEmitter;this._onConnecting=new qt.EventEmitter;this.pendingCellAdditions=new WeakMap;this._onDidDispose=new qt.EventEmitter;this.disposables=[];this.notebookKernels=new WeakMap;this.isDisposed=!1;this.runningCellExecutions=new WeakMap;this.associatedDocuments=new WeakMap;this.restoredConnections=new WeakSet;var m;eY(e.id,(m=e.interpreter)==null?void 0:m.id),s.push(this),this._onNotebookControllerSelected=new qt.EventEmitter,this.displayData=this.displayDataProvider.getDisplayData(this.connection),this.controller=qt.notebooks.createNotebookController(t,n,this.displayData.label,this.handleExecution.bind(this),this.getRendererScripts()),this.displayData.onDidChange(this.updateDisplayData,this,this.disposables),this.updateDisplayData(),this.controller.interruptHandler=this.handleInterrupt.bind(this),this.controller.supportsExecutionOrder=!0,this.controller.supportedLanguages=this.languageService.getSupportedLanguages(e),this.controller.supportedLanguages.includes("python")&&(this.controller.variableProvider=new eM(f,this.kernelProvider,this.controller.id,this.disposables)),this.controller.onDidChangeSelectedNotebooks(this.onDidChangeSelectedNotebooks,this,this.disposables),qt.workspace.onDidCloseNotebookDocument(h=>{this.associatedDocuments.delete(h)},this,this.disposables)}get id(){return this.controller.id}get label(){return this.controller.label}get connection(){return this.kernelConnection}get viewType(){return this._viewType}get onNotebookControllerSelected(){return this._onNotebookControllerSelected.event}get onNotebookControllerSelectionChanged(){return this._onNotebookControllerSelectionChanged.event}get onConnecting(){return this._onConnecting.event}get onDidReceiveMessage(){return this.controller.onDidReceiveMessage}get onDidDispose(){return this._onDidDispose.event}isAssociatedWithDocument(e){return this.associatedDocuments.has(e)}static create(e,t,n,i,o,s,a,l,c,u,p,f){return new r(e,t,n,i,o,s,a,l,c,u,p,f)}async restoreConnection(e){var u;if(this.restoredConnections.has(e))return;this.restoredConnections.add(e);let t=await this.connectToKernel(e,new Er(!0));if(this.kernelConnection.kind==="connectToLiveRemoteKernel"){let p=new QA(t,this.controller,e);this.disposables.push(p),p.initialize()}let n=this.kernelProvider.getKernelExecution(t),o=await this.serviceContainer.get(oc).getLastTrackedCellExecution(e,t);if(!((u=t.session)!=null&&u.kernel)||n.pendingCells.length||!o||e.cellCount<o.cellIndex||e.cellAt(o.cellIndex).kind!==qt.NotebookCellKind.Code)return;let s=!1,a=[],l,c=(p,f)=>{if(!(f.direction==="send"||s)&&np(f.msg)===o.msg_id){if("msg_type"in f.msg&&f.msg.msg_type==="status"&&"execution_state"in f.msg.content&&f.msg.content.execution_state==="idle")return;s=!0,n.resumeCellExecution(e.cellAt(o.cellIndex),{msg_id:o.msg_id,startTime:o.startTime,executionCount:o.executionCount}).catch(y),he(a)}};t.session.kernel.anyMessage.connect(c),l=new qt.Disposable(()=>{aa(()=>{var p,f;return(f=(p=t.session)==null?void 0:p.kernel)==null?void 0:f.anyMessage.disconnect(c)})}),a.push(l),this.disposables.push(l)}updateConnection(e){e.kind!=="connectToLiveRemoteKernel"&&(this.controller.label=ft(e))}asWebviewUri(e){return this.controller.asWebviewUri(e)}postMessage(e,t){let n=e&&"message"in e?e.message:"";return Ie(`\x1B[32mPosting message to Notebook UI ${n}`),this.controller.postMessage(e,t)}setPendingCellAddition(e,t){if(this.viewType!==St)throw new Error("setPendingCellAddition only applies to the Interactive Window");this.pendingCellAdditions.set(e,t)}dispose(){if(this.isDisposed)return;let e=qt.workspace.notebookDocuments.filter(t=>this.associatedDocuments.has(t)).map(t=>t.uri.toString());q(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""}`),Ie(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""} called from ${new Error("").stack}`),this.isDisposed=!0,this._onNotebookControllerSelected.dispose(),this._onNotebookControllerSelectionChanged.dispose(),this._onConnecting.dispose(),this.controller.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose(),he(this.disposables)}updateDisplayData(){this.controller.label=this.displayData.label;let e=this.connection.kind==="connectToLiveRemoteKernel"?"":this.displayData.description;this.controller.description=e,this.displayData.serverDisplayName&&(this.controller.description=e?`${e} (${this.displayData.serverDisplayName})`:this.displayData.serverDisplayName)}async handleExecution(e,t){if(e.length<1)return;let n=Qc(t);n==null||n.cellExecutionCount(e.length);let i=n==null?void 0:n.preExecuteCellTelemetry();this.pendingCellAdditions.has(t)&&await this.pendingCellAdditions.get(t),e=e.filter(o=>o.index<0?(ue(`Attempting to run a cell with index ${o.index}, kind ${o.kind}, text = ${o.document.getText()}`),!1):!0),qt.workspace.isTrusted&&(De(`Handle Execution of Cells ${e.map(o=>o.index)} for ${Se(t.uri)}`),await Wa(t.uri,this.connection),i==null||i.stop(),await Promise.all(e.map(o=>this.executeCell(t,o))))}async onDidChangeSelectedNotebooks(e){var n,i;if(Ie(`NotebookController selection event called for notebook ${e.notebook.uri.toString()} & controller ${this.connection.kind}:${this.id}. Selected ${e.selected} `),this.associatedDocuments.has(e.notebook)&&e.selected)return;if(!e.selected){let o=this.kernelProvider.get(e.notebook);(o==null?void 0:o.kernelConnectionMetadata.id)===this.kernelConnection.id&&(De(`Disposing kernel ${this.kernelConnection.id} for notebook ${Se(e.notebook.uri)} due to selection of another kernel or closing of the notebook`),o.dispose().catch(y)),this.associatedDocuments.delete(e.notebook),this._onNotebookControllerSelectionChanged.fire(e);return}if(!_r(e.notebook)&&e.notebook.notebookType!==St||!qt.workspace.isTrusted)return;(i=Qc(e.notebook))==null||i.kernelSelected(this.kernelConnection.id,(n=this.kernelConnection.interpreter)==null?void 0:n.id),aEe(this.kernelConnection);let t=Me();Ie(`Controller ${this.connection.kind}:${this.id} associated with nb ${Se(e.notebook.uri)}`),this.associatedDocuments.set(e.notebook,t.promise),await this.onDidSelectController(e.notebook),await this.updateCellLanguages(e.notebook),this._onNotebookControllerSelected.fire({notebook:e.notebook,controller:this}),this._onNotebookControllerSelectionChanged.fire(e),q("Controller selection change completed"),t.resolve()}async updateCellLanguages(e){let t=this.controller.supportedLanguages;if(!t||(t==null?void 0:t.length)===0)return;let i=Qt(this.kernelConnection)?Qe:t[0];await Promise.all(e.getCells().filter(o=>o.kind===qt.NotebookCellKind.Code).map(async o=>{t.includes(o.document.languageId)||await qt.languages.setTextDocumentLanguage(o.document,i).then(y,y)}))}getRendererScripts(){return this.context.extensionMode===qt.ExtensionMode.Development||this.context.extensionMode===qt.ExtensionMode.Test?[new qt.NotebookRendererScript(qt.Uri.joinPath(this.context.extensionUri,"dist","webviews","webview-side","widgetTester","widgetTester.js"))]:[]}handleInterrupt(e){q(`VS Code interrupted kernel for ${Se(e.uri)}`),e.getCells().forEach(t=>lt(t,"Cell cancellation requested")),qt.commands.executeCommand(X.InterruptKernel,{notebookEditor:{notebookUri:e.uri}}).then(y,t=>O("Failed to interrupt",t))}createCellExecutionIfNecessary(e,t){let n=this.runningCellExecutions.get(e.notebook);if(!n||n.cell===e){n==null||n.end(void 0,void 0),n=fo.getOrCreate(e,t,!0),this.runningCellExecutions.set(e.notebook,n);let i=n.end.bind(n);n.end=(o,s)=>{this.runningCellExecutions.delete(e.notebook),i(o,s)}}return n}async executeCell(e,t,n){var f;let i=new Wi,o=i.add(new qt.CancellationTokenSource);i.add(qt.workspace.onDidCloseNotebookDocument(m=>m===e?o.cancel():void 0));let s=this.createCellExecutionIfNecessary(t,new vv(this.controller)),a="start",l,c=new vv(this.controller),u=!1,p=this.serviceContainer.get(oc);try{if(l=await this.connectToKernel(e,new Er(!1)),l.disposing)throw new qt.CancellationError;let m=(f=Qc(e))==null?void 0:f.executeCell();m&&i.add(new qt.Disposable(()=>m.stop())),u=!0,l&&l.controller.id!==c.id&&(c=l.controller,s=this.createCellExecutionIfNecessary(t,l.controller)),a="execution",l.controller.id===this.id&&this.updateKernelInfoInNotebookWhenAvailable(l,e),p.trackCellExecution(t,l);let g=this.kernelProvider.getKernelExecution(l).executeCell(t,n);return g.then(()=>{if(l&&!ME.isExiting)return p.deleteTrackedCellExecution(t,l)}).catch(y),await g}catch(m){if(m instanceof hm)return;Di(m)||O("Error in execution",m),u||(s.start(),s.clearOutput(t).then(y,y));let h=this.serviceContainer.get(Pn);m=ri.unwrap(m);let g=Di(m)||m instanceof um;await Yf(t,c,await h.getErrorMessageForDisplayInCell(m,a,e.uri),g)}finally{i.dispose()}}async connectToKernel(e,t){var i;let n=(i=Qc(e))==null?void 0:i.startKernel();return this._onConnecting.fire(),Va.connectToNotebookKernel(this.kernelConnection,this.serviceContainer,{resource:e.uri,notebook:e,controller:this.controller},t,this.disposables).finally(()=>n==null?void 0:n.stop())}updateKernelInfoInNotebookWhenAvailable(e,t){if(this.notebookKernels.get(t)===e)return;this.notebookKernels.set(t,e);let n=[];qt.workspace.onDidCloseNotebookDocument(s=>{s===t&&he(n)},this,n);let i=e.onDisposed(()=>he(n)),o=e.onStatusChanged(async()=>{e.disposed||!e.info||this.associatedDocuments.has(t)&&(await WZ(t,e.kernelConnectionMetadata,e.info),e.info.status==="ok"&&he(n))});n.push({dispose:()=>o.dispose()}),n.push({dispose:()=>i==null?void 0:i.dispose()})}async onDidSelectController(e){let t=this.connection,n=this.kernelProvider.get(e);if(n&&cz(n.kernelConnectionMetadata,t)){De("Switch kernel did not change kernel.");return}if(Rr(e.uri,"DS_INTERNAL.SWITCH_KERNEL"),n&&qt.window.visibleNotebookEditors.filter(s=>s.notebook===e).forEach(s=>this.postMessage({message:"IPyWidgets_onKernelChanged",payload:void 0},s)),await WZ(e,t),e.notebookType===St)return;let i=this.kernelProvider.getOrCreate(e,{metadata:t,controller:this.controller,resourceUri:e.uri});if(q(`KernelProvider switched kernel to id = ${i.kernelConnectionMetadata.id}`),Qt(this.kernelConnection)&&!this.extensionChecker.isPythonExtensionInstalled)return;let o=this.serviceContainer.get(jS);!this.configuration.getSettings(void 0).disableJupyterAutoStart&&or(this.kernelConnection)&&this.kernelConnection.kernelSpec.specFile&&o.isTrusted(qt.Uri.file(this.kernelConnection.kernelSpec.specFile))&&this.connectToKernel(e,new Er(!0))}};async function WZ(r,e,t){let n=Ma(r)||{},{changed:i}=await tz(n,e,t);i&&await jG(r,n)}async function aEe(r){let e=await Op(r.interpreter,!0),t=(e==null?void 0:e.major)||0,n=(e==null?void 0:e.minor)||0;!e||t>=4||t<=0||n<=-1||r.kind!=="startUsingLocalKernelSpec"&&r.kind!=="startUsingPythonInterpreter"||(t<3||t===3&&n<=5)&&qt.window.showWarningMessage(_.warnWhenSelectingKernelWithUnSupportedPythonVersion,Be.learnMore).then(i=>{if(i===Be.learnMore)return JI("https://aka.ms/jupyterUnSupportedPythonKernelVersions")},y)}var n_=class{constructor(e,t,n,i,o,s){this.disposables=e;this.pythonEnvFilter=t;this.extensionChecker=n;this.serviceContainer=i;this.serverUriStorage=o;this.kernelFinder=s;this.registeredControllers=new Map;this.changeEmitter=new lp.EventEmitter;this.registeredMetadatas=new Map;this.selectedEmitter=new lp.EventEmitter;this.selectionChangedEmitter=new lp.EventEmitter;this.selectedControllers=new WeakMap;this._activeInterpreterControllerIds=new Set}get onDidChange(){return this.changeEmitter.event}get registered(){return[...this.registeredControllers.values()]}get all(){return this.metadatas}get metadatas(){return[...this.registeredMetadatas.values()]}get onControllerSelected(){return this.selectedEmitter.event}get onControllerSelectionChanged(){return this.selectionChangedEmitter.event}activate(){this.kernelFinder.onDidChangeKernels(()=>this.loadControllers(),this,this.disposables),this.kernelFinder.registered.forEach(e=>this.monitorDeletionOfConnections(e)),this.kernelFinder.onDidChangeRegistrations(e=>e.added.forEach(t=>this.monitorDeletionOfConnections(t)),this,this.disposables),this.pythonEnvFilter.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeUri,this,this.disposables),this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables),this.onDidChange(({added:e})=>{e.forEach(t=>{t.onNotebookControllerSelectionChanged(n=>{!n.selected&&this.isFiltered(t.connection)&&this.canControllerBeDisposed(t)&&(ue(`Removing controller ${t.id} for ${t.connection.kind} from kernel list`),t.dispose())},this,this.disposables)})},this,this.disposables),lp.workspace.onDidOpenNotebookDocument(this.onDidOpenNotebookDocument,this,this.disposables),lp.workspace.notebookDocuments.forEach(e=>this.onDidOpenNotebookDocument(e).catch(y)),this.loadControllers()}loadControllers(){this.controllersPromise=this.loadControllersImpl(),RZ(this.registered.map(e=>e.connection)),Ie(`Providing notebook controllers with length ${this.registered.length}.`)}get loaded(){return this.controllersPromise}async onDidOpenNotebookDocument(e){e.notebookType!==Ct&&e.notebookType!==St||lp.workspace.isTrusted}async loadControllersImpl(){let e=this.kernelFinder.kernels;this.createNotebookControllers(e),Array.from(this.registered).filter(n=>{let i=e.some(o=>o.id===n.connection.id)||Ni&&this._activeInterpreterControllerIds.has(n.id);return!i&&n.connection.kind==="connectToLiveRemoteKernel"?!0:this.canControllerBeDisposed(n)?(i||q(`Controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}' is no longer a valid`),!i):!1}).forEach(n=>{ue(`Disposing old controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}'`),n.dispose()})}createNotebookControllers(e){if(e.length!==0)try{this.batchAdd(e,[Ct,St])}catch(t){if(!Di(t,!0))throw t}}async monitorDeletionOfConnections(e){let t=e.onDidChangeKernels(({removed:n})=>{let i=new Set((n||[]).map(o=>o.id));this.registered.filter(o=>i.has(o.connection.id)).forEach(o=>{ue(`Deleting controller ${o.id} as it is associated with a connection that has been deleted ${o.connection.kind}:${o.id}`),o.dispose()})},this,this.disposables);this.kernelFinder.onDidChangeRegistrations(n=>{n.removed.includes(e)&&t.dispose()})}onDidChangeUri(){this.onDidChangeFilter()}async onDidRemoveServers(e){e.forEach(t=>{this.registered.forEach(n=>{Ft(n.connection)&&n.connection.serverProviderHandle.id===t.id&&n.connection.serverProviderHandle.handle===t.handle&&(ue(`Deleting controller ${n.id} as it is associated with a connection that has been removed`),n.dispose())})}),this.onDidChangeFilter()}onDidChangeFilter(){this.all.filter(t=>!this.isFiltered(t)).forEach(t=>this.addOrUpdate(t,[Ct,St])),this.registered.forEach(t=>{this.isFiltered(t.connection)&&this.canControllerBeDisposed(t)&&(ue(`Deleting controller ${t.id} as it is associated with a connection that has been hidden`),t.dispose())})}batchAdd(e,t){let n=[];e.forEach(i=>{let{added:o}=this.addImpl(i,t,!1);n.push(...o)}),n.length&&this.changeEmitter.fire({added:n,removed:[]})}trackActiveInterpreterControllers(e){e.forEach(t=>this._activeInterpreterControllerIds.add(t.id))}canControllerBeDisposed(e){return!this._activeInterpreterControllerIds.has(e.id)&&!this.isControllerAttachedToADocument(e)}getSelected(e){return this.selectedControllers.get(e)}addOrUpdate(e,t){let{added:n,existing:i}=this.addImpl(e,t,!0);return n.concat(i)}addImpl(e,t,n){let i=[],o=[];Ie(`Create Controller for ${e.kind} and id '${e.id}' for view ${t.join(", ")}`);try{t.map(s=>{let a=this.getControllerId(e,s);return this.registeredMetadatas.set(e.id,e),[a,s]}).filter(([s])=>{let a=this.registeredControllers.get(s);return a?(a.updateConnection(e),o.push(a),Ie(`Found existing controller '${a.id}', not creating a new one just updating it`),!1):this.isFiltered(e)?(Ie(`Existing controller '${s}' will be excluded as it is filtered`),!1):(Ie(`Existing controller not found for '${s}', hence creating a new one`),!0)}).forEach(([s,a])=>{let l=tM.create(e,s,a,this.serviceContainer.get($e),this.serviceContainer.get(ut),this.disposables,this.serviceContainer.get(ea),this.serviceContainer.get(Ke),this.extensionChecker,this.serviceContainer,this.serviceContainer.get(NI),this.serviceContainer.get(vo,st.KERNEL_VARIABLES)),c=[];l.onDidDispose(()=>{Ie(`Deleting controller '${l.id}' associated with view ${a} from registration as it was disposed`),this.registeredControllers.delete(l.id),c.forEach(u=>u.dispose())},this,this.disposables),this.disposables.push(l),this.registeredControllers.set(l.id,l),i.push(l),l.onNotebookControllerSelected(u=>{var p;Ie(`Controller ${(p=u.controller)==null?void 0:p.id} selected for ${u.notebook.uri.toString()}`),this.selectedControllers.set(u.notebook,u.controller),this.selectedEmitter.fire(u)},this,c),l.onNotebookControllerSelectionChanged(u=>this.selectionChangedEmitter.fire({...u,controller:l}),this,c)}),n&&i.length&&this.changeEmitter.fire({added:i,removed:[]})}catch(s){if(Di(s,!0))return{added:i,existing:o};O(`Failed to create notebook controller for ${e.id}`,s)}return{added:i,existing:o}}get(e,t){let n=this.getControllerId(e,t);return this.registeredControllers.get(n)}isFiltered(e){return!1}getControllerId(e,t){return t===Ct?e.id:`${e.id}${kz}`}isControllerAttachedToADocument(e){return lp.workspace.notebookDocuments.some(t=>e.isAssociatedWithDocument(t))}};n_=E([(0,ap.injectable)(),b(0,(0,ap.inject)(oe)),b(1,(0,ap.inject)(Xd)),b(2,(0,ap.inject)(wo)),b(3,(0,ap.inject)(jr)),b(4,(0,ap.inject)(yr)),b(5,(0,ap.inject)(di))],n_);d();d();var Im=z(re());d();var VZ=require("vscode"),ED=class{constructor(e,t){this.id="remote";if(e.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage of this class, can only be used with remtoe kernels");this.kernelConnection=e.kernelConnectionMetadata,this.scriptManager=t.getOrCreate(e)}dispose(){}async getBaseUrl(){return VZ.Uri.parse(this.kernelConnection.baseUrl)}async getWidgetScriptSource(e){let n=(await this.getWidgetScriptSources()).find(i=>i.moduleName.toLowerCase()===e.toLowerCase());if(!n&&e.includes("/")){let i=await this.getBaseUrl();return{moduleName:e,scriptUri:`${i.toString()}${e}`,source:"remote"}}return n||{moduleName:e}}async getWidgetScriptSources(){let e=await this.scriptManager.getWidgetModuleMappings();return e&&Object.keys(e).length?await Promise.all(Object.keys(e).map(async n=>({moduleName:n,scriptUri:e[n].toString(),source:"remote"}))):[]}};ED.validUrls=new Map;var i_=class{constructor(e,t,n){this.configurationSettings=e;this.globalMemento=t;this.widgetScriptManagerFactory=n}getProviders(e,t){let n=[];switch(n.push(new sc(this.globalMemento,this.configurationSettings)),e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":n.push(new ED(e,this.widgetScriptManagerFactory));break}return n}};i_=E([(0,Im.injectable)(),b(0,(0,Im.inject)(Ke)),b(1,(0,Im.inject)(wt)),b(1,(0,Im.named)(ur)),b(2,(0,Im.inject)(qA))],i_);d();var bv=z(re());d();var yv=require("vscode");d();var c9=require("vscode");var eee=z(XZ());var ZZ=["require.config({","requirejs?.config({","window.requirejs?.config({","requirejs.config({",'["require"].config({',"['require'].config({",'["requirejs"].config({',"['requirejs'].config({",'["require"]["config"]({',"['require']['config']({",'["requirejs"]["config"]({',"['requirejs']['config']({"];async function dEe(r,e,t){let n=[...ZZ],i=await Ot(e),o=0,s;for(;o<=0&&n.length&&(s=n.pop(),!!s);)o=t.indexOf(s);if(o<0){let f=[...ZZ].map(m=>m.substring(0,m.length-2));for(;o<=0&&f.length&&(s=f.pop(),!!s);)o=t.indexOf(s)}if(o<0){J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigStart"});return}let a=t.indexOf(")",o);if(a<=0||!s){J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigEnd"});return}let l=t.indexOf("{",o),c=t.substring(l,a);c=(0,eee.default)(c,{language:"javascript"}),c=dt(c,{trim:!0,removeEmptyEntries:!0}).join("");let u=c.split("{")[c.split("{").length-1].split("}")[0].split(",").map(f=>f.trim()).filter(f=>f.length&&f.includes(":")),p={};if(u.forEach(f=>{let m=f.split(":"),h=jE(m[0].replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim(),g=jE(f.substring(f.indexOf(":")+1).replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim();p[h]=g.startsWith("http")?c9.Uri.parse(g):c9.Uri.joinPath(r,g)}),!p||!Object.keys(p).length){J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"noRequireConfigEntries"});return}return J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",{requireEntryPointCount:Object.keys(p).length},{widgetFolderNameHash:i,patternUsedToRegisterRequireConfig:s}),p}var oM=class{constructor(e){this.kernel=e;this.disposables=[];e.onRestarted(this.onKernelRestarted,this,this.disposables)}dispose(){he(this.disposables)}async getWidgetModuleMappings(){return this.widgetModuleMappings||(this.widgetModuleMappings=this.getWidgetModuleMappingsImpl()),this.widgetModuleMappings}onKernelRestarted(){this.widgetModuleMappings=void 0}async getConfigFromWidget(e,t,n){let i=await this.getWidgetScriptSource(t);try{let o=await dEe(e,n,i);if(!o){let s=`Failed to extract require.config from widget for ${n} from ${Se(t)}`;Ni&&(s+=`with contents ${i}`),ue(s)}return o}catch(o){O(`Failed to extract require.config entry for ${n} from ${Se(t)}`,o)}}async getWidgetModuleMappingsImpl(){let e=new Mt,[t,n]=await Promise.all([this.getWidgetEntryPoints(),this.getNbExtensionsParentPath()]);if(!n)return;let o=(await Promise.all(t.map(s=>this.getConfigFromWidget(n,s.uri,s.widgetFolderName)))).reduce((s,a)=>Object.assign(s||{},a),{});return o&&Object.keys(o).length&&(delete o["jupyter-js-widgets"],delete o["@jupyter-widgets/base"],delete o["@jupyter-widgets/controls"],delete o["@jupyter-widgets/output"]),J("DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",{duration:e.elapsedTime},{type:or(this.kernel.kernelConnectionMetadata)?"local":"remote"}),o&&Object.keys(o).length?o:void 0}};var sM=class extends oM{constructor(t,n,i,o){super(t);this.context=n;this.fs=i;this.connection=o;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&t.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage, can only be used for remote kernels");this.kernelConnection=t.kernelConnectionMetadata,this.getWidgetEntryPoints().catch(y)}getBaseUrl(){return this.getNbExtensionsParentPath()}async getNbExtensionsParentPath(){return yv.Uri.parse(this.kernelConnection.baseUrl)}onKernelRestarted(){this.widgetEntryPointsPromise=void 0,super.onKernelRestarted()}async getWidgetEntryPoints(){return this.widgetEntryPointsPromise||(this.widgetEntryPointsPromise=this.getWidgetEntryPointsImpl()),this.widgetEntryPointsPromise}getCodeToExecute(){return this.code||(this.code=this.fs.readFile(yv.Uri.joinPath(this.context.extensionUri,"pythonFiles","printJupyWidgetEntryPoints.py"))),this.code}async getWidgetEntryPointsImpl(){var s;if(!Qt(this.kernelConnection))return[];let t=await this.getCodeToExecute();if(!((s=this.kernel.session)!=null&&s.kernel))return Ie("No Kernel session to get list of widget entry points"),[];let n=[];n.push(Ji(this.kernel.session.kernel,t,{traceErrors:!0,traceErrorsMessage:"Failed to get widget entry points from remote kernel"})),!Ni&&this.context.extensionMode===yv.ExtensionMode.Production&&n.push(mc(1e4).then(()=>[])),n.forEach(a=>a.catch(y));let i=await Promise.race(n);if(i.length===0)return Ie("Unable to get widget entry points, no outputs after running the code"),[];let o=i[0];if(o.output_type!=="stream"||o.name!=="stdout")return Ie("Unable to get widget entry points, no stream/stdout outputs after running the code"),[];try{return q(`Widget Outputs include, ${o.text}`),o.text.trim().substring(1).slice(0,-1).split(",").map(l=>jE(l.trim()).replace(/\\\\/g,"/").replace(/\\/g,"/")).map(l=>({uri:yv.Uri.joinPath(yv.Uri.parse(this.kernelConnection.baseUrl),"nbextensions",l),widgetFolderName:Ri(l)}))}catch(a){return O(`Failed to parse output to get list of IPyWidgets, output is ${o.text}`,a),[]}}async getWidgetScriptSource(t){let n=this.getWidgetScriptSourceUsingHttpClient(t),i=this.getWidgetScriptSourceUsingFetch(t),o=n.catch(()=>i);return o.catch(s=>{n.catch(a=>O(`Failed to download widget script source from ${t.toString(!0)}`,a)),O(`Failed to download widget script source from ${t.toString(!0)}`,s)}),o}async getWidgetScriptSourceUsingHttpClient(t){let n=t.toString(!0),o=await new Su().downloadFile(n);if(o.status===200)return o.text();throw new Error(`Error downloading from ${n}: ${o.statusText}`)}async getWidgetScriptSourceUsingFetch(t){let n=await this.connection.createConnectionInfo(this.kernelConnection.serverProviderHandle),i=t.toString(!0),s=await new Su(n.settings.fetch).downloadFile(i);if(s.status===200)return s.text();throw new Error(`Error downloading from ${i} using custom fetch: ${s.statusText}`)}};var o_=class{constructor(e,t,n,i){this.context=e;this.fs=t;this.disposables=n;this.connection=i;this.managers=new WeakMap}getOrCreate(e){if(!this.managers.has(e))if(e.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"||e.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec"){let t=new sM(e,this.context,this.fs,this.connection);this.managers.set(e,t),e.onDisposed(()=>t.dispose(),this,this.disposables)}else throw new Error("Cannot enumerate Widget Scripts using local kernels on the Web");return this.managers.get(e)}};o_=E([(0,bv.injectable)(),b(0,(0,bv.inject)(ut)),b(1,(0,bv.inject)(Tt)),b(2,(0,bv.inject)(oe)),b(3,(0,bv.inject)(bn))],o_);d();var tee=z(re()),ree=require("vscode");var s_=class{async getNbExtensionsParentPath(e){switch(e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":return ree.Uri.parse(e.kernelConnectionMetadata.baseUrl);default:return}}};s_=E([(0,tee.injectable)()],s_);d();var aM=z(re()),ac=require("vscode");var ja=class{constructor(e){this.disposables=[];e.push(this)}dispose(){he(this.disposables)}activate(){let e=new Sp(1e3);this.disposables.push(e),ac.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>this.onDidChangeNotebookDocument(t))},this,this.disposables)}onDidChangeNotebookDocument(e){_r(e.notebook)&&e.cellChanges.some(t=>t.outputs&&t.outputs.some(n=>n.items&&n.items.some(i=>i.mime===Io)))&&this.checkRendererExtensionVersion()}checkRendererExtensionVersion(){if(!ac.workspace.isTrusted)return;let e=ac.extensions.getExtension(jv);if(!e){this.displayNotInstalledMessage();return}let t=e.packageJSON.version;if(!t){this.displayUpdateMessage();return}let n=t.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10),s=parseInt(n[2],10);(i<1||i===1&&o===0&&s<15)&&this.displayUpdateMessage()}displayNotInstalledMessage(){ja.messageDisplayed||(ja.messageDisplayed=!0,ac.window.showInformationMessage(_.rendererExtensionRequired,{modal:!0},Be.bannerLabelYes).then(e=>{e===Be.bannerLabelYes&&ac.commands.executeCommand("extension.open",jv).then(y,y)}).then(y,y))}displayUpdateMessage(){ja.messageDisplayed||(ja.messageDisplayed=!0,ac.window.showInformationMessage(_.rendererExtension1015Required,{modal:!0},Be.bannerLabelYes).then(e=>{e===Be.bannerLabelYes&&ac.commands.executeCommand("extension.open",jv).then(y,y)}).then(y,y))}};ja.messageDisplayed=!1,ja=E([(0,aM.injectable)(),b(0,(0,aM.inject)(oe))],ja);function nee(r,e){r.addSingleton(sp,sp),r.addSingleton(JA,i_),r.addSingleton(qA,o_),r.addSingleton(_Z,s_),r.addSingleton(sc,sc),r.addSingleton(He,ja)}d();var _m=z(re()),Xr=require("vscode");var a_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.kernelFinder=t;this.notebookEditorProvider=n;this.kernelDependency=i;this.localDisposables=[];this.providerMappings=new Map;this.kernelSpecsSourceRegistered=!1;o.push(this)}dispose(){he(this.localDisposables)}activate(){if(!Tn()){this.localDisposables.push(Xr.notebooks.registerKernelSourceActionProvider(Ct,{provideNotebookKernelSourceActions:()=>[{label:_.localPythonEnvironments,documentation:Xr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]})),this.localDisposables.push(Xr.notebooks.registerKernelSourceActionProvider(St,{provideNotebookKernelSourceActions:()=>[{label:_.localPythonEnvironments,documentation:Xr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]}));let t=[],n=new Xr.EventEmitter;this.localDisposables.push(Xr.notebooks.registerKernelSourceActionProvider(Ct,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t})),this.localDisposables.push(Xr.notebooks.registerKernelSourceActionProvider(St,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t}));let i=()=>{this.kernelSpecsSourceRegistered||this.kernelFinder.kernels.some(o=>sz(o))&&(this.kernelSpecsSourceRegistered=!0,t=[{label:_.localKernelSpecs,documentation:Xr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerJupyterKernels"),command:"jupyter.kernel.selectLocalKernelSpec"}],n.fire())};i(),this.kernelFinder.onDidChangeKernels(()=>i(),this,this.localDisposables),this.localDisposables.push(Xr.commands.registerCommand("jupyter.kernel.selectLocalKernelSpec",this.onSelectLocalKernel.bind(this,"localKernelSpec"),this)),this.localDisposables.push(Xr.commands.registerCommand("jupyter.kernel.selectLocalPythonEnvironment",this.onSelectLocalKernel.bind(this,"localPythonEnvironment"),this))}this.localDisposables.push(Xr.commands.registerCommand("jupyter.kernel.selectJupyterServerKernel",this.onSelectRemoteKernel,this)),at.instance.get(mr).onDidChangeCollections(this.registerUriCommands,this,this.localDisposables),this.registerUriCommands()}registerUriCommands(){let e=at.instance.get(mr),t=new Set;e.jupyterCollections.map(n=>{let i=`${n.extensionId}:${n.id}`;if(n.id===oP||(t.add(i),this.providerMappings.has(i)))return;let o=Xr.notebooks.registerKernelSourceActionProvider(Ct,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]}),s=Xr.notebooks.registerKernelSourceActionProvider(St,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]});this.localDisposables.push(o),this.localDisposables.push(s),this.providerMappings.set(i,{disposables:[o,s],provider:n})}),this.providerMappings.forEach(({disposables:n},i)=>{t.has(i)||(he(n),this.providerMappings.delete(i))})}async onSelectLocalKernel(e,t){var n;if(t=t||((n=Xr.window.activeNotebookEditor)==null?void 0:n.notebook),!!t)if(e==="localPythonEnvironment"){let o=await at.instance.get(u1).selectLocalKernel(t);return this.getSelectedController(t,o)}else{let o=await at.instance.get(Nz).selectLocalKernel(t);return this.getSelectedController(t,o)}}async onSelectRemoteKernel(e,t,n){var l,c,u;if(n=n||((l=Xr.window.activeNotebookEditor)==null?void 0:l.notebook),!n&&Xr.window.activeTextEditor&&(n=(c=this.notebookEditorProvider.findNotebookEditor(Xr.window.activeTextEditor.document.uri))==null?void 0:c.notebook),!n)return;let i=`${e}:${t}`,o=(u=this.providerMappings.get(i))==null?void 0:u.provider;if(!o)return;let a=await at.instance.get(c1).selectRemoteKernel(n,o);return this.getSelectedController(n,a)}async getSelectedController(e,t){var o;if(!t)return;let n=this.controllerRegistration.addOrUpdate(t,[e.notebookType]);if(!Array.isArray(n)||n.length===0){ue(`No controller created for selected kernel connection ${t.kind}:${t.id}`);return}Wa(e.uri,t).finally(()=>Rr(e.uri,"DS_INTERNAL.SWITCH_KERNEL",void 0,{newKernelPicker:!0})).catch(y),(o=n.find(s=>s.viewType===e.notebookType))==null||o.controller.updateNotebookAffinity(e,Xr.NotebookControllerAffinity.Preferred);let i=n[0];return await this.onControllerSelected(e,i),i.controller.id}async onControllerSelected(e,t){if(QG(e),or(t.connection)&&Qt(t.connection)&&fa(t.connection.interpreter)&&!Tn()){let n=[];try{let i=new Xr.CancellationTokenSource;n.push(i);let o=new Er(!1);n.push(o),await this.kernelDependency.installMissingDependencies({resource:e.uri,kernelConnection:t.connection,token:i.token,ui:o,cannotChangeKernels:!0,ignoreCache:!0,installWithoutPrompting:!0})}catch(i){O(`Failed to install missing dependencies for Conda kernel ${t.connection.id}`,i)}finally{he(n)}}}};a_=E([(0,_m.injectable)(),b(0,(0,_m.inject)(Ht)),b(1,(0,_m.inject)(di)),b(2,(0,_m.inject)(Ho)),b(3,(0,_m.inject)(_I)),b(4,(0,_m.inject)(oe))],a_);d();var Nu=z(re()),fi=require("vscode");d();var ta=require("vscode");var u9=class{constructor(e){this.label=e}},lM=class extends u9{constructor(t,n){super(t);this.sortKey=n;this.kind=ta.QuickPickItemKind.Separator}},cM=class extends zr{constructor(t,n,i,o,s,a){super();this.provider=t;this.createQuickPickItem=n;this.getCategory=i;this.options=o;this.createErrorQuickPickItem=s;this._title=a;this.categories=new Map;this.quickPickItems=[];this.previouslyEnteredValue="";this.commands=new Set;this._placeholder="";this.quickPickItemMap=new WeakSet;this.errorQuickPickItemMap=new WeakSet}set recommended(t){var i;let n=((i=this._recommended)==null?void 0:i.id)!==(t==null?void 0:t.id);this._recommended=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get recommended(){return this._recommended}set placeholder(t){this.quickPick&&(this.quickPick.placeholder=t),this._placeholder=t}get placeholder(){return this._placeholder}set selected(t){let n=this._selected!==t;this._selected=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get selected(){return this._selected}createQuickPick(){let t=[],n={iconPath:new ta.ThemeIcon("refresh"),tooltip:Be.refresh},i=this.quickPick=ta.window.createQuickPick();return t.push(i),this.quickPickItems=[],i.placeholder=this.placeholder,i.matchOnDescription=!0,i.buttons=this.options.supportsBack?[ta.QuickInputButtons.Back,n]:[n],i.ignoreFocusOut=!0,i.busy=!0,i.value=this.previouslyEnteredValue,i.onDidChangeValue(o=>this.previouslyEnteredValue=o,this,t),i.onDidHide(()=>he(t),this,t),i.title=this._title||_.kernelPickerSelectKernelFromRemoteTitleWithoutName,this.provider.then(o=>{this.resolvedProvider=o,this._title||(i.title=_.kernelPickerSelectKernelFromRemoteTitle(o.title)),i.busy=o.status==="discovering",o.onDidChange(()=>this.updateQuickPickItems(i,o),this,t),i.onDidTriggerButton(async a=>{a===n&&(i.busy=!0,await o.refresh().catch(y),this.updateQuickPickItems(i,o),i.busy=!1)},this,t);let s;o.onDidChangeStatus(()=>{switch(s&&clearTimeout(s),o.status){case"discovering":i.busy=!0;break;case"idle":s=setTimeout(()=>i.busy=!1,500),t.push(new ta.Disposable(()=>s&&clearTimeout(s)));break}},this,t),iee(o.items.map(a=>this.toQuickPickItem(a)),(a,l)=>oee(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{let l=this.connectionToCategory(a[0].item);this.quickPickItems.push(l),a.sort((c,u)=>c.label.localeCompare(u.label)),this.quickPickItems.push(...a),this.categories.set(l,new Set(a))}),this.updateQuickPickItems(i,o)}).catch(o=>O(`Failed to get quick pick items for ${i.title}`,o)),t.forEach(o=>this._register(o)),{quickPick:i,disposables:t}}isCommandQuickPickItem(t){return this.commands.has(t)}addCommand(t,n){let i=t;return i.execute=n,this.commands.add(i),this.quickPick&&this.rebuildQuickPickItems(this.quickPick),{dispose:()=>{this.commands.delete(i)}}}async selectItem(t){for(;!t.isCancellationRequested;){let{quickPick:n,disposables:i}=this.createQuickPick();n.show();try{this.previouslySelectedItem=void 0;let o=await new Promise((s,a)=>{n.onDidChangeSelection(l=>{if(l.length){let c=l[0];this.isSelectorQuickPickItem(c)?s(c.item):this.isCommandQuickPickItem(c)?s(c):this.isErrorQuickPickItem(c)}}),n.onDidTriggerButton(l=>l===ta.QuickInputButtons.Back?s(Ze.back):void 0,this,i),n.onDidHide(()=>s(void 0),this,i)});if(t.isCancellationRequested||!o)return;if(o instanceof Ze)return o===Ze.back?Ze.back:void 0;if(o&&"label"in o&&this.isCommandQuickPickItem(o)){this.previouslySelectedItem=o;let s=await o.execute();if(!s||s===Ze.back)continue;return s instanceof Ze,s}return o||void 0}finally{he(i)}}}updateQuickPickItems(t,n){let i=new Map(t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>[a.item.id,a.item])),o=new Map(n.items.map(a=>[a.id,a]));this.quickPickItems=this.quickPickItems.map(a=>{if(this.isSelectorQuickPickItem(a)){let l=i.get(a.item.id);if(l&&l!==a.item)return this.toQuickPickItem(l);let c=o.get(a.item.id);if(c){let u=this.toQuickPickItem(c);if(JSON.stringify({...a,item:""})!==JSON.stringify({...u,item:""}))return this.toQuickPickItem(c)}}return a});let s=n.items.filter(a=>!i.has(a.id)).map(a=>this.toQuickPickItem(a));this.removeOutdatedQuickPickItems(t,n),iee(s,(a,l)=>oee(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{a.sort((u,p)=>u.label.localeCompare(p.label));let l=this.connectionToCategory(a[0].item),c=this.quickPickItems.find(u=>u.kind===ta.QuickPickItemKind.Separator&&u.label===l.label);if(c){let u=this.quickPickItems.indexOf(c),p=this.categories.get(c),f=new Map(Array.from(p).map(g=>[g.item.id,g])),m=p.size;a.forEach(g=>{let v=f.get(g.item.id);v&&p.delete(v),p.add(g)});let h=Array.from(p);h.sort((g,v)=>g.label.localeCompare(v.label)),this.quickPickItems.splice(u+1,m,...h)}else{let u=this.quickPickItems.filter(m=>m instanceof lM).map((m,h)=>[m,h]);u.push([l,-1]),u.sort((m,h)=>m[0].sortKey.localeCompare(h[0].sortKey));let p=u.findIndex(m=>m[1]===-1),f=0;p>0&&(f=u.length===p+1?this.quickPickItems.length:u[p+1][1]),a.sort((m,h)=>m.label.localeCompare(h.label)),this.quickPickItems.splice(f,0,l,...a),this.categories.set(l,new Set(a))}}),this.rebuildQuickPickItems(t)}rebuildQuickPickItems(t){var p;let n=this.recommended?this.toQuickPickItem(this.recommended):void 0,i=[];n&&i.push({label:_.recommendedItemCategoryInQuickPick,kind:ta.QuickPickItemKind.Separator},n);let o=n;o=this.selected?this.quickPickItems.filter(f=>this.isSelectorQuickPickItem(f)).map(f=>f).find(f=>{var m;return f.item.id===((m=this.selected)==null?void 0:m.id)}):o;let s=this.quickPickItems.filter(f=>{var m;return!this.isSelectorQuickPickItem(f)||f.item.id!==((m=n==null?void 0:n.item)==null?void 0:m.id)}),a=t.activeItems.length?t.activeItems[0]:void 0;o&&a&&(this.isSelectorQuickPickItem(a)?a.item.id!==o.item.id&&(o=void 0):o=void 0);let l=(p=this.resolvedProvider)!=null&&p.lastError?this.toErrorQuickPickItem(this.resolvedProvider.lastError):void 0,c=[].concat(Array.from(this.commands.values())).concat(i).concat(s).concat(l?[l]:[]),u=o?[o]:t.activeItems.length?[t.activeItems[0]]:[];if(u.length&&!c.includes(u[0])){let f=u[0],m=this.isSelectorQuickPickItem(f)&&c.find(h=>this.isSelectorQuickPickItem(h)&&h.item.id===f.item.id);m?u[0]=m:u.length=0}t.items=c,t.activeItems=u,!t.activeItems.length&&this.previouslySelectedItem&&c.includes(this.previouslySelectedItem)&&(t.activeItems=[this.previouslySelectedItem])}isErrorQuickPickItem(t){return this.errorQuickPickItemMap.has(t)}toErrorQuickPickItem(t){if(!this.createErrorQuickPickItem)return;let n=this.createErrorQuickPickItem(t,this);return this.errorQuickPickItemMap.add(n),n}isSelectorQuickPickItem(t){return this.quickPickItemMap.has(t)}toQuickPickItem(t){let n=this.createQuickPickItem(t,this);return n.item=t,this.quickPickItemMap.add(n),n}removeOutdatedQuickPickItems(t,n){let i=t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>a.item.id),o=new Map(n.items.map(a=>[a.id,a])),s=i.filter(a=>!o.has(a));if(s.length){let a=[];this.categories.forEach((l,c)=>{l.forEach(u=>{s.includes(u.item.id)&&(l.delete(u),a.push(u))}),l.size||(a.push(c),this.categories.delete(c))}),this.quickPickItems=this.quickPickItems.filter(l=>!a.includes(l)),this.rebuildQuickPickItems(t)}}connectionToCategory(t){let n=this.getCategory(t,this);return new lM(n.label,n.sortKey||n.label)}};function iee(r,e){let t=[],n;for(let i of r.slice(0).sort(e))!n||e(n[0],i)!==0?(n=[i],t.push(n)):n.push(i);return t}function oee(r,e){return(r.sortKey||r.label).localeCompare(e.sortKey||e.label,void 0,{sensitivity:"accent"})}d();var uM=require("vscode");d();function see(r){return Ai()==="Windows"?Ps(r).toUpperCase():Ps(r)}function aee(r,e){return e.endsWith(Yi)||(e+=Yi),r.endsWith(Yi)||(r+=Yi),see(r).startsWith(see(e))}var l_=class{constructor(e){this.jupyterConnection=e;this.disposables=[]}dispose(){he(this.disposables)}async findPreferredRemoteKernelConnection(e,t,n){return this.findPreferredRemoteKernelConnectionImpl(e,t,n,!1)}async findPreferredRemoteKernelConnectionImpl(e,t,n,i){var l;let o=await at.instance.get(Xs).getPreferredRemoteKernelId(e),s=async()=>{let c=t.kernels.find(p=>p.kind==="connectToLiveRemoteKernel"&&p.id===o);if(c)return c;if(t.status==="idle")return;let u=await new Promise(p=>t.onDidChangeKernels(()=>{let f=t.kernels.find(m=>m.kind==="connectToLiveRemoteKernel"&&m.id===o);f&&p(f),(t.status==="idle"||n.isCancellationRequested)&&p(void 0)},this,this.disposables));if(u)return u};if(o){let c=await s();if(c||i)return c}let a=(l=t.kernels.find(c=>Ft(c)))==null?void 0:l.serverProviderHandle;if(a){let c=await this.jupyterConnection.createConnectionInfo(a),u=(e.uri,void 0),p=u&&t.kernels.find(f=>Ft(f)&&f.kind==="connectToLiveRemoteKernel"&&f.kernelModel.model&&f.kernelModel.model.path===u.path&&f.kernelModel.model.name===u.name);if(p)return p}return this.findPreferredKernelSpecConnection(e,t,n,i)}async findPreferredLocalKernelSpecConnection(e,t,n){return this.findPreferredKernelSpecConnection(e,t,n,!1)}async findPreferredKernelSpecConnection(e,t,n,i){var u;let o=Ma(e),s=(u=o==null?void 0:o.kernelspec)==null?void 0:u.name,a=()=>{let p=s?t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.name===s):[];if(p.length||i)return p;let f=$A(e);if(f)return t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.language&&(m.kernelSpec.language===f||$c(m.kernelSpec.language)===$c(f)))},l=a();if(Array.isArray(l)&&l.length)return i&&l.length>1?void 0:l[0];if(t.status==="idle")return;let c=[];return new Promise(p=>t.onDidChangeKernels(()=>{if(n.isCancellationRequested)return p(void 0);let f=a();if(Array.isArray(f)&&f.length)return i&&f.length>1?p(void 0):p(f[0]);t.status==="idle"&&p(void 0)},this,this.disposables)).finally(()=>he(c))}async findPreferredPythonKernelConnection(e,t,n){return this.findPreferredPythonKernelConnectionImpl(e,t,n)}async findPreferredPythonKernelConnectionImpl(e,t,n){t=t||at.instance.get(di).registered.find(c=>c.kind==="localPythonEnvironment");let i=at.instance.get(pm),o=d9(e,t);if(o)return o;let s=await i.getActiveInterpreter(e.uri);if(!s)return;let a=()=>{if(!n.isCancellationRequested)return t.kernels.filter(c=>c.kind==="startUsingPythonInterpreter").map(c=>c).find(c=>c.interpreter.id===s.id)},l=a();if(l)return l;if(t.status==="discovering")return await new Promise(c=>{t.onDidChangeStatus(()=>t.status==="idle"&&c(),this,this.disposables),t.onDidChangeKernels(()=>(d9(e,t)||a())&&c(),this,this.disposables)}),d9(e,t)||a()}};function d9(r,e){var i,o;let t=((i=uM.workspace.getWorkspaceFolder(r.uri))==null?void 0:i.uri)||(((o=uM.workspace.workspaceFolders)==null?void 0:o.length)===1?uM.workspace.workspaceFolders[0].uri:void 0),n=lee(zv(r.uri),e);if(n)return n;if(t)return lee(t,e)}function lee(r,e){let n=e.kernels.filter(a=>a.kind==="startUsingPythonInterpreter").map(a=>a).filter(a=>{var l,c,u;return aee(((u=(c=(l=to(a.interpreter))==null?void 0:l.environment)==null?void 0:c.folderUri)==null?void 0:u.fsPath)||a.interpreter.uri.fsPath,r.fsPath)}),i=n.find(a=>{var l;return Or(a.interpreter)==="Venv"&&((l=ks(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(i)return i;let o=n.find(a=>{var l;return Or(a.interpreter)==="Conda"&&((l=ks(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(o)return o;let s=n.find(a=>{var l;return((l=ks(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});return s||(n.length?n[0]:void 0)}function dM(r){return r===Xe||r===Wv}var c_=class{constructor(e,t,n,i,o,s,a){this.kernelFinder=e;this.serverUriStorage=t;this.serverSelector=n;this.jupyterConnection=i;this.displayDataProvider=o;this.kernelFinderController=s;this.jupyterServerRegistry=a;this.localDisposables=[]}async selectRemoteKernel(e,t){var o,s,a,l;if(e.notebookType!==Ct&&e.notebookType!==St)return;this.localDisposables.forEach(c=>c.dispose()),this.localDisposables=[],(o=this.cancellationTokenSource)==null||o.cancel(),(s=this.cancellationTokenSource)==null||s.dispose(),this.cancellationTokenSource=new fi.CancellationTokenSource;let n=new tD,i={disposables:[],notebook:e};try{if(await n.run(this.getRemoteServersFromProvider.bind(this,t,this.cancellationTokenSource.token),i)===Ze.cancel||((a=i.selection)==null?void 0:a.type)==="userPerformedSomeOtherAction")throw new fi.CancellationError;if(this.cancellationTokenSource.token.isCancellationRequested){he(i.disposables);return}if(((l=i.selection)==null?void 0:l.type)==="connection")return i.selection.connection}finally{he(i.disposables)}}async getRemoteServersFromProvider(e,t,n,i){var x;let o=this.kernelFinder.registered.filter(D=>D.kind==="remote"),s=[],a=[],l=[],c=(x=this.jupyterServerRegistry.jupyterCollections.find(D=>D.extensionId===e.extensionId&&D.id===e.id))==null?void 0:x.serverProvider,u=c!=null&&c.provideJupyterServers?Promise.resolve(c.provideJupyterServers.bind(c)(t)).then(D=>D||[]):Promise.resolve([]),p=new Set,f=await u,m=new Set(f.map(D=>D.id));if(o.filter(D=>D.serverProviderHandle.id===e.id).filter(D=>m.has(D.serverProviderHandle.id)).map(D=>{let A=this.serverUriStorage.all.find(w=>zt(w.provider)===zt(D.serverProviderHandle));p.add(zt(D.serverProviderHandle)),l.push({server:D,time:A==null?void 0:A.time})}),l.sort((D,A)=>!D.time&&!A.time?D.server.displayName.localeCompare(A.server.displayName):!D.time&&A.time?1:D.time&&!A.time||(D.time||0)>(A.time||0)?-1:1),l.filter(({time:D})=>(D||0)>0).forEach(({server:D,time:A})=>{s.push({type:"finder",kernelFinderInfo:D,idAndHandle:D.serverProviderHandle,label:D.displayName,description:A?_.jupyterServerLastConnectionForQuickPickDescription(new Date(A)):void 0,buttons:c!=null&&c.removeJupyterServer&&dM(e.extensionId)?[{iconPath:new fi.ThemeIcon("close"),tooltip:_.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),l.filter(({time:D})=>!D).forEach(({server:D})=>{s.push({type:"finder",kernelFinderInfo:D,idAndHandle:D.serverProviderHandle,label:D.displayName,buttons:c!=null&&c.removeJupyterServer&&dM(e.extensionId)?[{iconPath:new fi.ThemeIcon("close"),tooltip:_.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),f.sort((D,A)=>D.label.localeCompare(A.label)).forEach(D=>{let A=zt({extensionId:e.extensionId,id:e.id,handle:D.id});p.has(A)||s.push({type:"jupyterServer",label:D.label,idAndHandle:{extensionId:e.extensionId,id:e.id,handle:D.id},server:D,buttons:c!=null&&c.removeJupyterServer&&dM(e.extensionId)?[{iconPath:new fi.ThemeIcon("close"),tooltip:_.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),e.commandProvider){let D=(await Promise.resolve(e.commandProvider.provideCommands(void 0,t))||[]).map(A=>({...A,provider:e,type:"uriProviderQuickPick",command:A}));s.length>0&&D.length&&a.push({label:"",kind:fi.QuickPickItemKind.Separator}),a.push(...D)}let h=s.concat(a),g=new fi.EventEmitter,v=h.length===1&&"command"in h[0]&&h[0].command.canBeAutoSelected?h[0]:void 0;if(c){let D=h.filter(A=>"type"in A);D.length===1&&D.every(A=>A.type!=="uriProviderQuickPick")?v=D[0]:D.every(A=>A.type==="uriProviderQuickPick")&&D.filter(A=>A.picked).length===1&&(v=h.filter(A=>A.picked)[0])}let I,S;if(v)S=v;else{let{quickPick:D,selection:A}=n.showLazyLoadQuickPick({items:h,placeholder:e.extensionId===Xe||e.extensionId===Wv?_.enterOrSelectRemoteJupyterPlaceholder:_.selectRemoteJupyterPlaceholder,title:_.quickPickTitleForSelectionOfJupyterServer,supportBackInFirstStep:!0,onDidTriggerItemButton:async w=>{if("type"in w.item&&(w.item.type==="finder"||w.item.type==="jupyterServer")){let R=w.item.idAndHandle.handle,j=f.find(ne=>ne.id===R);c!=null&&c.removeJupyterServer&&j&&dM(e.extensionId)&&(D.busy=!0,this.serverUriStorage.remove({extensionId:e.extensionId,id:e.id,handle:R}).catch(y),await c.removeJupyterServer(j),D.busy=!1,h.splice(h.indexOf(w.item),1),g.fire(h.concat([])))}},onDidChangeItems:g.event});D.onDidChangeValue(async w=>{var N;if(!((N=e.commandProvider)!=null&&N.provideCommands))return;let R=[];s.length>0&&R.push({label:"",kind:fi.QuickPickItemKind.Separator});let ne=(await Promise.resolve(e.commandProvider.provideCommands(w,t))||[]).map(ee=>({...ee,provider:e,type:"uriProviderQuickPick",command:ee}));D.items=s.concat(R).concat(ne)},this),I=D,S=await A}if(!t.isCancellationRequested&&S&&"type"in S)switch(S.type){case"finder":{let D=await this.selectRemoteKernelFromPicker(i.notebook,Promise.resolve(S.kernelFinderInfo),t).catch(A=>O("Failed to select a kernel",A));if(D&&D===Ze.back){if(S===v)throw Ze.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!D||D instanceof Ze)throw new fi.CancellationError;i.selection={type:"connection",connection:D};return}case"jupyterServer":{let D=(async()=>{let w={id:e.id,handle:S.server.id,extensionId:e.extensionId};return e.extensionId.toLowerCase()===fc.toLowerCase()&&await ys(t,this.serverSelector.addJupyterServer(w)),this.kernelFinderController.getOrCreateRemoteKernelFinder(w,S.server.label)})(),A=await this.selectRemoteKernelFromPicker(i.notebook,D,t).catch(w=>O("Failed to select a kernel",w));if(A&&A===Ze.back){if(S===v)throw Ze.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!A||A instanceof Ze)throw new fi.CancellationError;i.selection={type:"connection",connection:A};return}case"uriProviderQuickPick":{let D=fi.notebooks.createNotebookControllerDetectionTask(Ct);try{I&&(I.busy=!0);let A=await this.selectRemoteServerFromRemoteKernelFinder(S,i,t);return I&&(I.busy=!1),A}catch(A){if(A===Ze.back&&!v)return this.getRemoteServersFromProvider(e,t,n,i);throw A}finally{D.dispose()}}default:break}}async selectRemoteServerFromRemoteKernelFinder(e,t,n){var a;if(!((a=e.provider.commandProvider)!=null&&a.handleCommand)||n.isCancellationRequested)return;let i=await Promise.resolve(e.provider.commandProvider.handleCommand(e.command,n));if(!i)throw Ze.back;if(n.isCancellationRequested)throw new fi.CancellationError;let o=(async()=>{let l={id:e.provider.id,handle:i.id,extensionId:e.provider.extensionId};return l.extensionId.toLowerCase()===fc.toLowerCase()&&await ys(n,this.serverSelector.addJupyterServer(l)),this.kernelFinderController.getOrCreateRemoteKernelFinder(l,i.label)})(),s=await this.selectRemoteKernelFromPicker(t.notebook,o,n).catch(l=>O("Failed to select a kernel",l));if(s&&s===Ze.back)throw Ze.back;if(!s||s instanceof Ze)throw new fi.CancellationError;t.selection={type:"connection",connection:s}}async selectRemoteKernelFromPicker(e,t,n){let i,o=u=>{let p=this.displayDataProvider.getDisplayData(u);return{label:`${u===i?"$(star-full) ":""}${p.label}`,description:p.description,detail:p.detail}},s=u=>({label:this.displayDataProvider.getDisplayData(u).category||"Other"}),a=u=>({label:_.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel,detail:_.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail}),l=new cM(t,o,s,{supportsBack:!0},a),c=new l_(this.jupyterConnection);return t.then(u=>c.findPreferredRemoteKernelConnection(e,u,n)).then(u=>{i=u,(u==null?void 0:u.kind)==="startUsingRemoteKernelSpec"&&(l.recommended=u),l.selected=u}).catch(u=>O("Failed to determine preferred remote kernel",u)),l.selectItem(n)}};c_=E([(0,Nu.injectable)(),b(0,(0,Nu.inject)(di)),b(1,(0,Nu.inject)(yr)),b(2,(0,Nu.inject)(tc)),b(3,(0,Nu.inject)(bn)),b(4,(0,Nu.inject)(NI)),b(5,(0,Nu.inject)(fD)),b(6,(0,Nu.inject)(mr))],c_);function cee(r,e){r.addSingleton(Ht,n_),r.addBinding(Ht,He),r.addSingleton(NI,t_),r.addSingleton(c1,c_),r.addSingleton(He,a_),nee(r,e)}d();var wD=z(re()),Iv=require("vscode");d();var u_=Symbol("IJupyterDebugService"),Em=Symbol("INotebookDebuggingManager");var pM=Symbol("IDebugLocationTrackerFactory"),fM=Symbol("IDebugLocationTracker");var d_=class{constructor(e,t){this.debuggingManager=e;this.disposables=t}activate(){this.disposables.push(Iv.commands.registerCommand(X.RunByLine,this.runByLine,this)),this.disposables.push(Iv.commands.registerCommand(X.RunByLineNext,this.runByLineNext,this)),this.disposables.push(Iv.commands.registerCommand(X.RunByLineStop,this.runByLineStop,this)),this.disposables.push(Iv.commands.registerCommand(X.RunAndDebugCell,this.runAndDebugCell,this))}async runByLine(e){J("DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(0,e)}async runByLineNext(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineNext(e)}async runByLineStop(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineStop(e)}async runAndDebugCell(e){J("DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(1,e)}getCellFromActiveEditor(){let e=Iv.window.activeNotebookEditor;if(e){let t=e.selections[0];if(t)return e.notebook.cellAt(t.start)}}dispose(){this.disposables.forEach(e=>e.dispose())}};d_=E([(0,wD.injectable)(),b(0,(0,wD.inject)(Em)),b(1,(0,wD.inject)(oe))],d_);d();var lc=z(re());var xD=require("vscode");d();var p9=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]);function hM(r){var e;return{name:(e=r.evaluateName)!=null?e:r.name,type:r.type,count:0,shape:"",size:0,supportsDataExplorer:p9.has(r.type||""),value:r.value,truncated:!0,frameId:r.variablesReference}}d();var f9=require("vscode"),p_=class{constructor(e){this._sessionId=e;this.topMostFrameId=0;this.sequenceNumbersOfRequestsPendingResponses=new Set;this.waitingForStackTrace=!1;this.debugLocationUpdatedEvent=new f9.EventEmitter;this.sessionEndedEmitter=new f9.EventEmitter;this.DebugLocation=void 0}get sessionId(){return this._sessionId}get sessionEnded(){return this.sessionEndedEmitter.event}get debugLocationUpdated(){return this.debugLocationUpdatedEvent.event}get debugLocation(){return this._debugLocation}onDidSendMessage(e){var t,n;if(this.isResponseForRequestToFetchAllFrames(e)){let i=(t=e.body)==null?void 0:t.stackFrames[0];this.topMostFrameId=i==null?void 0:i.id,this.sequenceNumbersOfRequestsPendingResponses.delete(e.request_seq),this.waitingForStackTrace&&(this.DebugLocation={lineNumber:i==null?void 0:i.line,fileName:this.normalizeFilePath((n=i==null?void 0:i.source)==null?void 0:n.path),column:i.column},this.waitingForStackTrace=!1)}this.isStopEvent(e)&&(this.waitingForStackTrace=!0),this.isContinueEvent(e)&&(this.DebugLocation=void 0,this.waitingForStackTrace=!1)}onWillStopSession(){this.sessionEndedEmitter.fire(this)}onWillReceiveMessage(e){this.isRequestToFetchAllFrames(e)&&this.sequenceNumbersOfRequestsPendingResponses.add(e.seq)}set DebugLocation(e){let t=this._debugLocation;this._debugLocation=e,this._debugLocation!==t&&this.debugLocationUpdatedEvent.fire()}normalizeFilePath(e){return process.platform!=="win32"?e.replace(/\\/g,"/"):e}isStopEvent(e){return e.type==="event"&&e.event==="stopped"}isContinueEvent(e){if(e.type==="event"){if(e.event==="continue")return!0}else if(e.type==="response"&&e.command==="continue")return!0;return!1}isResponseForRequestToFetchAllFrames(e){var t;return e.type==="response"&&e.command==="stackTrace"&&((t=e.body)==null?void 0:t.stackFrames[0])&&this.sequenceNumbersOfRequestsPendingResponses.has(e.request_seq)}isRequestToFetchAllFrames(e){return e.type==="request"&&e.command==="stackTrace"&&(e.arguments.startFrame===0||e.arguments.startFrame===void 0)}};var pEe=new Set(["In","Out","exit","quit"]),gM=100,f_=class extends p_{constructor(t,n,i,o,s,a){super(void 0);this.debugService=t;this.debuggingManager=n;this.configService=i;this.varScriptGenerator=o;this.dfScriptGenerator=s;this.kernelProvider=a;this.refreshEventEmitter=new xD.EventEmitter;this.lastKnownVariables=[];this.importedGetVariableInfoScriptsIntoKernel=new Set;this.watchedNotebooks=new Map;this.debuggingStarted=!1;this.currentVariablesReference=0;this.currentSeqNumsForVariables=new Set;this.debuggingManager.onDoneDebugging(()=>this.refreshEventEmitter.fire(),this)}get refreshRequired(){return this.refreshEventEmitter.event}get active(){return(this.debugService.activeDebugSession!==void 0||this.activeNotebookIsDebugging())&&this.debuggingStarted}getAllVariableDiscriptions(){throw new Error("Method not implemented.")}async getVariables(t,n){n&&this.watchKernel(n);let i=n&&this.kernelProvider.getKernelExecution(n),o={executionCount:i?i.executionCount:t.executionCount,pageStartIndex:0,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(this.active){let s=t.sortColumn,a=(u,p)=>{let f=u[s]?u[s]:"",m=p[s]?p[s]:"";return t.sortAscending?f.localeCompare(m,void 0,{sensitivity:"base"}):m.localeCompare(f,void 0,{sensitivity:"base"})};this.lastKnownVariables.sort(a);let l=t.startIndex?t.startIndex:0,c=t.pageSize?t.pageSize:gM;o.pageStartIndex=l;for(let u=l;u<l+c&&u<this.lastKnownVariables.length;u+=1){let p=this.lastKnownVariables[u].truncated?await this.getFullVariable(this.lastKnownVariables[u]):this.lastKnownVariables[u];this.lastKnownVariables[u]=p,o.pageResponse.push(p)}o.totalCount=this.lastKnownVariables.length}return o}async getMatchingVariable(t,n){if(this.active){let i=this.lastKnownVariables.find(o=>o.name===t);return i&&(n!=null&&n.resourceUri)&&$v(n==null?void 0:n.resourceUri).toLowerCase()===".ipynb"&&J("DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER"),i}}async getVariableValueSummary(t){}async getDataFrameInfo(t,n,i,o){var m;if(!this.active)return t;o&&(t=await this.getFullVariable(t)),n&&this.watchKernel(n);let s=t.name;i&&(s=`${t.name}${i}`);let{cleanupCode:a,initializeCode:l,code:c}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!0,variableName:s}),u=await this.evaluate({code:c,cleanupCode:a,initializeCode:l,frameId:t.frameId}),p=n==null?void 0:n.notebook,f=p?sr(p.uri.path):"";return!f&&((m=this.debugLocation)!=null&&m.fileName)&&(f=sr(this.debugLocation.fileName)),u?{...t,...JSON.parse(u.result),maximumRowChunkSize:gM,fileName:f}:t}async getDataFrameRows(t,n,i,o,s){if(i-n>gM)throw new Error(`Debugger cannot provide more than ${gM} rows at once`);if(!this.debugService.activeDebugSession||t.columns===void 0)return{data:[]};o&&this.watchKernel(o);let a=t.name;s&&(a=`${t.name}${s}`);let{cleanupCode:l,initializeCode:c,code:u}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!0,variableName:a,startIndex:n,endIndex:i}),p=await this.evaluate({code:u,cleanupCode:l,initializeCode:c,frameId:t.frameId});return Qj(JSON.parse(p.result))}onWillReceiveMessage(t){super.onWillReceiveMessage(t),t.type==="request"&&t.command==="variables"&&t.arguments&&this.currentVariablesReference===t.arguments.variablesReference&&this.currentSeqNumsForVariables.add(t.seq)}onDidSendMessage(t){var n;if(super.onDidSendMessage(t),t.type==="response"&&t.command==="initialize")this.debuggingStarted=!0;else if(t.type==="event"&&t.event==="stopped"&&this.activeNotebookIsDebugging())this.handleNotebookVariables(t).catch(y);else if(t.type==="response"&&t.command==="scopes"&&t.body&&t.body.scopes){let o=t.body.scopes[0].variablesReference;o!==this.currentVariablesReference&&(this.currentVariablesReference=o,this.currentSeqNumsForVariables.clear())}else if(t.type==="response"&&t.command==="variables"&&t.body)this.currentSeqNumsForVariables.has(t.request_seq)&&this.updateVariables(void 0,t),this.monkeyPatchDataViewableVariables(t);else if(t.type==="event"&&t.event==="terminated"){this.lastKnownVariables=[],this.topMostFrameId=0,this.debuggingStarted=!1,this.refreshEventEmitter.fire();let i=(n=this.debugService.activeDebugSession)==null?void 0:n.id;i&&this.importedGetVariableInfoScriptsIntoKernel.delete(i)}}watchKernel(t){var i;let n=(i=t.notebook)==null?void 0:i.uri.toString();if(n&&!this.watchedNotebooks.has(n)){let o=[];o.push(t.onRestarted(this.resetImport.bind(this,n))),o.push(t.onDisposed(()=>{this.resetImport(n),o.forEach(s=>s.dispose()),this.watchedNotebooks.delete(n)})),this.watchedNotebooks.set(n,o)}}resetImport(t){this.importedGetVariableInfoScriptsIntoKernel.delete(t)}async evaluate({code:t,cleanupCode:n,frameId:i,initializeCode:o}){if(this.debugService.activeDebugSession){i=this.topMostFrameId||i;let s={frameId:i,context:"repl",format:{rawString:!0}};q(`Evaluating in debugger : ${this.debugService.activeDebugSession.id}: ${t}`);try{o&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:o});let a=await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:t});if(a&&a.result!=="None")return a;O(`Cannot evaluate ${t}`);return}finally{n&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:n})}}throw Error("Debugger is not active, cannot evaluate.")}async getFullVariable(t){let{initializeCode:n,code:i,cleanupCode:o}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!0,variableName:t.name}),s=await this.evaluate({code:i,initializeCode:n,cleanupCode:o,frameId:t.frameId});return s&&s.result?{...t,truncated:!1,...JSON.parse(s.result)}:t}monkeyPatchDataViewableVariables(t){t.body.variables.forEach(n=>{n.type&&p9.has(n.type)&&(n.__vscodeVariableMenuContext="viewableInDataViewer")})}updateVariables(t,n){var s;let i=this.configService.getSettings(t).variableExplorerExclude?(s=this.configService.getSettings().variableExplorerExclude)==null?void 0:s.split(";"):[],o=n.body.variables.filter(a=>!(!a.name||!a.type||!a.value||i&&i.includes(a.type)||a.name.startsWith("_")||pEe.has(a.name)||a.type==="NoneType"));this.lastKnownVariables=o.map(a=>hM(a)),this.refreshEventEmitter.fire()}activeNotebookIsDebugging(){let t=xD.window.activeNotebookEditor;return!!t&&this.debuggingManager.isDebugging(t.notebook)}async handleNotebookVariables(t){var o;let n=(o=xD.window.activeNotebookEditor)==null?void 0:o.notebook,i=t.body.threadId;if(n){let s=this.debuggingManager.getDebugSession(n);if(s){let a=await s.customRequest("stackTrace",{threadId:i,startFrame:0,levels:1});if(a&&a.stackFrames[0]){let l=a.stackFrames[0],c=this.debuggingManager.getDebugMode(n),u;if(c===0){let p=this.debuggingManager.getDebugCell(n);l.source&&p&&l.source.path===p.document.uri.toString()&&(u=await s.customRequest("scopes",{frameId:l.id}))}else{let p=sr(n.uri.toString());l.source&&l.source.path&&l.source.path.includes(p)&&(u=await s.customRequest("scopes",{frameId:l.id}))}u&&(u.scopes.forEach(p=>{s.customRequest("variables",{variablesReference:p.variablesReference}).then(y,y)}),this.refreshEventEmitter.fire())}}}}};f_=E([(0,lc.injectable)(),b(0,(0,lc.inject)(u_)),b(0,(0,lc.named)(st.MULTIPLEXING_DEBUGSERVICE)),b(1,(0,lc.inject)(Em)),b(2,(0,lc.inject)(Ke)),b(3,(0,lc.inject)(ey)),b(4,(0,lc.inject)(ty)),b(5,(0,lc.inject)($e))],f_);d();var cp=z(re()),Cm=require("vscode");d();var uee=require("vscode"),br=class{constructor(e){this.name=e}get value(){return this.lastValue}async set(e){this.lastValue!==e&&(this.lastValue=e,await uee.commands.executeCommand("setContext",this.name,this.lastValue))}};d();var gee=require("vscode");d();var DD=(o=>(o[o.Unknown=0]="Unknown",o[o.Ok=1]="Ok",o[o.Outdated=2]="Outdated",o[o.NotInstalled=3]="NotInstalled",o[o.ControllerNotSelected=4]="ControllerNotSelected",o))(DD||{});async function dee(r){var o,s;let e="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",t=`import builtins
import ipykernel
builtins.print("${e}" + ipykernel.__version__ + "${e}")`,n=await r.executeHidden(t),i=/^(\d+)\.\d+\.\d+$/;for(let a of n){if(a.output_type!=="stream")continue;let l=(s=(o=a.text)==null?void 0:o.toString().trim())!=null?s:"";if(!l.includes(e))continue;let c=l.split(e)[1].trim().match(i);if(c){let u=c[1];return Number(u)>=6?1:2}}return 0}function PD(r){let e=r;if(typeof e.__notebookUri=="undefined"||typeof e.__mode=="undefined"||(e.__mode===1||e.__mode===2||e.__mode===0)&&typeof e.__cellIndex=="undefined")throw new Error("Invalid launch configuration")}function pee(r){if(PD(r),r.__mode!==2)throw new Error("Invalid launch configuration")}function vM(r,e){switch(r.type){case"event":let t=r;switch(t.event){case"output":e(t.body);break;case"loadedSource":e(t.body);break;case"breakpoint":e(t.body.breakpoint);break;default:break}break;case"request":let n=r;switch(n.command){case"setBreakpoints":let o=n.arguments,s=o.breakpoints;if(s&&s.length){let a=s[0].line;s.forEach(c=>{e(c,{...o.source})});let l={source:o.source,line:a};e(l),o.source=l.source}break;case"breakpointLocations":e(n.arguments);break;case"source":e(n.arguments);break;case"gotoTargets":e(n.arguments);break;default:break}break;case"response":let i=r;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(o=>{e(o)});break;case"loadedSources":i.body.sources.forEach(o=>{let s={source:o};e(s),o.path=s.source.path});break;case"scopes":i.body.scopes.forEach(o=>{e(o)});break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;case"setBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;default:break}break}}function fee(r){return/~\d+\\/.test(r)}function mee(r,e){return new RegExp(r.replace(/\\/g,"\\\\").replace(/~\d+\\\\/g,"[^\\\\]+\\\\"),"i").test(e)}async function Sv(r,e){let t=`import debugpy
debugpy.debug_this_thread()`;await r.executeHidden(t),await e.dumpAllCells()}function hee(r){return!!r.header&&r.header.msg_type==="debug_event"}function TD(r){return r.includes("Frame skipped from debugging during step-in")}function m9(r){return r.event==="debugpyAttach"}var yM=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;J("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){q(`[Debug-Cell] ${e}: ${t}`)}async willSendEvent(e){return m9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&TD(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){e.command==="configurationDone"&&(await Sv(this.execution,this.debugAdapter),gee.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(y,y))}};d();var kD=class{constructor(e,t,n,i){this.mode=e;this.debugAdapter=t;this.debugCell=n;this.serviceContainer=i;this.debuggingManager=this.serviceContainer.get(Em)}trace(e,t){q(`[Debug-Restart] ${e}: ${t}`)}error(e,t){O(`[Debug-Restart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Handling restart request"),setTimeout(()=>{this.debugAdapter.disconnect().then(()=>(this.trace("restart","doRestart"),this.debuggingManager.tryToStartDebugging(this.mode,this.debugCell,!0))).catch(t=>{this.error("restart",`Error restarting: ${t}`)})},0),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};d();var ND=require("vscode");var bM=class{constructor(e,t,n,i){this.debugAdapter=e;this.debugCell=t;this.execution=n;this.settings=i;J("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE")}continue(){if(typeof this.lastPausedThreadId!="number"){q("No paused thread, can't do RBL"),this.stop();return}this.debugAdapter.stepIn(this.lastPausedThreadId).then(y,y)}stop(){Ie("RunbylineController::stop()"),this.execution.executeHidden("pass").then(y,y),this.debugAdapter.disconnect().then(y,y)}getMode(){return this.debugAdapter.getConfiguration().__mode}async willSendEvent(e){return e.event==="stopped"&&(this.lastPausedThreadId=e.body.threadId,await this.handleStoppedEvent(this.lastPausedThreadId))?(this.trace("intercepted","handled stop event"),!0):e.event==="output"&&TD(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){Ie(`willSendRequest: ${e.command}`),e.command==="configurationDone"&&await this.initializeExecute()}async handleStoppedEvent(e){return await this.shouldStepIn(e)?(this.debugAdapter.stepIn(e).then(y,y),!0):!1}async shouldStepIn(e){var n;let t=await this.debugAdapter.stackTrace({threadId:e,startFrame:0,levels:1});if(t&&t.stackFrames[0]){let i=t.stackFrames[0],o=new ND.Position(i.line,i.column);return(n=this.lastPausePosition)!=null&&n.isEqual(o)?(this.trace("intercept","working around duplicate stop event"),!0):(this.lastPausePosition=o,!!i.source&&i.source.path!==this.debugCell.document.uri.toString())}return!1}trace(e,t){q(`[Debug-RBL] ${e}: ${t}`)}async initializeExecute(){await Sv(this.execution,this.debugAdapter);let e=dt(this.debugCell.document.getText(),{trim:!1,removeEmptyEntries:!1}),t=[];if(Og(e,()=>void 0,(n,i)=>{n.trim().length!==0&&t.push(i)}),t.sort(),t.length!==0){let n={line:t[0]+1};await this.debugAdapter.setBreakpoints({source:{name:sr(this.debugCell.notebook.uri.path),path:this.debugCell.document.uri.toString()},breakpoints:[n],sourceModified:!1}),this.settings.getSettings(this.debugCell.notebook.uri).showVariableViewWhenDebugging&&ND.commands.executeCommand(X.OpenVariableView).then(y,y)}ND.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(y,y)}};d();var m_=class{constructor(e,t,n){this.document=e;this.config=t;this.session=n}};d();var mi=require("vscode");var h_=class{constructor(e,t,n){this.kernelProvider=e;this.controllerRegistration=t;this.serviceContainer=n;this.notebookToDebugger=new Map;this.notebookToDebugAdapter=new Map;this.notebookInProgress=new Set;this.disposables=[];this._doneDebugging=new mi.EventEmitter}activate(){this.disposables.push(mi.debug.onDidTerminateDebugSession(this.endSession.bind(this)),mi.workspace.onDidCloseNotebookDocument(async e=>{let t=this.notebookToDebugger.get(e);t&&(await mi.debug.stopDebugging(t.session),this.onDidStopDebugging(e))}))}getDebugCell(e){var t;return(t=this.notebookToDebugAdapter.get(e))==null?void 0:t.debugCell}get onDoneDebugging(){return this._doneDebugging.event}dispose(){this.disposables.forEach(e=>e.dispose())}isDebugging(e){return this.notebookToDebugger.has(e)}getDebugSession(e){let t=this.notebookToDebugger.get(e);if(t)return t.session}getDebugAdapter(e){return this.notebookToDebugAdapter.get(e)}onDidStopDebugging(e){}async startDebuggingConfig(e,t){Ie(`Attempting to start debugging with config ${JSON.stringify(e)}`);try{await mi.debug.startDebugging(void 0,e,t)}catch(n){O(`Can't start debugging (${n})`),mi.window.showErrorMessage(_.cantStartDebugging).then(y,y)}}trackDebugAdapter(e,t){this.notebookToDebugAdapter.set(e,t),this.disposables.push(t.onDidEndSession(this.endSession.bind(this)))}async endSession(e){De(`Ending debug session ${e.id}`),this._doneDebugging.fire();for(let[t,n]of this.notebookToDebugger.entries())if(n&&e.id===n.session.id){this.notebookToDebugger.delete(t),this.notebookToDebugAdapter.delete(t),this.onDidStopDebugging(t);break}}getDebuggerByUri(e){for(let[t,n]of this.notebookToDebugger.entries())if(e===t)return n}async ensureKernelIsRunning(e){let t=this.controllerRegistration.getSelected(e),n=this.kernelProvider.get(e);return t&&(!n||n&&n.status==="unknown")&&(n=await Va.connectToNotebookKernel(t.connection,this.serviceContainer,{notebook:e,controller:t.controller,resource:e.uri},new Er(!1),this.disposables,"jupyterExtension")),n}findEditorForCell(e){let t=e.notebook.uri.toString();return mi.window.visibleNotebookEditors.find(n=>n.notebook.uri.toString()===t)}async checkIpykernelAndPrompt(e,t=!0){let n=this.findEditorForCell(e);if(!n)return mi.window.showErrorMessage(_.noNotebookToDebug).then(y,y),0;let i=await this.checkForIpykernel6(n.notebook);switch(i){case 3:break;case 2:case 0:{this.promptInstallIpykernel6().then(y,y);break}case 4:if(t)return await mi.commands.executeCommand("notebook.selectKernel",{notebookEditor:n}),await this.checkIpykernelAndPrompt(e,!1)}return i}async checkForIpykernel6(e){var t,n;try{let i=this.kernelProvider.get(e);if(!i){let l=this.controllerRegistration.getSelected(e);if(!l)return 4;i=this.kernelProvider.getOrCreate(e,{metadata:l.connection,controller:l==null?void 0:l.controller,resourceUri:e.uri})}let o=i.kernelConnectionMetadata;if(Ft(o)){if(o.kind==="startUsingRemoteKernelSpec"&&((t=o.kernelSpec.metadata)!=null&&t.debugger))return 1;if(o.kind==="connectToLiveRemoteKernel"&&((n=o.kernelModel.metadata)!=null&&n.debugger))return 1}let s=this.kernelProvider.getKernelExecution(i),a=await dee(s);return J("DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",void 0,{status:a===1?"installed":"notInstalled"}),a}catch(i){O("Debugging: Could not check for ipykernel 6",i)}return 0}async promptInstallIpykernel6(){await mi.window.showInformationMessage(_.needIpykernel6,{modal:!0},_.setup)===_.setup?(J("DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP"),mi.env.openExternal(mi.Uri.parse("https://github.com/microsoft/vscode-jupyter/wiki/Setting-Up-Run-by-Line-and-Debugging-for-Notebooks"))):J("DATASCIENCE.DEBUGGING.CLOSED_MODAL")}};d();d();var Jo=require("vscode");d();var IM=class{constructor(e){this.debugAdapter=e}trace(e,t){q(`[Debug-Reset] ${e}: ${t}`)}async willSendRequest(e){e.command==="attach"&&(this.trace("attach","Continuing paused kernel threads if needed"),(await this.debugAdapter.debugInfo()).stoppedThreads.forEach(n=>this.debugAdapter.continueDirect(n)))}};var g_=class{constructor(e,t,n,i,o,s){this.session=e;this.notebookDocument=t;this.jupyterSession=n;this.kernel=i;this.platformService=o;this.debugService=s;this.fileToCell=new Map;this.sendMessage=new Jo.EventEmitter;this.endSession=new Jo.EventEmitter;this.disposables=[];this.delegates=[];this.onDidSendMessage=this.sendMessage.event;this.onDidEndSession=this.endSession.event;this.disconnected=!1;var l;Ie("Creating kernel debug adapter for debugging notebooks");let a=this.session.configuration;PD(a),this.configuration=a,this.debugCell=t.cellAt(a.__cellIndex),this.addDebuggingDelegates([new IM(this)]),(l=this.jupyterSession.kernel)==null||l.iopubMessage.connect(this.onIOPubMessage,this),this.disposables.push(new Jo.Disposable(()=>{var c;return(c=this.jupyterSession.kernel)==null?void 0:c.iopubMessage.disconnect(this.onIOPubMessage,this)})),this.kernel&&(this.kernel.addHook("willRestart",()=>this.disconnect(),this,this.disposables),this.kernel.addHook("interruptCompleted",()=>this.disconnect(),this,this.disposables),this.disposables.push(this.kernel.onDisposed(()=>{this.disconnected||(Jo.debug.stopDebugging(this.session).then(y,y),this.disconnect().catch(y),J("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"onKernelDisposed"}))}))),this.disposables.push(Jo.notebooks.onDidChangeNotebookCellExecutionState(c=>{this.configuration.__cellIndex===c.cell.index&&c.state===Jo.NotebookCellExecutionState.Idle&&!this.disconnected&&(J("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"normally"}),this.disconnect().catch(y))},this,this.disposables)),this.disposables.push(Jo.workspace.onDidChangeNotebookDocument(c=>{c.contentChanges.forEach(u=>{u.removedCells.forEach(p=>{p===this.debugCell&&this.disconnect().catch(y)})})},this,this.disposables)),this.disposables.push(this.debugService.onDidTerminateDebugSession(c=>{(c===this.session||c===this.session)&&this.disconnect().catch(y)}))}addDebuggingDelegates(e){this.delegates.push(...e)}trace(e,t){q(`[Debug] ${e}: ${t}`)}async onIOPubMessage(e,t){var n,i;if(Ie(`Debug IO Pub message: ${JSON.stringify(t)}`),hee(t)){this.trace("event",JSON.stringify(t));for(let o of(n=this.delegates)!=null?n:[])if(await((i=o==null?void 0:o.willSendEvent)==null?void 0:i.call(o,t.content)))return;this.sendMessage.fire(t.content)}}handleMessage(e){this.handleClientMessageAsync(e).catch(y)}async handleClientMessageAsync(e){var t,n;try{if(Ie(`KernelDebugAdapter::handleMessage ${JSON.stringify(e,void 0," ")}`),e.type==="request"&&e.command==="setBreakpoints"){let i=e.arguments;if(i.source&&i.source.path&&i.source.path.indexOf("vscode-notebook-cell:")===0){let o=this.notebookDocument.getCells().find(s=>s.document.uri.toString()===i.source.path);o&&await this.dumpCell(o.index)}}if(e.type==="request")for(let i of(t=this.delegates)!=null?t:[]){let o=await((n=i==null?void 0:i.willSendRequest)==null?void 0:n.call(i,e));if(o){this.trace("response",JSON.stringify(o)),this.sendMessage.fire(o);return}}await this.sendMessageToJupyterSession(e)}catch(i){O(`KernelDebugAdapter::handleMessage failure: ${i}`)}}getConfiguration(){return this.configuration}stepIn(e){return this.session.customRequest("stepIn",{threadId:e})}async debugInfo(){return await this.session.customRequest("debugInfo")}continueDirect(e){if(!this.jupyterSession.kernel)throw new sn;this.jupyterSession.kernel.requestDebug({seq:0,type:"request",command:"continue",arguments:{threadId:e}})}async disconnect(){var e;if(!this.disconnected){if(this.disconnected=!0,this.debugService.activeDebugSession===this.session||((e=this.debugService.activeDebugSession)==null?void 0:e.id)===this.session.id)try{await Promise.all([this.deleteDumpedFiles().catch(t=>ue("Error deleting temporary debug files.",t)),this.session.customRequest("disconnect",{restart:!1})])}catch(t){O("Failed to disconnect debug session",t)}this.endSession.fire(this.session)}}dispose(){this.disposables.forEach(e=>e.dispose())}stackTrace(e){return this.session.customRequest("stackTrace",e)}setBreakpoints(e){return this.session.customRequest("setBreakpoints",e)}async dumpAllCells(){await Promise.all(this.notebookDocument.getCells().map(async e=>{e.kind===Jo.NotebookCellKind.Code&&await this.dumpCell(e.index)}))}lookupCellByLongName(e){if(this.platformService.isWindows){e=Ps(e);for(let[t,n]of this.fileToCell.entries())if(fee(t)&&mee(t,e))return n}}async sendMessageToJupyterSession(e){if(this.jupyterSession.isDisposed||this.jupyterSession.status==="dead"||!this.jupyterSession.kernel){De(`Skipping sending message ${e.type} because session is disposed`);return}if(this.trace("to kernel",JSON.stringify(e)),e.type==="request"){let t=await this.sendRequestToJupyterSession(e);t&&this.sendMessage.fire(t)}else if(e.type==="response"){vM(e,this.translateRealLocationToDebuggerLocation.bind(this));let t=e;return this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command},!0).done}else O(`Unknown message type to send ${e.type}`)}async sendRequestToJupyterSession(e){var s,a;if(vM(e,this.translateRealLocationToDebuggerLocation.bind(this)),!this.jupyterSession.kernel)throw new sn;this.trace("to kernel, mapped",JSON.stringify(e));let t=e,o=(await this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command,arguments:t.arguments},!0).done).content;vM(o,this.translateDebuggerLocationToRealLocation.bind(this));for(let l of(s=this.delegates)!=null?s:[])await((a=l==null?void 0:l.willSendResponse)==null?void 0:a.call(l,o));return this.trace("response",JSON.stringify(o)),o}translateDebuggerLocationToRealLocation(e,t){var n,i;if(t=(n=e==null?void 0:e.source)!=null?n:t,t&&t.path){let o=(i=this.fileToCell.get(t.path))!=null?i:this.lookupCellByLongName(t.path);o&&(t.name=sr(o.path),t.path=o.toString())}}async deleteDumpedFiles(){let e=this.getDumpFilesForDeletion();if(this.jupyterSession.kernel&&e.length){let n=`import os as _VSCODE_os
_VSCODE_fileList = [${e.map(i=>'"'+i.replace(/\\/g,"\\\\")+'"').join(",")}]
for file in _VSCODE_fileList:
    try:
        _VSCODE_os.remove(file)
    except:
        pass
del _VSCODE_fileList
del _VSCODE_os`;await Ji(this.jupyterSession.kernel,n,{traceErrors:!0,traceErrorsMessage:"Error deleting temporary debugging files"})}}};var SM=class extends g_{constructor(){super(...arguments);this.cellToFile=new Map}async dumpCell(t){let n=this.notebookDocument.cellAt(t);try{let i=await this.session.customRequest("dumpCell",{code:n.document.getText().replace(/\r\n/g,`
`)}),o=Ps(i.sourcePath);this.fileToCell.set(o,n.document.uri),this.cellToFile.set(n.document.uri.toString(),o)}catch(i){O(i)}}translateRealLocationToDebuggerLocation(t){let n=t.source;if(n&&n.path){let i=this.cellToFile.get(n.path);i&&(n.path=i)}}getDumpFilesForDeletion(){return Array.from(this.cellToFile.values())}};var v_=class extends h_{constructor(t,n,i,o,s,a){super(t,n,a);this.configurationService=i;this.platform=o;this.debugService=s;this.notebookToRunByLineController=new Map;this.runByLineCells=new br(Cr.RunByLineCells),this.runByLineDocuments=new br(Cr.RunByLineDocuments),this.debugDocuments=new br(Cr.DebugDocuments)}activate(){super.activate(),this.disposables.push(Cm.debug.registerDebugAdapterDescriptorFactory(YL,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){let n=this.notebookToRunByLineController.get(t);return n==null?void 0:n.getMode()}onDidStopDebugging(t){super.onDidStopDebugging(t),this.notebookToRunByLineController.delete(t),this.updateRunByLineContextKeys(),this.updateDebugContextKey()}updateRunByLineContextKeys(){let t=[],n=[];this.notebookToRunByLineController.forEach(i=>{t.push(i.debugCell.document.uri),n.push(i.debugCell.notebook.uri)}),this.runByLineCells.set(t).catch(y),this.runByLineDocuments.set(n).catch(y)}updateDebugContextKey(){let t=new jA;this.notebookToDebugAdapter.forEach((n,i)=>t.add(i.uri)),this.notebookInProgress.forEach(n=>t.add(n.uri)),this.debugDocuments.set(Array.from(t.values())).catch(y)}async tryToStartDebugging(t,n,i=!1){if(De(`Starting debugging with mode ${t}`),!i){let o=await this.checkIpykernelAndPrompt(n);if(o!==1){De(`Ipykernel check failed: ${DD[o]}`);return}}(t===0||t===1)&&await this.startDebuggingCell(t,n)}runByLineNext(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&n.debugCell.document.uri.toString()===t.document.uri.toString()&&n.continue()}runByLineStop(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&(J("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"withKeybinding"}),n.stop())}async startDebuggingCell(t,n){let i=n.notebook,o=this.configurationService.getSettings(i.uri),s={type:YL,name:sr(i.uri.toString()),request:"attach",justMyCode:t===1?o.debugJustMyCode:!0,__mode:t,__cellIndex:n.index,__notebookUri:i.uri.toString()},a=t===0?{suppressDebugStatusbar:!0,suppressDebugToolbar:!0,suppressDebugView:!0,suppressSaveBeforeStart:!0}:{suppressSaveBeforeStart:!0};return this.startDebuggingConfig(s,a)}async createDebugAdapterDescriptor(t){let n=t.configuration;PD(n);let i=n.__notebookUri,o=Cm.workspace.notebookDocuments.find(s=>s.uri.toString()===i);if(!o){De(`Cannot start debugging. Notebook ${i} not found.`);return}if(this.notebookInProgress.has(o)){De("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(o)){De("Cannot start debugging. Already debugging this notebook document.");return}this.notebookToDebugger.set(o,new m_(o,n,t));try{return this.notebookInProgress.add(o),this.updateDebugContextKey(),await this.doCreateDebugAdapterDescriptor(n,t,o)}finally{this.notebookInProgress.delete(o),this.updateDebugContextKey()}}async doCreateDebugAdapterDescriptor(t,n,i){let o=await this.ensureKernelIsRunning(i);if(o!=null&&o.session){let s=new SM(n,i,o.session,o,this.platform,this.debugService);if(t.__mode===0&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new bM(s,a,this.kernelProvider.getKernelExecution(o),this.configurationService);s.addDebuggingDelegates([l,new kD(0,s,a,this.serviceContainer)]),this.notebookToRunByLineController.set(i,l),this.updateRunByLineContextKeys()}else if(t.__mode===1&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new yM(s,a,this.kernelProvider.getKernelExecution(o));s.addDebuggingDelegates([l,new kD(1,s,a,this.serviceContainer)])}return this.trackDebugAdapter(i,s),this.updateDebugContextKey(),new Cm.DebugAdapterInlineImplementation(s)}else Cm.window.showInformationMessage(_.kernelWasNotStarted).then(y,y)}};v_=E([(0,cp.injectable)(),b(0,(0,cp.inject)($e)),b(1,(0,cp.inject)(Ht)),b(2,(0,cp.inject)(Ke)),b(3,(0,cp.inject)(bs)),b(4,(0,cp.inject)(ho)),b(5,(0,cp.inject)(jr))],v_);d();var RD=z(re()),vee=require("vscode");var y_=class{constructor(e,t){this.disposableRegistry=t;this.activeTrackers=new WeakMap;this.activeTrackersById=new Map;this.updatedEmitter=new vee.EventEmitter;t.push(e.registerDebugAdapterTrackerFactory("python",this))}createDebugAdapterTracker(e){let t=new p_(e.id);return this.activeTrackers.set(e,t),this.activeTrackersById.set(e.id,t),t.sessionEnded(()=>{this.activeTrackers.delete(e),this.activeTrackersById.delete(e.id)},this,this.disposableRegistry),t.debugLocationUpdated(this.onLocationUpdated,this,this.disposableRegistry),this.onLocationUpdated(),t}get updated(){return this.updatedEmitter.event}getLocation(e){let t=this.activeTrackers.get(e)||this.activeTrackersById.get(e.id);if(t)return t.debugLocation}onLocationUpdated(){this.updatedEmitter.fire()}};y_=E([(0,RD.injectable)(),b(0,(0,RD.inject)(ho)),b(1,(0,RD.inject)(oe))],y_);d();var Ru=z(re()),_v=require("vscode");var b_=class{constructor(e,t,n){this.vscodeDebugService=t;this.jupyterDebugService=n;this.sessionChangedEvent=new _v.EventEmitter;this.sessionStartedEvent=new _v.EventEmitter;this.sessionTerminatedEvent=new _v.EventEmitter;this.sessionCustomEvent=new _v.EventEmitter;e.push(t.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(t.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(t.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(t.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))),n&&(e.push(n.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(n.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(n.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(n.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))))}get activeDebugSession(){return this.activeService.activeDebugSession}get activeDebugConsole(){return this.activeService.activeDebugConsole}get breakpoints(){return this.activeService.breakpoints}get onDidChangeActiveDebugSession(){return this.sessionChangedEvent.event}get onDidStartDebugSession(){return this.sessionStartedEvent.event}get onDidReceiveDebugSessionCustomEvent(){return this.sessionCustomEvent.event}get onDidTerminateDebugSession(){return this.sessionTerminatedEvent.event}get onDidChangeBreakpoints(){return this.activeService.onDidChangeBreakpoints}get onBreakpointHit(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.onBreakpointHit}startRunByLine(e){if(this.lastStartedService=this.jupyterDebugService,!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.startRunByLine(e)}registerDebugConfigurationProvider(e,t){let n=this.vscodeDebugService.registerDebugConfigurationProvider(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugConfigurationProvider(e,t);return this.combineDisposables(n,i)}return n}registerDebugAdapterTrackerFactory(e,t){let n=this.vscodeDebugService.registerDebugAdapterTrackerFactory(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugAdapterTrackerFactory(e,t);return this.combineDisposables(n,i)}return n}startDebugging(e,t,n){return this.lastStartedService=this.vscodeDebugService,this.vscodeDebugService.startDebugging(e,t,n)}addBreakpoints(e){return this.activeService.addBreakpoints(e)}removeBreakpoints(e){return this.activeService.removeBreakpoints(e)}getStack(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.getStack();throw new Error("Requesting jupyter specific stack when not debugging.")}step(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.step();throw new Error("Requesting jupyter specific step when not debugging.")}continue(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.continue();throw new Error("Requesting jupyter specific step when not debugging.")}requestVariables(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.requestVariables();throw new Error("Requesting jupyter specific variables when not debugging.")}stop(){this.jupyterDebugService&&this.lastStartedService===this.jupyterDebugService?this.jupyterDebugService.stop():_v.commands.executeCommand("workbench.action.debug.stop").then(y,y)}get activeService(){return this.lastStartedService?this.lastStartedService:this.vscodeDebugService}combineDisposables(e,t){return{dispose:()=>{e.dispose(),t.dispose()}}}endedDebugSession(e){this.sessionTerminatedEvent.fire(e),this.lastStartedService=void 0}startedDebugSession(e){this.sessionStartedEvent.fire(e)}changedDebugSession(e){this.sessionChangedEvent.fire(e)}gotCustomEvent(e){this.sessionCustomEvent.fire(e)}};b_=E([(0,Ru.injectable)(),b(0,(0,Ru.inject)(oe)),b(1,(0,Ru.inject)(ho)),b(2,(0,Ru.optional)()),b(2,(0,Ru.inject)(u_)),b(2,(0,Ru.named)(st.RUN_BY_LINE_DEBUGSERVICE))],b_);d();var h9=z(iv()),Cv=z(re());d();var I_=Symbol("IFileConverter"),wm=Symbol("IExportBase"),wNt=Symbol("IExport"),xm=Symbol("IExportUtil");function fEe(){return`${$f}${(0,h9.default)()}`}function mEe(r){let e=`${fEe()}${(0,h9.default)()}.ipynb`;return r?`${yi(r,".ipynb")}${e}`:`${_.defaultNotebookName}${e}`}var Ev=class{constructor(e,t,n,i){this.kernelProvider=e;this.fs=t;this.jupyterConnection=n;this.exportUtil=i}async export(e,t,n,i){}async executeCommand(e,t,n,i,o){var S;let s=this.kernelProvider.get(e);if(!s||(s.session||await s.start(new Er(!1)),!((S=s.session)!=null&&S.kernel)))return;let a=s.kernelConnectionMetadata,l=s.resourceUri;if(!Ft(a)||l)return;let c=s.session.kernel,p=(await this.jupyterConnection.createConnectionInfo(a.serverProviderHandle)).settings,f=ci(),m=new f.ContentsManager({serverSettings:p}),h=await this.exportUtil.getContent(e),g="";switch(n){case"html":g=".html";break;case"pdf":g=".pdf";break;case"python":g=".py";break}let v=await this.createBackingFile(l,m);if(!v)return;await m.save(v.filePath,{content:JSON.parse(h),type:"notebook"}).catch(y);let I;try{let x=await this.getCWD(s);I=(await m.newUntitled({type:"file",ext:g})).path;let A=`${x}/${v.filePath}`,w=await Ji(c,`!jupyter nbconvert ${A} --to ${n} --output ${sr(I)}`),R=this.parseStreamOutput(w);if(this.isExportFailed(R))throw new Error(R||`Failed to export to ${n}`);if(R&&q(R),n==="pdf"){let j=await m.get(I,{type:"file",format:"base64",content:!0}),N=await this.b64toBlob(j.content,"application/pdf").arrayBuffer();await this.fs.writeFile(t,new Uint8Array(N))}else{let j=await m.get(I,{type:"file",format:"text",content:!0});await this.fs.writeFile(t,j.content)}}finally{I&&await m.delete(I),await v.dispose(),await m.delete(v.filePath).catch(y),m.dispose()}}async createBackingFile(e,t){let n,i={type:"notebook"},o=mEe(e);try{n=await t.newUntitled(i);let s=Ri(n.path);n=await t.rename(n.path,s.length&&s!=="."?`${s}/${o}`:o)}catch(s){O(`Backing file not supported: ${s}`)}if(n){let s=n.path;return{filePath:s,dispose:()=>t.delete(s)}}}async getContents(e,t,n){return await n.get(e,{type:"file",format:t,content:!0})}b64toBlob(e,t){t=t||"";let n=512;e=e.replace(/^[^,]+,/,""),e=e.replace(/\s/g,"");let i=atob(e),o=[];for(let a=0;a<i.length;a+=n){let l=i.slice(a,a+n),c=new Array(l.length);for(let p=0;p<l.length;p++)c[p]=l.charCodeAt(p);let u=new Uint8Array(c);o.push(u)}return new Blob(o,{type:t})}isExportFailed(e){return e?/Traceback \(most recent call last\)/g.exec(e):!0}parseStreamOutput(e){if(e.length===0)return;let t=e[0];return t.name!=="stdout"&&t.output_type!=="stream"?void 0:zc(t.text).trim()}async getCWD(e){var i;if(!((i=e.session)!=null&&i.kernel))throw new sn;let t=await Ji(e.session.kernel,"import os;os.getcwd();");if(t.length===0)return;let n=t[0];if(n.output_type==="execute_result")return n.data["text/plain"]}};E([cX("PerformingExport")],Ev.prototype,"executeCommand",1),Ev=E([(0,Cv.injectable)(),b(0,(0,Cv.inject)($e)),b(1,(0,Cv.inject)(Tt)),b(2,(0,Cv.inject)(bn)),b(3,(0,Cv.inject)(xm))],Ev);d();var yee=z(re());d();var S_=require("vscode");d();var AD=require("vscode");var hEe={PDF:["pdf"]},gEe={HTML:["html","htm"]},vEe={Python:["py"]},dp=class{async showDialog(e,t,n){let i={},o;switch(e){case"python":i=vEe,o=".py";break;case"pdf":o=".pdf",i=hEe;break;case"html":o=".html",i=gEe;break;case"ipynb":o=".ipynb";let l=_.exportDialogFilter;i[l]=["ipynb"];break;default:return}let s=n||!t?n||"":`${sr(t.path,Pp(t.path))}${o}`,a={defaultUri:await this.getDefaultUri(t,s),saveLabel:_.exportButtonTitle,filters:i};return AD.window.showSaveDialog(a)}async getDefaultUri(e,t){if(e&&e.scheme==="untitled"&&Tn())return;if(!e||e.scheme==="file"||e.scheme==="untitled"||e.scheme==="vscode-interactive"){let i=at.instance.get(p1);return AD.Uri.file(JE(await i.computeWorkingDirectory(e),t))}let n=JE(Ri(e.path),t);return AD.Uri.parse(`${e.scheme}://${n}`).with({authority:e.authority})}};var _M=class{async getContent(e){let t=S_.extensions.getExtension("vscode.ipynb");if(!t)throw new Error("Unable to export notebook as the built-in vscode.ipynb extension is currently unavailable.");t.isActive||await t.activate();let i=e.getCells().map(s=>{let a=new S_.NotebookCellData(s.kind,s.document.getText(),s.document.languageId);return a.metadata=s.metadata,a.mime=s.mime,a.outputs=[...s.outputs],a}),o=new S_.NotebookData(i);return o.metadata=JSON.parse(JSON.stringify(e.metadata)),t.exports.exportNotebook(o)}async getTargetFile(e,t,n){return await new dp().showDialog(e,t,n)}};var __=class extends _M{};__=E([(0,yee.injectable)()],__);d();var w_=z(re());d();var PM=z(re()),TM=require("vscode");d();var pp=require("vscode");var EM=class{constructor(){this.fs=at.instance.get(Tt)}async openFile(e,t,n=!1){if(e==="python")await this.openPythonFile(t,n),J("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:!0});else{let i=await this.askOpenFile(t,n);J("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:i})}}async openPythonFile(e,t){let n;if(t)n=await pp.window.showTextDocument(e);else{let i=await this.fs.readFile(e);await this.fs.delete(e);let o=await pp.workspace.openTextDocument({language:Qe,content:i});n=await pp.window.showTextDocument(o)}await n.edit(i=>{i.insert(new pp.Position(n.document.lineCount,0),`
`)})}async askOpenFile(e,t){let n=_.openExportFileYes,i=_.openExportFileNo,o=[n,i];return await pp.window.showInformationMessage(_.openExportedFileMessage,...o).then(a=>a)===n?(t?pp.window.showTextDocument(e).then(y,y):JI(e.toString()),!0):!1}};d();var CM=class{async export(e,t,n,i){await at.instance.get(wm).executeCommand(e,t,"python",n,i)}};d();var wM=class{async export(e,t,n,i){await at.instance.get(wm).executeCommand(e,t,"pdf",n,i)}};d();var xM=class{async export(e,t,n,i){await at.instance.get(wm).executeCommand(e,t,"html",n,i)}};d();var g9=require("vscode");var DM=class{constructor(){this.fs=at.instance.get(Tt),this.configuration=at.instance.get(Ke),this.platform=at.instance.get(bs)}async writeFile(e,t){await this.fs.writeFile(e,t)}getEOL(){return this.platform.isWindows?`\r
`:`
`}async export(e,t,n){if(n.isCancellationRequested)return;let i=this.exportDocument(e);await this.writeFile(t,i)}exportDocument(e){return e.getCells().filter(t=>{var n;return!((n=t.metadata)!=null&&n.isInteractiveWindowMessageCell)}).reduce((t,n)=>t+this.exportCell(n),"")}exportCell(e){if(e.document.lineCount){let t=this.cellMarker(e),n=this.getEOL();switch(e.kind){case g9.NotebookCellKind.Code:return`${t}${n}${this.exportCodeCell(e)}${n}${n}`;case g9.NotebookCellKind.Markup:return`${t} [markdown]${n}${this.exportMarkdownCell(e)}${n}${n}`}}return""}exportCodeCell(e){let t=dt(e.document.getText(),{trim:!1,removeEmptyEntries:!1}),n=this.configuration.getSettings(e.notebook.uri).pythonExportMethod==="commentMagics";return uI(t,this.getEOL(),n?yEe:void 0).join("")}exportMarkdownCell(e){let t=dt(e.document.getText(),{trim:!1,removeEmptyEntries:!1});return uI(t,this.getEOL(),bEe).join("")}cellMarker(e){var n;let t=this.configuration.getSettings(e.notebook.uri);return(n=e.metadata.interactiveWindowCellMarker)!=null?n:t.defaultCellMarker}};function yEe(r){return/^\s*!/.test(r)||/^\s*%/.test(r)?`# ${r}`:r}function bEe(r){return`# ${r}`}var E_=class{constructor(e,t,n){this.exportUtil=e;this.progressReporter=t;this.configuration=n}async importIpynb(e){let t=this.progressReporter.createProgressIndicator(_.importingIpynb,!0);try{let n=await TM.workspace.openNotebookDocument(e);await this.exportImpl("python",n,void 0,t.token)}finally{t.dispose()}}async export(e,t,n,i){let o=this.progressReporter.createProgressIndicator(_.exportingToFormat(e.toString()),!0);try{await this.exportImpl(e,t,n,o.token,i)}finally{o.dispose()}if(o.token.isCancellationRequested){J("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,cancelled:!0});return}}async exportImpl(e,t,n,i,o){try{let s=await this.exportUtil.getTargetFile(e,t.uri,n);if(!s)return;await this.performExport(e,t,s,i,o)}catch(s){O("Export failed",s),J("DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",void 0,{format:e}),e==="pdf"&&O(_.exportToPDFDependencyMessage),this.showExportFailed(_.exportFailedGeneralMessage)}}async performExport(e,t,n,i,o){e==="python"&&this.configuration.getSettings(t.uri).pythonExportMethod!=="nbconvert"?await this.performPlainExport(e,t,n,i):await this.performNbConvertExport(t,e,n,o,i),n&&this.openExportedFile(e,n).catch(y)}async openExportedFile(e,t){await new EM().openFile(e,t,!0).catch(y)}async performPlainExport(e,t,n,i){if(n)switch(e){case"python":await new DM().export(t,n,i);break}return n}async performNbConvertExport(e,t,n,i,o){try{return await this.exportToFormat(e,n,t,i,o)}finally{}}async exportToFormat(e,t,n,i,o){switch(n){case"python":return new CM().export(e,t,i,o);case"pdf":return new wM().export(e,t,i,o);case"html":return new xM().export(e,t,i,o);default:break}}showExportFailed(e){TM.window.showErrorMessage(`${_.failedExportMessage} ${e}`)}};E_=E([b(0,(0,PM.inject)(xm)),b(1,(0,PM.inject)(rc)),b(2,(0,PM.inject)(Ke))],E_);var C_=class extends E_{constructor(t,n,i){super(t,n,i);this.exportUtil=t}};C_=E([(0,w_.injectable)(),b(0,(0,w_.inject)(xm)),b(1,(0,w_.inject)(rc)),b(2,(0,w_.inject)(Ke))],C_);d();var OD=z(re()),wv=require("vscode");d();var MD=require("vscode");var v9=new WeakMap;async function Au(r,e){let t=r;if(r.isClosed)return!0;let n=v9.has(t)?v9.get(t):Promise.resolve(),i=Me(),o=n.finally(async()=>{let s=new MD.WorkspaceEdit,a=e(s);VE(a)&&await a,await MD.workspace.applyEdit(s).then(l=>i.resolve(l),l=>i.reject(l))}).catch(y);return v9.set(t,o),i.promise}var x_=class{constructor(e,t){this.disposables=e;this.controllerRegistration=t}activate(){this.controllerRegistration.onControllerSelected(this.onDidChangeNotebookController,this,this.disposables)}async onDidChangeNotebookController(e){let t=e.notebook,n=e.controller.connection;if(!_r(t))return;let i=wv.window.visibleNotebookEditors.find(u=>u.notebook===t);if(!i)return;let o=t.getCells().filter(u=>u.kind===wv.NotebookCellKind.Code&&u.document.getText().trim().length===0),s=t.getCells().filter(u=>u.kind===wv.NotebookCellKind.Code).length;if(o.length===0||o.length!==s)return;let a,l=n.kind;switch(n.kind){case"connectToLiveRemoteKernel":{a=n.kernelModel.language;break}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":{a=n.kernelSpec.language;break}case"startUsingPythonInterpreter":{a=Qe;break}default:{O(`Unsupported kernel kind encountered ${l}`);return}}if(!a)return;let c=$c(a);Au(i.notebook,async()=>{await o.map(async u=>{if(c.toLowerCase()!==u.document.languageId)return wv.languages.setTextDocumentLanguage(u.document,c).then(y,y)})}).then(y,y)}};x_=E([(0,OD.injectable)(),b(0,(0,OD.inject)(oe)),b(1,(0,OD.inject)(Ht))],x_);d();var cc=z(re()),wr=require("vscode");var D_=class{constructor(e,t,n,i,o,s,a,l){this.disposableRegistry=e;this.languageService=t;this.configurationService=n;this.kernelProvider=i;this.controllerRegistration=o;this.errorHandler=s;this.notebookEditorProvider=a;this.serviceContainer=l;this.kernelInterruptedDontAskToRestart=!1;this.pendingRestartInterrupt=new WeakMap}register(){this.disposableRegistry.push(wr.commands.registerCommand(X.NotebookEditorRemoveAllCells,()=>this.removeAllCells())),this.disposableRegistry.push(wr.commands.registerCommand(X.NotebookEditorRunAllCells,()=>this.runAllCells())),this.disposableRegistry.push(wr.commands.registerCommand(X.NotebookEditorAddCellBelow,()=>this.addCellBelow())),this.disposableRegistry.push(wr.commands.registerCommand(X.RestartKernelAndRunUpToSelectedCell,()=>this.restartKernelAndRunUpToSelectedCell())),this.disposableRegistry.push(wr.commands.registerCommand(X.RestartKernel,e=>{var t;return e&&"notebookEditor"in e?this.restartKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(y):this.restartKernel(e).catch(y)})),this.disposableRegistry.push(wr.commands.registerCommand(X.InterruptKernel,e=>{var t;return this.interruptKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)})),this.disposableRegistry.push(wr.commands.registerCommand(X.RestartKernelAndRunAllCells,e=>{var t;e&&"notebookEditor"in e?this.restartKernelAndRunAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(y):this.restartKernelAndRunAllCells(e).catch(y)}))}runAllCells(){wr.window.activeNotebookEditor&&wr.commands.executeCommand("notebook.execute").then(y,y)}addCellBelow(){wr.window.activeNotebookEditor&&wr.commands.executeCommand("notebook.cell.insertCodeCellBelow").then(y,y)}removeAllCells(){var n;let e=(n=wr.window.activeNotebookEditor)==null?void 0:n.notebook;if(!e)return;let t=this.languageService.getPreferredLanguage(Ma(e));Au(e,i=>{let o=wr.NotebookEdit.replaceCells(new wr.NotebookRange(0,e.cellCount),[new wr.NotebookCellData(wr.NotebookCellKind.Code,"",t)]);i.set(e.uri,[o])}).then(y,y)}async interruptKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=wr.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;q(`Command interrupted kernel for ${Se(n.uri)}`);let i=this.kernelProvider.get(n);if(!i){De("Interrupt requested & no kernel.");return}await this.wrapKernelMethod("interrupt",i)}async restartKernelAndRunAllCells(e){await this.restartKernel(e),this.runAllCells()}async restartKernelAndRunUpToSelectedCell(){let e=this.notebookEditorProvider.activeNotebookEditor;e&&(await this.restartKernel(e.notebook.uri),wr.commands.executeCommand("notebook.cell.execute",{ranges:[{start:0,end:e.selection.end}],document:e.notebook.uri}).then(y,y))}async restartKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=wr.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;let i=this.kernelProvider.get(n);if(i)if(q(`Restart kernel command handler for ${Se(n.uri)}`),await this.shouldAskForRestart(n.uri)){let s=_.restartKernelMessage,a=_.restartKernelMessageYes,l=_.restartKernelMessageDontAskAgain,c=await wr.window.showInformationMessage(s,{modal:!0},a,l);c===l?(await this.disableAskForRestart(n.uri),this.wrapKernelMethod("restart",i).catch(y)):c===a&&this.wrapKernelMethod("restart",i).catch(y)}else this.wrapKernelMethod("restart",i).catch(y)}async wrapKernelMethod(e,t){let n=t.notebook,i=this.pendingRestartInterrupt.get(t);if(i)return i;let o=(async()=>{let s=this.kernelProvider.getKernelExecution(t).pendingCells[0],a=this.controllerRegistration.getSelected(n);try{if(!a)throw new Error("No kernel associated with the notebook");await Va.wrapKernelMethod(a.connection,e,t.creator,this.serviceContainer,{resource:t.resourceUri,notebook:n,controller:a.controller},new Er(!1),this.disposableRegistry)}catch(l){s?await Yf(s,t.controller,await this.errorHandler.getErrorMessageForDisplayInCell(l,e,t.resourceUri),!1):wr.window.showErrorMessage(l.toString()).then(y,y)}})();return o.finally(()=>{this.pendingRestartInterrupt.get(t)===o&&this.pendingRestartInterrupt.delete(t)}).catch(y),this.pendingRestartInterrupt.set(t,o),o}async shouldAskForRestart(e){if(this.kernelInterruptedDontAskToRestart)return!1;let t=this.configurationService.getSettings(e);return t&&t.askForKernelRestart===!0}async disableAskForRestart(e){this.configurationService.getSettings(e)&&this.configurationService.updateSetting("askForKernelRestart",!1,void 0,wr.ConfigurationTarget.Global).catch(y)}};D_=E([(0,cc.injectable)(),b(0,(0,cc.inject)(oe)),b(1,(0,cc.inject)(ea)),b(2,(0,cc.inject)(Ke)),b(3,(0,cc.inject)($e)),b(4,(0,cc.inject)(Ht)),b(5,(0,cc.inject)(Pn)),b(6,(0,cc.inject)(Ho)),b(7,(0,cc.inject)(jr))],D_);d();var bee=z(re()),Dm=require("vscode");var P_=class{constructor(){this.providers=new Set}registerEmbedNotebookProvider(e){this.providers.add(e)}findNotebookEditor(e){var o;let t=e?el(e,!0):"false",n=zl(e)==="notebook"?Dm.workspace.notebookDocuments.find(s=>el(s.uri,!0)===t):void 0,i=n&&((o=Dm.window.activeNotebookEditor)==null?void 0:o.notebook)===n?Dm.window.activeNotebookEditor:void 0;if(i)return i;for(let s of this.providers){let a=s.findNotebookEditor(e);if(a)return a}}get activeNotebookEditor(){var e,t;return this.findNotebookEditor((e=Dm.window.activeNotebookEditor)==null?void 0:e.notebook.uri)||this.findNotebookEditor((t=Dm.window.activeTextEditor)==null?void 0:t.document.uri)}findAssociatedNotebookDocument(e){let t=Ai()==="Windows",n=Dm.workspace.notebookDocuments.find(i=>t?i.uri.path.toLowerCase()===e.path.toLowerCase():i.uri.path===e.path);if(n)return n;for(let i of this.providers){let o=i.findAssociatedNotebookDocument(e);if(o)return o}}};P_=E([(0,bee.injectable)()],P_);d();var kM=z(re()),Pm=require("vscode");var T_=class{constructor(e){this.sentMimeTypes=new Set;this.disposables=[];e.push(this)}activate(){this.isTelemetryDisabled=_0(),Pm.workspace.onDidOpenNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),Pm.workspace.onDidCloseNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),Pm.workspace.onDidSaveNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),Pm.notebooks.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables),this.disposables.push(E0(e=>this.isTelemetryDisabled=e))}dispose(){he(this.disposables)}async onDidChangeNotebookCellExecutionState(e){!_r(e.cell.notebook)||this.isTelemetryDisabled||this.checkCell(e.cell,"onExecution")}onDidOpenCloseDocument(e){!_r(e)||this.isTelemetryDisabled||e.getCells().forEach(t=>this.checkCell(t,"onOpenCloseOrSave"))}checkCell(e,t){if(e.kind===Pm.NotebookCellKind.Markup||e.document.languageId==="raw")return;let n=e.notebook.notebookType===Ct?"notebook":"interactive";e.outputs.map(i=>i.items.map(o=>o.mime)).flat().map(i=>this.sendTelemetry(i,t,n))}sendTelemetry(e,t,n){let i=`${e}-${t}`;this.sentMimeTypes.has(i)||(this.sentMimeTypes.add(i),e=e.replace(/\//g,"_").replace(/\\/g,"_"),J("DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",void 0,{mimeType:e,when:t,resourceType:n}))}};T_=E([(0,kM.injectable)(),b(0,(0,kM.inject)(oe))],T_);d();var NM=z(re());var IEe=/(;32m[ ->]*?)(\d+)(.*)/g,k_=class{constructor(e){this.configurationService=e}format(e,t){return e.notebook.notebookType!==Ct?t:t.map(n=>this.modifyTracebackFrameIPython(e,n))}modifyTracebackFrameIPython(e,t){var o;let n=this.configurationService.getSettings(e.document.uri);return((o=n==null?void 0:n.formatStackTraces)!=null?o:!1)&&/^[Cell|Input|File].*?\n.*/.test(t)?this.modifyTracebackFrameIPython8(e,t):t}modifyTracebackFrameIPython8(e,t){t=t.replace(/\u001b\[4\dm/g,""),t=t.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),t=t.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(s,a,l,c)=>(c=c.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${a}${l}${c}
`)),Ie(`Trace frame to match: ${t}`);let n=(s,a)=>{let l=s.replace(IEe,(u,p,f,m)=>{let h=parseInt(f,10);return`${p}<a href='${e.document.uri.toString()}?line=${h-1}'>${h}</a>${m}`}),c=_.cellAtFormat(pt(e.document.uri),e.index+1);return l.replace(/.*?\n/,`\x1B[1;32m${c}\x1B[0m line \x1B[0;36m${a}
`)},i=/^Input.*?\[.*32mIn\s+\[(\d+).*?0;36m(.*?)\n.*/.exec(t);if(i&&i.length>1)return n(t,i[2]);let o=/Cell.*?\[.*32mIn\s*\[(\d+)\]\,\s+line\s+([(\d+)])(.*?)\n.*/gm.exec(t);return o&&o.length>1?n(t,o[2]):t}};k_=E([(0,NM.injectable)(),b(0,(0,NM.inject)(Ke))],k_);function Iee(r,e){cee(r,e),r.addSingleton(He,uv),r.addSingleton(Ho,P_),r.addSingleton(He,hv),r.addSingleton(EI,k_),r.addSingleton(gm,gm),r.addBinding(gm,He),r.addSingleton(He,e_),r.addSingleton(Zv,D_),r.addSingleton(ea,ea),r.addBinding(ea,He),r.addSingleton(He,x_),r.addSingleton(Em,v_,void 0,[He]),r.addSingleton(u_,b_,st.MULTIPLEXING_DEBUGSERVICE),r.addSingleton(fM,y_,void 0,[pM]),r.addSingleton(vo,f_,st.DEBUGGER_VARIABLES),r.addSingleton(He,d_),r.addSingleton(He,T_),r.addSingleton(wm,Ev),r.addSingleton(I_,C_),r.addSingleton(xm,__)}d();d();var Un=z(re()),ze=require("vscode");d();var Tm=Symbol("IDataScienceCodeLensProvider"),RM=Symbol("ICodeWatcher"),AM=Symbol("ICodeLensFactory"),aAt=Symbol("IGeneratedCodeStore"),Ba=Symbol("IGeneratedCodeStorageFactory"),N_=Symbol("ICodeGeneratorFactory");d();var See=Symbol("IInteractiveWindowDebugger"),_s=Symbol("IInteractiveWindowProvider"),MM=Symbol("IInteractiveControllerHelper"),OM=Symbol("IInteractiveWindowDebuggingManager");d();var LM=require("vscode");async function KM(r){let e=await LM.workspace.openNotebookDocument(r);await LM.window.showNotebookDocument(e)}d();var Ha=require("vscode");d();var qo=class{constructor(e){this.codeMatchRegEx=this.createRegExp(e?e.codeRegularExpression:void 0,LE.PythonCellMarker),this.markdownMatchRegEx=this.createRegExp(e?e.markdownRegularExpression:void 0,LE.PythonMarkdownCellMarker),this.codeExecRegEx=new RegExp(`${this.codeMatchRegEx.source}(.*)`),this.markdownExecRegEx=new RegExp(`${this.markdownMatchRegEx.source}(.*)`),this.defaultCellMarker=e!=null&&e.defaultCellMarker?e.defaultCellMarker:"# %%"}isCell(e){return this.isCode(e)||this.isMarkdown(e)}isMarkdown(e){return this.markdownMatchRegEx.test(e.trim())}isCode(e){return this.codeMatchRegEx.test(e.trim())||e.trim()===this.defaultCellMarker}getCellType(e){return this.isMarkdown(e)?"markdown":"code"}isEmptyCell(e){return this.stripFirstMarker(e).trim().length===0}stripFirstMarker(e){let t=dt(e,{trim:!1,removeEmptyEntries:!1});return t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0]))?t.slice(1).join(`
`):e}stripFirstMarkerNoConcat(e){return e.length>0&&(this.isCode(e[0])||this.isMarkdown(e[0]))?e.slice(1):e}getFirstMarker(e){let t=dt(e,{trim:!1,removeEmptyEntries:!1});if(t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0])))return t[0]}createRegExp(e,t){try{if(e)return new RegExp(e)}catch(n){}return t}};d();var ra=require("vscode");function _ee(r,e){let t=ft(r);return t?e==1?_.restartingKernelCustomHeader(t):_.startingNewKernelCustomHeader(t):e==1?_.restartingKernelHeader:_.startingNewKernelHeader}function Eee(r,e){let t=ft(r);return e==1?_.restartedKernelHeader(t||""):_.connectedKernelHeader(t||"")}function LD(r){var e;return r.kind===ra.NotebookCellKind.Markup&&((e=r.metadata)==null?void 0:e.isInteractiveWindowMessageCell)===!0}var FM=class{constructor(e,t){this.notebookDocument=e;this.isDeleted=!1;if(e.cellCount){let n=e.cellAt(e.cellCount);LD(n)&&(this.sysInfoCellPromise=Promise.resolve(n),this.sysInfoCellPromise=this.updateMessage(t))}this.sysInfoCellPromise===void 0&&(this.sysInfoCellPromise=this.createCell(t))}async createCell(e){let t;return await Au(this.notebookDocument,n=>{let i=new ra.NotebookCellData(ra.NotebookCellKind.Markup,e,KE);i.metadata={isInteractiveWindowMessageCell:!0},t=this.notebookDocument.cellCount;let o=ra.NotebookEdit.insertCells(t,[i]);n.set(this.notebookDocument.uri,[o])}),t=t!=null?t:this.notebookDocument.cellCount-1,this.notebookDocument.cellAt(t)}async updateMessage(e){let t=await this.sysInfoCellPromise;return await Au(this.notebookDocument,n=>{if(t.index>=0&&!this.isDeleted&&LD(t)){n.replace(t.document.uri,new ra.Range(0,0,t.document.lineCount,0),e),n.set(this.notebookDocument.uri,[ra.NotebookEdit.updateCellMetadata(t.index,{isInteractiveWindowMessageCell:!0})]);return}}),t}async deleteCell(){this.isDeleted=!0;let e=await this.sysInfoCellPromise;await Au(this.notebookDocument,t=>{if(e.index>=0&&LD(e)){let n=ra.NotebookEdit.deleteCells(new ra.NotebookRange(e.index,e.index+1));t.set(this.notebookDocument.uri,[n]);return}})}};function UM(r){return/^#\s*!/.test(r)?/^#\s*!\s*%%?/.test(r)?r.replace(/^#\s*!\s*/,""):r.replace(/^#\s*/,""):r}function Cee(r){return new Ha.NotebookCellData(Ha.NotebookCellKind.Code,r.join(`
`),"python")}function wee(r){return new Ha.NotebookCellData(Ha.NotebookCellKind.Markup,H0(r).join(`
`),"markdown")}function _Ee(r,e,t){let n=dt(e,{trim:!1}),i=n[0];if(new qo(r).isMarkdown(i)){let s=-1;return Og(n,(a,l)=>void 0,(a,l)=>{a&&a.length>0&&s===-1&&(s=t?l:-1)}),s>=0?[wee(n.slice(0,s)),Cee(n.slice(s))]:[wee(n)]}else return[Cee(n)]}function xee(r,e){let t=new qo(e);for(let n=0;n<r.lineCount;n+=1){let i=r.lineAt(n);if(t.isCell(i.text))return!0}return!1}function KD(r,e){let t=new qo(e),n=[];for(let i=0;i<r.lineCount;i+=1){let o=r.lineAt(i);if(t.isCell(o.text)){if(n.length>0){let s=n[n.length-1];s.range=new Ha.Range(s.range.start,r.lineAt(i-1).range.end)}n.push({range:o.range,cell_type:t.getCellType(o.text)})}}if(n.length>=1){let i=r.lineAt(r.lineCount-1),o=n[n.length-1];o.range=new Ha.Range(o.range.start,i.range.end)}return n}function y9(r,e){let t=KD(r,e);return Array.prototype.concat(...t.map(n=>{let i=r.getText(n.range);return _Ee(e,i,!1)}))}function Dee(r){return r.getCells().filter(e=>!LD(e)).map(e=>{let t=dt(e.document.getText(),{trim:!1,removeEmptyEntries:!1});e.metadata.interactiveWindowCellMarker!==void 0&&t.unshift(e.metadata.interactiveWindowCellMarker+`
`);let n=new Ha.NotebookCellData(e.kind,t.join(`
`),e.kind===Ha.NotebookCellKind.Code?e.document.languageId:"markdown");return e.kind===Ha.NotebookCellKind.Code&&(n.outputs=[...e.outputs]),n.metadata=Lg()?{custom:Wd(e)}:Wd(e),n})}d();var FD=require("vscode");var b9=class{constructor(e,t,n){this.disposed=!1;this.dispose=()=>{this.disposed||(this.disposed=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.disposeCallback(),this.deferred.completed||this.deferred.resolve())};this.promise=()=>this.deferred.promise;this.reject=()=>{this.deferred.reject(),this.dispose()};this.deferred=Me(),this.disposeCallback=t,n&&(this.timeout=setTimeout(this.dispose,n))}},WM=class{constructor(){this.statusCount=0;this.incrementCount=()=>{this.statusCount+=1};this.decrementCount=()=>{let e=this.statusCount-1;this.statusCount=Math.max(e,0)}}set(e,t,n){this.incrementCount();let i=new b9(e,()=>this.decrementCount(),t),o={location:n?FD.ProgressLocation.Notification:FD.ProgressLocation.Window,title:e,cancellable:n!==void 0};return FD.window.withProgress(o,(s,a)=>(a&&n&&a.onCancellationRequested(()=>{n(),i.reject()}),i.promise())).then(y,y),i}async waitWithStatus(e,t,n,i){let o=this.set(t,n,i),s;try{s=await e()}finally{o.dispose()}return s}};var Es=class{constructor(e,t,n,i,o,s,a,l,c,u,p,f,m){this.disposables=e;this.jupyterExporter=t;this.jupyterServerHelper=n;this.fileSystem=i;this.configuration=o;this.dataScienceCodeLensProvider=s;this.debugService=a;this.configService=l;this.interactiveWindowProvider=c;this.kernelProvider=u;this.dataScienceErrorHandler=p;this.ipynbProvider=f;this.fileConverter=m;this.statusProvider=new WM,ze.workspace.isTrusted||ze.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted(),this.registerCommand(X.InsertCellBelowPosition,this.insertCellBelowPosition),this.registerCommand(X.InsertCellBelow,this.insertCellBelow),this.registerCommand(X.InsertCellAbove,this.insertCellAbove),this.registerCommand(X.DeleteCells,this.deleteCells),this.registerCommand(X.SelectCell,this.selectCell),this.registerCommand(X.SelectCellContents,this.selectCellContents),this.registerCommand(X.ExtendSelectionByCellAbove,this.extendSelectionByCellAbove),this.registerCommand(X.ExtendSelectionByCellBelow,this.extendSelectionByCellBelow),this.registerCommand(X.MoveCellsUp,this.moveCellsUp),this.registerCommand(X.MoveCellsDown,this.moveCellsDown),this.registerCommand(X.ChangeCellToMarkdown,this.changeCellToMarkdown),this.registerCommand(X.ChangeCellToCode,this.changeCellToCode),this.registerCommand(X.GotoNextCellInFile,this.gotoNextCellInFile),this.registerCommand(X.GotoPrevCellInFile,this.gotoPrevCellInFile),this.registerCommand(X.AddCellBelow,this.addCellBelow),this.registerCommand(X.CreateNewNotebook,this.createNewNotebook),this.registerCommand(X.LatestExtension,this.openPythonExtensionPage),this.registerCommand(X.EnableDebugLogging,this.enableDebugLogging),this.registerCommand(X.ResetLoggingLevel,this.resetLoggingLevel),this.registerCommand(X.EnableLoadingWidgetsFrom3rdPartySource,this.enableLoadingWidgetScriptsFromThirdParty),this.registerCommand(X.CreateNewInteractive,e=>this.createNewInteractiveWindow(e)),this.registerCommand(X.ImportNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),this.registerCommand(X.ImportNotebookFile,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),ze.commands.registerCommand(X.ExportFileAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFile(e);{let n=ze.window.activeTextEditor;if(n&&n.document.languageId===Qe)return this.exportFile(n.document.uri)}return Promise.resolve()})),this.registerCommand(X.ExportFileAndOutputAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFileAndOutput(e);{let n=ze.window.activeTextEditor;if(n&&n.document.languageId===Qe)return this.exportFileAndOutput(n.document.uri)}return Promise.resolve()})),this.registerCommand(X.ExpandAllCells,async e=>{var t;return this.expandAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(X.CollapseAllCells,async e=>{var t;return this.collapseAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(X.ExportOutputAsNotebook,()=>this.exportCells()),this.registerCommand(X.InteractiveExportAsNotebook,e=>{var t;return this.export((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(X.InteractiveExportAs,e=>{var t;return this.exportAs((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(X.ScrollToCell,(e,t)=>this.scrollToCell(e,t)),this.registerCommand(X.InteractiveClearAll,this.clearAllCellsInInteractiveWindow),this.registerCommand(X.InteractiveGoToCode,this.goToCodeInInteractiveWindow),ze.commands.registerCommand(X.InteractiveCopyCell,this.copyCellInInteractiveWindow)}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){ze.workspace.isTrusted&&(this.registerCommand(X.RunAllCells,this.runAllCells),this.registerCommand(X.RunCell,this.runCell),this.registerCommand(X.RunCurrentCell,this.runCurrentCell),this.registerCommand(X.RunCurrentCellAdvance,this.runCurrentCellAndAdvance),this.registerCommand(X.ExecSelectionInInteractiveWindow,e=>{this.runSelectionOrLine(e).catch(y)}),this.registerCommand(X.RunAllCellsAbove,this.runAllCellsAbove),this.registerCommand(X.RunCellAndAllBelow,this.runCellAndAllBelow),this.registerCommand(X.RunAllCellsAbovePalette,this.runAllCellsAboveFromCursor),this.registerCommand(X.RunCellAndAllBelowPalette,this.runCellAndAllBelowFromCursor),this.registerCommand(X.RunCurrentCellAndAddBelow,this.runCurrentCellAndAddBelow),this.registerCommand(X.DebugCell,this.debugCell),this.registerCommand(X.DebugStepOver,this.debugStepOver),this.registerCommand(X.DebugContinue,this.debugContinue),this.registerCommand(X.DebugStop,this.debugStop),this.registerCommand(X.DebugCurrentCellPalette,this.debugCurrentCellFromCursor),this.registerCommand(X.OpenVariableView,this.openVariableView),this.registerCommand(X.OpenOutlineView,this.openOutlineView),this.registerCommand(X.RunToLine,this.runToLine),this.registerCommand(X.RunFromLine,this.runFromLine),this.registerCommand(X.RunFileInInteractiveWindows,this.runFileInteractive),this.registerCommand(X.DebugFileInInteractiveWindows,this.debugFileInteractive))}registerCommand(e,t){let n=ze.commands.registerCommand(e,t,this);this.disposables.push(n)}getCodeWatcher(e){if(e&&this.dataScienceCodeLensProvider){let t=ze.workspace.textDocuments.filter(n=>ca(n.uri,e));if(t&&t.length===1)return this.dataScienceCodeLensProvider.getCodeWatcher(t[0]);if(t&&t.length>1)throw new Error(_.documentMismatch(pt(e)))}}async enableDebugLogging(){this.configService.getSettings().logging.level!=="debug"&&(await this.configService.updateSetting("logging.level","debug",void 0,ze.ConfigurationTarget.Global),ze.commands.executeCommand("jupyter.reloadVSCode",_.reloadRequired).then(y,y))}async resetLoggingLevel(){this.configService.getSettings().logging.level!=="error"&&(await this.configService.updateSetting("logging.level","error",void 0,ze.ConfigurationTarget.Global),ze.commands.executeCommand("jupyter.reloadVSCode",_.reloadRequired).then(y,y))}async enableLoadingWidgetScriptsFromThirdParty(){this.configService.getSettings(void 0).widgetScriptSources.length>0||await this.configService.updateSetting("widgetScriptSources",["jsdelivr.com","unpkg.com"],void 0,ze.ConfigurationTarget.Global).catch(y)}async runAllCells(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runAllCells()}async runFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runFileInteractive()}async debugFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.debugFileInteractive()}async runCell(e,t,n,i,o){let s=this.getCodeWatcher(e);if(s)return s.runCell(new ze.Range(t,n,i,o))}async runAllCellsAbove(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runAllCellsAbove(t,n)}}async runCellAndAllBelow(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runCellAndAllBelow(t,n)}}async runToLine(){let e=this.getCurrentCodeWatcher(),t=ze.window.activeTextEditor;if(e&&t&&t.selection)return e.runToLine(t.selection.start.line)}async runFromLine(){let e=this.getCurrentCodeWatcher(),t=ze.window.activeTextEditor;if(e&&t&&t.selection)return e.runFromLine(t.selection.start.line)}async runCurrentCell(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCell()}async runCurrentCellAndAdvance(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCellAndAdvance()}async runSelectionOrLine(e){let t=this.getCurrentCodeWatcher();if(t)return t.runSelectionOrLine(ze.window.activeTextEditor,kn(e)?void 0:e)}async debugCell(e,t,n,i,o){if(e){let s=this.getCodeWatcher(e);if(s)return s.debugCell(new ze.Range(t,n,i,o))}}async debugStepOver(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&ze.commands.executeCommand("workbench.action.debug.stepOver").then(y,y)}async debugStop(e){var t;if((t=this.debugService)!=null&&t.activeDebugSession&&this.interactiveWindowProvider){let n=this.interactiveWindowProvider.get(e);if(n&&n.notebookDocument){let i=this.kernelProvider.get(n.notebookDocument);i&&(q(`Interrupt kernel due to debug stop of IW ${e.toString()}`),await i.interrupt())}ze.commands.executeCommand("workbench.action.debug.stop").then(y,y)}}async debugContinue(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&ze.commands.executeCommand("workbench.action.debug.continue").then(y,y)}async addCellBelow(){var e;await((e=this.getCurrentCodeWatcher())==null?void 0:e.addEmptyCellToBottom())}async runCurrentCellAndAddBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.runCurrentCellAndAddBelow()}async insertCellBelowPosition(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelowPosition()}async insertCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelow()}async insertCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellAbove()}async deleteCells(){var e;(e=this.getCurrentCodeWatcher())==null||e.deleteCells()}async selectCell(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCell()}async selectCellContents(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCellContents()}async extendSelectionByCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellAbove()}async extendSelectionByCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellBelow()}async moveCellsUp(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsUp()}async moveCellsDown(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsDown()}async changeCellToMarkdown(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToMarkdown()}async changeCellToCode(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToCode()}async gotoNextCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoNextCell()}async gotoPrevCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoPreviousCell()}async runAllCellsAboveFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runAllCellsAbove(e.range.start.line,e.range.start.character)}else return}async runCellAndAllBelowFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runCellAndAllBelow(e.range.start.line,e.range.start.character)}else return}async debugCurrentCellFromCursor(){if(this.getCurrentCodeLens()){let t=this.getCurrentCodeWatcher();if(t)return t.debugCurrentCell()}else return}async createNewNotebook(){ze.window.showInformationMessage('This command has been deprecated and will eventually be removed, please use ["Create: New Jupyter Notebook"](command:workbench.action.openGlobalKeybindings?%5B%22@command:ipynb.newUntitledIpynb%22%5D) instead.').then(y,y),await ze.commands.executeCommand("ipynb.newUntitledIpynb")}getCurrentCodeLens(){let e=ze.window.activeTextEditor,t=this.getCurrentCodeWatcher();if(e&&t)return t.getCodeLenses().find(n=>n.range.end.line>=e.selection.anchor.line&&n.range.start.line<=e.selection.anchor.line)}getCurrentCodeWatcher(){let e=ze.window.activeTextEditor;if(!(!e||!e.document||!this.dataScienceCodeLensProvider))return this.dataScienceCodeLensProvider.getCodeWatcher(e.document)}openPythonExtensionPage(){ze.env.openExternal(ze.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter")).then(y,y)}async openVariableView(){return ze.commands.executeCommand("jupyterViewVariables.focus")}async openOutlineView(){return ze.commands.executeCommand("outline.focus")}async listenForErrors(e){let t;try{return t=await e(),t}catch(n){O("listenForErrors",n),this.dataScienceErrorHandler.handleError(n).then(y,y)}return t}async exportFile(e){let t=pt(e);if(t&&t.length>0&&this.jupyterExporter){let n=ze.window.activeTextEditor;if(n&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=y9(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new dp().showDialog("ipynb",e);if(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},_.exportingFormat,Se(e)),o&&t){let s=_.exportOpenQuestion1;await ze.window.showInformationMessage(_.exportDialogComplete(Se(e)),s)===s&&await KM(o)}}}}}async exportFileAndOutput(e){let t=pt(e);if(t&&t.length>0&&this.jupyterExporter&&this.jupyterServerHelper&&await this.jupyterServerHelper.isJupyterServerSupported()){let n=ze.window.activeTextEditor;if(n&&n.document&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=y9(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new dp().showDialog("ipynb",e);return o?(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},_.exportingFormat,Se(e)),await ze.workspace.openNotebookDocument(o).then(s=>ze.window.showNotebookDocument(s)),await ze.commands.executeCommand("notebook.execute"),o):void 0}}}else this.jupyterServerHelper&&await this.dataScienceErrorHandler.handleError(new cm(_.jupyterNotSupported(await this.jupyterServerHelper.getJupyterServerError())))}async expandAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);De(`Expanding all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.expandAllCells()}async collapseAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);De(`Collapsing all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.collapseAllCells()}exportCells(){var t;let e=(t=this.interactiveWindowProvider)==null?void 0:t.activeWindow;e&&e.export()}exportAs(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.exportAs()}export(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.export()}async createNewInteractiveWindow(e){var t;await((t=this.interactiveWindowProvider)==null?void 0:t.getOrCreate(void 0,e))}waitForStatus(e,t,n,i){let o=t(n||"");return this.statusProvider.waitWithStatus(e,o,void 0,i)}async importNotebook(){let e=_.importDialogFilter,t={};t[e]=["ipynb"];let n=await ze.window.showOpenDialog({openLabel:_.importDialogTitle,filters:t});n&&n.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(n[0])},_.importingFormat,Se(n[0]))}async importNotebookOnFile(e){let t=pt(e);t&&t.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(e)},_.importingFormat,Se(e))}async scrollToCell(e,t){if(t&&e){let n=this.interactiveWindowProvider.getInteractiveWindowsWithSubmitter(e);for(let i=0;i<n.length;i+=1)if(await n[i].hasCell(t)){n[i].scrollToCell(t);break}}}async clearAllCellsInInteractiveWindow(e){var s,a;let t=(a=this.interactiveWindowProvider.getInteractiveWindowWithNotebook((s=e==null?void 0:e.notebookEditor)==null?void 0:s.notebookUri))==null?void 0:a.notebookUri;if(!t)return;let n=ze.workspace.notebookDocuments.find(l=>l.uri.toString()===t.toString());if(!n)return;let i=new ze.WorkspaceEdit,o=ze.NotebookEdit.deleteCells(new ze.NotebookRange(0,n.cellCount));i.set(n.uri,[o]),await ze.workspace.applyEdit(i)}async goToCodeInInteractiveWindow(e){var t;if(e&&((t=e.metadata)!=null&&t.interactive)){let n=ze.Uri.parse(e.metadata.interactive.uristring),i=e.metadata.interactive.lineIndex,o=await ze.window.showTextDocument(n,{viewColumn:ze.ViewColumn.One});o&&(o.revealRange(new ze.Range(i,0,i,0)),o.selection=new ze.Selection(new ze.Position(i,0),new ze.Position(i,0)))}}async copyCellInInteractiveWindow(e){var t;if(e){let n=this.configuration.getSettings(e.notebook.uri),i=[(t=e.metadata.interactiveWindowCellMarker)!=null?t:n.defaultCellMarker,e.document.getText()].join(`
`);await ze.env.clipboard.writeText(i)}}};E([Ln("DATASCIENCE.DEBUG_STEP_OVER")],Es.prototype,"debugStepOver",1),E([Ln("DATASCIENCE.DEBUG_STOP")],Es.prototype,"debugStop",1),E([Ln("DATASCIENCE.DEBUG_CONTINUE")],Es.prototype,"debugContinue",1),E([Fr("DATASCIENCE.ADD_CELL_BELOW")],Es.prototype,"addCellBelow",1),E([Ln("DATASCIENCE.EXPORT_PYTHON_FILE")],Es.prototype,"exportFile",1),E([Ln("DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT")],Es.prototype,"exportFileAndOutput",1),E([Ln("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"command"})],Es.prototype,"importNotebook",1),E([Ln("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"file"})],Es.prototype,"importNotebookOnFile",1),Es=E([(0,Un.injectable)(),b(0,(0,Un.inject)(oe)),b(1,(0,Un.inject)(TI)),b(1,(0,Un.optional)()),b(2,(0,Un.inject)(r1)),b(2,(0,Un.optional)()),b(3,(0,Un.inject)(Tt)),b(4,(0,Un.inject)(Ke)),b(5,(0,Un.inject)(Tm)),b(5,(0,Un.optional)()),b(6,(0,Un.inject)(ho)),b(6,(0,Un.optional)()),b(7,(0,Un.inject)(Ke)),b(8,(0,Un.inject)(_s)),b(9,(0,Un.inject)($e)),b(10,(0,Un.inject)(Pn)),b(11,(0,Un.inject)(Ho)),b(12,(0,Un.inject)(I_))],Es);d();var xv=z(re()),Mu=require("vscode");d();function uc(r){if(r.metadata.interactive!==void 0)return r.metadata}function Pee(r,e,t){let n=dt(r,{trim:!1,removeEmptyEntries:!1}),i=t.stripFirstMarkerNoConcat(n),o=HG(i),s=uI(o,`
`,e.magicCommandsAsComments?UM:void 0);return Gv(s.join(""))}function UD(r){let e=r;return e&&e.input&&kn(e.input.uri)&&kn(e.input.inputBoxUri)}var kee=require("vscode");var EEe=_.runCurrentCellAndAddBelow,CEe=_.addCellBelowCommandTitle,wEe=_.debugCellCommandTitle,xEe=_.debugCellCommandTitle,DEe=_.debugStepOverCommandTitle,PEe=_.debugContinueCommandTitle,TEe=_.debugStopCommandTitle,kEe=_.runCellLensCommandTitle,NEe=_.runAllCellsLensCommandTitle,REe=_.runAllCellsAboveLensCommandTitle,Tee=_.runCellAndAllBelowLensCommandTitle,AEe=_.scrollToCellTitleFormatMessage,R_=class{constructor(e,t,n,i){this.configService=e;this.generatedCodeStorageFactory=n;this.updateEvent=new Mu.EventEmitter;this.notebookData=new Map;this.codeLensCache=new Map;this.totalCodeLensUpdateTimeInMs=0;this.codeLensUpdateCount=0;this.maxCellCount=0;Mu.workspace.onDidCloseTextDocument(this.onClosedDocument,this,t),Mu.workspace.onDidGrantWorkspaceTrust(()=>this.codeLensCache.clear(),this,t),this.configService.getSettings(void 0).onDidChange(this.onChangedSettings,this,t),kee.notebooks.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,t),i.onDidDisposeKernel(o=>{this.notebookData.delete(o.notebook.uri.toString())},this,t)}getPerfMeasures(){return{totalCodeLensUpdateTimeInMs:this.totalCodeLensUpdateTimeInMs,codeLensUpdateCount:this.codeLensUpdateCount,maxCellCount:this.maxCellCount}}get updateRequired(){return this.updateEvent.event}createCodeLenses(e){let t=this.getCodeLensCacheData(e);return[...t.documentLenses,...t.gotoCellLens]}getCellRanges(e){return this.getCodeLensCacheData(e).cellRanges}getCodeLensCacheData(e){var l;let t=new Mt,n=!1,i=e.uri.toString(),o=this.codeLensCache.get(i),s=!1;o||(o={cachedDocumentVersion:void 0,cachedExecutionCounts:new Set,documentLenses:[],cellRanges:[],gotoCellLens:[]},s=!0,this.codeLensCache.set(i,o)),o.cachedDocumentVersion!==e.version&&(o.cellRanges=KD(e,this.configService.getSettings(e.uri)),o.documentLenses=[],o.gotoCellLens=[],o.cachedDocumentVersion=e.version,s=!0);let a=this.getDocumentExecutionCounts(i);if((a.length!==o.cachedExecutionCounts.size||a.find(c=>!(o!=null&&o.cachedExecutionCounts.has(c))))&&(o.gotoCellLens=[],o.cachedExecutionCounts=new Set(a),s=!0),o.documentLenses.length===0&&s&&o.cellRanges.length){n=!0;let c=this.enumerateCommands(e.uri);q(`CodeLensFactory: Generating new code lenses for version ${e.version} of document ${e.uri} for commands ${c.join(", ")}`);let u=!0;o.cellRanges.forEach(p=>{c.forEach(f=>{let m=this.createCodeLens(e,p,f,u);m&&o.documentLenses.push(m)}),u=!1})}else Ie(`NOT Generating new code lenses for version ${e.version} of document ${e.uri} - needUpdate: ${s}, cellRanges.length: ${o.cellRanges.length}`);if(s&&o.gotoCellLens.length===0&&o.cellRanges.length&&this.configService.getSettings(e.uri).addGotoCodeLenses){let c=this.generatedCodeStorageFactory.get({fileUri:e.uri}),u=c?(l=c.all.find(p=>p.uri.toString()===e.uri.toString()))==null?void 0:l.generatedCodes:void 0;u&&u.length&&o.cellRanges.forEach(p=>{let f=this.createExecutionLens(e,p.range,u);f&&(o==null||o.gotoCellLens.push(f))})}return n&&(this.totalCodeLensUpdateTimeInMs+=t.elapsedTime,this.codeLensUpdateCount+=1,this.maxCellCount=Math.max(this.maxCellCount,o.cellRanges.length)),o}getDocumentExecutionCounts(e){return[...this.notebookData.values()].map(t=>t.documentExecutionCounts.get(e)).filter(t=>t!==void 0)}onDidChangeNotebookCellExecutionState(e){var i;if(e.cell.notebook.notebookType!==St||e.state!==Mu.NotebookCellExecutionState.Idle||!((i=e.cell.executionSummary)!=null&&i.executionOrder))return;let t=uc(e.cell),n=this.notebookData.get(e.cell.notebook.uri.toString());n||(n={cellExecutionCounts:new Map,documentExecutionCounts:new Map},this.notebookData.set(e.cell.notebook.uri.toString(),n)),n!==void 0&&t!==void 0&&(n.cellExecutionCounts.set(t.id,e.cell.executionSummary.executionOrder),n.documentExecutionCounts.set(t.interactive.uristring,e.cell.executionSummary.executionOrder),this.updateEvent.fire())}onClosedDocument(e){this.codeLensCache.delete(e.uri.toString())}onChangedSettings(){this.codeLensCache.clear(),this.updateEvent.fire()}enumerateCommands(e){let t,n=this.configService.getSettings(e).codeLenses;n?t=n.split(",").map(s=>s.trim()):t=Hu.DefaultDesignLenses;let i=this.configService.getSettings(e).debugCodeLenses;i?t=t.concat(i.split(",").map(s=>s.trim())):t=t.concat(Hu.DefaultDebuggingLenses);let o=[];return Mu.workspace.isTrusted||(o=[...Hu.DebuggerCommands,...Hu.DebuggerCommands,X.RunAllCells,X.RunAllCellsAbove,X.RunAllCellsAbovePalette,X.RunCellAndAllBelowPalette,X.RunCurrentCell,X.RunCurrentCellAdvance,X.RunCurrentCellAndAddBelow,X.RunFileInInteractiveWindows,X.InterruptKernel,X.RunToLine,X.RunCell,X.DebugCell,X.DebugContinue,X.DebugStepOver,X.DebugStop,X.RunCellAndAllBelowPalette]),o&&(t=t.filter(s=>!o.includes(s))),t}createCodeLens(e,t,n,i){let{range:o,cell_type:s}=t;switch(n){case X.RunCurrentCellAndAddBelow:return this.generateCodeLens(o,X.RunCurrentCellAndAddBelow,EEe);case X.AddCellBelow:return this.generateCodeLens(o,X.AddCellBelow,CEe,[e.uri,o.start.line]);case X.DebugCurrentCellPalette:return this.generateCodeLens(o,X.DebugCurrentCellPalette,wEe);case X.DebugCell:if(s!=="code")break;return this.generateCodeLens(o,X.DebugCell,xEe,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case X.DebugStepOver:if(s!=="code")break;return this.generateCodeLens(o,X.DebugStepOver,DEe,[e.uri]);case X.DebugContinue:if(s!=="code")break;return this.generateCodeLens(o,X.DebugContinue,PEe,[e.uri]);case X.DebugStop:if(s!=="code")break;return this.generateCodeLens(o,X.DebugStop,TEe,[e.uri]);case X.RunCurrentCell:case X.RunCell:return this.generateCodeLens(o,X.RunCell,kEe,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case X.RunAllCells:return this.generateCodeLens(o,X.RunAllCells,NEe,[e.uri,o.start.line,o.start.character]);case X.RunAllCellsAbovePalette:case X.RunAllCellsAbove:return i?this.generateCodeLens(o,X.RunCellAndAllBelow,Tee,[e.uri,o.start.line,o.start.character]):this.generateCodeLens(o,X.RunAllCellsAbove,REe,[e.uri,o.start.line,o.start.character]);case X.RunCellAndAllBelowPalette:case X.RunCellAndAllBelow:return this.generateCodeLens(o,X.RunCellAndAllBelow,Tee,[e.uri,o.start.line,o.start.character]);default:ue(`Invalid command for code lens ${n}`);break}}findMatchingCellExecutionCount(e){let t=[...this.notebookData.values()].find(n=>n.cellExecutionCounts.get(e));return t==null?void 0:t.cellExecutionCounts.get(e)}createExecutionLens(e,t,n){if(n){let i=n.filter(o=>o.line-2===t.start.line).sort((o,s)=>o.timestamp-s.timestamp);if(i&&i.length){let o=i[i.length-1],s=this.findMatchingCellExecutionCount(o.id);if(s!==void 0)return this.generateCodeLens(t,X.ScrollToCell,AEe(s),[e.uri,o.id])}}}generateCodeLens(e,t,n,i){return new Mu.CodeLens(e,MEe(t,n,i))}};R_=E([(0,xv.injectable)(),b(0,(0,xv.inject)(Ke)),b(1,(0,xv.inject)(oe)),b(2,(0,xv.inject)(Ba)),b(3,(0,xv.inject)($e))],R_);function MEe(r,e,t){return{arguments:t,title:e,command:r}}d();var Ou=z(re()),dc=z(require("vscode"));var A_=class{constructor(e,t,n,i,o){this.serviceContainer=e;this.debugLocationTracker=t;this.configuration=n;this.debugService=o;this.totalExecutionTimeInMs=0;this.totalGetCodeLensCalls=0;this.activeCodeWatchers=[];this.didChangeCodeLenses=new dc.EventEmitter;i.push(this),i.push(dc.workspace.onDidGrantWorkspaceTrust(()=>{this.activeCodeWatchers=he(this.activeCodeWatchers),this.didChangeCodeLenses.fire()})),i.push(this.debugService.onDidChangeActiveDebugSession(this.onChangeDebugSession.bind(this))),i.push(dc.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument.bind(this))),this.debugLocationTracker&&i.push(this.debugLocationTracker.updated(this.onDebugLocationUpdated.bind(this)))}dispose(){this.totalGetCodeLensCalls>0&&J("DS_INTERNAL.CODE_LENS_ACQ_TIME",{duration:this.totalExecutionTimeInMs/this.totalGetCodeLensCalls}),he(this.activeCodeWatchers)}get onDidChangeCodeLenses(){return this.didChangeCodeLenses.event}provideCodeLenses(e,t){return[Ip,lP].includes(e.uri.scheme)?[]:this.getCodeLensTimed(e)}getCodeWatcher(e){return this.matchWatcher(e.uri)}onDebugLocationUpdated(){this.didChangeCodeLenses.fire()}onChangeDebugSession(e){this.didChangeCodeLenses.fire()}onDidCloseTextDocument(e){let t=this.activeCodeWatchers.findIndex(n=>n.uri&&n.uri.toString()===e.uri.toString());t>=0&&this.activeCodeWatchers.splice(t,1)[0].dispose()}getCodeLensTimed(e){let t=new Mt,n=this.getCodeLens(e);return this.totalExecutionTimeInMs+=t.elapsedTime,this.totalGetCodeLensCalls+=1,new br(Cr.HasCodeCells).set(n&&n.length>0).catch(y),this.configuration.getSettings(e.uri).enableCellCodeLens?this.adjustDebuggingLenses(e,n):[]}adjustDebuggingLenses(e,t){let n=Hu.DebuggerCommands;if(this.debugLocationTracker&&this.debugService.activeDebugSession){let i=this.debugLocationTracker.getLocation(this.debugService.activeDebugSession),o;try{o=i?dc.Uri.parse(i.fileName):void 0}catch(s){}if(i&&(ca(dc.Uri.file(i.fileName),e.uri,!0)||o&&ca(o,e.uri,!0)))return t.filter(a=>{let l=new dc.Position(i.lineNumber-1,i.column-1);return a.range.contains(l)}).filter(a=>a.command?n.includes(a.command.command):!1);Ie(`Detected debugging context because activeDebugSession is name:"${this.debugService.activeDebugSession.name}", type: "${this.debugService.activeDebugSession.type}", but fell through with debugLocation: ${JSON.stringify(i)}, and document.uri: ${e.uri.toString()}`)}else return t.filter(i=>i.command?!n.includes(i.command.command):!1);return[]}getCodeLens(e){let t=this.matchWatcher(e.uri);return t?t.getCodeLenses():(q(`Creating a new watcher for document ${e.uri}`),this.createNewCodeWatcher(e).getCodeLenses())}matchWatcher(e){let t=this.activeCodeWatchers.findIndex(i=>i.uri&&i.uri.toString()==e.toString());if(t>=0)return this.activeCodeWatchers[t];let n=dc.workspace.textDocuments.filter(i=>i.uri.toString()===e.toString());if(n&&n.length>0)return q(`creating new code watcher with matching document ${e}`),this.createNewCodeWatcher(n[0])}createNewCodeWatcher(e){let t=this.serviceContainer.get(RM);return t.setDocument(e),t.codeLensUpdated(this.onWatcherUpdated.bind(this)),this.activeCodeWatchers.push(t),t}onWatcherUpdated(){this.didChangeCodeLenses.fire()}};A_=E([(0,Ou.injectable)(),b(0,(0,Ou.inject)(jr)),b(1,(0,Ou.inject)(fM)),b(1,(0,Ou.optional)()),b(2,(0,Ou.inject)(Ke)),b(3,(0,Ou.inject)(oe)),b(4,(0,Ou.inject)(ho))],A_);d();var km=z(re()),xe=require("vscode");d();var VM=Symbol("ICodeExecutionHelper");d();var Dv=class extends Error{constructor(t){super("Cell failed to execute");this.cell=t}};function OEe(r,e){if(e<=0)throw new RangeError(`Length must be > 0 not ${e}`);return r<0&&(r+=e),r<0?0:r>=e?e-1:r}var cr=class{constructor(e,t,n,i,o){this.interactiveWindowProvider=e;this.configService=t;this.executionHelper=n;this.dataScienceErrorHandler=i;this.codeLensFactory=o;this.version=-1;this.codeLenses=[];this.cells=[];this.codeLensUpdatedEvent=new xe.EventEmitter;this.disposables=[this.codeLensUpdatedEvent]}setDocument(e){this.document=e,this.version=e.version,this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.disposables.push(this.codeLensFactory.updateRequired(this.onCodeLensFactoryUpdated.bind(this))),this.disposables.push(xe.workspace.onDidCloseTextDocument(this.onDocumentClosed.bind(this))),this.disposables.push(xe.workspace.onDidCloseNotebookDocument(this.ondidCloseNotebook.bind(this)))}get codeLensUpdated(){return this.codeLensUpdatedEvent.event}get uri(){var e;return(e=this.document)==null?void 0:e.uri}getVersion(){return this.version}getCodeLenses(){let e=this.document;return e&&e.version!=this.version&&(this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.version=e.version),this.codeLenses}async debugCurrentCell(){if(!(!xe.window.activeTextEditor||!xe.window.activeTextEditor.document))return this.runMatchingCell(xe.window.activeTextEditor.selection,!1,!0)}dispose(){let e=this.codeLensFactory.getPerfMeasures();e&&e.codeLensUpdateCount>0&&J("DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",{codeLensUpdateTime:e.totalCodeLensUpdateTimeInMs/e.codeLensUpdateCount,maxCellCount:e.maxCellCount}),he(this.disposables)}async runAllCells(e){let t=await this.getActiveInteractiveWindow(),n=this.codeLenses.filter(s=>s.command&&s.command.command===X.RunCell&&s.command.arguments&&s.command.arguments.length>=5),i=n.length,o=Promise.resolve(!0);for(let s of n){let a=new xe.Range(s.command.arguments[1],s.command.arguments[2],s.command.arguments[3],s.command.arguments[4]);if(this.document){i===n.length&&(a=new xe.Range(new xe.Position(0,0),a.end));let l=this.document.getText(a);i-=1,o=this.addCode(t,l,this.document.uri,a.start.line,e)}}if(await o,n.length===0)return this.runFileAsOneCell(e!=null?e:!1)}async runFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells();if(this.document)return this.runFileAsOneCell(!1)}async debugFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells(!0);if(this.document)return this.runFileAsOneCell(!0)}async runAllCellsAbove(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===X.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t);o<0&&(o=i.length);let s=o,a=Promise.resolve(!0);for(let l of i)if(o>0&&this.document){let c=new xe.Range(l.range.start,l.range.end);o===s&&(c=new xe.Range(new xe.Position(0,0),c.end)),o-=1;let u=this.document.getText(c);a=this.addCode(n,u,this.document.uri,l.range.start.line)}else break;await a}async runCellAndAllBelow(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===X.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t),s=o>0?i.length-o:i.length,a=Promise.resolve(!0);for(let l=o;l>=0&&l<i.length;l+=1)if(s>0&&this.document){let c=i[l];s-=1;let u=this.document.getText(c.range);a=this.addCode(n,u,this.document.uri,c.range.start.line)}await a}async runSelectionOrLine(e,t){var n;if(this.document&&e&&ca(e.document.uri,this.document.uri)){let i=await this.getActiveInteractiveWindow(),o;if(t===void 0||kn(t)?o=this.executionHelper.getSelectedTextToExecute(e):o=t,!o)return;let a=((n=this.configService.getSettings(e.document.uri).normalizeSelectionForInteractiveWindow)!=null?n:!0)?await this.executionHelper.normalizeLines(o):o;if(!a||a.trim().length===0)return;await this.addCode(i,a,this.document.uri,e.selection.start.line)}}async runToLine(e){if(this.document&&e>0){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(e-1),i=this.document.getText(new xe.Range(0,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,0)}}async runFromLine(e){if(this.document&&e<this.document.lineCount){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(this.document.lineCount-1),i=this.document.getText(new xe.Range(e,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,e)}}async runCell(e){if(!xe.window.activeTextEditor||!xe.window.activeTextEditor.document)return;let t=e.contains(xe.window.activeTextEditor.selection.start)&&this.configService.getSettings(xe.window.activeTextEditor.document.uri).enableAutoMoveToNextCell;return this.runMatchingCell(e,t)}async debugCell(e){if(!(!xe.window.activeTextEditor||!xe.window.activeTextEditor.document))return this.runMatchingCell(e,!1,!0)}async runCurrentCell(){if(!(!xe.window.activeTextEditor||!xe.window.activeTextEditor.document))return this.runMatchingCell(xe.window.activeTextEditor.selection,!1)}async runCurrentCellAndAdvance(){if(!(!xe.window.activeTextEditor||!xe.window.activeTextEditor.document))return this.runMatchingCell(xe.window.activeTextEditor.selection,!0)}async addEmptyCellToBottom(){let e=xe.window.activeTextEditor;e&&this.insertCell(e,e.document.lineCount+1)}async runCurrentCellAndAddBelow(){if(!xe.window.activeTextEditor||!xe.window.activeTextEditor.document)return;let e=xe.window.activeTextEditor,t=new qo(this.configService.getSettings(e.document.uri)),n=0,i=this.getDefaultCellMarker(e.document.uri);e&&e.edit(s=>{let a=!0;for(let l=e.selection.end.line+1;l<e.document.lineCount;l+=1)if(t.isCell(e.document.lineAt(l).text)){a=!1,n=l,s.insert(new xe.Position(l,0),`${i}

`);break}a&&(n=e.document.lineCount,s.insert(new xe.Position(e.document.lineCount,0),`
${i}
`))}).then(y,y);let o=new xe.Position(n+1,0);return this.runMatchingCell(e.selection,!1).then(()=>this.advanceToRange(new xe.Range(o,o)))}insertCellBelowPosition(){let e=xe.window.activeTextEditor;e&&e.selection&&this.insertCell(e,e.selection.end.line+1)}insertCellBelow(){let e=xe.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.end);t?this.insertCell(e,t.range.end.line+1):this.insertCell(e,e.selection.end.line+1)}}insertCellAbove(){let e=xe.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.start);t?this.insertCell(e,t.range.start.line):this.insertCell(e,e.selection.start.line)}}deleteCells(){let e=xe.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCells(e.selection);if(!t)return;let n=t[0],i=t[1],o=0,s=0,a=i.range.end.line+1,l=0;n.range.start.line>0&&(o=n.range.start.line-1,s=e.document.lineAt(o).range.end.character,a=i.range.end.line,l=i.range.end.character);let c=new xe.Range(new xe.Position(o,s),new xe.Position(a,l));e.edit(u=>{u.replace(c,""),this.codeLensUpdatedEvent.fire()}).then(y,y)}selectCell(){let e=xe.window.activeTextEditor;if(e&&e.selection){let t=this.getStartEndCells(e.selection);if(t){let n=t[0],i=t[1];e.selection.anchor.isBeforeOrEqual(e.selection.active)?e.selection=new xe.Selection(n.range.start,i.range.end):e.selection=new xe.Selection(i.range.end,n.range.start)}}}selectCellContents(){let e=xe.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCellIndex(e.selection);if(!t)return;let n=t[0],i=t[1],o=e.selection.anchor.isBeforeOrEqual(e.selection.active),s=this.cells,a=[];for(let l=n;l<=i;l+=1){let c=s[l],u=c.range.start.line+1,p=0,f=c.range.end.line,m=c.range.end.character;c.range.start.line===c.range.end.line&&(u=c.range.start.line,p=e.document.lineAt(u).range.end.character,f=u,m=p),o?a.push(new xe.Selection(u,p,f,m)):a.push(new xe.Selection(f,m,u,p))}e.selections=a}extendSelectionByCellAbove(){let e=xe.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBefore(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],c=o[a];if(!l.range.start.isEqual(t.start)||!c.range.end.isEqual(t.end)){let u;i?s<a?u=new xe.Selection(l.range.start,o[a-1].range.end):u=new xe.Selection(l.range.end,l.range.start):u=new xe.Selection(c.range.end,l.range.start),e.selection=u}else{let u;i&&s<a?(u=o[a-1],e.selection=new xe.Selection(l.range.start,u.range.end)):s>0&&(u=o[s-1],e.selection=new xe.Selection(c.range.end,u.range.start)),u&&e.revealRange(u.range,xe.TextEditorRevealType.Default)}}extendSelectionByCellBelow(){let e=xe.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBeforeOrEqual(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],c=o[a];if(!l.range.start.isEqual(t.start)||!c.range.end.isEqual(t.end)){let u;i?u=new xe.Selection(l.range.start,c.range.end):s<a?u=new xe.Selection(o[s+1].range.start,c.range.end):u=new xe.Selection(c.range.start,c.range.end),e.selection=u}else{let u;i||s===a?a<o.length-1&&(u=o[a+1],e.selection=new xe.Selection(l.range.start,u.range.end)):s<a&&(u=o[s+1],e.selection=new xe.Selection(c.range.end,u.range.start)),u&&e.revealRange(u.range,xe.TextEditorRevealType.Default)}}async moveCellsUp(){await this.moveCellsDirection(!0)}async moveCellsDown(){await this.moveCellsDirection(!1)}changeCellToMarkdown(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"markdown"))}changeCellToCode(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"code"))}gotoNextCell(){let e=xe.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getNextCellLens(t.start);n&&i&&this.advanceToRange(i.range)}gotoPreviousCell(){let e=xe.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getPreviousCellLens(t.start);n&&i&&this.advanceToRange(i.range)}applyToCells(e){let t=xe.window.activeTextEditor,n=this.getStartEndCellIndex(t==null?void 0:t.selection);if(!t||!n)return;let i=this.cells,o=n[0],s=n[1];for(let a=o;a<=s;a+=1)e(t,i[a],a)}changeCellTo(e,t,n){if(n==="raw")throw Error("Cell Type raw not implemented");if(t.cell_type===n)return;let i=new qo(this.configService.getSettings(e.document.uri)),o=e.document.lineAt(t.range.start.line),s=e.document.getText(o.range),a=this.getDefaultCellMarker(e.document.uri),l=n==="markdown"?i.codeExecRegEx.exec(s):i.markdownExecRegEx.exec(s);if(!l)return;let c=l[l.length-1],u=n==="markdown"?`${a} [markdown]${c}`:`${a}${c}`;e.edit(async p=>{p.replace(o.range,u),t.cell_type=n,t.range.start.line<t.range.end.line&&(e.selection=new xe.Selection(t.range.start.line+1,0,t.range.end.line,t.range.end.character),xe.commands.executeCommand("editor.action.removeCommentLine").then(y,y),n==="markdown"&&xe.commands.executeCommand("editor.action.addCommentLine").then(y,y))}).then(y,y)}async moveCellsDirection(e){let t=xe.window.activeTextEditor;if(!t||!t.selection)return!1;let n=this.getStartEndCellIndex(t.selection);if(!n)return!1;let i=n[0],o=n[1],s=this.cells,a=s[i],l=s[o];if(!a||!l)return!1;let c=new xe.Range(a.range.start,l.range.end),u=new xe.Range(t.selection.start.line-c.start.line,t.selection.start.character,t.selection.end.line-c.start.line,t.selection.end.character),p=t.selection.active.isBefore(t.selection.anchor),f;if(e){if(i===0)return!1;{let m=s[i-1];f=this.exchangeTextLines(t,m.range,c).then(g=>(g&&(t.selection=new xe.Selection(m.range.start.line+u.start.line,u.start.character,m.range.start.line+u.end.line,u.end.character)),g))}}else{if(o===s.length-1)return!1;{let m=s[o+1],h=this.exchangeTextLines(t,c,m.range),g=m.range.end.line-m.range.start.line,v=c.end.line-c.start.line,I=g-v;f=h.then(S=>(S&&(t.selection=new xe.Selection(m.range.start.line+I+u.start.line,u.start.character,m.range.start.line+I+u.end.line,u.end.character)),S))}}return f.then(m=>(m&&p&&(t.selection=new xe.Selection(t.selection.active,t.selection.anchor)),!0))}exchangeTextLines(e,t,n){let i=t.start.line,o=t.end.line,s=n.start.line,a=n.end.line;if(o>=s)throw RangeError(`Above lines must be fully above not ${o} <= ${s}`);let l=new xe.Range(i,0,o,e.document.lineAt(o).range.end.character),c=e.document.getText(l),u=new xe.Range(s,0,a,e.document.lineAt(a).range.end.character),p=e.document.getText(u),f="";if(o+1<s){let g=o+1,v=s-1,I=new xe.Range(g,0,v,e.document.lineAt(v).range.end.character);f=`${e.document.getText(I)}
`}let m=`${p}
${f}${c}`,h=new xe.Range(l.start,u.end);return e.edit(g=>{g.replace(h,m),this.codeLensUpdatedEvent.fire()})}getStartEndCells(e){let t=this.getStartEndCellIndex(e);if(t){let n=this.getCellFromIndex(t[0]),i=this.getCellFromIndex(t[1]);return[n,i]}}getStartEndCellIndex(e){if(!e)return;let t=this.getCellIndex(e.start),n=t;if(e.start.line!==e.end.line&&(n=this.getCellIndex(e.end)),t===-1){if(n===-1)return;{t=0;let i=this.getCellFromIndex(0);if(e.start.line>i.range.start.line)throw RangeError(`Should not be able to pick a range with an end in a cell and start after a cell. ${e.start.line} > ${i.range.end.line}`)}}if(t>=0&&n>=0)return[t,n]}insertCell(e,t){let n=this.getDefaultCellMarker(e.document.uri),i=t>=e.document.lineCount?`
${n}
`:`${n}

`,o=new xe.Position(t,0),s=new xe.Position(t+1,0);e.edit(a=>{a.insert(o,i),this.codeLensUpdatedEvent.fire()}).then(y,y),e.selection=new xe.Selection(s,s)}getDefaultCellMarker(e){return this.configService.getSettings(e).defaultCellMarker||st.DefaultCodeCellMarker}onCodeLensFactoryUpdated(){this.document&&(this.codeLenses=this.codeLensFactory.createCodeLenses(this.document),this.cells=this.codeLensFactory.getCellRanges(this.document)),this.codeLensUpdatedEvent.fire()}onDocumentClosed(e){this.document&&ca(e.uri,this.document.uri)&&he(this.disposables)}ondidCloseNotebook(e){var t;e.notebookType===St&&this.configService.getSettings((t=this.document)==null?void 0:t.uri).addGotoCodeLenses&&this.onCodeLensFactoryUpdated()}getActiveInteractiveWindow(){var e;return this.interactiveWindowProvider.getOrCreate((e=this.document)==null?void 0:e.uri)}async addCode(e,t,n,i,o){let s=!1;try{o?s=await e.debugCode(t,n,i):s=await e.addCode(t,n,i)}catch(a){a instanceof Dv||await this.dataScienceErrorHandler.handleError(a)}return s}async runMatchingCell(e,t,n){let i=this.getCurrentCellLens(e.start),o=this.getNextCellLens(e.start);if(i&&this.document){let s=Gv(this.document.getText(i.range));if(t){let l=xe.window.activeTextEditor,{newCellOnRunLast:c}=this.configService.getSettings(this.document.uri),u=new qo(this.configService.getSettings(this.document.uri));o?this.advanceToRange(o.range):c&&l&&!u.isEmptyCell(s)&&this.insertCell(l,i.range.end.line+1)}let a=await this.getActiveInteractiveWindow();await this.addCode(a,s,this.document.uri,i.range.start.line,n)}}getCellIndex(e){return this.cells.findIndex(t=>e&&t.range.contains(e))}getCellFromIndex(e){let t=this.cells,n=OEe(e,t.length);return t[n]}getCellFromPosition(e){if(!e){let t=xe.window.activeTextEditor;t&&t.selection&&(e=t.selection.active)}if(e){let t=this.getCellIndex(e);if(t>=0)return this.cells[t]}}getCurrentCellLens(e){return this.codeLenses.find(t=>t.range.contains(e)&&t.command!==void 0&&t.command.command===X.RunCell)}getNextCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===X.RunCell);if(t>=0)return this.codeLenses.find((n,i)=>n.command!==void 0&&n.command.command===X.RunCell&&i>t)}getPreviousCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===X.RunCell);if(t>=1)return this.codeLenses.find((n,i)=>n.command!==void 0&&i<t&&i+1===t)}async runFileAsOneCell(e){if(this.document){let t=await this.getActiveInteractiveWindow(),n=this.document.getText();await this.addCode(t,n,this.document.uri,0,e)}}advanceToRange(e){let t=xe.window.activeTextEditor,n=new xe.Selection(e.start,e.start);t&&(t.selection=n,t.revealRange(e,xe.TextEditorRevealType.Default))}};E([Ln("DATASCIENCE.DEBUG_CURRENT_CELL")],cr.prototype,"debugCurrentCell",1),E([Ln("DATASCIENCE.RUN_ALL_CELLS")],cr.prototype,"runAllCells",1),E([Ln("DATASCIENCE.RUN_FILE_INTERACTIVE")],cr.prototype,"runFileInteractive",1),E([Ln("DATASCIENCE.DEBUG_FILE_INTERACTIVE")],cr.prototype,"debugFileInteractive",1),E([Ln("DATASCIENCE.RUN_ALL_CELLS_ABOVE")],cr.prototype,"runAllCellsAbove",1),E([Ln("DATASCIENCE.RUN_CELL_AND_ALL_BELOW")],cr.prototype,"runCellAndAllBelow",1),E([Ln("DATASCIENCE.RUN_SELECTION_OR_LINE")],cr.prototype,"runSelectionOrLine",1),E([Ln("DATASCIENCE.RUN_TO_LINE")],cr.prototype,"runToLine",1),E([Ln("DATASCIENCE.RUN_FROM_LINE")],cr.prototype,"runFromLine",1),E([FB("CodeWatcher::runCell",4)],cr.prototype,"runCell",1),E([Ln("DATASCIENCE.DEBUG_CURRENT_CELL")],cr.prototype,"debugCell",1),E([Ln("DATASCIENCE.RUN_CURRENT_CELL")],cr.prototype,"runCurrentCell",1),E([Ln("DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE")],cr.prototype,"runCurrentCellAndAdvance",1),E([Fr("DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW")],cr.prototype,"runCurrentCellAndAddBelow",1),E([Fr("DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION")],cr.prototype,"insertCellBelowPosition",1),E([Fr("DATASCIENCE.RUN_INSERT_CELL_BELOW")],cr.prototype,"insertCellBelow",1),E([Fr("DATASCIENCE.RUN_INSERT_CELL_ABOVE")],cr.prototype,"insertCellAbove",1),E([Fr("DATASCIENCE.RUN_DELETE_CELLS")],cr.prototype,"deleteCells",1),E([Fr("DATASCIENCE.RUN_SELECT_CELL")],cr.prototype,"selectCell",1),E([Fr("DATASCIENCE.RUN_SELECT_CELL_CONTENTS")],cr.prototype,"selectCellContents",1),E([Fr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE")],cr.prototype,"extendSelectionByCellAbove",1),E([Fr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW")],cr.prototype,"extendSelectionByCellBelow",1),E([Fr("DATASCIENCE.RUN_MOVE_CELLS_UP")],cr.prototype,"moveCellsUp",1),E([Fr("DATASCIENCE.RUN_MOVE_CELLS_DOWN")],cr.prototype,"moveCellsDown",1),E([Fr("DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN")],cr.prototype,"changeCellToMarkdown",1),E([Fr("DATASCIENCE.RUN_CHANGE_CELL_TO_CODE")],cr.prototype,"changeCellToCode",1),E([Fr("DATASCIENCE.GOTO_NEXT_CELL_IN_FILE")],cr.prototype,"gotoNextCell",1),E([Fr("DATASCIENCE.GOTO_PREV_CELL_IN_FILE")],cr.prototype,"gotoPreviousCell",1),cr=E([(0,km.injectable)(),b(0,(0,km.inject)(_s)),b(1,(0,km.inject)(Ke)),b(2,(0,km.inject)(VM)),b(3,(0,km.inject)(Pn)),b(4,(0,km.inject)(AM))],cr);d();var O_=z(re()),ki=z(require("vscode"));var Nm=require("vscode");var M_=class{constructor(e,t,n){this.configuration=t;this.extensionChecker=n;this.computeDecorations(),e.push(this),e.push(this.configuration.getSettings(void 0).onDidChange(this.settingsChanged,this)),e.push(ki.window.onDidChangeActiveTextEditor(this.changedEditor,this)),e.push(ki.window.onDidChangeTextEditorSelection(this.changedSelection,this)),e.push(ki.workspace.onDidChangeTextDocument(this.changedDocument,this)),this.settingsChanged()}activate(){}dispose(){this.timer&&clearTimeout(this.timer)}settingsChanged(){ki.window.activeTextEditor&&this.triggerUpdate(ki.window.activeTextEditor)}changedEditor(){this.triggerUpdate(void 0)}changedDocument(e){ki.window.activeTextEditor&&e.document===ki.window.activeTextEditor.document&&this.triggerUpdate(Nm.window.activeTextEditor)}changedSelection(e){e.textEditor&&e.textEditor.selection.anchor&&this.triggerUpdate(e.textEditor)}triggerUpdate(e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>this.update(e),100)}computeDecorations(){this.currentCellTopUnfocused=Nm.window.createTextEditorDecorationType({borderColor:new ki.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottomUnfocused=Nm.window.createTextEditorDecorationType({borderColor:new ki.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellTop=Nm.window.createTextEditorDecorationType({borderColor:new ki.ThemeColor("interactive.activeCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottom=Nm.window.createTextEditorDecorationType({borderColor:new ki.ThemeColor("interactive.activeCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0})}cellDecorationEnabled(e){return e.decorateCells===!1?!1:e.decorateCells==="currentCell"||e.decorateCells==="allCells"}update(e){let t=e===void 0?Nm.window.visibleTextEditors:[e];for(let n of t)if(n&&n.document&&n.document.languageId===Qe&&!lI(n.document)&&this.currentCellTop&&this.currentCellBottom&&this.currentCellTopUnfocused&&this.currentCellBottomUnfocused&&this.extensionChecker.isPythonExtensionInstalled){let i=this.configuration.getSettings(n.document.uri);if(this.cellDecorationEnabled(i)){let o=KD(n.document,i),s=o.map(u=>u.range).filter(u=>u.contains(n.selection.anchor)),a=s.length>0?[new ki.Range(s[0].start,s[0].start)]:[],l=i.decorateCells!=="allCells"&&s.length>0?[new ki.Range(s[0].end,s[0].end)]:[],c=[];i.decorateCells==="allCells"&&o.forEach(u=>{let p=u.range.start;p!==s[0].start&&c.push(new ki.Range(p,p))}),Nm.window.activeTextEditor===n?(n.setDecorations(this.currentCellTop,a),n.setDecorations(this.currentCellBottom,l),n.setDecorations(this.currentCellTopUnfocused,c),n.setDecorations(this.currentCellBottomUnfocused,[])):(n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[...c,...a]),n.setDecorations(this.currentCellBottomUnfocused,l))}else n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[]),n.setDecorations(this.currentCellBottomUnfocused,[])}}};M_=E([(0,O_.injectable)(),b(0,(0,O_.inject)(oe)),b(1,(0,O_.inject)(Ke)),b(2,(0,O_.inject)(wo))],M_);d();var Cs=z(re()),on=require("vscode");d();var Gt=require("vscode");var Nee=z(iv());var Pv=class{constructor(e,t,n,i,o){this.serviceContainer=e;this._owner=t;this.controllerFactory=n;this.inputUri=o;this._onDidChangeViewState=new Gt.EventEmitter;this.closedEvent=new Gt.EventEmitter;this._submitters=[];this.internalDisposables=[];var s;this.fs=this.serviceContainer.get(Tt),this.configuration=this.serviceContainer.get(Ke),this.jupyterExporter=this.serviceContainer.get(TI),this.interactiveWindowDebugger=this.serviceContainer.tryGet(See),this.errorHandler=this.serviceContainer.get(Pn),this.codeGeneratorFactory=this.serviceContainer.get(N_),this.storageFactory=this.serviceContainer.get(Ba),this.kernelProvider=this.serviceContainer.get($e),this.debuggingManager=this.serviceContainer.get(OM),this.notebookUri=UD(i)?i.input.uri:i.notebook.uri,this._owner&&this._submitters.push(this._owner),Gt.window.onDidChangeActiveNotebookEditor(a=>{(a==null?void 0:a.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire()},this.internalDisposables),Gt.workspace.onDidCloseNotebookDocument(a=>{a.uri.toString()===this.notebookUri.toString()&&this.closedEvent.fire()},this.internalDisposables),((s=Gt.window.activeNotebookEditor)==null?void 0:s.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire(),this.cellMatcher=new qo(this.configuration.getSettings(this.owningResource)),this.notebookDocument&&this.codeGeneratorFactory.getOrCreate(this.notebookDocument)}get onDidChangeViewState(){return this._onDidChangeViewState.event}get closed(){return this.closedEvent.event}get owner(){return this._owner}get submitters(){return this._submitters}get notebookDocument(){return this._notebookDocument||(this._notebookDocument=Gt.workspace.notebookDocuments.find(e=>e.uri.toString()===this.notebookUri.toString())),this._notebookDocument}get kernelConnectionMetadata(){var e;return(e=this.controller)==null?void 0:e.metadata}notifyConnectionReset(){if(this.notebookDocument)this.controller||(this.controller=this.initController(this.notebookDocument)),this.controller.setInfoMessageCell(_.noKernelConnected);else{let e=Gt.workspace.onDidOpenNotebookDocument(t=>{t.uri.toString()===this.notebookUri.toString()&&(this._notebookDocument=t,this.controller=this.initController(t),this.internalDisposables.push(this.controller.listenForControllerSelection()),this.controller.setInfoMessageCell(_.noKernelConnected),e.dispose())})}}initController(e){let t=this.controllerFactory.create(e,this.errorHandler,this.kernelProvider,this._owner);return this.internalDisposables.push(t.listenForControllerSelection()),t}async ensureInitialized(){if(!this.notebookDocument&&(q("Showing Interactive editor to initialize codeGenerator from notebook document"),await this.showInteractiveEditor(),!this.notebookDocument))throw new Error("Could not open notebook document for Interactive Window");this.codeGeneratorFactory.get(this.notebookDocument)||this.codeGeneratorFactory.getOrCreate(this.notebookDocument),this.controller||(this.controller=this.initController(this.notebookDocument)),this.controller.controller?this.controller.startKernel().catch(y):(De("No controller selected for Interactive Window initialization"),this.controller.setInfoMessageCell(_.selectKernelForEditor))}async showInteractiveEditor(){let e;Gt.window.tabGroups.all.find(i=>{i.tabs.find(o=>{UD(o)&&o.input.uri.toString()==this.notebookUri.toString()&&(e=o)})});let t=this.notebookDocument||await this.openNotebookDocument();return await Gt.window.showNotebookDocument(t,{preserveFocus:!0,viewColumn:e==null?void 0:e.group.viewColumn})}async openNotebookDocument(){return q(`Opening notebook document ${this.notebookUri}`),await Gt.workspace.openNotebookDocument(this.notebookUri)}dispose(){var e;this.internalDisposables.forEach(t=>t.dispose()),(e=this.controller)==null||e.disconnect()}async showErrorForCell(e,t){var o,s,a;let n=(o=this.controller)==null?void 0:o.controller,i=yy(e);if(n&&i&&t){let l=fo.getOrCreate(t,new vv(n));try{await l.appendOutput(i)}catch(c){ue(`Could not append error message "${i}" to cell: ${c}`)}finally{l.end(!1,(a=(s=t.executionSummary)==null?void 0:s.timing)==null?void 0:a.endTime)}}else De(`Could not append error message to cell "${i}"`)}changeMode(e){var t;(t=this.controller)==null||t.updateMode(e)}async addCode(e,t,n){return this.submitCode(e,t,n,!1)}useNewDebugMode(){var t;return!!(this.configuration.getSettings(this.owner).forceIPyKernelDebugger||(t=this.controller)!=null&&t.metadata&&!or(this.controller.metadata))}async debugCode(e,t,n){let i=!0,o=Gt.workspace.textDocuments.find(a=>this.fs.arePathsSame(a.uri,t));if(!this.useNewDebugMode()&&o&&o.isUntitled){let a=[...Gt.workspace.textDocuments];if(i=await o.save(),i){let l=Gt.workspace.textDocuments.filter(c=>a.indexOf(c)===-1);l&&l.length>0&&(t=(l.find(u=>u.languageId==="python")||l.find(u=>!u.fileName.endsWith(".interactive"))||l[0]).uri,await Gt.workspace.openTextDocument(t))}}let s=!0;return i?this.submitCode(e,t,n,!0):s}async submitCode(e,t,n,i){var u;if(this.cellMatcher.isEmptyCell(e)||!((u=this.controller)!=null&&u.controller))return!0;this.updateOwners(t);let o=dt(e,{trim:!1}),s=new qo(this.configuration.getSettings(t)),a=-1;s.isMarkdown(o[0])&&Og(o,(p,f)=>void 0,(p,f)=>{p&&p.length>0&&a===-1&&(a=f)});let c=(a>0?[o.slice(0,a).join(`
`),o.slice(a).join(`
`)]:[e]).map(p=>{let f=Me();this.controller.setPendingCellAdd(f.promise);let m=this.addNotebookCell(p,t,n),h=this.createExecutionPromise(m,i);return h.catch(g=>{g instanceof Dv?m.then(v=>{g.cell!==v&&this.showErrorForCell(_.cellStopOnErrorMessage,v).then(y,y)}).catch(y):m.then(v=>this.errorHandler.getErrorMessageForDisplayInCell(g,"execution",this.owningResource).then(I=>this.showErrorForCell(I,v))).catch(y)}).finally(()=>{f==null||f.resolve()}),h});return c[c.length-1]}async createExecutionPromise(e,t){var a,l;if(!this.controller||!this.notebookDocument)return!1;Ie("InteractiveWindow.ts.createExecutionPromise.start");let n=this.controller.startKernel(),i=await e,o=!0,s=async()=>void 0;try{let c=await n;await this.generateCodeAndAddMetadata(i,t,c),t&&this.useNewDebugMode()?await this.debuggingManager.start(this.notebookDocument,i):t&&or(c.kernelConnectionMetadata)&&this.interactiveWindowDebugger&&(s=async()=>{var f;return(f=this.interactiveWindowDebugger)==null?void 0:f.detach(c)},await this.interactiveWindowDebugger.attach(c),await this.interactiveWindowDebugger.updateSourceMaps(((a=this.storageFactory.get({notebook:i.notebook}))==null?void 0:a.all)||[]),this.interactiveWindowDebugger.enable(c)),Ie("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell");let u=uc(i);o=await this.kernelProvider.getKernelExecution(c).executeCell(i,(l=u==null?void 0:u.generatedCode)==null?void 0:l.code).then(()=>!0,()=>!1),Ie("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell.finished")}finally{await s(),Ie("InteractiveWindow.ts.createExecutionPromise.end")}if(!o)throw new Dv(i);return o}async expandAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{await Gt.commands.executeCommand("notebook.cell.expandCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async collapseAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{e.kind===Gt.NotebookCellKind.Code&&await Gt.commands.executeCommand("notebook.cell.collapseCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async scrollToCell(e){let t=await this.showInteractiveEditor(),n=t.notebook.getCells().find(i=>{var o;return((o=uc(i))==null?void 0:o.id)===e});if(n){let i=new Gt.NotebookRange(n.index,n.index+1);t.revealRange(i,Gt.NotebookEditorRevealType.Default),t.selection=i}}async hasCell(e){let t=this.notebookDocument;return!!t&&t.getCells().some(n=>{var i;return((i=uc(n))==null?void 0:i.id)===e})}get owningResource(){if(this.owner)return this.owner;let e=sI();if(e)return e}updateOwners(e){var t;this._owner||(this._owner=e,(t=this.controller)==null||t.updateOwners(e)),this._submitters.find(n=>n.toString()==e.toString())||this._submitters.push(e)}async addNotebookCell(e,t,n){var h,g;let i=this.notebookDocument;if(!i)throw new Error("No notebook document");let o=this.configuration.getSettings(this.owningResource),s=this.cellMatcher.getCellType(e)===KE,a=s?H0(dt(e)).join(""):Pee(e,o,this.cellMatcher),l=this.cellMatcher.getFirstMarker(e),c=(g=(h=Gt.workspace.textDocuments.find(v=>{var I;return v.uri.toString()===((I=this.owner)==null?void 0:I.toString())}))==null?void 0:h.languageId)!=null?g:Qe,u=new Gt.NotebookCellData(s?Gt.NotebookCellKind.Markup:Gt.NotebookCellKind.Code,a,s?KE:c),p={uristring:t.toString(),lineIndex:n,originalSource:e},f={interactiveWindowCellMarker:l,interactive:p,id:(0,Nee.default)()};u.metadata=f,await Au(i,v=>{let I=Gt.NotebookEdit.insertCells(i.cellCount,[u]);v.set(i.uri,[I])});let m=i.cellCount-1;return i.cellAt(m)}async generateCodeAndAddMetadata(e,t,n){let i=uc(e);if(!i)return;let o=!or(n.kernelConnectionMetadata)||this.configuration.getSettings(void 0).forceIPyKernelDebugger,s=await this.codeGeneratorFactory.getOrCreate(this.notebookDocument).generateCode(i,e.index,t,o),a={...i,generatedCode:s},l=new Gt.WorkspaceEdit,c=Gt.NotebookEdit.updateCellMetadata(e.index,a);l.set(e.notebook.uri,[c]),await Gt.workspace.applyEdit(l)}async export(){var n;if(!this.notebookDocument)throw new Error("no notebook to export.");let e=Dee(this.notebookDocument),t=await new dp().showDialog("ipynb",this.owningResource);t&&await((n=this.jupyterExporter)==null?void 0:n.exportToFile(e,pt(t)))}async exportAs(){var n;if(await this.ensureInitialized(),!this.controller)throw new Error("An active kernel is required to export the notebook.");let e=(n=this.controller.kernel)==null?void 0:n.value,t;if(this.submitters&&this.submitters.length){let i=this.submitters[this.submitters.length-1];t=sr(i.path,Pp(i.path))}Tn()?Gt.commands.executeCommand(X.ExportAsPythonScript,this.notebookDocument,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(y,y):Gt.commands.executeCommand(X.Export,this.notebookDocument,t,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(y,y)}};E([YO()],Pv.prototype,"showErrorForCell",1),E([YO()],Pv.prototype,"createExecutionPromise",1);d();function Ree(r){return _.interactiveWindowTitleFormat(sr(r.path))}d();var I9=class{constructor(e,t,n,i,o,s,a){this.controllerService=e;this.mode=t;this.notebook=n;this.errorHandler=i;this.kernelProvider=o;this.owner=s;this.disposables=[];this.controller=a==null?void 0:a.controller,this.metadata=a==null?void 0:a.connection}updateMode(e){this.mode=e}updateOwners(e){this.owner=e}async startKernel(){var e;if((e=this.connectingListener)==null||e.dispose(),this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Interactive Window kernel not selected");this.setInfoMessage(this.metadata,0);try{let t=await this.createKernel(),n=async()=>{this.notebook&&this.metadata&&(this.systemInfoCell=void 0,this.setInfoMessage(this.metadata,1))};return this.disposables.push(t.addHook("willRestart",n)),t.onRestarted(async()=>{q("Restart event handled in IW"),this.fileInKernel=void 0;try{await this.setFileInKernel(t)}catch(i){O("Failed to run initialization after restarting")}finally{this.finishSysInfoMessage(t,1)}},this,this.disposables),this.fileInKernel=void 0,await this.setFileInKernel(t),this.finishSysInfoMessage(t,0),t}catch(t){throw this.owner?this.deleteSysInfoCell():await this.finishSysInfoWithFailureMessage(t),t}}async createKernel(){if(this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Controller not selected");let e=Me();e.promise.catch(y),this.kernel=e;try{let{kernel:t,actualController:n}=await this.controllerService.createKernel(this.metadata,this.controller,this.owner,this.notebook,this.disposables);return this.metadata=t.kernelConnectionMetadata,this.controller=n,this.disposables.push(t),e.resolve(t),t}catch(t){throw e.reject(t),this.disconnect(),t}}async setFileInKernel(e){let t=this.owner;if(!t){Ie("Unable to run initialization for IW");return}let n=pt(t),i=this.kernelProvider.getKernelExecution(e);this.mode==="perFile"&&!this.fileInKernel?(q(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):(!this.fileInKernel||this.fileInKernel.toString()!==t.toString())&&this.mode!=="perFile"?(q(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):q(`Not Initializing __file__ in setFileInKernel with ${n} for mode ${this.mode} currently ${this.fileInKernel}`)}setPendingCellAdd(e){if(this.metadata&&this.notebook){let t=this.controllerService.getRegisteredController(this.metadata);t==null||t.setPendingCellAddition(this.notebook,e)}}listenForControllerSelection(){return this.controllerService.onControllerSelected(e=>{var t,n,i,o;if(!(!this.notebook||e.notebook.uri.toString()!==((n=(t=this.notebook)==null?void 0:t.uri)==null?void 0:n.toString()))&&e.controller.id!==((i=this.controller)==null?void 0:i.id)){let s=!!this.kernel;this.disconnect(),this.controller=e.controller.controller,this.metadata=e.controller.connection,s?this.startKernel().catch(y):((o=this.connectingListener)==null||o.dispose(),this.connectingListener=e.controller.onConnecting(()=>{this.startKernel().catch(y)}),this.disposables.push(this.connectingListener))}},this)}setInfoMessageCell(e){this.systemInfoCell?this.systemInfoCell.updateMessage(e).catch(t=>ue(`could not update info cell with message: "${e}", error: ${t}`)):this.systemInfoCell=new FM(this.notebook,e)}setInfoMessage(e,t){let n=_ee(e,t);this.setInfoMessageCell(n)}finishSysInfoMessage(e,t){var i;let n=Eee(e.kernelConnectionMetadata,t);(i=this.systemInfoCell)==null||i.updateMessage(n).catch(o=>ue(`System info message was not updated: "${n}" because of error: ${o}`)),this.systemInfoCell=void 0}async finishSysInfoWithFailureMessage(e){var n;let t=await this.errorHandler.getErrorMessageForDisplayInCell(e,"start",this.owner);t=t.split(`
`).join(`  
`),(n=this.systemInfoCell)==null||n.updateMessage(t).catch(i=>ue(`System info message was not updated: "${t}" because of error: ${i}`)),this.systemInfoCell=void 0}deleteSysInfoCell(){var e;(e=this.systemInfoCell)==null||e.deleteCell().then(y,y),this.systemInfoCell=void 0}disconnect(){this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.kernel=void 0}},WD=class{constructor(e,t,n){this.controllerService=e;this.mode=t;this.initialController=n}create(e,t,n,i){let o=this.initialController,s=this.controllerService.getSelectedController(e);return s&&(o=s),new I9(this.controllerService,this.mode,e,t,n,i,o)}};var Aee="ds_asked_per_file_interactive",Mee="ds_interactive_window_cache",L_=class{constructor(e,t,n,i,o,s,a,l){this.serviceContainer=e;this.disposables=t;this.fs=n;this.configService=i;this.globalMemento=o;this.workspaceMemento=s;this.notebookEditorProvider=a;this.controllerHelper=l;this._onDidChangeActiveInteractiveWindow=new on.EventEmitter;this._windows=[];this.notebookEditorProvider.registerEmbedNotebookProvider(this),this.restoreWindows()}get onDidChangeActiveInteractiveWindow(){return this._onDidChangeActiveInteractiveWindow.event}get activeWindow(){var t;let e=(t=on.window.activeNotebookEditor)==null?void 0:t.notebook.uri.toString();return e?this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e}):void 0}restoreWindows(){let e=new Map;on.window.tabGroups.all.forEach(t=>{t.tabs.forEach(n=>{UD(n)&&n.input.uri&&e.set(n.input.uri.toString(),n)})}),this.workspaceMemento.get(Mee,[]).forEach(t=>{if(!t.uriString||!e.get(t.uriString))return;let n=e.get(t.uriString);if(!n)return;let i=this.configService.getSettings(n.input.uri).interactiveWindowMode,o=new Pv(this.serviceContainer,on.Uri.parse(t.owner),new WD(this.controllerHelper,i),n,on.Uri.parse(t.inputBoxUriString));o.notifyConnectionReset(),this._windows.push(o),J("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!1,hasOwner:!!t.owner,mode:i,restored:!0});let s=o.closed(this.onInteractiveWindowClosed.bind(this,o));this.disposables.push(o),this.disposables.push(s),this.disposables.push(o.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this)))}),this._updateWindowCache()}async getOrCreate(e,t){if(!on.workspace.isTrusted)throw new Error("Workspace not trusted");let n=await this.getInteractiveMode(e);this.pendingCreations&&await this.pendingCreations.catch(y);let i=this.getExisting(e,n,t);return i||(i=await this.create(e,n,t)),await i.ensureInitialized(),i}get(e){let t=this.configService.getSettings(e).interactiveWindowMode;return this.getExisting(e,t)}async create(e,t,n){let i=Me();this.pendingCreations=i.promise;try{let o=await this.controllerHelper.getInitialController(e,n);De(`Starting interactive window for resource '${Se(e)}' with controller '${o==null?void 0:o.id}'`);let[s,a]=await this.createEditor(o,e,t);o&&o.controller.updateNotebookAffinity(a.notebook,on.NotebookControllerAffinity.Preferred),q(`Interactive Window Editor Created: ${a.notebook.uri.toString()} with input box: ${s.toString()}`);let l=new Pv(this.serviceContainer,e,new WD(this.controllerHelper,t,o),a,s);this._windows.push(l),J("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!!o,hasOwner:!!e,mode:t,restored:!1}),this._updateWindowCache(),this.lastActiveInteractiveWindow=l;let c=l.closed(this.onInteractiveWindowClosed.bind(this,l));return this.disposables.push(l),this.disposables.push(c),this.disposables.push(l.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this))),l}finally{i.resolve()}}async createEditor(e,t,n){let i=e?`${Xe}/${e.id}`:void 0,o=t!==void 0,s=this.getInteractiveViewColumn(t),{inputUri:a,notebookEditor:l}=await on.commands.executeCommand("interactive.open",{viewColumn:s,preserveFocus:o},void 0,i,t&&n==="perFile"?Ree(t):void 0);if(!l)throw new Error("Failed to request creation of interactive window from VS Code.");return[a,l]}getInteractiveViewColumn(e){if(e)return on.ViewColumn.Beside;let t=this.configService.getSettings(e).interactiveWindowViewColumn;return t==="secondGroup"?on.ViewColumn.One:t==="active"?on.ViewColumn.Active:on.ViewColumn.Beside}async getInteractiveMode(e){let t=this.configService.getSettings(e).interactiveWindowMode;if(t==="multiple"&&e&&!this.globalMemento.get(Aee)&&this._windows.length===1&&(!this._windows[0].owner||!this.fs.arePathsSame(this._windows[0].owner,e))){this.globalMemento.update(Aee,!0).then(y,y);let n=[_.interactiveWindowModeBannerSwitchYes,_.interactiveWindowModeBannerSwitchNo];await on.window.showInformationMessage(_.interactiveWindowModeBannerTitle,...n)===n[0]&&(t="perFile",this._windows[0].changeMode(t),await this.configService.updateSetting("interactiveWindow.creationMode",t,e,on.ConfigurationTarget.Global))}return t}_updateWindowCache(){let e=this._windows.map(t=>{var n;return{owner:(n=t.owner)==null?void 0:n.toString(),uriString:t.notebookUri.toString(),inputBoxUriString:t.inputUri.toString()}});this.workspaceMemento.update(Mee,e).then(y,y)}getExisting(e,t,n){return t==="single"?this._windows.length>0?this._windows[0]:void 0:t==="multiple"?e?this.activeWindow||this.lastActiveInteractiveWindow||this._windows[0]:void 0:this._windows.find(i=>{var o;return!e&&!i.owner&&!n?!0:e&&i.owner&&this.fs.arePathsSame(e,i.owner)?!n||((o=i.kernelConnectionMetadata)==null?void 0:o.id)===n.id:!1})}raiseOnDidChangeActiveInteractiveWindow(){this.lastActiveInteractiveWindow=this.activeWindow?this.activeWindow:this.lastActiveInteractiveWindow,this._onDidChangeActiveInteractiveWindow.fire(this.activeWindow)}onInteractiveWindowClosed(e){var t;q(`Closing interactive window: ${(t=e.notebookUri)==null?void 0:t.toString()}`),e.dispose(),this._windows=this._windows.filter(n=>n!==e),this._updateWindowCache(),this.lastActiveInteractiveWindow===e&&(this.lastActiveInteractiveWindow=this._windows[0]),this.raiseOnDidChangeActiveInteractiveWindow()}getActiveOrAssociatedInteractiveWindow(){if(this.activeWindow)return this.activeWindow;if(on.window.activeTextEditor===void 0)return;let e=on.window.activeTextEditor.document.uri;if(e.scheme!==Ip)return this.get(e)}findNotebookEditor(e){var n,i;let t;if(e&&e.path.endsWith(".interactive"))t=(n=this.get(e))==null?void 0:n.notebookDocument;else{let o=this.configService.getSettings(e).interactiveWindowMode;t=(i=this.getExisting(e,o))==null?void 0:i.notebookDocument}return t?on.window.visibleNotebookEditors.find(o=>o.notebook===t):void 0}findAssociatedNotebookDocument(e){let t=this._windows.find(i=>{var o;return((o=i.inputUri)==null?void 0:o.toString())===e.toString()});return t==null?void 0:t.notebookDocument}getInteractiveWindowWithNotebook(e){let t;return e!==void 0?t=this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e.toString()}):t=this.getActiveOrAssociatedInteractiveWindow(),t}getInteractiveWindowsWithSubmitter(e){return this._windows.filter(t=>t.submitters.find(n=>this.fs.arePathsSame(e,n)))}};L_=E([(0,Cs.injectable)(),b(0,(0,Cs.inject)(jr)),b(1,(0,Cs.inject)(oe)),b(2,(0,Cs.inject)(Tt)),b(3,(0,Cs.inject)(Ke)),b(4,(0,Cs.inject)(wt)),b(4,(0,Cs.named)(ur)),b(5,(0,Cs.inject)(wt)),b(5,(0,Cs.named)(Ts)),b(6,(0,Cs.inject)(Ho)),b(7,(0,Cs.inject)(MM))],L_);d();var F_=z(re());d();var Ja=require("vscode");var jM=class{constructor(e,t,n,i){this.configService=e;this.storage=t;this.notebook=n;this.executionCount=0;this.cellIndexesCounted={};this.disposables=[];i.push(this),Ja.workspace.onDidChangeTextDocument(this.onChangedDocument,this,this.disposables),Ja.notebooks.onDidChangeNotebookCellExecutionState(this.onDidCellStateChange,this,this.disposables)}dispose(){this.disposed||(this.disposed=!0,this.storage.clear(),this.disposables.forEach(e=>e.dispose()))}reset(){this.storage.clear(),this.executionCount=0}async generateCode(e,t,n,i){let{executableLines:o}=this.extractExecutableLines(e);if(this.executionCount+=1,this.cellIndexesCounted[t]=!0,o.length>0&&o.find(s=>s.trim().length>0))return this.generateCodeImpl(e,this.executionCount,n,i)}extractExecutableLines(e){let t=e.interactive.originalSource,n=this.configService.getSettings(this.notebook.uri),i=new qo(n),o=cI(t);if(n.magicCommandsAsComments&&o.forEach((s,a)=>o[a]=UM(s)),e.interactiveWindowCellMarker&&o.length&&o[0].trim()===e.interactiveWindowCellMarker.trim()){let s=o.slice(1).filter(a=>a.trim().length>0);if(s.length>0&&s[0].trim().startsWith("%%")){let a=o.slice(o.indexOf(s[0]));return{lines:a,executableLines:a}}}return o.length>0&&(i.isCode(o[0])||i.isMarkdown(o[0]))?{lines:o,executableLines:o.slice(1)}:{lines:o,executableLines:o}}onDidCellStateChange(e){var t;e.cell.notebook!==this.notebook||!((t=e.cell.executionSummary)!=null&&t.executionOrder)||this.cellIndexesCounted[e.cell.index]||(this.executionCount+=1,this.cellIndexesCounted[e.cell.index]=!0)}async generateCodeImpl(e,t,n,i){let{lineIndex:o,uristring:s}=e.interactive,a=Ja.workspace.textDocuments.find(ne=>ne.uri.toString()===s);if(!a)return;let{stripped:l,trueStartLine:c}=this.extractStrippedLines(e),u=a.lineAt(c),p=a.lineAt(Math.min(c+l.length-1,a.lineCount-1)),f=0;for(;f<l.length&&l[f].trim().length===0;)f+=1;let m=f+c,h=a.offsetAt(new Ja.Position(o,0)),g=a.offsetAt(p.rangeIncludingLineBreak.end),v=(e.interactiveWindowCellMarker||"").length>0,{runtimeLine:I,debuggerStartLine:S}=this.addHiddenLines(n,l,c,m,v,i),x=l.join(""),D=a.getText(new Ja.Range(new Ja.Position(o,0),p.rangeIncludingLineBreak.end)),A=(await ol(x,"SHA-1")).substring(0,12),w=this.getRuntimeFile(A,t),R=n?-1:0,j={line:u?u.lineNumber+1:1,endLine:p?p.lineNumber+1:1,firstNonBlankLineIndex:m,debuggerStartLine:S,executionCount:t,startOffset:h,endOffset:g,deleted:!1,code:x,trimmedRightCode:l.map(ne=>ne.replace(/[ \t\r]+\n$/g,`
`)).join(""),realCode:D,runtimeLine:I,runtimeFile:w,id:e.id,timestamp:Date.now(),lineOffsetRelativeToIndexOfFirstLineInCell:R,hasCellMarker:v};return De(`Generated code for ${t} = ${w} with ${l.length} lines`),this.storage.store(Ja.Uri.parse(e.interactive.uristring),j),j}getRuntimeFile(e,t){return`<ipython-input-${t}-${e}>`}onChangedDocument(e){let t=this.storage.getFileGeneratedCode(e.document.uri);if(t){let n=e.document.getText();e.contentChanges.forEach(i=>{this.handleContentChange(n,i,t)})}}extractStrippedLines(e){let t=cI(e.interactive.originalSource),{lines:n}=this.extractExecutableLines(e),i=e.interactive.lineIndex+1;if(!e.interactiveWindowCellMarker){i=e.interactive.lineIndex;for(let l=0;l<n.length;l+=1)if(n[l]!==t[l]){i+=l+1;break}}let o=0;for(;o<n.length&&n[o].trim().length===0;)o+=1;let s=n.length-1,a=n.length-2;for(;a>0;){let l=n[s],c=n[a];if((l.length===0||l===`
`)&&(c.length===0||c===`
`))n.splice(s,1),s-=1,a-=1;else break}!n[s].endsWith(`
`)&&n[s].length>0&&(n[s]=`${n[s]}
`);for(let l=0;l<n.length;l++)n[l]=n[l].replace(/\r\n/g,`
`);return{stripped:n,trueStartLine:i}}handleContentChange(e,t,n){let i=t.range.start.line-t.range.end.line+t.text.split(`
`).length-1,o=t.text.length-t.rangeLength,s=t.rangeLength<=0?t.rangeOffset:t.rangeOffset+t.rangeLength-1;n.forEach(a=>{a.endOffset<t.rangeOffset||(a.startOffset>s?(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.startOffset===s?a.deleted||t.rangeLength>0||i===0?a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode:(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode)})}addHiddenLines(e,t,n,i,o,s){let a=s||this.configService.getSettings(void 0).forceIPyKernelDebugger===!0;return e&&this.configService.getSettings(this.notebook.uri).stopOnFirstLineWhileDebugging?a?(t.splice(0,0,`breakpoint()
`),{runtimeLine:1,debuggerStartLine:n+1}):(t.splice(0,0,`breakpoint()
`),{runtimeLine:2,debuggerStartLine:n}):{runtimeLine:1,debuggerStartLine:o?i:i+1}}};var Oee=require("vscode");var K_=class{constructor(e,t,n){this.configService=e;this.storageFactory=t;this.disposables=n;this.codeGenerators=new WeakMap}activate(){Oee.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebook,this,this.disposables)}getOrCreate(e){let t=this.get(e);if(t)return t;let n=new jM(this.configService,this.storageFactory.getOrCreate(e),e,this.disposables);return this.codeGenerators.set(e,n),n}get(e){return this.codeGenerators.get(e)}onDidCloseNotebook(e){var t;(t=this.codeGenerators.get(e))==null||t.dispose(),this.codeGenerators.delete(e)}};K_=E([(0,F_.injectable)(),b(0,(0,F_.inject)(Ke)),b(1,(0,F_.inject)(Ba)),b(2,(0,F_.inject)(oe))],K_);d();var Lee=z(re()),Kee=require("vscode");d();var BM=class{constructor(){this.codeGeneratorsByFile=new Tu}clear(){this.codeGeneratorsByFile.clear()}get all(){return[...this.codeGeneratorsByFile.entries()].map(e=>({uri:e[0],generatedCodes:e[1].filter(t=>!t.deleted)})).filter(e=>e.generatedCodes.length>0)}getFileGeneratedCode(e){return this.codeGeneratorsByFile.get(e)||[]}store(e,t){let n=this.codeGeneratorsByFile.get(e)||[],i=!1;for(let o=0;o<n.length&&!i;o+=1){let s=n[o];t.line>=s.line&&t.line<=s.endLine?(n.splice(o,1,t),i=!0):s.line>t.line&&(n.splice(o,0,t),i=!0)}i||n.push(t),this.codeGeneratorsByFile.set(e,n)}};var U_=class{constructor(){this.storages=new WeakMap}getOrCreate(e){return this.storages.has(e)||this.storages.set(e,new BM),this.storages.get(e)}get(e){if("notebook"in e)return this.storages.get(e.notebook);{let t=Kee.workspace.notebookDocuments.find(n=>{let i=this.storages.get(n);return i==null?void 0:i.all.find(o=>o.uri.toString()===e.fileUri.toString())});return t?this.storages.get(t):void 0}}};U_=E([(0,Lee.injectable)()],U_);d();var Rm=z(re());var W_=class{constructor(e,t,n,i,o){this.kernelProvider=e;this.codeGeneratorFactory=n;this.storageFactory=i;this.controllers=o;this.disposables=[];t.push(this)}dispose(){he(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.controllers.onControllerSelected(this.onNotebookControllerSelected,this,this.disposables)}onNotebookControllerSelected({notebook:e}){var t,n;(t=this.storageFactory.get({notebook:e}))==null||t.clear(),(n=this.codeGeneratorFactory.get(e))==null||n.reset()}onDidCreateKernel(e){var n;let t=e.notebook;e.creator!=="jupyterExtension"||t.notebookType!==St||((n=this.storageFactory.get({notebook:t}))==null||n.clear(),e.onRestarted(()=>{var i;(i=this.storageFactory.get({notebook:t}))==null||i.clear(),this.codeGeneratorFactory.getOrCreate(t).reset()},this,this.disposables))}};W_=E([(0,Rm.injectable)(),b(0,(0,Rm.inject)($e)),b(1,(0,Rm.inject)(oe)),b(2,(0,Rm.inject)(N_)),b(3,(0,Rm.inject)(Ba)),b(4,(0,Rm.inject)(Ht))],W_);d();var j_=z(re()),bte=require("vscode");var yte=vte(),JM=/(;32m[ ->]*?)(\d+)(.*)/g,V_=class{constructor(e,t,n){this.storageFactory=e;this.platformService=t;this.configurationService=n}format(e,t){var a;if(e.notebook.notebookType!==St)return t;let n=this.storageFactory.get({notebook:e.notebook}),i=t.some(l=>/^[Input|Cell|File].*?\n.*/.test(l));if(!i&&!n)return t;let o=this.configurationService.getSettings(e.document.uri),s=(a=o==null?void 0:o.formatStackTraces)!=null?a:!1;return t.map(l=>i?this.modifyTracebackFrameIPython8(l,n==null?void 0:n.all,s):s?this.modifyTracebackFrameIPython7(l,n.all):l)}modifyTracebackFrameIPython8(e,t,n){var u,p,f,m,h;e=e.replace(/\u001b\[4\dm/g,""),e=e.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),e=e.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(g,v,I,S)=>(S=S.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${v}${I}${S}
`)),Ie(`Trace frame to match: ${e}`);let i,o,s=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,l=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\].*line: (?<lineNumber>\d).*/.exec(e),c=s.exec(e);if(l&&((u=l.groups)!=null&&u.executionCount)&&((p=l.groups)!=null&&p.lineNumber)?(i=parseInt(l.groups.executionCount),o=(f=l.groups)==null?void 0:f.lineNumber):c&&((m=c.groups)!=null&&m.executionCount)&&((h=c.groups)!=null&&h.lineNumber)&&(i=parseInt(c.groups.executionCount),o=c.groups.lineNumber),t&&i){let g,v;for(let I of t)if(v=I.generatedCodes.find(S=>S.executionCount===i),v){g=I.uri;break}if(v&&g){let I=e;return n&&(I=I.replace(JM,(S,x,D,A)=>{let w=parseInt(D,10),ne=(v.hasCellMarker?v.line-1:v.line)-1+v.lineOffsetRelativeToIndexOfFirstLineInCell+w;return`${x}<a href='${g==null?void 0:g.toString()}?line=${ne-1}'>${ne}</a>${A}`})),I.replace(/.*?\n/,`File \x1B[1;32m${pt(g)}:${o}\x1B[0m
`)}}if(n){let g=/^File.*?\[\d;32m(.*):\d+.*\u001b.*\n/.exec(e);if(g&&g.length>1){let v=CP(g[1],pt(this.platformService.homeDir)),I=bte.Uri.file(v);return e.replace(JM,(S,x,D,A)=>{let w=parseInt(D,10);return`${x}<a href='${I==null?void 0:I.toString()}?line=${w-1}'>${w}</a>${A}`})}}return e}modifyTracebackFrameIPython7(e,t){return t.map(i=>i.uri).forEach(i=>{let o=pt(i),s=Se(i),a=this.storageFactory.get({fileUri:i});if(a){if(e.includes(o)&&new RegExp(`\\[.*?;32m${yte(o)}`).test(e)||e.includes(s)&&new RegExp(`\\[.*?;32m${yte(s)}`).test(e)){let l="",c=/(;32m[ ->]*?)(\d+)(.*)/g;for(let p=c.exec(e);p&&p.length>3;p=c.exec(e)){let f=Pu(p[3]).substr(1);l=`${l}${f}
`}let u=this.findCellOffset(a.getFileGeneratedCode(i),l);u!==void 0&&(e=e.replace(JM,(p,f,m,h)=>{let g=parseInt(m,10),v=u+g-1;return`${f}<a href='${i.toString()}?line=${v}'>${v+1}</a>${h}`}))}if(e.includes(o)){let l=this.findCellOffset(a.getFileGeneratedCode(i),e);if(l)return e.replace(JM,(c,u,p,f)=>{let m=parseInt(p,10),h=l+m-1;return`${u}<a href='${i.toString()}?line=${h}'>${h+1}</a>${f}`})}}}),e}findCellOffset(e,t){if(e){for(let n of e)if(n.trimmedRightCode.indexOf(t)>=0)return n.firstNonBlankLineIndex}}};V_=E([(0,j_.injectable)(),b(0,(0,j_.inject)(Ba)),b(1,(0,j_.inject)(bs)),b(2,(0,j_.inject)(Ke))],V_);d();var Lu=z(re()),Am=require("vscode");d();function Ite(r){let e={source:{path:pt(r.uri)},pydevdSourceMaps:[]};return e.pydevdSourceMaps=r.generatedCodes.map(t=>({line:t.debuggerStartLine,endLine:t.endLine,runtimeSource:{path:t.runtimeFile},runtimeLine:t.runtimeLine})),e}d();var qM=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;this._ready=Me();this.ready=this._ready.promise;J("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){q(`[Debug-IW] ${e}: ${t}`)}async willSendEvent(e){return m9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&TD(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){let t=uc(this.debugCell);e.command==="setBreakpoints"&&t&&t.generatedCode&&!this.cellDumpInvoked&&(this.debugCellDumped||(this.debugCellDumped=Sv(this.execution,this.debugAdapter)),await this.debugCellDumped),e.command==="configurationDone"&&t&&t.generatedCode&&(this.debugCellDumped||(this.debugCellDumped=Sv(this.execution,this.debugAdapter)),await this.debugCellDumped,this._ready.resolve())}};d();var GM=class extends m_{constructor(){super(...arguments);this._ready=Me();this.ready=this._ready.promise}resolve(){this._ready.resolve()}};d();var S9=require("vscode");var YM=class extends g_{constructor(t,n,i,o,s,a,l){super(t,n,i,o,s,a);this.cellToDebugFileSortedInReverseOrderByLineNumber=[];l&&(this.debugLocationTracker=l.createDebugAdapterTracker(t),this.debugLocationTracker.onWillStartSession&&this.debugLocationTracker.onWillStartSession(),this.onDidSendMessage(c=>{var u;(u=this.debugLocationTracker)!=null&&u.onDidSendMessage&&this.debugLocationTracker.onDidSendMessage(c)},this,this.disposables),this.onDidEndSession(()=>{var c;(c=this.debugLocationTracker)!=null&&c.onWillStopSession&&this.debugLocationTracker.onWillStopSession()},this,this.disposables))}handleClientMessageAsync(t){var n,i;return Ie(`KernelDebugAdapter::handleMessage ${JSON.stringify(t,void 0," ")}`),t.type==="request"&&((n=this.debugLocationTracker)!=null&&n.onWillReceiveMessage)&&this.debugLocationTracker.onWillReceiveMessage(t),t.type==="response"&&((i=this.debugLocationTracker)!=null&&i.onDidSendMessage)&&this.debugLocationTracker.onDidSendMessage(t),super.handleClientMessageAsync(t)}async dumpCell(t){var o,s;let n=this.notebookDocument.cellAt(t),i=uc(n);if(!i)throw new Error("Not an interactive window cell");try{let a=(((o=i.generatedCode)==null?void 0:o.code)||n.document.getText()).replace(/\r\n/g,`
`),l=await this.session.customRequest("dumpCell",{code:a}),c=Ps(l.sourcePath);this.fileToCell.set(c,S9.Uri.parse(i.interactive.uristring));let u=0;i.generatedCode&&!i.generatedCode.hasCellMarker&&(u=i.generatedCode.firstNonBlankLineIndex),this.cellToDebugFileSortedInReverseOrderByLineNumber.push({debugFilePath:c,interactiveWindow:S9.Uri.parse(i.interactive.uristring),metadata:i,lineOffset:u+i.interactive.lineIndex+(((s=i.generatedCode)==null?void 0:s.lineOffsetRelativeToIndexOfFirstLineInCell)||0)}),this.cellToDebugFileSortedInReverseOrderByLineNumber.sort((p,f)=>f.metadata.interactive.lineIndex-p.metadata.interactive.lineIndex)}catch(a){O(`Failed to dump cell for ${n.index} with code ${i.interactive.originalSource}`,a)}}translateDebuggerLocationToRealLocation(t,n){var o;if(n=(o=t==null?void 0:t.source)!=null?o:n,!n||!n.path)return;let i=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(s=>s.debugFilePath===n.path);i&&(n.name=sr(i.interactiveWindow.path),n.path=i.interactiveWindow.toString(),typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine+(i.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line+(i.lineOffset||0)))}translateRealLocationToDebuggerLocation(t,n){var s;let i=t.line;if(n=(s=t==null?void 0:t.source)!=null?s:n,!n||!n.path||typeof i!="number")return;let o=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(a=>i>=a.metadata.interactive.lineIndex+1);!o||o.interactiveWindow.path!==n.path||(n.path=o.debugFilePath,typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine-(o.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line-(o.lineOffset||0)))}async sendRequestToJupyterSession(t){var n,i;if(t.command==="setBreakpoints"){let o=t.arguments;if(delete o.lines,o.source.path!==((n=this.cellToDebugFileSortedInReverseOrderByLineNumber[0])==null?void 0:n.interactiveWindow.path))return super.sendRequestToJupyterSession(t);let s,a=[],l=[],c=()=>{if(a.length){let f=JSON.parse(JSON.stringify(t));f.arguments.breakpoints=a,l.push(super.sendRequestToJupyterSession(f))}};for(let f of(i=t.arguments.breakpoints)!=null?i:[]){let m=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(h=>f.line>=h.metadata.generatedCode.line&&f.line<=h.metadata.generatedCode.endLine);if(m&&m.metadata.interactive.lineIndex!==s)c(),s=m.metadata.interactive.lineIndex,a=[f];else if(m)a.push(f);else{let h={...f,verified:!0};l.push(Promise.resolve({body:{breakpoints:[h]}}))}}c();let u=await Promise.all(l),p=JSON.parse(JSON.stringify(u[0]));return u.slice(1).forEach(f=>{var m;p.body.breakpoints=p.body.breakpoints.concat((m=f.body.breakpoints)!=null?m:[])}),p.command="setBreakpoints",p.type="response",p.success=!0,p.request_seq=t.seq,p}return super.sendRequestToJupyterSession(t)}getDumpFilesForDeletion(){return this.cellToDebugFileSortedInReverseOrderByLineNumber.map(t=>t.debugFilePath)}};d();var Ste=require("vscode");var $M=class{constructor(e){this.debugCell=e}trace(e,t){q(`[Debug-IWRestart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Showing warning for unsupported restart request"),Ste.window.showWarningMessage(_.restartNotSupported,{modal:!0}).then(y,y),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};var B_=class extends h_{constructor(t,n,i,o,s,a,l){super(t,n,l);this.platform=i;this.debugLocationTrackerFactory=o;this.configService=s;this.debugService=a}activate(){super.activate(),this.disposables.push(Am.debug.registerDebugAdapterDescriptorFactory($L,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){return 2}async start(t,n){Ie("Starting debugging IW"),await this.checkIpykernelAndPrompt(n)===1&&await this.startDebuggingCell(t,n)}async startDebuggingCell(t,n){let i=this.configService.getSettings(t.uri),o={type:$L,name:sr(t.uri.toString()),request:"attach",justMyCode:i.debugJustMyCode,__notebookUri:t.uri.toString(),__mode:2,__cellIndex:n.index},s={suppressSaveBeforeStart:!0};await this.startDebuggingConfig(o,s);let a=this.notebookToDebugger.get(t);if(!a){O("Debugger not found, could not start debugging.");return}await a.ready}async createDebugAdapterDescriptor(t){let n=t.configuration;pee(n);let i=Am.workspace.notebookDocuments.find(s=>s.uri.toString()===n.__notebookUri);if(!i||typeof n.__cellIndex!="number"){O("Invalid debug session for debugging of IW using Jupyter Protocol");return}if(this.notebookInProgress.has(i)){De("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(i)){De("Cannot start debugging. Already debugging this notebook document. Toolbar should update");return}let o=new GM(i,n,t);this.notebookToDebugger.set(i,o);try{return this.notebookInProgress.add(i),await this.doCreateDebugAdapterDescriptor(n,t,i,o)}finally{this.notebookInProgress.delete(i)}}async doCreateDebugAdapterDescriptor(t,n,i,o){let s=await this.ensureKernelIsRunning(i);if(!(s!=null&&s.session)){Am.window.showInformationMessage(_.kernelWasNotStarted).then(y,y);return}let a=new YM(n,i,s.session,s,this.platform,this.debugService,this.debugLocationTrackerFactory);this.disposables.push(a.onDidEndSession(this.endSession.bind(this)));let l=i.cellAt(t.__cellIndex),c=new qM(a,l,this.kernelProvider.getKernelExecution(s));return a.addDebuggingDelegates([c,new $M(l)]),c.ready.then(()=>o.resolve()).catch(u=>console.error("Failed waiting for controller to be ready",u)),this.trackDebugAdapter(i,a),new Am.DebugAdapterInlineImplementation(a)}async updateSourceMaps(t,n){let i=this.getDebugSession(t.notebook);i&&(Ie("Sending debug request for source map"),await Promise.all(n.map(async o=>{if(i)return i.customRequest("setPydevdSourceMap",Ite(o))})))}};B_=E([(0,Lu.injectable)(),b(0,(0,Lu.inject)($e)),b(1,(0,Lu.inject)(Ht)),b(2,(0,Lu.inject)(bs)),b(3,(0,Lu.inject)(pM)),b(4,(0,Lu.inject)(Ke)),b(5,(0,Lu.inject)(ho)),b(6,(0,Lu.inject)(jr))],B_);d();var Tv=z(re()),_te=require("vscode");var H_=class{constructor(e,t,n,i){this.configService=e;this.fs=t;this.context=n;this.registry=i;this.priority=5}activate(){this.registry.register(this,St)}async getCode(e){var t;if(!Qt(e.kernelConnectionMetadata))return[];if(!Tn()){if(this.configService.getSettings(void 0).forceIPyKernelDebugger===!0)return[];if(!or(e.kernelConnectionMetadata))return[]}if(((t=e.notebook)==null?void 0:t.notebookType)===St){if(!or(e.kernelConnectionMetadata))return[];this.addRunCellHookContents||(this.addRunCellHookContents=this.fs.readFile(_te.Uri.joinPath(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","kernel","addRunCellHook.py")));let n=await this.addRunCellHookContents;return dt(n,{trim:!1})}return[]}};H_=E([(0,Tv.injectable)(),b(0,(0,Tv.inject)(Ke)),b(1,(0,Tv.inject)(Tt)),b(2,(0,Tv.inject)(ut)),b(3,(0,Tv.inject)(Hd))],H_);d();var q_=z(re()),G_=require("vscode");var J_=class{constructor(e,t,n){this.dataScienceCodeLensProvider=e;this.extensionContext=t;this.configurationService=n}activate(){this.configurationService.getSettings().pythonCellFolding&&this.extensionContext.subscriptions.push(G_.languages.registerFoldingRangeProvider([aP],this))}provideFoldingRanges(e,t,n){if([Ip,lP].includes(e.uri.scheme))return;let i=this.dataScienceCodeLensProvider.getCodeWatcher(e);if(i){let o=i.getCodeLenses();return n.isCancellationRequested||o.length==0?void 0:o.map(s=>new G_.FoldingRange(s.range.start.line,s.range.end.line,G_.FoldingRangeKind.Region))}}};J_=E([(0,q_.injectable)(),b(0,(0,q_.inject)(Tm)),b(1,(0,q_.inject)(ut)),b(2,(0,q_.inject)(Ke))],J_);d();var BD=z(re());var Ete=require("vscode");var Y_=class{constructor(e,t){this.dataScienceCodeLensProvider=e;this.extensionContext=t}activate(){this.extensionContext.subscriptions.push(Ete.languages.registerCodeLensProvider([aP],this.dataScienceCodeLensProvider))}};Y_=E([(0,BD.injectable)(),b(0,(0,BD.inject)(Tm)),b(1,(0,BD.inject)(ut))],Y_);d();var qa=z(re());var _9="LastInteractiveKernelSelected",$_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.interpreterService=t;this.disposables=n;this.workspaceMemento=i;this.serviceContainer=o;this.onControllerSelected=this.controllerRegistration.onControllerSelected}async getInitialController(e,t){if(t){let n=this.controllerRegistration.get(t,St);if(n)return n}if(this.workspaceMemento.get(_9)){let n=this.workspaceMemento.get(_9),i=n?this.controllerRegistration.get(n,St):void 0;if(i)return i}if(this.interpreterService)return await hCe(St,e,this.interpreterService,this.controllerRegistration)}getSelectedController(e){return this.controllerRegistration.getSelected(e)}getRegisteredController(e){return this.controllerRegistration.get(e,"interactive")}async createKernel(e,t,n,i,o){await Wa(n,e);let s=(u,p)=>{u!=="start"&&u!=="restart"||Ie(`(onStart) Looking for controller ${p.controller.id} in ${this.controllerRegistration.all.map(f=>`${f.kind}:${f.id}`).join(", ")}`)},a=await Va.connectToNotebookKernel(e,this.serviceContainer,{resource:n||i.uri,notebook:i,controller:t},new Er(!1),o,"jupyterExtension",s),l=this.controllerRegistration.registered.find(u=>u.id===a.controller.id);if(!l)throw Error(`Controller ${a.controller.id} not found or not yet created`);let c=l.controller;return this.interpreterService&&gCe(a.kernelConnectionMetadata,n,this.interpreterService).then(async u=>{await this.workspaceMemento.update(_9,u?void 0:a.kernelConnectionMetadata)}).catch(u=>{ue("Failed to store kernel connection metadata",u)}),{kernel:a,actualController:c}}};$_=E([(0,qa.injectable)(),b(0,(0,qa.inject)(Ht)),b(1,(0,qa.inject)(pm)),b(1,(0,qa.optional)()),b(2,(0,qa.inject)(oe)),b(3,(0,qa.inject)(wt)),b(3,(0,qa.named)(Ts)),b(4,(0,qa.inject)(jr))],$_);async function hCe(r,e,t,n){let i=await t.getActiveInterpreter(e);if(i){let o=await Hx(i),s=Wx.create({kernelSpec:o,interpreter:i,id:$R(o,i)}),a=n.addOrUpdate(s,[r]),l=a[0];return n.trackActiveInterpreterControllers(a),Ie(`Active Interpreter Controller ${l.connection.kind}:${l.id} created for View ${r} with resource ${Se(e)}`),l}}async function gCe(r,e,t){var i;let n=await t.getActiveInterpreter(e);return(n==null?void 0:n.id)===((i=r.interpreter)==null?void 0:i.id)}function Cte(r){r.addSingleton(_s,L_),r.addSingleton(MM,$_),r.addSingleton(He,Es),r.add(RM,cr),r.addSingleton(AM,R_),r.addSingleton(Tm,A_),r.addSingleton(He,Y_),r.addSingleton(He,J_),r.addSingleton(He,M_),r.addSingleton(He,W_),r.addSingleton(N_,K_,void 0,[He]),r.addSingleton(Ba,U_),r.addSingleton(EI,V_),r.addSingleton(OM,B_,void 0,[He]),r.addSingleton(He,H_)}d();d();var wte=z(re());d();var yo=require("vscode");var zM=class{async normalizeLines(e,t){return e}async getFileToExecute(){let e=yo.window.activeTextEditor;if(!e){yo.window.showErrorMessage("No open file to run in terminal").then(y,y);return}if(e.document.isUntitled){yo.window.showErrorMessage("The active file needs to be saved before it can be run").then(y,y);return}if(e.document.languageId!==Qe){yo.window.showErrorMessage("The active file is not a Python source file").then(y,y);return}return e.document.isDirty&&await e.document.save(),e.document.uri}getSelectedTextToExecute(e){if(!e)return;let t=e.selection,n;return t.isEmpty?n=e.document.lineAt(t.start.line).text:t.isSingleLine?n=this.getSingleLineSelectionText(e):n=this.getMultiLineSelectionText(e),Gv(n.trimEnd())}async saveFileIfDirty(e){let t=yo.workspace.textDocuments.filter(n=>n.uri.path===e.path);t.length===1&&t[0].isDirty&&await t[0].save()}getSingleLineSelectionText(e){let t=e.selection,n=new yo.Range(t.start,t.end),i=e.document.getText(n),o=e.document.lineAt(t.start.line).text;return i.trim()===o.trim()?o:i}getMultiLineSelectionText(e){let t=e.selection,n=new yo.Range(t.start,t.end),i=e.document.getText(n),o=new yo.Range(new yo.Position(t.start.line,0),new yo.Position(t.end.line,e.document.lineAt(t.end.line).text.length)),s=e.document.getText(o);if(i.trim()===s.trim())return s;let a=e.document.lineAt(t.start.line).text,l=new yo.Range(t.start,new yo.Position(t.start.line,a.length)),c=e.document.getText(l);return c.trimStart()===a.trimStart()?a+i.substring(c.length):i}};var z_=class extends zM{};z_=E([(0,wte.injectable)()],z_);function xte(r){r.addSingleton(VM,z_)}d();d();var Ga=z(re());d();var na=require("vscode");var QM=class{constructor(e,t,n,i,o,s){this.fileConverter=e;this.fs=t;this.interactiveProvider=n;this.controllerRegistration=i;this.preferredKernel=o;this.kernelFinder=s;this.disposables=[]}register(){this.registerCommand(X.ExportAsPythonScript,(e,t)=>this.export(e,"python",void 0,t)),this.registerCommand(X.ExportToHTML,(e,t,n)=>this.export(e,"html",t,n)),this.registerCommand(X.ExportToPDF,(e,t,n)=>this.export(e,"pdf",t,n)),this.registerCommand(X.Export,(e,t,n)=>this.export(e,void 0,t,n)),this.registerCommand(X.NativeNotebookExport,e=>this.nativeNotebookExport(e))}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommand(e,t){let n=na.commands.registerCommand(e,t,this);this.disposables.push(n)}async nativeNotebookExport(e){var i,o,s;let t=kn(e)?e:(i=e==null?void 0:e.notebookEditor)==null?void 0:i.notebookUri,n=t?na.workspace.notebookDocuments.find(a=>this.fs.arePathsSame(a.uri,t)):(o=na.window.activeNotebookEditor)==null?void 0:o.notebook;if(n){let a,l=this.kernelFinder.registered.find(p=>p.kind==="localPythonEnvironment"),c=new na.CancellationTokenSource;try{a=l?await this.preferredKernel.findPreferredLocalKernelSpecConnection(n,l,c.token).then(p=>p==null?void 0:p.interpreter):void 0}finally{c.dispose()}let u=((s=this.controllerRegistration.getSelected(n))==null?void 0:s.connection.interpreter)||a;return this.export(n,void 0,void 0,u)}else return this.export(void 0,void 0,void 0,void 0)}async export(e,t,n,i){var o,s,a,l;if(!e){if(e=((o=na.window.activeNotebookEditor)==null?void 0:o.notebook)||((a=(s=this.interactiveProvider)==null?void 0:s.getActiveOrAssociatedInteractiveWindow())==null?void 0:a.notebookDocument),!e){De("Export called without a valid exportable document active");return}i=i||((l=this.controllerRegistration.getSelected(e))==null?void 0:l.connection.interpreter),t&&J("DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",void 0,{format:t})}if(t)await this.fileConverter.export(t,e,n,i);else{let c=await this.showExportQuickPickMenu(e,n,i).then(u=>u);c!==void 0?c.handler():J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK")}}getExportQuickPickItems(e,t,n){let i=[];return(n||e.metadata&&GR(Ma(e)))&&i.push({label:_.exportPythonQuickPickLabel,picked:!0,handler:()=>{J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"python"}),na.commands.executeCommand(X.ExportAsPythonScript,e,n).then(y,y)}}),i.push({label:_.exportHTMLQuickPickLabel,picked:!1,handler:()=>{J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"html"}),na.commands.executeCommand(X.ExportToHTML,e,t,n).then(y,y)}},{label:_.exportPDFQuickPickLabel,picked:!1,handler:()=>{J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"pdf"}),na.commands.executeCommand(X.ExportToPDF,e,t,n).then(y,y)}}),i}async showExportQuickPickMenu(e,t,n){let i=this.getExportQuickPickItems(e,t,n),o={ignoreFocusOut:!1,matchOnDescription:!0,matchOnDetail:!0,placeHolder:_.exportAsQuickPickPlaceholder};return na.window.showQuickPick(i,o)}};var XM=require("vscode");var Q_=class{constructor(e,t,n,i,o,s,a){this.disposables=e;this.fileConverter=t;this.fs=n;this.interactiveProvider=i;this.controllerSelection=o;this.kernelFinder=s;this.jupyterConnection=a;this.exportCommand=new QM(this.fileConverter,this.fs,this.interactiveProvider,o,new l_(a),s),XM.workspace.isTrusted||XM.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){var e;XM.workspace.isTrusted&&((e=this.exportCommand)==null||e.register())}};Q_=E([(0,Ga.injectable)(),b(0,(0,Ga.inject)(oe)),b(1,(0,Ga.inject)(I_)),b(2,(0,Ga.inject)(Tt)),b(3,(0,Ga.inject)(_s)),b(3,(0,Ga.optional)()),b(4,(0,Ga.inject)(Ht)),b(5,(0,Ga.inject)(di)),b(6,(0,Ga.inject)(bn))],Q_);d();var Ku=z(re()),bo=require("vscode");var X_=class{constructor(e,t,n,i,o){this.interactiveProvider=e;this.kernelProvider=n;this.controllers=i;this.jupyterUriProviderRegistration=o;this.disposables=[];this.isPythonFileActive=!1;t.push(this),this.nativeContext=new br(Cr.IsNativeActive),this.canRestartNotebookKernelContext=new br(Cr.CanRestartNotebookKernel),this.canInterruptNotebookKernelContext=new br(Cr.CanInterruptNotebookKernel),this.canRestartInteractiveWindowKernelContext=new br(Cr.CanRestartInteractiveWindowKernel),this.canInterruptInteractiveWindowKernelContext=new br(Cr.CanInterruptInteractiveWindowKernel),this.interactiveContext=new br(Cr.IsInteractiveActive),this.interactiveOrNativeContext=new br(Cr.IsInteractiveOrNativeActive),this.pythonOrNativeContext=new br(Cr.IsPythonOrNativeActive),this.pythonOrInteractiveContext=new br(Cr.IsPythonOrInteractiveActive),this.pythonOrInteractiveOrNativeContext=new br(Cr.IsPythonOrInteractiveOrNativeActive),this.hasNativeNotebookCells=new br(Cr.HaveNativeCells),this.isPythonNotebook=new br(Cr.IsPythonNotebook),this.isJupyterKernelSelected=new br(Cr.IsJupyterKernelSelected),this.hasNativeNotebookOrInteractiveWindowOpen=new br(Cr.HasNativeNotebookOrInteractiveWindowOpen),this.kernelSourceContext=new br(Cr.KernelSource)}dispose(){this.disposables.forEach(e=>e.dispose())}activate(){var e;bo.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,this.disposables),this.kernelProvider.onKernelStatusChanged(this.onDidKernelStatusChange,this,this.disposables),this.interactiveProvider&&(this.interactiveProvider.onDidChangeActiveInteractiveWindow(this.onDidChangeActiveInteractiveWindow,this,this.disposables),this.interactiveProvider.activeWindow&&this.onDidChangeActiveInteractiveWindow()),bo.window.activeNotebookEditor&&this.onDidChangeActiveNotebookEditor(bo.window.activeNotebookEditor),bo.window.onDidChangeActiveNotebookEditor(this.onDidChangeActiveNotebookEditor,this,this.disposables),((e=bo.window.activeTextEditor)==null?void 0:e.document.languageId)===Qe&&this.onDidChangeActiveTextEditor(bo.window.activeTextEditor),bo.window.onDidChangeNotebookEditorSelection(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),bo.workspace.onDidOpenNotebookDocument(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),bo.workspace.onDidCloseNotebookDocument(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),this.controllers.onControllerSelectionChanged(()=>this.updateSelectedKernelContext(),this,this.disposables),this.updateSelectedKernelContext()}updateNativeNotebookCellContext(){var t;let e=(((t=bo.window.activeNotebookEditor)==null?void 0:t.notebook.cellCount)||0)>0;this.hasNativeNotebookCells.set(e).catch(y)}onDidChangeActiveInteractiveWindow(e){this.interactiveContext.set(!!e).catch(y),this.updateNativeNotebookInteractiveWindowOpenContext(),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}onDidChangeActiveNotebookEditor(e){let t=e?e.notebook.notebookType===Ct:!1;this.nativeContext.set(t).catch(y),this.isPythonNotebook.set(e&&t?GR(Ma(e.notebook)):!1).catch(y),this.updateContextOfActiveNotebookKernel(e),this.updateContextOfActiveInteractiveWindowKernel(),this.updateNativeNotebookInteractiveWindowOpenContext(),this.updateNativeNotebookCellContext(),this.updateMergedContexts()}updateNativeNotebookInteractiveWindowOpenContext(){this.hasNativeNotebookOrInteractiveWindowOpen.set(bo.workspace.notebookDocuments.some(e=>e.notebookType===Ct||e.notebookType===St)).catch(y)}updateContextOfActiveNotebookKernel(e){let t=e&&e.notebook.notebookType===Ct?this.kernelProvider.get(e.notebook):void 0;if(t){let n=this.kernelProvider.getKernelExecution(t),i=t.status!=="unknown"||n.executionCount>0||t.startedAtLeastOnce;this.canRestartNotebookKernelContext.set(!!i).catch(y);let o=t.status==="busy";this.canInterruptNotebookKernelContext.set(!!o).catch(y)}else this.canRestartNotebookKernelContext.set(!1).catch(y),this.canInterruptNotebookKernelContext.set(!1).catch(y);this.updateKernelSourceContext(t).catch(y),this.updateSelectedKernelContext()}async updateKernelSourceContext(e){if(!e||!Ft(e.kernelConnectionMetadata)){this.kernelSourceContext.set("").catch(y);return}let t=e.kernelConnectionMetadata,n=await this.jupyterUriProviderRegistration.jupyterCollections.find(i=>i.extensionId===t.serverProviderHandle.extensionId&&i.id===t.serverProviderHandle.id);if(!n){this.kernelSourceContext.set("").catch(y);return}this.kernelSourceContext.set(n.id).catch(y)}updateSelectedKernelContext(){var t,n,i;let e=((t=bo.window.activeNotebookEditor)==null?void 0:t.notebook)||((i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument);e&&_r(e)&&this.controllers.getSelected(e)?this.isJupyterKernelSelected.set(!0).catch(y):this.isJupyterKernelSelected.set(!1).catch(y)}updateContextOfActiveInteractiveWindowKernel(){var n,i;let e=(i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument,t=e?this.kernelProvider.get(e):void 0;if(t){let o=t.status!=="unknown";this.canRestartInteractiveWindowKernelContext.set(!!o).catch(y);let s=t.status==="busy";this.canInterruptInteractiveWindowKernelContext.set(!!s).catch(y)}else this.canRestartInteractiveWindowKernelContext.set(!1).catch(y),this.canInterruptInteractiveWindowKernelContext.set(!1).catch(y);this.updateSelectedKernelContext()}onDidKernelStatusChange({kernel:e}){var n;let t=e.notebook;t.notebookType===St?this.updateContextOfActiveInteractiveWindowKernel():t.notebookType===Ct&&t===((n=bo.window.activeNotebookEditor)==null?void 0:n.notebook)&&this.updateContextOfActiveNotebookKernel(bo.window.activeNotebookEditor)}onDidChangeActiveTextEditor(e){this.isPythonFileActive=(e==null?void 0:e.document.languageId)===Qe&&!dB(e.document.uri),this.updateNativeNotebookCellContext(),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}updateMergedContexts(){this.interactiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0).catch(y),this.pythonOrNativeContext.set(this.nativeContext.value===!0||this.isPythonFileActive===!0).catch(y),this.pythonOrInteractiveContext.set(this.interactiveContext.value===!0||this.isPythonFileActive===!0).catch(y),this.pythonOrInteractiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0&&this.isPythonFileActive===!0).catch(y)}};X_=E([(0,Ku.injectable)(),b(0,(0,Ku.inject)(_s)),b(0,(0,Ku.optional)()),b(1,(0,Ku.inject)(oe)),b(2,(0,Ku.inject)($e)),b(3,(0,Ku.inject)(Ht)),b(4,(0,Ku.inject)(mr))],X_);d();var Fu=z(re());var E9=require("vscode");var Z_=class{constructor(e,t,n,i){this.disposableRegistry=e;this.configuration=t;this.rawSupported=n;this.commandListeners=i;this.isDisposed=!1;this.startTime=Date.now();this.onSettingsChanged=()=>{let t=this.configuration.getSettings(void 0).sendSelectionToInteractiveWindow;new br(Cr.OwnsSelection).set(t).catch(y)}}get activationStartTime(){return this.startTime}activate(){this.onSettingsChanged(),this.changeHandler=this.configuration.getSettings(void 0).onDidChange(this.onSettingsChanged.bind(this)),this.disposableRegistry.push(this),this.disposableRegistry.push(E9.window.onDidChangeActiveTextEditor(()=>this.onChangedActiveTextEditor())),this.onChangedActiveTextEditor(),this.computeZmqAvailable(),this.commandListeners&&this.commandListeners.forEach(e=>e.register())}async dispose(){this.changeHandler&&(this.changeHandler.dispose(),this.changeHandler=void 0)}computeZmqAvailable(){new br(Cr.ZmqAvailable).set(this.rawSupported?this.rawSupported.isSupported:!1).then(y,y)}onChangedActiveTextEditor(){let e=new br(Cr.HasCodeCells),t=E9.window.activeTextEditor;t&&t.document.languageId===Qe?e.set(xee(t.document,this.configuration.getSettings())).catch(y):e.set(!1).catch(y)}};Z_=E([(0,Fu.injectable)(),b(0,(0,Fu.inject)(oe)),b(1,(0,Fu.inject)(Ke)),b(2,(0,Fu.inject)(ep)),b(2,(0,Fu.optional)()),b(3,(0,Fu.multiInject)(Zv))],Z_);d();var Mm=z(re()),Uu=require("vscode");var eE=class{constructor(e,t,n){this.jupyterServerHelper=e;this.fileSystem=t;this.errorHandler=n;this.extractPythonMainVersion=async()=>{if(!this.jupyterServerHelper)return 3;let e=await this.jupyterServerHelper.getUsableJupyterPython(),t=await Op(e);return e&&t&&t.major||3}}async exportToFile(e,t,n=!0){let i=await this.serialize(e);try{if(await this.fileSystem.writeFile(Uu.Uri.file(t),i||""),!n)return;let o=_.exportOpenQuestion1;Uu.window.showInformationMessage(_.exportDialogComplete(t),o).then(async s=>{try{s===o&&await KM(Uu.Uri.file(t))}catch(a){await this.errorHandler.handleError(a)}},y)}catch(o){O("Error in exporting notebook file"),Uu.window.showInformationMessage(_.exportDialogFailed(o)).then(y,y)}}async serialize(e,t){var a;let n=await this.extractPythonMainVersion(),i={language_info:{codemirror_mode:{name:"ipython",version:n},file_extension:".py",mimetype:"text/x-python",name:"python",nbconvert_exporter:"python",pygments_lexer:`ipython${n}`,version:n},kernelspec:t},o=(a=Uu.extensions.getExtension("vscode.ipynb"))==null?void 0:a.exports;if(!o)throw new Error("vscode.ipynb extension not found");let s=new Uu.NotebookData(e);return s.metadata=Lg()?{custom:{metadata:i,nbformat:UE.major,nbformat_minor:UE.minor}}:{metadata:i,nbformat:UE.major,nbformat_minor:UE.minor},o.exportNotebook(s)}};eE=E([(0,Mm.injectable)(),b(0,(0,Mm.inject)(r1)),b(0,(0,Mm.optional)()),b(1,(0,Mm.inject)(Tt)),b(2,(0,Mm.inject)(Pn))],eE);d();var Gi=z(re()),ZM=require("vscode");d();var Nv=z(re()),kv=require("vscode");var Pte=require("vscode");var C9="JUPYTER_API_ACCESS_INFORMATION",Dte=new Set([Xe.split(".")[0],"rchiodo","donjayamanne","SynapseVSCode"]),w9=new Set(["rchiodo","nuant"]),fp=class{constructor(e,t){this.globalState=e;this.context=t;this.extensionAccess=new Map;this.promiseChain=new Bv}async getAccessInformation(e){var s,a;let t=!e.extensionId||e.extensionId===cP?"":e.extensionId.split(".")[0]||"";if(this.context.extensionMode===kv.ExtensionMode.Test||!t||$d()==="insiders"){if(!Dte.has(t)&&!w9.has(t)){ue(`Publisher ${t} is allowed to access the Kernel API with a message.`);let l=((a=(s=Pte.extensions.getExtension(e.extensionId))==null?void 0:s.packageJSON)==null?void 0:a.displayName)||"",c=l&&e.extensionId?`${l} (${e.extensionId})`:e.extensionId||t;kv.window.showErrorMessage(_.thanksForUsingJupyterKernelApiPleaseRegisterWithUs(c)).then(y,y)}if(!w9.has(t)||!t||this.context.extensionMode===kv.ExtensionMode.Test)return{extensionId:e.extensionId,accessAllowed:!0}}if(Dte.has(t))return{extensionId:e.extensionId,accessAllowed:!0};if(!w9.has(t))return kv.window.showErrorMessage(`Please contact the Jupyter Extension to get access to the Kernel API. Publisher ${t}`).then(y,y),O(`Publisher ${t} is not allowed to access the Kernel API.`),{extensionId:e.extensionId,accessAllowed:!1};let n=this.globalState.get(C9),i=n==null?void 0:n.find(l=>l.extensionId===e.extensionId);if(i)return J("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:i.allowed}),{extensionId:e.extensionId,accessAllowed:i.allowed==="yes"};if(this.extensionAccess.get(e.extensionId))return this.extensionAccess.get(e.extensionId);let o=(async()=>{let l=_.allowExtensionToUseJupyterKernelApi(`${e.displayName} (${e.extensionId})`,Be.bannerLabelYes),u=await kv.window.showInformationMessage(l,{modal:!0},Be.bannerLabelYes,Be.bannerLabelNo)===Be.bannerLabelYes;return this.promiseChain.chainFinally(async()=>{let p=[...this.globalState.get(C9,[])];return p=p.filter(f=>f.extensionId!==e.extensionId),p.push({allowed:u?"yes":"no",extensionId:e.extensionId}),this.globalState.update(C9,p)}).then(y,y),J("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:u?"yes":"no"}),{extensionId:e.extensionId,accessAllowed:u}})();return this.extensionAccess.set(e.extensionId,o),o}};fp=E([(0,Nv.injectable)(),b(0,(0,Nv.inject)(wt)),b(0,(0,Nv.named)(ur)),b(1,(0,Nv.inject)(ut))],fp);d();var Tte=new WeakMap;function x9(r){let e=Tte.get(r);return e||(e=vCe(r),Tte.set(r,e)),e}function vCe(r){return new Proxy(r,{get(e,t){return t==="kernel"?e.kernel?yCe(e.kernel):void 0:Reflect.get(e,t)}})}var kte=new WeakMap;function yCe(r){let e=kte.get(r);return e||(e=bCe(r),kte.set(r,e)),e}function bCe(r){return new Proxy(r,{get(e,t){return t==="registerCommTarget"?(n,i)=>(gZ(r,n),Reflect.get(e,t).apply(e,[n,i])):t==="removeCommTarget"?(n,i)=>(vZ(r,n),Reflect.get(e,t).apply(e,[n,i])):Reflect.get(e,t)}})}var tE=class{constructor(e,t,n,i,o,s,a,l){this.kernelProvider=e;this.kernelFinder=t;this.thirdPartyKernelProvider=n;this.disposables=i;this.controllerRegistration=o;this.apiAccess=s;this.extensions=a;this.serviceContainer=l;this.chainedApiAccess=new Bv;this.extensionApi=new Map}async getService(){let e=this.extensions.determineExtensionFromCallStack(),t=await this.chainedApiAccess.chainFinally(()=>this.apiAccess.getAccessInformation(e));if(!t.accessAllowed)return;if(this.extensionApi.get(t.extensionId))return this.extensionApi.get(t.extensionId);let n=new HD(t.extensionId,this.kernelProvider,this.kernelFinder,this.thirdPartyKernelProvider,this.disposables,this.controllerRegistration,this.serviceContainer);return this.extensionApi.set(t.extensionId,n),n}};tE=E([(0,Gi.injectable)(),b(0,(0,Gi.inject)($e)),b(1,(0,Gi.inject)(di)),b(2,(0,Gi.inject)(Gg)),b(3,(0,Gi.inject)(oe)),b(4,(0,Gi.inject)(Ht)),b(5,(0,Gi.inject)(fp)),b(6,(0,Gi.inject)(tl)),b(7,(0,Gi.inject)(jr))],tE);var HD=class{constructor(e,t,n,i,o,s,a){this.callingExtensionId=e;this.kernelProvider=t;this.kernelFinder=n;this.thirdPartyKernelProvider=i;this.disposables=o;this.controllerRegistration=s;this.serviceContainer=a;this._onDidChangeKernelSpecifications=new ZM.EventEmitter;this._onDidChangeKernels=new ZM.EventEmitter;this.translatedConnections=new WeakMap;this._onDidChangeStatus=new ZM.EventEmitter;this._status=this.kernelFinder.status,this.kernelFinder.onDidChangeStatus(()=>{this._status=this.kernelFinder.status,this._onDidChangeStatus.fire()},this,o),this.kernelProvider.onDidDisposeKernel(l=>{var c;Ie(`Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.kernelProvider.onDidStartKernel(l=>{var c;Ie(`Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidDisposeKernel(l=>{var c;Ie(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidStartKernel(l=>{var c;Ie(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.controllerRegistration.onDidChange(()=>this._onDidChangeKernelSpecifications.fire(),this,o)}get onDidChangeKernelSpecifications(){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernelSpecifications"}),q(`API called from ${this.callingExtensionId}`),this._onDidChangeKernelSpecifications.event}get onDidChangeKernels(){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernels"}),this._onDidChangeKernels.event}get status(){return this._status}get onDidChangeStatus(){return this._onDidChangeStatus.event}async getKernelSpecifications(){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernelSpecifications"}),this.kernelFinder.kernels.map(e=>this.translateKernelConnectionMetadataToExportedType(e))}getActiveKernels(){J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getActiveKernels"});let e=[],t=new Set;return this.kernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.kernelProvider.get(n.notebook);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.thirdPartyKernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.thirdPartyKernelProvider.get(n.uri);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.controllerRegistration.registered.forEach(n=>{n.controller.notebookType===Ct&&n.connection.kind==="connectToLiveRemoteKernel"&&(!n.connection.kernelModel.id||t.has(n.connection.kernelModel.id)||e.push({metadata:n.connection,uri:void 0,id:n.id}))}),e}getKernel(e){var n;J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernel"});let t=(n=this.thirdPartyKernelProvider.get(e))!=null?n:this.kernelProvider.get(e);if(t!=null&&t.session)return{metadata:this.translateKernelConnectionMetadataToExportedType(t.kernelConnectionMetadata),connection:x9(t.session)}}async startKernel(e,t){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"startKernel"}),this.startOrConnect(e,t)}async connect(e,t){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"connect"}),this.startOrConnect(e,t)}async startOrConnect(e,t){let n=this.kernelFinder.kernels.find(o=>o.id===e.id);if(!n)throw new Error("Not found");let i=await Va.connectToKernel(n,this.serviceContainer,{resource:t},new Er(!1),this.disposables,"3rdPartyExtension");if(!(i!=null&&i.session))throw new Error("Not found");return x9(i.session)}translateKernelConnectionMetadataToExportedType(e){if(!this.translatedConnections.has(e)){let t=Object.freeze(su.fromJSON(e.toJSON()));this.translatedConnections.set(e,t)}return this.translatedConnections.get(e)}};HD=E([b(1,(0,Gi.inject)($e)),b(2,(0,Gi.inject)(di)),b(3,(0,Gi.inject)(Gg)),b(4,(0,Gi.inject)(oe)),b(5,(0,Gi.inject)(Ht)),b(6,(0,Gi.inject)(jr))],HD);d();var nE=z(re());var rE=class{constructor(e){this.syncActivationServices=e}activate(){this.syncActivationServices.map(e=>{try{e.activate()}catch(t){O(`Error in activating extension, failed in ${e.constructor.name}`,t)}})}};rE=E([(0,nE.injectable)(),b(0,(0,nE.optional)()),b(0,(0,nE.multiInject)(He))],rE);d();d();var pc=require("vscode");function Nte(r,e){e&&pc.commands.registerCommand("dataScience.ClearCache",async()=>{let t=[];for(let n of r.globalState.keys())t.push(r.globalState.update(n,void 0).then(y,y));for(let n of r.workspaceState.keys())t.push(r.workspaceState.update(n,void 0).then(y,y));t.push(pc.commands.executeCommand(X.ClearSavedJupyterUris).then(y,y)),await Promise.all(t).catch(y),await Promise.all([pc.workspace.fs.delete(pc.Uri.joinPath(r.globalStorageUri,"lastExecutedRemoteCell.json")).then(y,y),pc.workspace.fs.delete(pc.Uri.joinPath(r.globalStorageUri,"remoteServersMRUList.json")).then(y,y),pc.workspace.fs.delete(pc.Uri.joinPath(r.globalStorageUri,xS)).then(y,y)]),De("Cache cleared")})}function Rte(r,e){Nte(r,e)}d();d();var rO=z(re()),tr=require("vscode");var eO=_.percentPipCondaInstallInsteadOfBang("pip"),D9=_.percentPipCondaInstallInsteadOfBang("conda"),Ate=_.matplotlibWidgetInsteadOfOther,tO="Jupyter",iE=class{constructor(e){this.disposables=[];this.notebooksProcessed=new WeakMap;this.cellsToProcess=new Set;this.problems=tr.languages.createDiagnosticCollection(tO),this.disposables.push(this.problems),e.push(this)}dispose(){he(this.disposables),this.problems.dispose()}activate(){this.disposables.push(tr.languages.registerCodeActionsProvider(Qe,this)),this.disposables.push(tr.languages.registerHoverProvider(Qe,this)),tr.workspace.onDidChangeTextDocument(t=>{let n=lI(t.document);if(!n)return;let i=n.getCells().find(o=>o.document===t.document);i&&this.analyzeNotebookCell(i)},this,this.disposables),tr.workspace.onDidCloseNotebookDocument(t=>{this.problems.delete(t.uri);let n=this.notebooksProcessed.get(t);this.notebooksProcessed.delete(t),n&&n.forEach((i,o)=>this.problems.delete(tr.Uri.parse(o)))},this,this.disposables),tr.workspace.onDidOpenNotebookDocument(t=>this.analyzeNotebook(t),this,this.disposables);let e=new Sp(300);this.disposables.push(e),tr.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>{let n=this.notebooksProcessed.get(t.notebook);t.contentChanges.forEach(i=>{i.removedCells.forEach(o=>{n==null||n.delete(o.document.uri.toString())}),i.addedCells.forEach(o=>this.queueCellForProcessing(o))}),t.cellChanges.forEach(i=>this.queueCellForProcessing(i.cell))})},this,this.disposables),tr.workspace.notebookDocuments.map(t=>this.analyzeNotebook(t))}provideHover(e,t,n){let i=lI(e);if((i==null?void 0:i.notebookType)!==Ct)return;let o=this.problems.get(e.uri);if(!o)return;let s=o.find(l=>l.message===eO||l.message===D9);if(!s||!s.range.contains(t))return;let a=s.message===eO?"pip":"conda";return new tr.Hover(_.pipCondaInstallHoverWarning(a,"https://aka.ms/jupyterCellMagicBangInstall"),s.range)}provideCodeActions(e,t,n,i){if(!lI(e))return[];let o=[];return n.diagnostics.forEach(s=>{switch(s.message){case eO:o.push(this.createReplaceCodeAction(e,"pip",s));break;case D9:o.push(this.createReplaceCodeAction(e,"conda",s));break;case Ate:o.push(this.createGotoWikiAction(e,tr.Uri.parse("https://aka.ms/vscodejupytermatplotlibwidget"),s));break;default:break}}),o}createReplaceCodeAction(e,t,n){let i=new tr.CodeAction(_.replacePipCondaInstallCodeAction(t),tr.CodeActionKind.QuickFix);i.isPreferred=!0,i.diagnostics=[n];let o=new tr.WorkspaceEdit;return o.replace(e.uri,new tr.Range(n.range.start,new tr.Position(n.range.start.line,n.range.start.character+1)),"%"),i.edit=o,i}createGotoWikiAction(e,t,n){let i=new tr.CodeAction(_.matplotlibWidgetCodeActionTitle,tr.CodeActionKind.QuickFix);return i.isPreferred=!0,i.diagnostics=[n],i.command={title:_.matplotlibWidgetCodeActionTitle,command:"vscode.open",arguments:[t]},i}analyzeNotebook(e){e.notebookType===Ct&&e.getCells().forEach((t,n)=>n<100?this.queueCellForProcessing(t):void 0)}queueCellForProcessing(e){this.cellsToProcess.add(e),this.analyzeNotebookCells()}analyzeNotebookCells(){if(this.cellsToProcess.size===0)return;let e=this.cellsToProcess.values().next().value;this.cellsToProcess.delete(e),this.analyzeNotebookCell(e),setTimeout(()=>this.analyzeNotebookCells(),0)}analyzeNotebookCell(e){var n;if(e.kind!==tr.NotebookCellKind.Code||e.document.languageId!==Qe||e.notebook.isClosed||e.document.isClosed||((n=this.notebooksProcessed.get(e.notebook))==null?void 0:n.get(e.document.uri.toString()))===e.document.version)return;this.problems.delete(e.document.uri);let t=this.notebooksProcessed.get(e.notebook)||new Map;t.set(e.document.uri.toString(),e.document.version),this.notebooksProcessed.set(e.notebook,t);for(let i=0;i<Math.min(e.document.lineCount,50);i++){let o=e.document.lineAt(i),s=o.text;if(s.trim().startsWith("!pip install")){let a=s.indexOf("!"),l=s.indexOf("l"),c=new tr.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:eO,range:c,severity:tr.DiagnosticSeverity.Error,source:tO}])}else if(s.trim().startsWith("!conda install")){let a=s.indexOf("!"),l=s.indexOf("l"),c=new tr.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:D9,range:c,severity:tr.DiagnosticSeverity.Error,source:tO}])}else if(s.trim().startsWith("%matplotlib")&&!s.trim().endsWith("widget")&&!s.trim().endsWith("inline")){let a=s.indexOf("%"),l=s.length,c=new tr.Range(o.lineNumber,a,o.lineNumber,l);this.problems.set(e.document.uri,[{message:Ate,range:c,severity:tr.DiagnosticSeverity.Warning,source:tO}])}}}};iE=E([(0,rO.injectable)(),b(0,(0,rO.inject)(oe))],iE);d();var aO=z(re()),xr=require("vscode");d();var Mte=new Map([["method",0],["function",1],["constructor",2],["field",3],["variable",4],["class",5],["struct",6],["interface",7],["module",8],["property",9],["event",10],["operator",11],["unit",12],["value",13],["constant",14],["enum",15],["enumMember",16],["keyword",17],["text",18],["color",19],["file",20],["reference",21],["customcolor",22],["folder",23],["typeParameter",24],["snippet",25],["<unknown>",3]]);d();function nO(r){if(r>=300)return"ZZZZZZZ";if(r<=25)return`A${String.fromCharCode(65+r)}`;let e=String.fromCharCode(65+Math.ceil(r/25)),t=String.fromCharCode(65+r%25);return`${e}${t}`}d();var jte=require("vscode");d();var Rv=require("vscode");var ICe=new Map([["julia",CCe],["python",_Ce],["r",wCe]]);function Ote(r,e){let t=ICe.get(e.toLowerCase());return t?t(r):r}var SCe=["Docstring:","Options:","Parameters","Returns","See Also","Notes","Examples","Usage:","Subclasses:"];function _Ce(r){let e=dt(r,{trim:!1,removeEmptyEntries:!1}),t=-1,n=!1,i=!1,o=[],s=new Set,a=!1,l="",c=!1,u=!1;if(e.map((f,m)=>{if(m===0){let g=["Signature:","Init signature:"].find(v=>f.toLowerCase().startsWith(v.toLowerCase()));if(g){n=!0,f=f.substring(g.length).trim(),o.push("```python"),f.trim().length&&(o.push(f),c=!0);return}}if(f.startsWith("File:")&&m===e.length-1||f.startsWith("Type:")&&m===0)return;if(!a&&f.toLowerCase().startsWith("String form:".toLowerCase())){i=!0;return}let h=SCe.find(g=>f.trim().toLowerCase().startsWith(g.toLowerCase()));if(h&&!s.has(h)){l=h.toLowerCase(),s.add(h),a=!0,t=m,i=!1,n&&o.push("```","----------"),n=!1,u=!1,l!=="docstring:"&&o.push(`## ${h}`);let g=f.includes(":")?f.split(":")[1].replace("<no docstring>","").trim():"";g.length&&(o.push(g),c=!0);return}if(!i){if(t+1===m&&f.replace(/-/g,"").replace(/:/g,"").replace("<no docstring>","").trim().length===0){t=m,i=!1,n=!1,u=!1;return}if(l==="parameters"||l==="see also"){f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),c=c||f.trim().length>0;return}if(l==="options:"){f.startsWith("-")&&f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),c=c||f.trim().length>0;return}if(l==="returns"){f.trim().length&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),c=c||f.trim().length>0;return}if(l==="examples"&&!n&&(t+1===m||t+2===m))return i=!1,n=!0,c=c||f.trim().length>0,o.push("```python",f);if(!n&&f.startsWith("class ")&&f.trim().endsWith("):")){n=!0,u=!0,o.push("```python",f),c=c||f.trim().length>0;return}if(n&&u&&f.trim().length>0&&f.substring(0,1)!==" "&&f.substring(0,1)!=="	")return n=!1,u=!1,o.push(f,"```");c=c||f.trim().length>0,o.push(f)}}),!c)return"";let p=o.join(`  
`);return n?new Rv.MarkdownString(p+"  \n```"):new Rv.MarkdownString(p)}var ECe=[{section:"Examples:",header:"Examples",nextLine:/≡/g},{section:"Usage note",header:"Usage note",nextLine:/≡/g},{section:"Note:",header:"\u2502 Note",nextLine:"\u2502"},{section:"Note:",header:"\u2502 Note",nextLine:String.fromCharCode(9474)}];function CCe(r){let e=dt(r,{trim:!1,removeEmptyEntries:!1}),t=!1,n=[],i=new Set,o="",s=!1,a=!1;e.every(c=>c.trim().length===0||c.startsWith("  "))&&e.forEach((c,u)=>e[u]=c.trim().length?c.substring(2):c),e.map((c,u)=>{if(c.trim()==="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500")return a=!1,n.push(c);if(!a)return o="signature",t=!0,a=!0,c.trim().length?(s=!0,n.push("```julia",c)):n.push("```julia");o==="signature"&&c.trim()===""&&(o="",t=!1,s=!1,n.push("```"));let p=ECe.find(f=>c.trim().toLowerCase().startsWith(f.header.toLowerCase()));if(p&&(typeof p.nextLine=="string"?e[u+1].trim()===p.nextLine.trim():e[u+1].trim().replace(p.nextLine,"").length===0)){e[u+1]="",o=p.section.toLowerCase(),i.add(p.header),t&&n.push("```"),t=!1,n.push(`## ${p.section}`),o==="note:"&&!e.slice(u+1).every(f=>f.trim().length===0||f.trim().startsWith("|")||f.trim().startsWith(String.fromCharCode(9474)))&&(o="");return}if(o==="examples:"&&!t)return t=!0,c.trim().length?(s=!0,n.push("```julia",c)):n.push("```julia");if(o==="note:"){n.push(c.trim()?c.trim().substring(1):"");return}t&&!s&&c.trim().length===0||n.push(c)});let l=n.join(`  
`);return t?new Rv.MarkdownString(l+"  \n```"):new Rv.MarkdownString(l)}function wCe(r){let e=dt(r,{trim:!1,removeEmptyEntries:!1}),t=[];e.forEach((a,l)=>e[l]=a.indexOf("     ")===0?a.substring(5):a);let n="",i=!1,o=!1;e.map(a=>{let l=a.replace(/_/g,"").trim();if(a.startsWith("_")&&a.includes(String.fromCharCode(8))&&a.split("_").length===a.split(String.fromCharCode(8)).length&&l){i&&t.push("```"),i=!1,n=l.trim().toLowerCase(),t.push(`## ${l}`);return}if((n==="examples"||n==="examples:"||n==="usage"||n==="usage:")&&!i)return i=!0,a.trim().length?(o=!0,t.push("```r",a)):t.push("```r");if(n==="note:"){t.push(a.trim()?a.trim().substring(1):"");return}i&&!o&&a.trim().length===0||t.push(a)});let s=t.join(`  
`);return i?new Rv.MarkdownString(s+"  \n```"):new Rv.MarkdownString(s)}d();var Kte=z(re());var oE=class{execCodeInBackgroundThread(e,t,n){return JD(e,t,n)}};oE=E([(0,Kte.injectable)()],oE);var Lte=new WeakMap;async function JD(r,e,t){var f;let n=Lte.get(r)||0;Lte.set(r,n+1);let i=t1(Xe,r),o=`application/vnd.vscode.bg.execution.${n}`,s=`application/vnd.vscode.bg.execution.${n}.result`,a=`application/vnd.vscode.bg.execution.${n}.error`,l="",c=`
def __jupyter_exec_background__():
    from IPython.display import display
    from threading import Thread
    from traceback import format_exc

    # First send a dummy response to get the display id.
    # Later we'll send the real response with the actual data.
    # And that can happen much later even after the execution completes,
    # as that response will be sent from a bg thread.
    output = display({"${o}": ""}, raw=True, display_id=True)

    def do_implementation():
        ${e.map((m,h)=>h===0?m:`        ${m}`).join(`
`)}

    def bg_main():
        try:
            output.update({"${s}": do_implementation()}, raw=True)
        except Exception as e:
            output.update({"${a}": format_exc()}, raw=True)


    Thread(target=bg_main, daemon=True).start()


__jupyter_exec_background__()
del __jupyter_exec_background__
`.trim(),u=new Wi;u.add(t.onCancellationRequested(()=>u.dispose()));let p=Js(t,new Promise((m,h)=>{u.add(i.onDidReceiveDisplayUpdate(async g=>{var S;if(t.isCancellationRequested)return m(void 0);let v=Yg(g);if(!l||((S=v==null?void 0:v.transient)==null?void 0:S.display_id)!==l)return;let I=g.items.find(x=>x.mime===s);if(I)try{return m(JSON.parse(new TextDecoder().decode(I.data)))}catch(x){return h(new Error("Failed to parse the result",x))}}))})).finally(()=>{r.session&&hz(r.session,l),u.dispose()});for await(let m of i.executeCode(c,t)){if(t.isCancellationRequested)return;let h=Yg(m);if(!((f=h==null?void 0:h.transient)!=null&&f.display_id))continue;if(m.items.find(v=>v.mime===o)){l=h.transient.display_id;continue}if(l===h.transient.display_id){let v=m.items.find(I=>I.mime===s||I.mime===a);if((v==null?void 0:v.mime)===s)return JSON.parse(new TextDecoder().decode(v.data));if((v==null?void 0:v.mime)===a){ue(`Error in background execution:
`,new TextDecoder().decode(v.data));return}}}if(!t.isCancellationRequested){if(!l){ue("Failed to get display id for completions");return}return p}}var xCe=1,Om=gi.IntellisenseResolveTimeout,Fte=5,P9=new WeakSet,iO=class extends Error{constructor(){super("Request timed out")}};async function Bte(r,e,t,n,i,o,s,a){var p;if(!r.range||!((p=n.session)!=null&&p.kernel)||P9.has(n)||!Qt(n.kernelConnectionMetadata)&&n.status!=="idle")return r;let l=LCe(e||r,s,a),c=OCe(l,n,t),u=Rz(t);try{let f=await Hv(Om,new iO,Js(u.token,c));if(!t.isCancellationRequested&&(f==null?void 0:f.status)==="ok"&&(f!=null&&f.found)){let m=DCe(f);r.documentation=Ote(m,o)}}catch(f){if(f instanceof jte.CancellationError)return r;f instanceof iO&&(u.cancel(),PCe(n,o,i))}finally{u.dispose()}return r}function DCe(r){return!r||r.status!=="ok"||!r.found?";":!r.data||typeof r.data!="object"?"":"text/plain"in r.data?Pu(r.data["text/plain"]):""}var Ute=new WeakSet;function PCe(r,e,t){Qt(r.kernelConnectionMetadata)||P9.has(r)||(P9.add(r),ue(`Failed to inspect code in kernel ${ft(r.kernelConnectionMetadata)}`),Ute.has(r)||(Ute.add(r),J("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",void 0,{kernelId:t,kernelConnectionType:r.kernelConnectionMetadata.kind,kernelLanguage:e})))}var T9=new WeakMap,k9=new WeakMap;async function TCe(r,e,t){let n=`return get_ipython().kernel.do_inspect("${Jx(e.code)}", ${e.cursor_pos}, ${e.detail_level})`;return{content:await JD(r,[n],t)}}var Wte={data:{},found:!1,status:"ok",metadata:{}};function kCe(r,e){var i;if(!((i=r.session)!=null&&i.kernel))return;let t=JSON.stringify(e),n=T9.get(r.session.kernel);return n==null?void 0:n.get(t)}function NCe(r,e,t){var o;if(!((o=r.session)!=null&&o.kernel)||t.status!=="ok"||!t.found)return;let n=JSON.stringify(e),i=T9.get(r.session.kernel)||new Map;T9.set(r.session.kernel,i),i.size>100&&i.clear(),i.set(n,t)}function RCe(r){var t;if(!((t=r.session)!=null&&t.kernel))return!1;let e=k9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};return!Qt(r.kernelConnectionMetadata)&&e.maxTime>Om?(ue(`Not sending inspect request as previous requests took over ${Om}s.`),!1):e.numberOfTimesMaxedOut>Fte?(ue(`Not sending inspect request as there have been at least ${Fte} requests that took over ${Om}s.`),!1):e.maxTime>Om&&Date.now()-e.lastRequestTime<3e4?(ue(`Not sending inspect request as previous requests took over ${Om}s.`),!1):!0}async function ACe(r,e){var i;if(!((i=r.session)!=null&&i.kernel)||!Vte(r))return;De(`Too many pending requests ${Hte(r)} for kernel ${r.id}, waiting for it to be ready.`);let t=r.session.kernel,n=[];await Js(e,new Promise(o=>{let s=()=>{if(!Vte(r)){o(),he(n);return}setInterval(s,100)};zg(e.onCancellationRequested)(()=>{o(),t.statusChanged.disconnect(s)},void 0,n),t.statusChanged.connect(s),n.push({dispose:()=>{t.statusChanged.disconnect(s)}})})).finally(()=>he(n))}function MCe(r,e){var n;if(!((n=r.session)!=null&&n.kernel))return;let t=k9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};t.maxTime=Math.max(t.maxTime,e),t.lastRequestTime=Date.now(),e>Om&&(t.numberOfTimesMaxedOut+=1),k9.set(r.session.kernel,t)}async function OCe(r,e,t){var l;if(!((l=e.session)!=null&&l.kernel))return;let n=kCe(e,r);if(n)return n;if(!RCe(e)||(await ACe(e,t),t.isCancellationRequested))return Wte;let i=KCe(e),o=new Mt,s=dt(r.code).reverse()[0].slice(-50);q(`Inspecting code ${s}`);let a=Qt(e.kernelConnectionMetadata)?TCe(e,r,t):e.session.kernel.requestInspect(r);return a.finally(()=>i.dispose()),a.then(({content:c})=>{var p;if(!((p=e.session)!=null&&p.kernel))return;NCe(e,r,c),MCe(e,o.elapsedTime);let u=o.elapsedTime>Om?ue:q;return t.isCancellationRequested?u(`Inspected code ${s} in ${o.elapsedTime}ms (but cancelled)`):u(`Inspected code ${s} in ${o.elapsedTime}ms`),c})}function LCe(r,e,t){var l;let n=e.getText(),i=(typeof r.insertText=="string"?r.insertText:(l=r.insertText)==null?void 0:l.value)||(typeof r.label=="string"?r.label:r.label.label)||"",o=n.substring(0,t.character)+i,s=t.character+i.length;return{code:o,cursor_pos:s,detail_level:0}}var qD=new WeakMap;function Vte(r){var e;return(e=r.session)!=null&&e.kernel?Hte(r)>=xCe:!1}function Hte(r){var e,t,n,i,o;return(e=r.session)!=null&&e.kernel?(qD.has((t=r.session)==null?void 0:t.kernel)||qD.set((n=r.session)==null?void 0:n.kernel,{count:0}),((o=qD.get((i=r.session)==null?void 0:i.kernel))==null?void 0:o.count)||0):0}function KCe(r){var t,n,i;if(!((t=r.session)!=null&&t.kernel))return{dispose:y};let e=qD.get((n=r.session)==null?void 0:n.kernel)||{count:0};return qD.set((i=r.session)==null?void 0:i.kernel,e),e.count+=1,{dispose:()=>{e.count-=1}}}var sO=class extends Error{constructor(){super("Request timed out")}},N9=class{constructor(e,t,n){this.kernelId=e;this.kernel=t;this.monacoLanguage=n;this.pendingCompletionRequest=new WeakMap;this.previousCompletionItems=new WeakMap}async provideCompletionItems(e,t,n,i){var a;if(!((a=this.kernel.session)!=null&&a.kernel))return[];let o=e.version;if(this.pendingCompletionRequest.has(e))return[];this.pendingCompletionRequest.set(e,{position:t,version:o});let s=new xr.Disposable(()=>{var l,c;(l=this.pendingCompletionRequest.get(e))!=null&&l.position.isEqual(t)&&((c=this.pendingCompletionRequest.get(e))==null?void 0:c.version)===o&&this.pendingCompletionRequest.delete(e)});try{let l=Ju(Js(n,Promise.resolve(xr.commands.executeCommand("vscode.executeCompletionItemProvider",e.uri,t)).then(m=>(m==null?void 0:m.items)||[]))),c=new Mt;if(await mc(50),n.isCancellationRequested)return[];let u=await Hv(gi.IntellisenseTimeout,new sO,this.provideCompletionItemsFromKernel(e,t,n,i));if(n.isCancellationRequested||!u||!u.length)return[];let p=await So(0,l.promise);Qt(this.kernel.kernelConnectionMetadata)&&!l.completed&&c.elapsedTime<gi.IntellisenseTimeout+50&&(p=await So(gi.IntellisenseTimeout-c.elapsedTime,l.promise));let f=new Set((p||[]).map(m=>typeof m.label=="string"?m.label:m.label.label));return u.filter(m=>!f.has(typeof m.label=="string"?m.label:m.label.label))}catch(l){if(l instanceof sO)return[];throw l instanceof xr.CancellationError||q("Completions failed",l),l}finally{s.dispose()}}async provideCompletionItemsFromKernel(e,t,n,i){var v,I,S,x,D;if(n.isCancellationRequested||!((v=this.kernel.session)!=null&&v.kernel))return[];let o=new Mt,s={duration:0,timesExceededTimeout:0,requestDuration:0,completionItems:0},a={kernelId:this.kernelId,kernelConnectionType:this.kernel.kernelConnectionMetadata.kind,kernelLanguage:cO(this.kernel),monacoLanguage:this.monacoLanguage,cancelled:!1,kernelStatusBeforeRequest:this.kernel.status,completed:!1,requestSent:!1};if(!Qt(this.kernel.kernelConnectionMetadata)&&this.kernel.status!=="idle")return[];let l=e.getText(),c=e.offsetAt(t);a.requestSent=!0;let u=await Js(n,this.getKernelCompletion(l,c,n));if(q(`Jupyter completion time: ${o.elapsedTime}`),a.cancelled=n.isCancellationRequested,a.completed=!n.isCancellationRequested,a.kernelStatusAfterRequest=this.kernel.status,s.requestDuration=n.isCancellationRequested?0:o.elapsedTime,n.isCancellationRequested)return[];if(((I=u==null?void 0:u.content)==null?void 0:I.status)!=="ok"||((D=(x=(S=u==null?void 0:u.content)==null?void 0:S.matches)==null?void 0:x.length)!=null?D:0)===0)return qte(this.kernel,s,a),[];let p={matches:u.content.matches,cursor:{start:u.content.cursor_start,end:u.content.cursor_end},metadata:u.content.metadata},f=p.metadata?p.metadata._jupyter_types_experimental:[];s.completionItems=p.matches.length,qte(this.kernel,s,a);let m={code:l,cursor:p.cursor,documentRef:new WeakRef(e),position:e.positionAt(p.cursor.start)},h=new xr.Range(e.positionAt(p.cursor.start),e.positionAt(p.cursor.end)),g=[];return Array.isArray(f)&&f.length>=p.matches.length&&f.every(A=>A&&typeof A.text=="string")?g=u.content.matches.map((A,w)=>{let R=f[w],j=R.type?Mte.get(R.type):xr.CompletionItemKind.Field,ne=new xr.CompletionItem(A,j);return typeof R.start=="number"&&typeof R.end=="number"?ne.range=new xr.Range(e.positionAt(R.start),e.positionAt(R.end)):ne.range=h,ne.insertText=R.text,ne.sortText=nO(w),Qt(this.kernel.kernelConnectionMetadata)&&(A.startsWith("%")||A.startsWith("!"))&&(ne.sortText=`ZZZ${ne.sortText}`),this.previousCompletionItems.set(ne,{...m,originalCompletionItem:JSON.parse(JSON.stringify(ne))}),ne}):g=p.matches.map((A,w)=>{let R=new xr.CompletionItem(A);return R.range=h,R.sortText=nO(w),Qt(this.kernel.kernelConnectionMetadata)&&(A.startsWith("%")||A.startsWith("!"))&&(R.sortText=`ZZZ${R.sortText}`),this.previousCompletionItems.set(R,{...m,originalCompletionItem:R}),R}),Qt(this.kernel.kernelConnectionMetadata)?VCe(i.triggerCharacter,this.allowStringFilterForPython,g,e,t):g}async resolveCompletionItem(e,t){var l;if(!e.range||!((l=this.kernel.session)!=null&&l.kernel))return e;let n=this.previousCompletionItems.get(e);if(!n)return e;let{documentRef:i,position:o,originalCompletionItem:s}=n,a=i.deref();return a?Bte(e,s,t,this.kernel,this.kernelId,this.monacoLanguage,a,o):e}async getKernelCompletion(e,t,n){var i;if((i=this.kernel.session)!=null&&i.kernel)return Qt(this.kernel.kernelConnectionMetadata)?this.getPythonKernelCompletion(e,t,n):Js(n,this.kernel.session.kernel.requestComplete({code:e,cursor_pos:t}))}async getPythonKernelCompletion(e,t,n){let i=`return get_ipython().kernel.do_complete("${Jx(e)}", ${t})`;return{content:await JD(this.kernel,[i],n)}}},Jte=new WeakMap,oO=new WeakMap;function qte(r,e,t){var o;let n=Jte.get(r),i=((o=oO.get(r))==null?void 0:o.count)||0;e.duration>=gi.IntellisenseTimeout&&oO.set(r,{count:i+1,measures:e,properties:t}),e.timesExceededTimeout=i,n?n.elapsedTime>6e4&&(J("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n.reset(),oO.delete(r)):(J("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n=new Mt,Jte.set(r,new Mt),oO.delete(r))}var R9=class extends zr{constructor(t,n){super();this.kernel=t;this.notebookEditorProvider=n;this.cellCompletionProviders=new WeakMap;this.completionItemsSent=new WeakMap;this.monacoLanguage=lO(this.kernel);this.registerCompletionProvider(),this._register(xr.workspace.onDidChangeConfiguration(i=>{var o;if(i.affectsConfiguration("jupyter.enableKernelCompletions"))if(Gte(this.kernel.notebook.uri))this.completionProvider||this.registerCompletionProvider();else{(o=this.completionProvider)==null||o.dispose(),this.completionProvider=void 0;return}!i.affectsConfiguration("jupyter.completionTriggerCharacters")&&!i.affectsConfiguration("jupyter.pythonCompletionTriggerCharacters")||this.registerCompletionProvider()}))}registerCompletionProvider(){var n;if(!Gte(this.kernel.notebook.uri))return;let t=FCe(this.kernel);if(t.length===0){UCe(this.kernel);return}q(`Registering Kernel Completion Provider from kernel ${ft(this.kernel.kernelConnectionMetadata)} for language ${this.monacoLanguage}`),this.allowStringFilterForPython=t.includes("'")||t.includes('"'),(n=this.completionProvider)==null||n.dispose(),this.completionProvider=void 0,this.completionProvider=xr.languages.registerCompletionItemProvider(this.monacoLanguage,this,...t)}dispose(){var t;super.dispose(),(t=this.completionProvider)==null||t.dispose()}async provideCompletionItems(t,n,i,o){if(this.notebookEditorProvider.findAssociatedNotebookDocument(t.uri)!==this.kernel.notebook)return[];let s=this.cellCompletionProviders.get(t);if(!s){let a=await Ot(this.kernel.kernelConnectionMetadata.id);s=new N9(a,this.kernel,this.monacoLanguage),this.cellCompletionProviders.set(t,s)}return s.allowStringFilterForPython=this.allowStringFilterForPython,s.provideCompletionItems(t,n,i,o).then(a=>(a.forEach(l=>this.completionItemsSent.set(l,s)),a))}async resolveCompletionItem(t,n){let i=this.completionItemsSent.get(t);return i?i.resolveCompletionItem(t,n):t}},Lm=class extends zr{constructor(t){super();this.kernelCompletionProviders=new WeakMap;t.push(this)}activate(){let t=at.instance.get($e);this._register(t.onDidStartKernel(async n=>{var a;if((a=n.session)!=null&&a.kernel&&Qt(n.kernelConnectionMetadata)&&n.session.kernel.requestComplete({code:"__file__.",cursor_pos:9}),!lO(n)||this.kernelCompletionProviders.has(n))return;let o=at.instance.get(Ho),s=this._register(new R9(n,o));this.kernelCompletionProviders.set(n,s)})),this._register(t.onDidDisposeKernel(n=>{var i;(i=this.kernelCompletionProviders.get(n))==null||i.dispose()}))}};Lm=E([(0,aO.injectable)(),b(0,(0,aO.inject)(oe))],Lm);function lO(r){return $c(cO(r))}function cO(r){let e="";switch(r.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":e=r.kernelConnectionMetadata.kernelModel.language;break;case"startUsingRemoteKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;case"startUsingLocalKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;default:e=r.kernelConnectionMetadata.kernelSpec.language;break}return(e||"").toLowerCase()}function Gte(r){return xr.workspace.getConfiguration("jupyter",r).get("enableKernelCompletions",!1)}function FCe(r){let e=xr.workspace.getConfiguration("jupyter",r.notebook.uri).get("completionTriggerCharacters");if(!e||typeof e!="object")return[];let t=cO(r),n=lO(r);return t in e?Array.isArray(e[t])?e[t]:[]:n in e?Array.isArray(e[n])?e[n]:[]:[]}function UCe(r){let e=cO(r),t=lO(r);e.toLowerCase()===t.toLowerCase()?ue(xr.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ft(r.kernelConnectionMetadata),`{${e}`)):ue(xr.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
 or the following: 
jupyter.completionTriggerCharacters = {2}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ft(r.kernelConnectionMetadata),`{${e}`,`{${t}`))}function WCe(r,e){let t=r.indexOf('"'),n=r.indexOf("'"),i=r.lastIndexOf('"'),o=r.lastIndexOf("'"),s=t>=0?t:n,a=i>=0?i:o;return s>=0&&e.character>s&&e.character<=a}function VCe(r,e,t,n,i){let o=t,s=i.character===0?void 0:new xr.Range(i.line,i.character-1,i.line,i.character),l=(s?n.getText(s):void 0)===".",c=n.getWordRangeAtPosition(l||r==="."?new xr.Position(i.line,i.character-1):i),u=c&&s?c.union(s):void 0,p=n.lineAt(i.line).text,f=u?n.getText(u):p,m=f.endsWith(".")||l,h=e&&(r=="'"||r=='"'||WCe(p,i));return Ie(`Jupyter completions filtering applied: ${h} on ${p}`),o=o.map((g,v)=>{let I=typeof g.label=="string"?g.label:g.label.label,S=typeof g.label=="string"?g.label:g.label.label;if(S.startsWith("%")||S.startsWith("!"))return{...g,sortText:`ZZZ${g.sortText}`};if(h)return g;let x=f?S.indexOf(f):-1,D,A,w;if(f&&m&&S.includes(f)){D=S.substring(S.indexOf(f)+(m?f.length:0)),A=S.substring(S.indexOf(f)+f.length);let R=(typeof g.label=="string"?g.label.length:g.label.label.length)-A.length;w=g.range&&"start"in g.range?new xr.Range(new xr.Position(g.range.start.line,g.range.start.character+R),g.range.end):g.range}if(!A&&x>0){D=S.substring(S.indexOf(f)+(m?f.length:0)),A=S.substring(S.indexOf(f)+f.length);let R=(typeof g.label=="string"?g.label.length:g.label.label.length)-A.length;w=g.range&&"start"in g.range?new xr.Range(new xr.Position(g.range.start.line,g.range.start.character+R),g.range.end):g.range}return D&&A&&w&&(g.label=D,I=A,g.insertText=A,g.filterText=m?`.${A}`:A,g.range=w,g.sortText=nO(v)),I.endsWith("/")?{...g,command:{command:"editor.action.triggerSuggest",title:""}}:(I.includes(" ")&&(I=I.replace(/\\ /g," "),typeof g.label=="string"?g.label=g.label.replace(/\\ /g," "):g.label.label=g.label.label.replace(/\\ /g," ")),h||!I.includes(".")&&!I.endsWith("/")?g:void 0)}).filter(g=>g!==void 0),Ie(`Jupyter completions for ${f} at pos ${i.line}:${i.character} with trigger: ${r}
   ${t.map(g=>g.label).join(",")}`),Ie(`Jupyter results for ${f} at pos ${i.line}:${i.character} with trigger: ${r}
   ${o.map(g=>g.label).join(",")}`),o}function Yte(r,e){r.addSingleton(He,iE),r.addSingleton(Lm,Lm),r.addBinding(Lm,He)}d();var aE=z(re());var $te=require("vscode");var sE=class{constructor(e,t,n){this.extensionChecker=e;this.disposables=t;this.kernelProvider=n}activate(){this.extensionChecker.onPythonExtensionInstallationStatusChanged(this.onPythonExtensionInstallationStatusChanged,this,this.disposables)}async onPythonExtensionInstallationStatusChanged(e){e==="installed"&&this.anyKernelsAreActive()&&$te.window.showInformationMessage(_.pythonExtensionInstalled,Be.ok).then(y,y)}anyKernelsAreActive(){return this.kernelProvider.kernels.length>0}};sE=E([(0,aE.injectable)(),b(0,(0,aE.inject)(wo)),b(1,(0,aE.inject)(oe)),b(2,(0,aE.inject)($e))],sE);d();var uO=z(re()),ws=require("vscode");var jCe=/^\s*(from (?<fromImport>\w+)(?:\.\w+)* import \w+(?:, \w+)*(?: as \w+)?|import (?<importImport>\w+(?:, \w+)*)(?: as \w+)?)$/,BCe=1e3,HCe=Sn(),lE=class{constructor(e,t=1e3){this.pendingChecks=new Tu;this.disposables=new Wi;this.sentMatches=new Set;e.push(this.disposables),this.disposables.add(new ws.Disposable(()=>he(this.pendingChecks.values()))),this.isTelemetryDisabled=_0(),this.disposables.add(ws.workspace.onDidOpenNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(ws.workspace.onDidCloseNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(ws.workspace.onDidSaveNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave")));let n=new Sp(t);this.disposables.add(ws.notebooks.onDidChangeNotebookCellExecutionState(i=>{n.trigger(()=>{i.state==ws.NotebookCellExecutionState.Pending&&!this.isTelemetryDisabled&&this.checkNotebookCell(i.cell,"onExecution").catch(y)})},this)),this.disposables.add(E0(i=>this.isTelemetryDisabled=i))}activate(){ws.workspace.notebookDocuments.forEach(e=>this.checkNotebookDocument(e,"onOpenCloseOrSave"))}getDocumentLines(e){let t=[];for(let n=0;n<Math.min(BCe,e.lineCount);n++){let i=e.lineAt(n);i.isEmptyOrWhitespace||t.push(i.text.trim())}return t}onOpenedOrClosedNotebookDocument(e,t){!_r(e)||this.isTelemetryDisabled||this.scheduleCheck(e.uri,this.checkNotebookDocument.bind(this,e,t))}scheduleCheck(e,t){let n=this.pendingChecks.get(e);if(n&&(n.dispose(),this.pendingChecks.delete(e)),HCe)t();else{let i=setTimeout(t,5e3);this.pendingChecks.set(e,new ws.Disposable(()=>clearTimeout(i)))}}async checkNotebookDocument(e,t){!_r(e)||this.isTelemetryDisabled||await Promise.all(e.getCells().map(async n=>this.checkNotebookCell(n,t)))}async checkNotebookCell(e,t){if(!(!_r(e.notebook)||e.kind!==ws.NotebookCellKind.Code||e.document.languageId!==Qe))try{let n=e.notebook.notebookType===Ct?"notebook":"interactive";await this.sendTelemetryForImports(this.getDocumentLines(e.document),n,t)}catch(n){if(!Ni)throw n}}lookForImports(e){let t=[];try{for(let n of e){if(!n.includes("import")&&!n.includes("from"))continue;let i=n?jCe.exec(n):null;i!==null&&i.groups!==void 0&&(i.groups.fromImport!==void 0?t.push(i.groups.fromImport):i.groups.importImport!==void 0&&t.push(...i.groups.importImport.split(",").map(o=>o.trim())))}}catch(n){}return t}async sendTelemetryForImports(e,t,n){await Promise.all(this.lookForImports(e).map(async i=>{let o=`${i}_${t||""}_${n}`;if(this.sentMatches.has(o))return;this.sentMatches.add(o);let s=await Ot(i);J("HASHED_PACKAGE_NAME",void 0,{hashedNamev2:s,resourceType:t,when:n})}))}};lE=E([(0,uO.injectable)(),b(0,(0,uO.inject)(oe))],lE);d();var Zr=z(re()),Xte=z(iv()),mt=require("vscode");d();var Wu=require("vscode");var dO=class{constructor(e,t,n,i,o){this.configService=e;this.agentCreator=t;this.requestCreator=n;this.serverUriStorage=i;this.disposables=o;this.savedConnectInfo=new Map;this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}getPasswordConnectionInfo(e){if(!e.url||e.url.length<1)throw new Error("Invalid URL");let t=cE(e.url),n=e.disposables||[],i=!Array.isArray(e.disposables),o=this.savedConnectInfo.get(e.handle);return o||(o=this.getJupyterConnectionInfo({url:t,isTokenEmpty:e.isTokenEmpty,disposables:n,validationErrorMessage:e.validationErrorMessage}).then(s=>((!s||s.requiresPassword&&Object.keys(s).length===1)&&(ue(`Password for ${t} was invalid.`),this.savedConnectInfo.delete(e.handle)),s)),o.catch(()=>this.savedConnectInfo.delete(e.handle)),o.finally(()=>{i&&he(n)}).catch(y),this.savedConnectInfo.set(e.handle,o)),o}async getJupyterConnectionInfo(e){let t,n,i,o,s=await this.needPassword(e.url);if(s||e.isTokenEmpty){if(s&&e.isTokenEmpty){let a=Wu.window.createInputBox();e.disposables.push(a),a.title=_.jupyterSelectPasswordTitle,a.placeholder=_.jupyterSelectPasswordPrompt,a.ignoreFocusOut=!0,a.password=!0,a.validationMessage=e.validationErrorMessage||"",a.show(),a.buttons=[Wu.QuickInputButtons.Back],o=await new Promise((l,c)=>{a.onDidTriggerButton(u=>{u===Wu.QuickInputButtons.Back&&c(Ze.back)},this,e.disposables),a.onDidChangeValue(()=>a.validationMessage="",this,e.disposables),a.onDidAccept(()=>l(a.value),this,e.disposables),a.onDidHide(()=>c(Ze.cancel),this,e.disposables)})}if(typeof o===void 0&&!o&&e.isTokenEmpty)throw new Wu.CancellationError;if(o||e.isTokenEmpty)if(t=await this.getXSRFToken(e.url,""),t){let a=await this.getSessionCookie(e.url,t,o||"");n=a.sessionCookieName,i=a.sessionCookieValue}else n="authservice_session",i=o,t=await this.getXSRFToken(e.url,`${n}=${i}`);else return{requiresPassword:s}}else return{requiresPassword:s};return t&&n&&(i||e.isTokenEmpty)?(J("DS_INTERNAL.GET_PASSWORD_SUCCESS"),{requestHeaders:{Cookie:`_xsrf=${t}; ${n}=${i||""}`,"X-XSRFToken":t},requiresPassword:s}):(J("DS_INTERNAL.GET_PASSWORD_FAILURE"),{requiresPassword:s})}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async getXSRFToken(e,t){var a;let n,i,o=new URL("login?",cE(e)).toString();t!=""?(o=new URL("tree",cE(e)).toString(),i={Connection:"keep-alive",Cookie:t}):i={Connection:"keep-alive"};let s=await this.makeRequest(o,{method:"get",redirect:"manual",headers:i});if(s!==void 0&&s.ok){let l=this.getCookies(s);l.has("_xsrf")&&(n=(a=l.get("_xsrf"))==null?void 0:a.split(";")[0])}return n}async needPassword(e){let t=await this.makeRequest(cE(e),{method:"get",redirect:"follow",headers:{Connection:"keep-alive"}});if(t.status===200&&t.redirected){if(t.url.toLowerCase().includes("/login?"))return!0;if(t.url.toLowerCase().includes("/lab?"))return!1}let n=new URL("tree?",cE(e)).toString();return t=await this.makeRequest(n,{method:"get",redirect:"manual",headers:{Connection:"keep-alive"}}),t.status===404?(O(`Jupyter Server not found at ${e}, got 404 for ${n}`),!1):t.status!==200}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=_.jupyterSelfCertEnable,s=_.jupyterSelfCertClose,a=await Wu.window.showErrorMessage(_.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Wu.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}async getSessionCookie(e,t,n){let i,o,s=new URLSearchParams;s.append("_xsrf",t),s.append("password",n);let a=await this.makeRequest(new URL("login?",cE(e)).toString(),{method:"post",headers:{Cookie:`_xsrf=${t}`,Connection:"keep-alive","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},body:s.toString(),redirect:"manual"});if(a.status===302){let l=this.getCookies(a);l.size>0&&(i=l.entries().next().value[0],o=l.entries().next().value[1])}return{sessionCookieName:i,sessionCookieValue:o}}getCookies(e){let t=new Map,i=(e.headers.raw?e.headers.raw():e.headers)["set-cookie"];return i&&i.forEach(o=>{let s=o.substring(0,o.indexOf("=")),a=o.substring(o.indexOf("=")+1);t.set(s,a)}),t}onDidRemoveServers(e){e.forEach(t=>{t.id.startsWith("_builtin")&&this.savedConnectInfo.delete(t.handle)})}};function cE(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}d();var fO=require("vscode");var pO=class{constructor(e,t,n,i,o,s,a){this.multiStepFactory=e;this.asyncDisposableRegistry=t;this.configService=n;this.agentCreator=i;this.requestCreator=o;this.serverUriStorage=s;this.disposables=a;this.savedConnectInfo=new Map;this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}async getPasswordConnectionInfo(e){if(!e.url||e.url.length<1)throw new Error("Invalid URL");if(!await this.isJupyterHub(e.url))throw new Error("Not a Jupyter Hub Url");let t=zte(e.url),n=e.disposables||[],i=!Array.isArray(e.disposables),o=this.savedConnectInfo.get(e.handle);return o||(o=this.getJupyterHubConnectionInfo(t,e.validationErrorMessage).then(s=>((!s||s.requiresPassword&&Object.keys(s).length===1)&&(ue(`Password for ${t} was invalid.`),this.savedConnectInfo.delete(e.handle)),s)),o.catch(()=>this.savedConnectInfo.delete(e.handle)),o.finally(()=>{i&&he(n)}).catch(y),this.savedConnectInfo.set(e.handle,o)),o}async isJupyterHub(e){try{if(e.toLowerCase().includes("/user/")&&e.includes("token="))return!1;if(e.toLowerCase().includes("/user/")&&!e.includes("token="))return!0;let t=await this.makeRequest(new URL("hub/api",zte(e)).toString(),{method:"get"});if(t.status!==200)return!1;try{let n=await t.json();return q(`JupyterHub version is ${n&&n.version} for url ${e}`),n&&n.version}catch(n){}return!1}catch(t){return q(`Error in detecting whether url is isJupyterHub: ${t}`),!1}}async getJupyterHubConnectionInfo(e,t){try{let n=await this.getUserNameAndPassword(t);if(n.username||n.password){let i=await this.getJupyterHubConnectionInfoFromLogin(e,n.username,n.password);if(i){let o=Object.keys(i||{}).length===0,s=o?"emptyResponseFromLogin":"gotResponseFromLogin";J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:o,info:s})}else{J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:!0,info:"emptyResponseFromLogin"}),i=await this.getJupyterHubConnectionInfoFromApi(e,n.username,n.password);let o=Object.keys(i||{}).length===0,s=o?"emptyResponseFromApi":"gotResponseFromApi";J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:o,info:s})}return i}return J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:!1,info:"passwordNotRequired"}),{requiresPassword:!1}}catch(n){throw J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:!0,info:"failure"}),n}}async getJupyterHubConnectionInfoFromLogin(e,t,n){let i=new URL(e),o=`${i.protocol}//${i.host}`,s=new URLSearchParams;s.append("username",t||""),s.append("password",n||"");let a=await this.makeRequest(`${o}/hub/login?next=`,{method:"POST",headers:{Connection:"keep-alive",Referer:`${o}/hub/login`,"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},body:s.toString(),redirect:"manual"});if(a&&a.status===302){let c=[...this.getCookies(a).entries()].reduce((u,p)=>`${u};${p[0]}=${p[1]}`,"");if(a=await this.makeRequest(`${o}/hub/api/users/${t}/tokens`,{method:"POST",headers:{Connection:"keep-alive",Cookie:c,Referer:`${o}/hub/login`}}),a.ok&&a.status===200){let u=await a.json();if(u&&u.token&&u.id)return await this.makeRequest(`${o}/hub/api/users/${t}/server`,{method:"POST",headers:{Connection:"keep-alive",Cookie:c,Referer:`${o}/hub/login`}}),this.asyncDisposableRegistry.push({dispose:async()=>{this.makeRequest(`${o}/hub/api/users/${t}/tokens/${u.id}`,{method:"DELETE",headers:{Connection:"keep-alive",Cookie:c,Referer:`${o}/hub/login`}}).catch(y)}}),{requestHeaders:{},remappedBaseUrl:`${o}/user/${t}`,remappedToken:u.token,requiresPassword:!0}}}}async getJupyterHubConnectionInfoFromApi(e,t,n){let i=new URL(e),o=`${i.protocol}//${i.host}`,s=await this.makeRequest(`${o}/hub/api/authorizations/token`,{method:"POST",headers:{Connection:"keep-alive","content-type":"application/json;charset=UTF-8"},body:`{ "username": "${t||""}", "password": "${n||""}"  }`,redirect:"manual"});if(s.ok&&s.status===200){let a=await s.json();if(a&&a.user&&a.user.server&&a.token)return{requestHeaders:{},remappedBaseUrl:`${o}${a.user.server}`,remappedToken:a.token,requiresPassword:!0}}return{requiresPassword:!1}}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async getUserNameAndPassword(e){let t=this.multiStepFactory.create(),n={username:"",password:"",validationMessage:e};return await t.run(this.getUserNameMultiStep.bind(this),n),n}async getUserNameMultiStep(e,t){if(t.username=await e.showInputBox({title:_.jupyterSelectUserAndPasswordTitle,prompt:_.jupyterSelectUserPrompt,validate:this.validateUserNameOrPassword,validationMessage:t.validationMessage,value:""}),t.username)return this.getPasswordMultiStep.bind(this)}async validateUserNameOrPassword(e){}async getPasswordMultiStep(e,t){t.password=await e.showInputBox({title:_.jupyterSelectUserAndPasswordTitle,prompt:_.jupyterSelectPasswordPrompt,validate:this.validateUserNameOrPassword,value:"",password:!0})}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=_.jupyterSelfCertEnable,s=_.jupyterSelfCertClose,a=await fO.window.showErrorMessage(_.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,fO.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}getCookies(e){let t=new Map,i=(e.headers.raw?e.headers.raw():e.headers)["set-cookie"];return i&&i.forEach(o=>{let s=o.substring(0,o.indexOf("=")),a=o.substring(o.indexOf("=")+1);t.set(s,a)}),t}onDidRemoveServers(e){e.forEach(t=>{t.id.startsWith("_builtin")&&this.savedConnectInfo.delete(t.handle)})}};function zte(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}var mO="user-jupyter-server-uri-list-version2";var JCe="DataScienceAllowInsecureConnections",uE=class extends zr{constructor(t,n,i,o,s,a,l,c,u,p,f,m,h,g=HO){super();this.jupyterConnection=n;this.context=f;this.fs=m;this.jupyterServerProviderRegistry=h;this.id=g;this.extensionId=Xe;this.documentation=mt.Uri.parse("https://aka.ms/vscodeJuptyerExtKernelPickerExistingServer");this.displayName=_.UserJupyterServerUrlProviderDisplayName;this.detail=_.UserJupyterServerUrlProviderDetail;this._onDidChangeHandles=this._register(new mt.EventEmitter);this.onDidChangeHandles=this._onDidChangeHandles.event;this._onDidChangeServers=this._register(new mt.EventEmitter);this.onDidChangeServers=this._onDidChangeServers.event;a.push(this),this.newStorage=new $D(i),this.secureConnectionValidator=new YD(s),this.jupyterServerUriInput=new GD(p),this.jupyterServerUriDisplayName=new A9,this.jupyterPasswordConnect=new dO(t,u,p,o,a),this.jupyterHubPasswordConnect=new pO(l,c,t,u,p,o,a)}activate(){let t=this._register(this.jupyterServerProviderRegistry.createJupyterServerCollection(Xe,this.id,this.displayName,this));t.commandProvider=this,t.documentation=this.documentation,this._register(this.onDidChangeHandles(()=>this._onDidChangeServers.fire(),this)),this._register(mt.commands.registerCommand("dataScience.ClearUserProviderJupyterServerCache",async()=>{await Promise.all([this.newStorage.clear().catch(y),this.fs.delete(mt.Uri.joinPath(this.context.globalStorageUri,xS)).catch(y)]),this._onDidChangeHandles.fire()})),this.initializeServers().catch(y)}async resolveJupyterServer(t,n){let i=await this.getServerUri(t.id);return{...t,connectionInformation:{id:t.id,label:t.label,baseUrl:mt.Uri.parse(i.baseUrl),token:i.token,headers:i.authorizationHeader,mappedRemoteNotebookDir:i.mappedRemoteNotebookDir?mt.Uri.file(i.mappedRemoteNotebookDir):void 0}}}async handleCommand(t,n){let i=new mt.CancellationTokenSource;this._register(new mt.Disposable(()=>{i.cancel(),i.dispose()}));try{let o="url"in t?t.url:void 0,s=await this.captureRemoteJupyterUrl(i.token,o);if(!s||s===Ze.cancel)throw new mt.CancellationError;if(s&&s instanceof Ze)return;let l=(await this.provideJupyterServers(i.token)).find(c=>c.id===s);if(!l)throw new Error(`Server ${s} not found`);return l}catch(o){if(o instanceof mt.CancellationError)throw o;O("Failed to select a Jupyter Server",o);return}finally{i.cancel(),i.dispose()}}async provideCommands(t,n){let i="";try{t=(t||"").trim(),["http:","https:"].includes(new URL(t.trim()).protocol.toLowerCase())&&(i=t)}catch(o){}return i?[{label:_.connectToToTheJupyterServer(i),url:i}]:[{label:_.jupyterSelectUriCommandLabel,canBeAutoSelected:!0}]}async provideJupyterServers(t){return await this.initializeServers(),(await this.newStorage.getServers(!1)).map(i=>({id:i.handle,label:i.serverInfo.displayName}))}async removeJupyterServer(t){await this.initializeServers(),await this.newStorage.remove(t.id),this._onDidChangeHandles.fire()}initializeServers(){if(this._cachedServerInfoInitialized)return this._cachedServerInfoInitialized;let t=Me();return this._cachedServerInfoInitialized=t.promise,(async()=>{this.newStorage.getServers(!1).catch(y),t.resolve()})().then(()=>t.resolve(),n=>t.reject(n)).catch(y),this._cachedServerInfoInitialized}recommendInstallingJupyterHubExtension(){if(!mt.workspace.getConfiguration("jupyter").get("bypassJupyterHubExtensionCheck"))throw mt.extensions.getExtension(Wv)?mt.window.showInformationMessage(_.useJupyterHubExtension,{modal:!0,detail:_.useJupyterHubExtensionDetail}).then(()=>{mt.commands.executeCommand("notebook.selectKernel",{notebookEditor:mt.window.activeNotebookEditor}).then(y,y)},y):mt.window.showInformationMessage(_.installJupyterHub,{modal:!0,detail:_.installJupyterHubDetail},Be.install,Be.moreInfo).then(t=>{t===Be.install?mt.commands.executeCommand("workbench.extensions.installExtension",Wv,{context:{skipWalkthrough:!0}}).then(y,y):t===Be.moreInfo&&mt.env.openExternal(mt.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter-hub")).then(y,y)},y),new mt.CancellationError}async captureRemoteJupyterUrl(t,n=""){await this.initializeServers();let i=[],o={baseUrl:"",displayName:"",token:""},s="",a=!1,l=!1,c,u="Get Url",p="Get Url",f=n,m=!1;if(n){let h=await this.jupyterServerUriInput.parseUserUriAndGetValidationError(n);typeof h.validationError=="string"?(s=h.validationError,u="Get Url"):(m=!0,o=h.jupyterServerUri,u="Check Passwords")}try{let h=!1,g=!1;for(;;)try{if(c=(0,Xte.default)(),u==="Get Url"){m=!1,u="Check Passwords",p=void 0;let I=s;s="";let S=await this.jupyterServerUriInput.getUrlFromUser(f||n,I,i);o=S.jupyterServerUri,f=S.url}if(t.isCancellationRequested)return Ze.cancel;let v=[];if(u==="Check Passwords"){u="Check Insecure Connections",p=m&&n?void 0:"Get Url";try{let I=s;s="",h=await this.jupyterHubPasswordConnect.isJupyterHub(o.baseUrl),h&&this.recommendInstallingJupyterHubExtension();let S=h?await this.jupyterHubPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,handle:c,displayName:o.displayName,validationErrorMessage:I,disposables:v}):await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:c,validationErrorMessage:I,disposables:v});a=S.requiresPassword,o.authorizationHeader=S.requestHeaders,g=!1}catch(I){if(g=!1,I instanceof mt.CancellationError||I==Ze.back||I==Ze.cancel)throw I;if(!Hs.isSelfCertsError(I)){if(!lu.isSelfCertsExpiredError(I)){Av(c,o.baseUrl,h,"ConnectionFailure");let S=/(https?:\/\/[^\s]+)/g,x=(I.message||I.toString()).replace(S,D=>`[${D}](${D})`);if(s=(Tn()?_.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:_.remoteJupyterConnectionFailedWithoutServerWithError)(x),o.token.length>0&&(I.message||"").toLowerCase()==="Failed to fetch".toLowerCase())g=!0;else{u="Get Url";continue}}}}finally{v.forEach(I=>this._register(I))}}if(t.isCancellationRequested)return Ze.cancel;if(u==="Check Insecure Connections"&&(u="Verify Connection",p=a&&o.token.length===0?"Check Passwords":"Get Url",p==="Get Url"&&(p=m&&n?void 0:"Get Url"),!a&&o.token.length===0&&new URL(o.baseUrl).protocol.toLowerCase()==="http:"&&(l=!0,he(v),!await this.secureConnectionValidator.promptToUseInsecureConnections())))return Av(c,o.baseUrl,h,"InsecureHTTP"),Ze.cancel;if(t.isCancellationRequested)return Ze.cancel;if(u==="Verify Connection")try{u="Get Display Name",await this.jupyterConnection.validateRemoteUri({id:this.id,handle:c,extensionId:Xe},o,!0)}catch(I){if(ue("Uri verification error",I),g&&s){u="Get Url";continue}if(I instanceof mt.CancellationError||I==Ze.back||I==Ze.cancel)throw I;if(Hs.isSelfCertsError(I)){s=_.jupyterSelfCertFailErrorMessageOnly,u="Get Url",Av(c,o.baseUrl,h,"SelfCert");continue}else if(lu.isSelfCertsExpiredError(I)){s=_.jupyterSelfCertExpiredErrorMessageOnly,u="Get Url",Av(c,o.baseUrl,h,"ExpiredCert");continue}else if(a&&o.token.length===0){s=_.passwordFailure,u="Check Passwords",Av(c,o.baseUrl,h,"AuthFailure");continue}else{Av(c,o.baseUrl,h,"ConnectionFailure");let S=/(https?:\/\/[^\s]+)/g,x=(I.message||I.toString()).replace(S,D=>`[${D}](${D})`);s=(Tn()?_.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:_.remoteJupyterConnectionFailedWithoutServerWithError)(x),u="Get Url";continue}}finally{he(v)}if(t.isCancellationRequested)return Ze.cancel;if(u==="Get Display Name"){he(v),p=l?"Check Insecure Connections":a&&o.token.length===0?"Check Passwords":"Get Url",p==="Get Url"&&(p=m&&n?void 0:"Get Url"),o.displayName=await this.jupyterServerUriDisplayName.getDisplayName(c,o.displayName||new URL(o.baseUrl).hostname);break}}catch(v){if(v instanceof mt.CancellationError||v===Ze.cancel)return Ze.cancel;if(v===Ze.back){if(!p)return Ze.back;u=p;continue}throw v}return t.isCancellationRequested?Ze.cancel:(await this.addNewServer({handle:c,uri:f,serverInfo:o}),oA({extensionId:this.extensionId,id:this.id,handle:c},o.displayName),Av(c,o.baseUrl,h),c)}catch(h){if(h instanceof mt.CancellationError)return Ze.cancel;throw h}finally{he(i)}}async addNewServer(t){await this.newStorage.add(t),this._onDidChangeHandles.fire()}async getServerUri(t){let i=(await this.newStorage.getServers(!1)).find(c=>c.handle===t);if(!i)throw new Error("Server not found");let o=i.serverInfo,s=this.jupyterServerUriDisplayName.displayNamesOfHandles.get(t);s&&(o.displayName=s);let a=await this.jupyterHubPasswordConnect.isJupyterHub(o.baseUrl),l=Object.assign({},o);try{let c=a?await this.jupyterHubPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,handle:t,displayName:o.displayName}):await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:t});l=Object.assign({},o,{authorizationHeader:c.requestHeaders||o.authorizationHeader}),a&&c.remappedBaseUrl&&(l.baseUrl=c.remappedBaseUrl),a&&c.remappedToken&&(l.token=c.remappedToken)}catch(c){O("Failed to validate Password info",c)}return l}};uE=E([(0,Zr.injectable)(),b(0,(0,Zr.inject)(Ke)),b(1,(0,Zr.inject)(bn)),b(2,(0,Zr.inject)(Yx)),b(3,(0,Zr.inject)(yr)),b(4,(0,Zr.inject)(wt)),b(4,(0,Zr.named)(ur)),b(5,(0,Zr.inject)(oe)),b(6,(0,Zr.inject)(H1)),b(7,(0,Zr.inject)(_o)),b(8,(0,Zr.inject)(o1)),b(8,(0,Zr.optional)()),b(9,(0,Zr.inject)(Qg)),b(10,(0,Zr.inject)(ut)),b(11,(0,Zr.inject)(Tt)),b(12,(0,Zr.inject)(mr)),b(13,(0,Zr.optional)()),b(13,(0,Zr.inject)(Date.now().toString()))],uE);var GD=class{constructor(e){this.requestCreator=e}async getUrlFromUser(e,t="",n){if(!e&&!yP)try{let s=await mt.env.clipboard.readText(),a=s.trim().startsWith("https://github.com/")?void 0:mt.Uri.parse(s.trim(),!0);e=s&&a&&a.scheme.toLowerCase().startsWith("http")?s:""}catch(s){e=""}let i=mt.window.createInputBox();n.push(i),i.title=_.jupyterSelectUriInputTitle,i.placeholder=_.jupyterSelectUriInputPlaceholder,i.value=e,i.validationMessage=t,i.buttons=[mt.QuickInputButtons.Back],i.ignoreFocusOut=!0,i.show();let o=Me();return i.onDidChangeValue(()=>i.validationMessage="",this,n),i.onDidHide(()=>o.reject(Ze.cancel),this,n),i.onDidTriggerButton(s=>{s===mt.QuickInputButtons.Back&&o.reject(Ze.back)},this,n),i.onDidAccept(async()=>{let s=await this.parseUserUriAndGetValidationError(i.value);if(typeof s.validationError=="string"){i.validationMessage=s.validationError;return}o.resolve(s)}),o.promise}async parseUserUriAndGetValidationError(e){let t=e.trim().replace(/\/(lab|tree)(\??)$/,""),n=M9(t,"");return n?(n.baseUrl=await qCe(t,this.requestCreator)||n.baseUrl,!t.toLowerCase().startsWith("http:")&&!t.toLowerCase().startsWith("https:")?{validationError:_.jupyterSelectURIMustBeHttpOrHttps}:{jupyterServerUri:n,url:t,validationError:void 0}):{validationError:_.jupyterSelectURIInvalidURI}}};GD=E([b(0,(0,Zr.inject)(Qg))],GD);async function qCe(r,e){var t;try{if(r=((t=M9(r,""))==null?void 0:t.baseUrl)||r,new URL(r).pathname==="/")return r;let n=r.indexOf("token=")>0?r.substring(0,r.indexOf("token=")):r,s=(await e.getFetchMethod()(n,{method:"GET",redirect:"manual"})).headers.get("location");if(s&&s.includes("login?"))return s.substring(0,s.indexOf("login?"))}catch(n){q("Unable to identify the baseUrl of the Jupyter Server",n)}}function Av(r,e,t,n){e=e.trim().toLowerCase();let i=zt({handle:r,extensionId:Xe,id:HO});Promise.all([Ot(e.toLowerCase()),Ot(i.toLowerCase())]).then(([o,s])=>{J("DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",void 0,{serverIdHash:s,failed:!!n,baseUrlHash:o,isJupyterHub:t,isLocalHost:["localhost","127.0.0.1","::1"].includes(new URL(e).hostname),reason:n})}).catch(o=>O(`Failed to hash remote url ${e}`,o))}var A9=class{constructor(){this.displayNamesOfHandles=new Map}async getDisplayName(e,t){let n=[];try{let i=mt.window.createInputBox();n.push(i),i.ignoreFocusOut=!0,i.title=_.jupyterRenameServer,i.value=t,i.placeholder=_.jupyterServerUriDisplayNameInputPlaceholder,i.buttons=[mt.QuickInputButtons.Back],i.show();let o=Me();return n.push(i.onDidHide(()=>o.reject(Ze.cancel))),i.onDidTriggerButton(s=>{s===mt.QuickInputButtons.Back&&o.reject(Ze.back)},this,n),i.onDidAccept(()=>{let s=i.value.trim()||t;this.displayNamesOfHandles.set(e,s),o.resolve(s)},this,n),await o.promise}finally{he(n)}}},YD=class{constructor(e){this.globalMemento=e}async promptToUseInsecureConnections(){if(this.globalMemento.get(JCe,!1))return!0;let e=[],t=Me();try{let n=mt.window.createQuickPick();return e.push(n),n.canSelectMany=!1,n.ignoreFocusOut=!0,n.title=_.insecureSessionMessage,n.buttons=[mt.QuickInputButtons.Back],n.items=[{label:Be.bannerLabelYes},{label:Be.bannerLabelNo}],n.show(),e.push(n.onDidHide(()=>t.reject(Ze.cancel))),n.onDidTriggerButton(i=>{i===mt.QuickInputButtons.Back&&t.reject(Ze.back)},this,e),n.onDidAccept(()=>t.resolve(n.selectedItems.some(i=>i.label===Be.bannerLabelYes)),this,e),await t.promise}finally{he(e)}}};YD=E([b(0,(0,Zr.inject)(wt)),b(0,(0,Zr.named)(ur))],YD);function M9(r,e){if(!r.startsWith(st.REMOTE_URI))try{let t=new URL(r);return{baseUrl:`${t.protocol}//${t.host}${t.pathname==="/lab"||t.pathname==="/tree"?"":t.pathname}`,token:t.searchParams.get("token")||"",displayName:e||t.hostname}}catch(t){O(`Failed to parse URI ${r}`,t);return}}function Qte(r){return r.map(e=>({handle:e.handle,uri:e.uri,displayName:e.serverInfo.displayName}))}function GCe(r){let e=[];return r.forEach(t=>{let n=M9(t.uri,t.displayName);n&&e.push({handle:t.handle,uri:t.uri,serverInfo:n})}),e}var $D=class{constructor(e){this.encryptedStorage=e;this.updatePromise=Promise.resolve()}async getServers(e){if(this.servers&&!e)return this.servers;let t=await this.encryptedStorage.retrieve(gi.JupyterServerRemoteLaunchService,mO);if(!t||t==="[]")return[];try{return this.servers=GCe(JSON.parse(t))}catch(n){return[]}}async add(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e.handle).concat(e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).concat(e);this.servers=t,await this.encryptedStorage.store(gi.JupyterServerRemoteLaunchService,mO,JSON.stringify(Qte(t)))}).catch(y))}async remove(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).filter(n=>n.handle!==e);return this.servers=t,this.encryptedStorage.store(gi.JupyterServerRemoteLaunchService,mO,JSON.stringify(Qte(t)))}).catch(y))}async clear(){this.servers=[],await(this.updatePromise=this.updatePromise.then(async()=>{this.servers=[],await this.encryptedStorage.store(gi.JupyterServerRemoteLaunchService,mO,void 0)}).catch(y))}};$D=E([b(0,(0,Zr.inject)(Yx))],$D);d();var zD=z(re()),pE=require("vscode");var dE=class extends zr{constructor(t,n){super();this.uriProviderRegistration=t;this.serverUriStorage=n;this.handleMappings=new Map;this._onDidChangeHandles=this._register(new pE.EventEmitter);this.extensionId=Xe;this.id=oP;this.displayName="Jupyter Server for Testing";this.onDidChangeServers=this._onDidChangeHandles.event}async provideJupyterServers(t){return Array.from(this.handleMappings.values()).map(n=>n.server)}async resolveJupyterServer(t,n){return t}activate(){this._register(this.uriProviderRegistration.createJupyterServerCollection(Xe,this.id,this.displayName,this)),this._register(pE.commands.registerCommand("jupyter.selectjupyteruri",this.selectJupyterUri,this))}async selectJupyterUri(t){var c;De(`Setting Jupyter Server URI to remote: ${t}`);let n=t.toString(!0),i=new URL(n),o=pE.Uri.parse(`${i.protocol}//${i.host}${i.pathname==="/lab"?"":i.pathname}`),s=(c=i.searchParams.get("token"))!=null?c:"",a=await ol(t.toString(!0),"SHA-1"),l={label:this.displayName,id:a,connectionInformation:{baseUrl:o,token:s}};this.handleMappings.set(a,{uri:t,server:l}),await this.serverUriStorage.add({id:this.id,handle:a,extensionId:Xe}),this._onDidChangeHandles.fire()}};dE=E([(0,zD.injectable)(),b(0,(0,zD.inject)(mr)),b(1,(0,zD.inject)(yr))],dE);d();var hO=z(re());var QD=require("vscode");var fE=class{constructor(e){this.disposables=e}activate(){this.registerCommandsIfTrusted()}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){QD.workspace.isTrusted&&this.registerCommand(X.ContinueEditSessionInCodespace,this.continueEditSessionInCodespace)}registerCommand(e,t){let n=QD.commands.registerCommand(e,t,this);this.disposables.push(n)}async continueEditSessionInCodespace(){await QD.commands.executeCommand("_workbench.editSessions.actions.continueEditSession.github.codespaces.continueEditSessionInCodespaceWithJupyterServer")}};fE=E([(0,hO.injectable)(),b(0,(0,hO.inject)(oe))],fE);d();var Zte=z(re());var ere=require("vscode");var mE=class{activate(){this.eagerlyActivateOtherExtensions().catch(y)}async eagerlyActivateOtherExtensions(){await Promise.all(ere.extensions.all.filter(e=>{var t,n;return(n=(t=e.packageJSON)==null?void 0:t.contributes)==null?void 0:n.pythonRemoteServerProvider}).map(e=>e.isActive?Promise.resolve():e.activate().then(y,y)))}};mE=E([(0,Zte.injectable)()],mE);d();var gO=z(re()),tre=require("vscode");var hE=class{constructor(e){this.uriStorage=e}activate(){tre.commands.registerCommand("jupyter.getUsedAzMLServerHandles",()=>{let e=[];return this.uriStorage.all.forEach(n=>{n.provider.extensionId.toLowerCase()==="ms-toolsai.vscode-ai".toLowerCase()&&e.push(n.provider)}),e})}};hE=E([(0,gO.injectable)(),b(0,(0,gO.inject)(yr))],hE);d();var mp=require("vscode");var rre=z(re());var gE=class{activate(){let e=at.instance.get(oe),t=new Wi;e.push(t),e.push(mp.commands.registerCommand("jupyter.manageAccessToKernels",()=>YCe(t)))}};gE=E([(0,rre.injectable)()],gE);async function YCe(r){let e=await bz(),t=[];Array.from(e.entries()).forEach(([s])=>{var l,c;let a=(c=(l=mp.extensions.getExtension(s))==null?void 0:l.packageJSON)==null?void 0:c.displayName;a&&t.push({label:a,description:s,extensionId:s})});let n=[];r.add({dispose:()=>{n=he(n)}});let i=mp.window.createQuickPick();i.title=mp.l10n.t("Manage Access To Jupyter Kernels"),i.placeholder=mp.l10n.t("Choose which extensions can access Jupyter Kernels"),i.items=t,i.selectedItems=t.filter(s=>e.get(s.extensionId)===!0),i.canSelectMany=!0,i.ignoreFocusOut=!1;let o=!1;n.push(i),i.show(),await Promise.race([FV(i.onDidAccept,void 0,n).then(()=>o=!0),FV(i.onDidHide,void 0,n)]),o&&(await Iz(i.selectedItems.map(s=>s.extensionId)),n=he(n))}function nre(r,e,t){e.addSingleton(He,Z_),e.addSingleton(He,X_),e.addSingleton(He,Q_),e.addSingleton(He,lE),e.addSingleton(He,mE),e.addSingleton(He,dE),e.add(G1,rE),e.add(TI,eE),e.addSingleton(d1,tE),e.addSingleton(fp,fp),e.addSingleton(He,sE),Yte(e,t),Rte(r,t),e.addSingleton(He,uE),e.addSingleton(He,fE),e.addSingleton(He,hE),e.addSingleton(He,gE),e.addSingleton(a1,oE)}d();d();var XD=z(re()),ore=require("vscode");d();var ire=class{};"force_variable_refresh","settings_updated","activate","show_data_explorer","get_variables_request","get_variables_response","variable_explorer_toggle","set_variable_explorer_height","variable_explorer_height_response","open_link","variables_complete","update_settings","loc_init","update_variable_view_execution_count","get_html_by_id_request","get_html_by_id_response","restart_kernel";var vO=Symbol("INotebookWatcher"),yO=Symbol("IVariableViewProvider");var vE=class{constructor(e,t){this.extensionContext=e;this.variableViewProvider=t}activate(){this.extensionContext.subscriptions.push(ore.window.registerWebviewViewProvider(this.variableViewProvider.viewType,this.variableViewProvider,{webviewOptions:{retainContextWhenHidden:!1}}))}};vE=E([(0,XD.injectable)(),b(0,(0,XD.inject)(ut)),b(1,(0,XD.inject)(yO))],vE);d();var $a=z(re());d();var Ya=require("vscode");d();var bO=class{constructor(e,t){this.disposedCallback=t,this.callback=e}async dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}};d();d();var gp=require("vscode");var hp=class{constructor(e,t,n){this.configService=e;this.rootPath=t;this.scripts=n;this.disposed=!1;this.themeIsDarkPromise=Me();this.webviewInit=Me();this._disposables=[];this.onMessageListeners=[];this._onDidDisposeWebviewPanel=new gp.EventEmitter;this.onDataScienceSettingsChanged=async()=>{let e=JSON.stringify(await this.generateDataScienceExtraSettings());this.postMessageInternal("update_settings",e).catch(y)};this.onWebViewLoadFailed=async()=>{this.dispose()};this.onPossibleSettingsChange=async e=>{if(e.affectsConfiguration("workbench.colorTheme")||e.affectsConfiguration("editor.fontSize")||e.affectsConfiguration("editor.fontFamily")||e.affectsConfiguration("editor.cursorStyle")||e.affectsConfiguration("editor.cursorBlinking")||e.affectsConfiguration("editor.autoClosingBrackets")||e.affectsConfiguration("editor.autoClosingQuotes")||e.affectsConfiguration("editor.autoSurround")||e.affectsConfiguration("editor.autoIndent")||e.affectsConfiguration("editor.scrollBeyondLastLine")||e.affectsConfiguration("editor.fontLigatures")||e.affectsConfiguration("editor.scrollbar.verticalScrollbarSize")||e.affectsConfiguration("editor.scrollbar.horizontalScrollbarSize")||e.affectsConfiguration("files.autoSave")||e.affectsConfiguration("files.autoSaveDelay")||e.affectsConfiguration("jupyter.widgetScriptSources")){let t=await this.generateDataScienceExtraSettings();if(t){let n=JSON.stringify(t);this.postMessageInternal("update_settings",n).catch(y)}}};this._disposables.push(gp.workspace.onDidChangeConfiguration(this.onPossibleSettingsChange,this)),this._disposables.push(this.configService.getSettings(void 0).onDidChange(this.onDataScienceSettingsChanged.bind(this)))}get onDidDispose(){return this._onDidDisposeWebviewPanel.event}dispose(){this.disposed||(this.disposed=!0,this._disposables.forEach(e=>e.dispose())),this.webviewInit=void 0,this._onDidDisposeWebviewPanel.fire()}getHTMLById(e){if(!this.activeHTMLRequest)this.activeHTMLRequest=Me(),this.postMessageInternal("get_html_by_id_request",e).catch(y);else throw new Error("getHTMLById request already in progress");return this.activeHTMLRequest.promise}addMessageListener(e){this.onMessageListeners.push(e)}removeMessageListener(e){let t=this.onMessageListeners.indexOf(e);t>=0&&this.onMessageListeners.splice(t,1)}asWebviewUri(e){var t;if(!this.webview)throw new Error("asWebViewUri called too early");return(t=this.webview)==null?void 0:t.asWebviewUri(e)}postMessage(e,t){return this.postMessageInternal(e.toString(),t)}onMessage(e,t){switch(e){case"started":this.webViewRendered();break;case"get_html_by_id_response":this.activeHTMLRequest&&(this.activeHTMLRequest.resolve(t),this.activeHTMLRequest=void 0);break;default:break}this.onMessageListeners.forEach(n=>{n(e,t)})}async loadWebview(e,t){var n;if(this.disposed=!1,this.webviewInit=this.webviewInit||Me(),this.webview===void 0){let i=await this.generateDataScienceExtraSettings(),o=(n=gp.workspace.getWorkspaceFolder(e))==null?void 0:n.uri;this.webview=await this.provideWebview(e,i,o,t),this._disposables.push(this.webview.loadFailed(this.onWebViewLoadFailed,this))}this.onDataScienceSettingsChanged().catch(y),this.sendLocStrings().catch(y)}async generateDataScienceExtraSettings(){let e=this.owningResource,t=gp.workspace.getConfiguration("editor"),n=gp.workspace.getConfiguration("workbench"),i=n?n.get("colorTheme",JO):JO,o=gp.extensions.getExtension(sa);return{...JSON.parse(JSON.stringify(this.configService.getSettings(e))),extraSettings:{editor:{cursor:this.getValue(t,"cursorStyle","line"),cursorBlink:this.getValue(t,"cursorBlinking","blink"),autoClosingBrackets:this.getValue(t,"autoClosingBrackets","languageDefined"),autoClosingQuotes:this.getValue(t,"autoClosingQuotes","languageDefined"),autoSurround:this.getValue(t,"autoSurround","languageDefined"),autoIndent:this.getValue(t,"autoIndent",!1),fontLigatures:this.getValue(t,"fontLigatures",!1),scrollBeyondLastLine:this.getValue(t,"scrollBeyondLastLine",!0),verticalScrollbarSize:this.getValue(t,"scrollbar.verticalScrollbarSize",14),horizontalScrollbarSize:this.getValue(t,"scrollbar.horizontalScrollbarSize",10),fontSize:this.getValue(t,"fontSize",14),fontFamily:this.getValue(t,"fontFamily","Consolas, 'Courier New', monospace")},theme:i,hasPythonExtension:o!==void 0,isWeb:Ai()==="Unknown"}}}async sendLocStrings(){let e={collapseSingle:$t.collapseSingle,expandSingle:$t.expandSingle,openExportFileYes:_.openExportFileYes,openExportFileNo:_.openExportFileNo,noRowsInDataViewer:$t.noRowsInDataViewer,sliceIndexError:$t.sliceIndexError,sliceMismatchedAxesError:$t.sliceMismatchedAxesError,filterRowsTooltip:$t.sliceMismatchedAxesError,fetchingDataViewer:$t.fetchingDataViewer,dataViewerHideFilters:$t.dataViewerHideFilters,dataViewerShowFilters:$t.dataViewerShowFilters,refreshDataViewer:$t.refreshDataViewer,clearFilters:$t.refreshDataViewer,sliceSummaryTitle:$t.sliceSummaryTitle,sliceData:$t.sliceData,sliceSubmitButton:$t.sliceSubmitButton,sliceDropdownAxisLabel:$t.sliceDropdownAxisLabel,sliceDropdownIndexLabel:$t.sliceDropdownIndexLabel,variableExplorerNameColumn:$t.variableExplorerNameColumn,variableExplorerTypeColumn:$t.variableExplorerTypeColumn,variableExplorerCountColumn:$t.variableExplorerCountColumn,variableExplorerValueColumn:$t.variableExplorerValueColumn,collapseVariableExplorerLabel:$t.collapseVariableExplorerLabel,variableLoadingValue:$t.variableLoadingValue,showDataExplorerTooltip:$t.showDataExplorerTooltip,noRowsInVariableExplorer:$t.noRowsInVariableExplorer,loadingRowsInVariableExplorer:$t.loadingRowsInVariableExplorer,previousPlot:$t.previousPlot,nextPlot:$t.nextPlot,panPlot:$t.panPlot,zoomInPlot:$t.zoomInPlot,zoomOutPlot:$t.zoomOutPlot,exportPlot:$t.exportPlot,deletePlot:$t.deletePlot,selectedImageListLabel:$t.selectedImageListLabel,selectedImageLabel:$t.selectedImageLabel};this.postMessageInternal("loc_init",JSON.stringify(e)).catch(y)}async postMessageInternal(e,t){var n;this.webviewInit&&(await this.webviewInit.promise,(n=this.webview)==null||n.postMessage({type:e.toString(),payload:t}))}webViewRendered(){this.webviewInit&&!this.webviewInit.resolved&&this.webviewInit.resolve(),this.sendLocStrings().catch(y),this.onDataScienceSettingsChanged().catch(y)}getValue(e,t,n){return e?e.get(t,n):n}};E([Jv()],hp.prototype,"getHTMLById",1),E([Jv()],hp.prototype,"addMessageListener",1),E([Jv()],hp.prototype,"removeMessageListener",1);var IO=class extends hp{constructor(t,n,i,o,s){super(t,o,s);this.configService=t;this.provider=i;this.messageListener=n(this.onMessage.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webviewView(){return this.webview&&this.webview}async provideWebview(t,n,i,o){if(!o)throw new Error("WebviewViews must be passed an initial VS Code Webview");return this.provider.create({additionalPaths:i?[i]:[],rootPath:this.rootPath,cwd:t,listener:this.messageListener,scripts:this.scripts,settings:n,webviewHost:o})}};var sre=require("vscode");var Mv=class extends IO{constructor(t,n,i,o,s,a,l){let c=$i(i.extensionUri,"dist","webviews","webview-side","viewers");super(t,(u,p)=>new bO(u,p),n,c,[$i(c,"variableView.js")]);this.variables=o;this.disposables=s;this.notebookWatcher=a;this.experiments=l;this.notebookWatcher.onDidFinishExecutingActiveNotebook(this.activeNotebookExecuted,this,this.disposables),this.notebookWatcher.onDidChangeActiveNotebook(this.activeNotebookChanged,this,this.disposables),this.notebookWatcher.onDidRestartActiveNotebook(this.activeNotebookRestarted,this,this.disposables),this.variables.refreshRequired(this.sendRefreshMessage,this,this.disposables),Ya.window.onDidChangeActiveTextEditor(this.activeTextEditorChanged,this,this.disposables)}get owningResource(){}async load(t){await super.loadWebview(Ya.Uri.file(process.cwd()),t).catch(O),this.webviewView&&this.disposables.push(this.webviewView.onDidChangeVisibility(()=>{this.handleVisibilityChanged()})),this.handleVisibilityChanged()}get title(){return"variableView"}onMessage(t,n){switch(t){case"get_variables_request":this.handleMessage(t,n,this.requestVariables);break;case"show_data_explorer":this.handleMessage(t,n,this.showDataViewer);break;default:break}super.onMessage(t,n)}handleMessage(t,n,i){let o=n;i.bind(this)(o)}handleVisibilityChanged(){let t=new br("jupyter.variableViewVisible"),n=!1;this.webviewView&&(n=this.webviewView.visible),t.set(n).catch(y),n&&(J("DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE"),this.notebookWatcher.activeNotebookExecutionCount!==void 0?this.postMessage("update_variable_view_execution_count",{executionCount:this.notebookWatcher.activeNotebookExecutionCount}).catch(y):this.postMessage("force_variable_refresh").catch(y))}async showDataViewer(t){var n,i;t.variable.fileName=(i=t.variable.fileName)!=null?i:(n=this.notebookWatcher.activeKernel)==null?void 0:n.notebook.uri;try{if(this.experiments.inExperiment("DataViewerContribution")){let o=this.getMatchingVariableViewers(t.variable);if(o.length===0){await Ya.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers");return}else if(o.length===1){let s=o[0].jupyterVariableViewers.command;return Ya.commands.executeCommand(s,t.variable)}else{let s=o.filter(l=>l.extension.id!==Xe);if(s.length===1){let l=s[0].jupyterVariableViewers.command;return Ya.commands.executeCommand(l,t.variable)}let a=Ya.window.createQuickPick();a.title="Select DataFrame Viewer",a.items=o.map(l=>{var c,u;return{label:l.jupyterVariableViewers.title,detail:(u=(c=l.extension.packageJSON)==null?void 0:c.displayName)!=null?u:l.extension.id,command:l.jupyterVariableViewers.command}}),a.onDidAccept(()=>{let l=a.selectedItems[0];l&&(a.hide(),Ya.commands.executeCommand(l.command,t.variable).then(y,y))}),a.show()}}else return Ya.commands.executeCommand(X.ShowDataViewer,t.variable)}catch(o){O(o),J("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER"),Ya.window.showErrorMessage(_.showDataViewerFail).then(y,y)}}getMatchingVariableViewers(t){return this.getVariableViewers().filter(i=>i.jupyterVariableViewers.dataTypes.includes(t.type))}getVariableViewers(){return sre.extensions.all.filter(n=>{var i,o,s,a;return((o=(i=n.packageJSON)==null?void 0:i.contributes)==null?void 0:o.jupyterVariableViewers)&&((a=(s=n.packageJSON)==null?void 0:s.contributes)==null?void 0:a.jupyterVariableViewers.length)}).map(n=>{var o;let i=(o=n.packageJSON)==null?void 0:o.contributes;return i!=null&&i.jupyterVariableViewers?i.jupyterVariableViewers.map(s=>({extension:n,jupyterVariableViewers:s})):[]}).flat()}postProcessSupportsDataExplorer(t){let n=this.getVariableViewers();return t.pageResponse.forEach(i=>{this.experiments.inExperiment("DataViewerContribution")&&(i.supportsDataExplorer=n.some(o=>o.jupyterVariableViewers.dataTypes.includes(i.type)))}),t}async requestVariables(t){let n=this.notebookWatcher.activeKernel;if(n){let i=await this.variables.getVariables(t,n);this.postMessage("get_variables_response",this.postProcessSupportsDataExplorer(i)).catch(y),J("DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",{variableCount:i.totalCount})}else{let i={executionCount:t.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};this.postMessage("get_variables_response",i).catch(y)}}async activeNotebookExecuted(t){this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(y)}async activeNotebookChanged(t){t.executionCount?this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(y):this.postMessage("update_variable_view_execution_count",{executionCount:0}).catch(y),this.postMessage("force_variable_refresh").catch(y)}activeTextEditorChanged(){this.postMessage("force_variable_refresh").catch(y)}async activeNotebookRestarted(){this.postMessage("restart_kernel").catch(y)}async sendRefreshMessage(){this.postMessage("force_variable_refresh").catch(y)}};E([Fr("DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED")],Mv.prototype,"load",1),E([_n()],Mv.prototype,"showDataViewer",1),E([_n()],Mv.prototype,"requestVariables",1);var yE=class{constructor(e,t,n,i,o,s,a){this.configuration=e;this.webviewViewProvider=t;this.context=n;this.variables=i;this.disposables=o;this.notebookWatcher=s;this.experiments=a;this.viewType="jupyterViewVariables"}get activeVariableView(){if(!Sn())throw new Error("activeVariableView only for test code");return this.variableView?Promise.resolve(this.variableView):(this.activeVariableViewPromise=Me(),this.activeVariableViewPromise.promise)}async resolveWebviewView(e,t,n){e.webview.options={enableScripts:!0},this.variableView=new Mv(this.configuration,this.webviewViewProvider,this.context,this.variables,this.disposables,this.notebookWatcher,this.experiments),this.activeVariableViewPromise&&this.activeVariableViewPromise.resolve(this.variableView),await this.variableView.load(e)}};yE=E([(0,$a.injectable)(),b(0,(0,$a.inject)(Ke)),b(1,(0,$a.inject)(f1)),b(2,(0,$a.inject)(ut)),b(3,(0,$a.inject)(vo)),b(3,(0,$a.named)(st.ALL_VARIABLES)),b(4,(0,$a.inject)(oe)),b(5,(0,$a.inject)(vO)),b(6,(0,$a.inject)(Np))],yE);d();var yp=z(re());d();var lre=1e3,are;(t=>(t.Fetching="fetching",t.Skipped="skipped"))(are||(are={}));var ia;(p=>(p.Started="started",p.UpdateSettings="update_settings",p.InitializeData="init",p.GetAllRowsRequest="get_all_rows_request",p.GetAllRowsResponse="get_all_rows_response",p.GetRowsRequest="get_rows_request",p.GetRowsResponse="get_rows_response",p.CompletedData="complete",p.GetSliceRequest="get_slice_request",p.RefreshDataViewer="refresh_data_viewer",p.SliceEnablementStateChanged="slice_enablement_state_changed"))(ia||(ia={}));var bE=Symbol("IDataViewerFactory"),SO=Symbol("IDataViewer"),_O=Symbol("IJupyterVariableDataProvider"),EO=Symbol("IJupyterVariableDataProviderFactory"),IE=Symbol("IDataViewerDependencyService");var vp=class{constructor(e,t){this.variableManager=e;this.dependencyService=t;this.initialized=!1}get kernel(){return this._kernel}static getNormalizedColumns(e){return e.map(t=>{let n;switch(t.type){case"bool":n="bool";break;case"integer":case"int32":case"int64":case"float":case"float32":case"float64":case"number":n="number";break;default:n="string"}return{key:t.key,type:n}})}static parseShape(e){try{if(e.startsWith("(")&&e.endsWith(")"))return e.substring(1,e.length-1).split(",").map(t=>parseInt(t))}catch(t){O(`Could not parse IJupyterVariable with malformed shape: ${e}`)}}dispose(){}setDependencies(e,t){this._kernel=t,this.variable=e}async getDataFrameInfo(e,t){let n={};await this.ensureInitialized();let i=this.variable;return i&&((e||t)&&(i=await this.variableManager.getDataFrameInfo(i,this._kernel,e,t)),n={columns:i.columns?vp.getNormalizedColumns(i.columns):i.columns,indexColumn:i.indexColumn,rowCount:i.rowCount,dataDimensionality:i.dataDimensionality,shape:vp.parseShape(i.shape),sliceExpression:e,type:i.type,maximumRowChunkSize:i.maximumRowChunkSize,name:i.name,fileName:pt(i.fileName)}),t&&(this.variable=i),n}async getAllRows(e){let t=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(t=(await this.variableManager.getDataFrameRows(this.variable,0,this.variable.rowCount,this._kernel,e)).data),t}async getRows(e,t,n){let i=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(i=(await this.variableManager.getDataFrameRows(this.variable,e,t,this._kernel,n)).data),i}async ensureInitialized(){var e,t;!this.initialized&&this.variable&&(this.initialized=!0,(e=this._kernel)!=null&&e.kernelConnectionMetadata&&this.dependencyService&&await this.dependencyService.checkAndInstallMissingDependencies(_p()?this._kernel:((t=this._kernel)==null?void 0:t.kernelConnectionMetadata.interpreter)||this._kernel),this.variable=await this.variableManager.getDataFrameInfo(this.variable,this._kernel))}};vp=E([(0,yp.injectable)(),b(0,(0,yp.inject)(vo)),b(0,(0,yp.named)(st.ALL_VARIABLES)),b(1,(0,yp.inject)(IE)),b(1,(0,yp.optional)())],vp);d();var CO=z(re());var SE=class{constructor(e){this.serviceContainer=e}async create(e,t){let n=this.serviceContainer.get(_O);return n.setDependencies(e,t),n}};SE=E([(0,CO.injectable)(),b(0,(0,CO.inject)(jr))],SE);d();var Br=z(re()),xs=require("vscode");d();var xO=require("vscode");var wO=class{constructor(e){this.configuration=e}async isRequestedColumnSizeAllowed(e,t){if(e>lre&&await this.shouldAskForLargeData(t)){let n=_.tooManyColumnsMessage,i=_.tooManyColumnsYes,o=_.tooManyColumnsNo,s=_.tooManyColumnsDontAskAgain,a=await xO.window.showWarningMessage(n,i,o,s);return a===s&&await this.disableAskForLargeData(),a===i}return!0}async shouldAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();return t&&t.askForLargeDataFrames===!0}async disableAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();t&&(t.askForLargeDataFrames=!1,this.configuration.updateSetting("askForLargeDataFrames",!1,void 0,xO.ConfigurationTarget.Global).catch(y))}};var cre="ds_prompt_about_deprecation",_E=class{constructor(e,t,n,i,o,s,a,l,c,u,p,f,m,h){this.disposables=e;this.debugService=t;this.jupyterVariableDataProviderFactory=i;this.dataViewerFactory=o;this.variableProvider=s;this.errorHandler=a;this.dataViewerDependencyService=l;this.interpreterService=c;this.platformService=u;this.kernelProvider=p;this.interactiveWindowProvider=f;this.experimentService=m;this.globalMemento=h;this.dataViewerChecker=new wO(n),xs.workspace.isTrusted||xs.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){xs.workspace.isTrusted&&this.registerCommand(X.ShowDataViewer,this.onVariablePanelShowDataViewerRequest)}registerCommand(e,t){let n=xs.commands.registerCommand(e,t,this);this.disposables.push(n)}async onVariablePanelShowDataViewerRequest(e){var i,o;let t="variable"in e?e.variable:e;J("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX");let n=this.experimentService.inExperiment("DataViewerDeprecation");if(!this.globalMemento.get(cre)&&n&&(this.globalMemento.update(cre,!0).then(y,y),xs.window.showInformationMessage(_.dataViewerDeprecationMessage,_.dataViewerDeprecationRecommendationActionMessage).then(s=>{s===_.dataViewerDeprecationRecommendationActionMessage&&xs.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(y,y)},y)),(i=this.debugService)!=null&&i.activeDebugSession&&this.variableProvider&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory)try{if(this.debugService.activeDebugSession.configuration&&this.dataViewerDependencyService&&this.interpreterService){let p=await this.getDebugAdapterPython(this.debugService.activeDebugSession.configuration);p&&await this.dataViewerDependencyService.checkAndInstallMissingDependencies(p)}let s=hM(t),a=await this.variableProvider.getFullVariable(s),l=await this.jupyterVariableDataProviderFactory.create(a),c=await l.getDataFrameInfo(),u=(o=c==null?void 0:c.columns)==null?void 0:o.length;if(u&&await this.dataViewerChecker.isRequestedColumnSizeAllowed(u)){let p=`${_.dataExplorerTitle} - ${a.name}`,f=await this.dataViewerFactory.create(l,p);return J("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX"),f}}catch(s){J("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",void 0,void 0,s),O(s),this.errorHandler.handleError(s).then(y,y)}else try{let s=this.getActiveKernel();if(s&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory){let a=await this.jupyterVariableDataProviderFactory.create(t,s),l=`${_.dataExplorerTitle} - ${t.name}`;return await this.dataViewerFactory.create(a,l)}}catch(s){O(s),J("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER"),xs.window.showErrorMessage(_.showDataViewerFail).then(y,y)}}getActiveKernel(){var s,a;let e=(s=xs.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==Ct?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=(a=this.dataViewerFactory)==null?void 0:a.activeViewer;return o?this.kernelProvider.kernels.find(l=>l===o.kernel):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return xs.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}async getDebugAdapterPython(e){if(!this.interpreterService){De("Interpreter Service missing when trying getDebugAdapterPython");return}let t="";if(e.debugAdapterPython!==void 0?(De("Found debugAdapterPython on Debug Configuration to use"),t=e.debugAdapterPython):e.pythonPath&&(De("Found pythonPath on Debug Configuration to use"),t=e.pythonPath),t){let n=t;return n.startsWith("~")&&this.platformService.homeDir&&(n=CP(n,this.platformService.homeDir.path)),this.interpreterService.getInterpreterDetails(xs.Uri.file(n))}else return this.interpreterService.getActiveInterpreter()}};_E=E([(0,Br.injectable)(),b(0,(0,Br.inject)(oe)),b(1,(0,Br.inject)(ho)),b(1,(0,Br.optional)()),b(2,(0,Br.inject)(Ke)),b(3,(0,Br.inject)(EO)),b(3,(0,Br.optional)()),b(4,(0,Br.inject)(bE)),b(4,(0,Br.optional)()),b(5,(0,Br.inject)(vo)),b(5,(0,Br.optional)()),b(5,(0,Br.named)(st.DEBUGGER_VARIABLES)),b(6,(0,Br.inject)(Pn)),b(7,(0,Br.inject)(IE)),b(7,(0,Br.optional)()),b(8,(0,Br.inject)(pm)),b(8,(0,Br.optional)()),b(9,(0,Br.inject)(bs)),b(10,(0,Br.inject)($e)),b(11,(0,Br.inject)(_s)),b(12,(0,Br.inject)(Np)),b(13,(0,Br.inject)(wt)),b(13,(0,Br.named)(ur))],_E);d();var Ov=z(re()),Ds=require("vscode");var EE=class{constructor(e,t,n,i){this.interactiveWindowProvider=e;this.kernelProvider=t;this.dataViewerFactory=n;this.disposables=i;this._onDidFinisheExecutingActiveNotebook=new Ds.EventEmitter;this._onDidChangeActiveNotebook=new Ds.EventEmitter;this._onDidRestartActiveNotebook=new Ds.EventEmitter;this._executionCountTracker=new WeakMap;Ds.window.onDidChangeActiveNotebookEditor(this.activeEditorChanged,this,this.disposables),Ds.workspace.onDidCloseNotebookDocument(this.notebookEditorClosed,this,this.disposables),this.kernelProvider.onDidRestartKernel(o=>{this.handleRestart({state:1,notebook:o.notebook})},this,this.disposables),Ds.notebooks.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables)}get onDidChangeActiveNotebook(){return this._onDidChangeActiveNotebook.event}get onDidFinishExecutingActiveNotebook(){return this._onDidFinisheExecutingActiveNotebook.event}get onDidRestartActiveNotebook(){return this._onDidRestartActiveNotebook.event}get activeKernel(){var s;let e=(s=Ds.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==Ct?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=this.dataViewerFactory.activeViewer;return o?this.kernelProvider.kernels.find(a=>a===o.kernel):void 0}get activeNotebookExecutionCount(){var t;let e=(t=this.activeKernel)==null?void 0:t.notebook;return e?this._executionCountTracker.get(e):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return Ds.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}onDidChangeNotebookCellExecutionState(e){_r(e.cell.notebook)&&e.state===Ds.NotebookCellExecutionState.Idle&&this.handleExecute({notebook:e.cell.notebook,state:0,cell:e.cell})}handleExecute(e){var t,n,i,o,s,a;this.isNonSilentExecution(e)&&(((n=(t=e.cell)==null?void 0:t.executionSummary)==null?void 0:n.executionOrder)!==void 0&&this._executionCountTracker.set(e.notebook,(i=e.cell.executionSummary)==null?void 0:i.executionOrder),this.isActiveNotebookEvent(e)&&((s=(o=e.cell)==null?void 0:o.executionSummary)==null?void 0:s.executionOrder)!==void 0&&this.activeKernel&&this.kernelProvider.getKernelExecution(this.activeKernel).pendingCells.length===0&&this._onDidFinisheExecutingActiveNotebook.fire({executionCount:(a=e.cell.executionSummary)==null?void 0:a.executionOrder}))}handleRestart(e){this._executionCountTracker.delete(e.notebook),this.isActiveNotebookEvent(e)&&this._onDidRestartActiveNotebook.fire()}notebookEditorClosed(e){this._executionCountTracker.delete(e)}activeEditorChanged(e){let t={};if(e&&_r(e.notebook)){let n=this._executionCountTracker.get(e.notebook);n&&(t.executionCount=n)}this._onDidChangeActiveNotebook.fire(t)}isNonSilentExecution(e){var t;return!!(e.state===0&&e.cell&&((t=e.cell.executionSummary)!=null&&t.executionOrder))}isActiveNotebookEvent(e){var t;return((t=this.activeKernel)==null?void 0:t.notebook)===e.notebook}};EE=E([(0,Ov.injectable)(),b(0,(0,Ov.inject)(_s)),b(1,(0,Ov.inject)($e)),b(2,(0,Ov.inject)(bE)),b(3,(0,Ov.inject)(oe))],EE);d();var CE=z(re());var ure=require("vscode");var Km=class{constructor(e,t,n){this.serviceContainer=e;this.disposables=n;this.knownViewers=new Set;t.push(this),this.viewContext=new br(Cr.IsDataViewerActive),this.disposables.push(ure.commands.registerCommand(X.RefreshDataViewer,this.refreshDataViewer,this))}async dispose(){for(let e of this.knownViewers)e.dispose()}async create(e,t){let n,i=this.serviceContainer.get(SO);try{this.knownViewers.add(i),i.onDidDisposeDataViewer(this.updateOpenDataViewers,this,this.disposables),i.onDidChangeDataViewerViewState(this.updateViewStateContext,this,this.disposables),await i.showData(e,t),n=i}finally{n||i.dispose()}return n}get activeViewer(){return[...this.knownViewers.values()].find(e=>e.active)}updateOpenDataViewers(e){this.knownViewers.delete(e)}async updateViewStateContext(){let e=!1;this.knownViewers.forEach(t=>{t.active&&(e=!0)}),await this.viewContext.set(e)}refreshDataViewer(){for(let e of this.knownViewers)e.active&&e.refreshData().then(y,y)}};E([Fr("DATASCIENCE.START_SHOW_DATA_EXPLORER")],Km.prototype,"create",1),E([m1(1e3)],Km.prototype,"refreshDataViewer",1),Km=E([(0,CE.injectable)(),b(0,(0,CE.inject)(jr)),b(1,(0,CE.inject)(_o)),b(2,(0,CE.inject)(oe))],Km);d();var Vu=z(re()),za=require("vscode");d();var DO=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}async dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged(e)}};d();d();var L9;function K9(r,e){return L9&&L9.hasOwnProperty(r)?L9[r]:e}function F9(r,...e){return r.replace(/{(\d+)}/g,(t,n)=>e[n]===void 0?t:e[n])}var $Ce=/^\s*((?<StartRange>-?\d+:)|(?<StopRange>-?:\d+)|(?:(?<Start>-?\d+)(?::(?<Stop>-?\d+))?(?::(?<Step>-?\d+))?))\s*$/;function U9(r){let e=r.length-2;return"["+r.map(()=>e>0?(e-=1,"0"):":").join(", ")+"]"}function zCe(r,e){if(r.startsWith("[")&&r.endsWith("]")){let t,n=r.substring(1,r.length-1).split(",").map((i,o)=>{var a;let s=$Ce.exec(i);if((a=s==null?void 0:s.groups)!=null&&a.Start&&!s.groups.Stop){let l=parseInt(s.groups.Start),c=e[o];return(l>=0&&l>=c||l<0&&l<-c)&&(t={shapeIndex:o,value:l}),l}});if(t){let{shapeIndex:i,value:o}=t,s=K9("sliceIndexError","Index {0} out of range for axis {1} with {2} elements");return F9(s,o.toString(),i.toString(),e[i].toString())}else if(n&&n.length!==e.length){let i=K9("sliceMismatchedAxesError","Expected {0} axes, got {1} in slice expression");return F9(i,e.length.toString(),n.length.toString())}}return""}function dre(r,e){return zCe(r,e)===""}d();var wE=class extends hp{constructor(t,n,i,o,s,a,l){super(t,o,s);this.configService=t;this.provider=n;this._title=a;this.viewColumn=l;this.viewState={visible:!1,active:!1};this.webPanelViewStateChanged=t=>{let n=t.isVisible(),i=t.isActive(),o={visible:n,active:i},s={visible:this.viewState.visible,active:this.viewState.active};this.viewState.visible=n,this.viewState.active=i,this.onViewStateChanged({current:o,previous:s})};this.messageListener=i(this.onMessage.bind(this),this.webPanelViewStateChanged.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webPanel(){if(this.webview)return this.webview}async show(t){this.isDisposed||this.webPanel&&await this.webPanel.show(t)}dispose(){this.isDisposed||this.webPanel&&this.webPanel.close(),super.dispose()}get title(){return this._title}setTitle(t){this._title=t,!this.isDisposed&&this.webPanel&&this.webPanel.setTitle(t)}onViewStateChanged(t){}async provideWebview(t,n,i,o){return this.provider.create({viewColumn:this.viewColumn,listener:this.messageListener,title:this.title,rootPath:this.rootPath,scripts:this.scripts,settings:n,cwd:t,webviewHost:o,additionalPaths:i?[i]:[]})}};var pre="JupyterDataViewerPreferredViewColumn",Lv=class extends wE{constructor(t,n,i,o,s){var l;let a=$i(s.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(c,u,p)=>new DO(c,u,p),a,[$i(a,"dataExplorer.js")],_.dataExplorerTitle,(l=i.get(pre))!=null?l:za.ViewColumn.One);this.globalMemento=i;this.errorHandler=o;this.context=s;this.pendingRowsCount=0;this.sentDataViewerSliceDimensionalityTelemetry=!1;this._onDidDisposeDataViewer=new za.EventEmitter;this._onDidChangeDataViewerViewState=new za.EventEmitter;this.onDidDispose(this.dataViewerDisposed,this)}get active(){var t;return!!((t=this.webPanel)!=null&&t.isActive())}get refreshPending(){return this.pendingRowsCount>0}get onDidDisposeDataViewer(){return this._onDidDisposeDataViewer.event}get onDidChangeDataViewerViewState(){return this._onDidChangeDataViewerViewState.event}async showData(t,n){if(!this.isDisposed){this.dataProvider=t,await super.loadWebview(za.Uri.file(process.cwd())).catch(O),super.setTitle(n),await super.show(!0);let i=await this.prepDataFrameInfo();if(i.shape&&i.shape.length>2){this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length);let o=U9(i.shape);i=await this.getDataFrameInfo(o)}this.postMessage(ia.InitializeData,i).catch(y)}}get kernel(){if(this.dataProvider&&"kernel"in this.dataProvider)return this.dataProvider.kernel}dataViewerDisposed(){this._onDidDisposeDataViewer.fire(this)}async refreshData(){let t=this.currentSliceExpression;this.dataFrameInfoPromise=void 0;let n=await this.getDataFrameInfo(void 0,!0);if(t!==void 0&&n.shape!==void 0)if(dre(t,n.shape))n=await this.getDataFrameInfo(t);else{let i=U9(n.shape);n=await this.getDataFrameInfo(i)}De(`Refreshing data viewer for variable ${n.name}`),this.postMessage(ia.InitializeData,n).catch(y)}dispose(){super.dispose(),this.dataProvider&&(this.dataProvider.dispose(),this.dataProvider=void 0)}async onViewStateChanged(t){var n;t.current.active&&t.current.visible&&t.previous.active&&t.current.visible&&await this.globalMemento.update(pre,(n=this.webPanel)==null?void 0:n.viewColumn),this._onDidChangeDataViewerViewState.fire()}get owningResource(){}onMessage(t,n){switch(t){case ia.GetAllRowsRequest:this.getAllRows(n).catch(y);break;case ia.GetRowsRequest:this.getRowChunk(n).catch(y);break;case ia.GetSliceRequest:this.getSlice(n).catch(y);break;case ia.RefreshDataViewer:this.refreshData().catch(y),J("DATASCIENCE.REFRESH_DATA_VIEWER");break;case ia.SliceEnablementStateChanged:J("DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",void 0,{newState:n.newState?"checked":"unchecked"});break;default:break}super.onMessage(t,n)}getDataFrameInfo(t,n){return(!this.dataFrameInfoPromise||t!==this.currentSliceExpression)&&(this.dataFrameInfoPromise=this.dataProvider?this.dataProvider.getDataFrameInfo(t,n):Promise.resolve({}),this.currentSliceExpression=t),this.dataFrameInfoPromise}async prepDataFrameInfo(){this.rowsTimer=new Mt;let t=await this.getDataFrameInfo();try{J("DATASCIENCE.SHOW_DATA_EXPLORER",void 0,{rows:t.rowCount?t.rowCount:0,columns:t.columns?t.columns.length:0}),this.pendingRowsCount=t.rowCount?t.rowCount:0}catch(n){}return t}async getAllRows(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.dataProvider.getAllRows(t);return this.pendingRowsCount=0,this.postMessage(ia.GetAllRowsResponse,n)}})}getSlice(t){return this.wrapRequest(async()=>{var n;if(this.dataProvider){let i=await this.getDataFrameInfo(t.slice);return(n=i.shape)!=null&&n.length&&this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length),J("DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",void 0,{source:t.source}),this.postMessage(ia.InitializeData,i)}})}getRowChunk(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.getDataFrameInfo(t.sliceExpression),i=await this.dataProvider.getRows(t.start,Math.min(t.end,n.rowCount?n.rowCount:0),t.sliceExpression);return this.pendingRowsCount=Math.max(0,this.pendingRowsCount-i.length),this.postMessage(ia.GetRowsResponse,{rows:i,start:t.start,end:t.end})}})}async wrapRequest(t){try{return await t()}catch(n){if(n instanceof KS){O(n.message);let i=_.pythonInteractiveHelpLink;za.window.showErrorMessage(_.jupyterDataRateExceeded,i).then(o=>{o===i&&za.env.openExternal(za.Uri.parse(sP.JupyterDataRateHelpLink))},y),this.dispose()}O(n),this.errorHandler.handleError(n).then(y,y)}finally{this.sendElapsedTimeTelemetry()}}sendElapsedTimeTelemetry(){this.rowsTimer&&this.pendingRowsCount===0&&J("DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",void 0,{rowsTimer:this.rowsTimer.elapsedTime})}maybeSendSliceDataDimensionalityTelemetry(t){this.sentDataViewerSliceDimensionalityTelemetry||(J("DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",{numberOfDimensions:t}),this.sentDataViewerSliceDimensionalityTelemetry=!0)}};E([Fr("DATAVIEWER.WEBVIEW_LOADED")],Lv.prototype,"showData",1),Lv=E([(0,Vu.injectable)(),b(0,(0,Vu.inject)(MI)),b(1,(0,Vu.inject)(Ke)),b(2,(0,Vu.inject)(wt)),b(2,(0,Vu.named)(ur)),b(3,(0,Vu.inject)(Pn)),b(4,(0,Vu.inject)(ut))],Lv);d();var fre=z(re());d();d();d();var PO="0.20.0";var TO=require("vscode");var ZD=class{async getVersion(e,t){try{let n=await this._getVersion(e,t);return typeof n=="string"?JG(n):n}catch(n){ue(_.failedToGetVersionOfPandas,n.message);return}}async promptInstall(e,t,n){let i=n?_.pandasTooOldForViewingFormat(n,PO):_.pandasRequiredForViewing(PO);if((X9()?Be.install:await TO.window.showErrorMessage(i,{modal:!0},Be.install))===Be.install)await this._doInstall(e,t);else throw J("DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS"),new Error(i)}async checkOrInstall(e){let t=new TO.CancellationTokenSource;try{let n=await this.getVersion(e,t.token);if(t.token.isCancellationRequested){J("DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED");return}if(n){if(n.compare(PO)>0){J("DS_INTERNAL.SHOW_DATA_PANDAS_OK");return}J("DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD");let i=`${n.major}.${n.minor}.${n.build}`;await this.promptInstall(e,t,i)}J("DS_INTERNAL.SHOW_DATA_NO_PANDAS"),await this.promptInstall(e,t)}finally{t.dispose()}}};E([Fr("DS_INTERNAL.PYTHON_MODULE_INSTALL",{action:"displayed",moduleName:Ti.get(23)})],ZD.prototype,"promptInstall",1);var W9="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",QCe=`import pandas as _VSCODE_pandas;print(_VSCODE_pandas.__version__);print("${W9}"); del _VSCODE_pandas`;function XCe(r){return(r.kernelConnectionMetadata.interpreter&&Or(r.kernelConnectionMetadata.interpreter))==="Conda"?"%conda":"%pip"}var kO=class extends ZD{async execute(e,t){var o;if(!((o=t.session)!=null&&o.kernel))throw new sn;let n=await Ji(t.session.kernel,e),i=n.find(s=>s.output_type==="error");return i&&ue(_.failedToGetVersionOfPandas,i.message),n.map(s=>{var a;return(a=s.text)==null?void 0:a.toString()})}async _getVersion(e){let n=(await this.execute(QCe,e)).map(s=>s?s.toString():void 0).find(s=>s);if(!(n!=null&&n.includes(W9)))return ue(_.failedToGetVersionOfPandas,`Output is ${n}`),"";let i=dt(n.trim()),o=i.indexOf(W9);return o>=0?i[o-1]:""}async _doInstall(e){let t=`${XCe(e)} install pandas`;try{await this.execute(t,e),J("DATASCIENCE.USER_INSTALLED_PANDAS")}catch(n){throw J("DATASCIENCE.USER_INSTALLED_PANDAS",void 0,void 0,n),new Error(_.failedToInstallPandas)}}async checkAndInstallMissingDependencies(e){var t;if(J("DATAVIEWER.USING_KERNEL"),!((t=e.session)!=null&&t.kernel))throw J("DATASCIENCE.NO_ACTIVE_KERNEL_SESSION"),new Error("No no active kernel session.");await this.checkOrInstall(e)}};var xE=class{constructor(){this.withKernel=new kO}async checkAndInstallMissingDependencies(e){return this.withKernel.checkAndInstallMissingDependencies(e)}};xE=E([(0,fre.injectable)()],xE);d();var oa;(s=>(s.Started="started",s.UpdateSettings="update_settings",s.SendPlot="send_plot",s.CopyPlot="copy_plot",s.ExportPlot="export_plot",s.RemovePlot="remove_plot"))(oa||(oa={}));var mre=class{};oa.Started,oa.UpdateSettings,oa.SendPlot,oa.CopyPlot,oa.ExportPlot,oa.RemovePlot;var NO=Symbol("IPlotViewerProvider"),RO=Symbol("IPlotViewer");d();var Kv=z(re());var ju=require("vscode");d();var AO=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}async dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged&&this.viewChanged(e)}};var DE=class extends wE{constructor(t,n,i,o){let s=new Mt,a=$i(o.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(l,c,u)=>new AO(l,c,u),a,[$i(a,"plotViewer.js")],_.plotViewerTitle,ju.ViewColumn.One);this.fs=i;this.context=o;this.closedEvent=new ju.EventEmitter;this.removedEvent=new ju.EventEmitter;this.addPlot=async t=>{this.isDisposed||(await super.show(!1),this.postMessage(oa.SendPlot,t).catch(y))};super.loadWebview(ju.Uri.file(process.cwd())).catch(O).finally(()=>{J("PLOTVIEWER.WEBVIEW_LOADED",{duration:s.elapsedTime})})}get closed(){return this.closedEvent.event}get removed(){return this.removedEvent.event}async show(){if(!this.isDisposed)return super.show(!0)}dispose(){super.dispose(),this.removedEvent.dispose(),this.closedEvent&&this.closedEvent.fire(this)}get owningResource(){}onMessage(t,n){switch(t){case oa.CopyPlot:this.copyPlot(n.toString()).catch(y);break;case oa.ExportPlot:this.exportPlot(n).catch(y);break;case oa.RemovePlot:this.removePlot(n);break;default:break}super.onMessage(t,n)}removePlot(t){this.removedEvent.fire(t)}copyPlot(t){return Promise.resolve()}async exportPlot(t){De("exporting plot...");let n={};n[_.pngFilter]=["png"],n[_.svgFilter]=["svg"];let i=await ju.window.showSaveDialog({saveLabel:_.exportPlotTitle,filters:n});try{if(i)switch(Pp(i.path).toLowerCase()){case".png":let s=BR(t.png.replace("data:image/png;base64",""));await this.fs.writeFile(i,s);break;default:case".svg":await this.fs.writeFile(i,t.svg);break}}catch(o){O(o),ju.window.showErrorMessage(_.exportImageFailed(o.toString())).then(y,y)}}};DE=E([(0,Kv.injectable)(),b(0,(0,Kv.inject)(MI)),b(1,(0,Kv.inject)(Ke)),b(2,(0,Kv.inject)(Tt)),b(3,(0,Kv.inject)(ut))],DE);d();var eP=z(re());var PE=class{constructor(e,t){this.serviceContainer=e;this.imageList=[];this.closedViewer=()=>{this.currentViewer&&(this.currentViewer=void 0),this.currentViewerClosed&&(this.currentViewerClosed.dispose(),this.currentViewerClosed=void 0)};this.removedPlot=e=>{this.imageList.splice(e,1)};t.push(this)}async dispose(){this.currentViewer&&this.currentViewer.dispose()}async showPlot(e){this.imageList.push(e);let t=this.currentViewer?[e]:this.imageList,n=await this.getOrCreate();await Promise.all(t.map(n.addPlot))}async getOrCreate(){return this.currentViewer||(this.currentViewer=this.serviceContainer.get(RO),this.currentViewerClosed=this.currentViewer.closed(this.closedViewer),this.currentViewer.removed(this.removedPlot),J("DATASCIENCE.OPEN_PLOT_VIEWER"),await this.currentViewer.show()),this.currentViewer}};PE=E([(0,eP.injectable)(),b(0,(0,eP.inject)(jr)),b(1,(0,eP.inject)(_o))],PE);d();var OO=z(re()),Fm=require("vscode");var hre="image/svg+xml",MO={"image/png":"png","image/jpeg":"jpeg","image/gif":"gif",[hre]:"svg"},TE=class{constructor(e){this.fs=e}async savePlot(e,t,n){if(e.isClosed)return;let i=ZCe(e,t,n);if(!i)return O(`No plot to save ${Se(e.uri)}, id: ${t} for ${n}`);if(!(n.toLowerCase()in MO))return O(`Unsupported MimeType ${Se(e.uri)}, id: ${t} for ${n}`);let o=await this.getSaveTarget(i,n);o&&(o.path.toLowerCase().endsWith("pdf")?await this.saveAsPdf(i,o):await this.saveAsImage(i,o))}getSaveTarget(e,t){var l;let n=MO[t.toLowerCase()],i={};e.items.find(c=>c.mime.toLowerCase()===hre)&&(i[_.pdfFilter]=["pdf"],i[_.svgFilter]=["svg"]),n==="png"&&(i[_.pngFilter]=["png"]),Object.keys(i).length===0&&(i.Images=[n]);let o=(((l=Fm.workspace.workspaceFolders)==null?void 0:l.length)||0)>0?Fm.workspace.workspaceFolders[0].uri:void 0,s="output",a=o?Fm.Uri.joinPath(o,s):Fm.Uri.file(s);return Fm.window.showSaveDialog({defaultUri:a,saveLabel:_.exportPlotTitle,filters:i})}async saveAsImage(e,t){let n=Pp(t.path).substring(1),i=Object.keys(MO).find(s=>MO[s]===n),o=e.items.find(s=>s.mime===i);if(!o)throw new Error(`Unsupported MimeType ${t.toString()}, available mime Types: ${e.items.map(s=>s.mime).join(", ")}`);await this.fs.writeFile(t,o.data)}async saveAsPdf(e,t){return O("Save as PDF is not yet supported on the web.")}};TE=E([(0,OO.injectable)(),b(0,(0,OO.inject)(Tt))],TE);function ZCe(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e&&i.items.find(o=>o.mime===t))return i}d();var LO=z(re());var ewe="image/svg+xml",twe="image/png",bp=class{constructor(e){this.plotViewProvider=e}async openPlot(e,t){if(e.isClosed)return;let n=gre(e,t,ewe),i;if(n)i=new TextDecoder().decode(n.data);else{let o=gre(e,t,twe);if(!o)return O(`No SVG or PNG Plot to open ${Se(e.uri)}, id: ${t}`);i=rwe(o)}i&&await this.plotViewProvider.showPlot(i)}};bp=E([(0,LO.injectable)(),b(0,(0,LO.inject)(NO))],bp);function gre(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e)return i.items.find(o=>o.mime===t)}function rwe(r){let e=r.data,t=HR(e),n=nwe(e);return`<?xml version="1.0" encoding="utf-8" standalone="no"?>
<svg height="${n.height}" width="${n.width}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g>
        <image xmlns="http://www.w3.org/2000/svg" x="0" y="0" height="100%" width="100%" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/png;base64,${t}"/>
    </g>
</svg>`}function nwe(r){if(!iwe(r))throw new Error("The buffer is not a valid png");let e=new DataView(new Uint8Array(r).buffer);return{width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}function iwe(r){return r[0]===137&&r[1]===80&&r[2]===78&&r[3]===71&&r[4]===13&&r[5]===10&&r[6]===26&&r[7]===10&&r.length>8+21}d();var tP=z(re()),FO=require("vscode");d();var KO=Symbol("IPlotSaveHandler");var kE=class{constructor(e,t){this.plotSaveHandler=e;this.plotViewHandler=t;this.disposables=[]}dispose(){he(this.disposables)}activate(){this.activateImpl().catch(y)}async activateImpl(){let e=FO.extensions.getExtension(jv);if(!e)return;e.isActive||await e.activate(),e.exports.onDidReceiveMessage(({editor:n,message:i})=>{var s;let o=n.notebook||((s=FO.window.activeNotebookEditor)==null?void 0:s.notebook);o&&(i.type==="saveImageAs"?this.plotSaveHandler.savePlot(o,i.outputId,i.mimeType).catch(y):i.type==="openImageInPlotViewer"&&this.plotViewHandler.openPlot(o,i.outputId).catch(y))},this,this.disposables)}};kE=E([(0,tP.injectable)(),b(0,(0,tP.inject)(KO)),b(1,(0,tP.inject)(bp))],kE);d();var rP=z(re()),UO=require("vscode");var NE=class{constructor(e,t){this.kernelProvider=e;this.controllers=t;this.disposables=[];this.widgetOutputsPerNotebook=new WeakMap}dispose(){he(this.disposables)}activate(){let e=UO.notebooks.createRendererMessaging("jupyter-ipywidget-renderer");e.onDidReceiveMessage(this.onDidReceiveMessage.bind(this,e),this,this.disposables),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables)}onDidStartKernel(e){this.hookupKernel(e),e.onStarted(()=>this.hookupKernel(e),this,this.disposables),e.onRestarted(()=>this.hookupKernel(e),this,this.disposables)}hookupKernel(e){var s,a,l;this.widgetOutputsPerNotebook.delete(e.notebook);let t=(s=e.session)==null?void 0:s.kernel,n=(l=(a=e.session)==null?void 0:a.kernel)==null?void 0:l.iopubMessage;if(!n)return;let i=ci(),o=(c,u)=>{c===t&&(i.KernelMessage.isDisplayDataMsg(u)||i.KernelMessage.isUpdateDisplayDataMsg(u)||i.KernelMessage.isExecuteReplyMsg(u)||i.KernelMessage.isExecuteResultMsg(u))&&this.trackModelId(e.notebook,u)};n.connect(o),this.disposables.push(new UO.Disposable(()=>n.disconnect(o)))}trackModelId(e,t){let n=t.content;if(n.data&&typeof n.data=="object"&&Io in n.data){let i=n.data[Io];if(i&&"model_id"in i){let o=this.widgetOutputsPerNotebook.get(e)||new Set;o.add(i.model_id),this.widgetOutputsPerNotebook.set(e,o)}}}onDidReceiveMessage(e,{editor:t,message:n}){n&&typeof n=="object"&&n.command==="query-widget-state"&&this.queryWidgetState(e,t,n),n&&typeof n=="object"&&n.command==="ipywidget-renderer-loaded"&&this.sendWidgetVersionAndState(e,t)}queryWidgetState(e,t,n){let i=this.widgetOutputsPerNotebook.get(t.notebook),o=!!this.controllers.getSelected(t.notebook),s=!!(i!=null&&i.has(n.model_id));e.postMessage({command:"query-widget-state",model_id:n.model_id,hasWidgetState:s,kernelSelected:o},t).then(y,y)}sendWidgetVersionAndState(e,t){let n=this.kernelProvider.get(t.notebook),i=n==null?void 0:n.ipywidgetsVersion;n!=null&&n.ipywidgetsVersion&&q(`IPyWidget version in Kernel is ${n==null?void 0:n.ipywidgetsVersion}.`);let o=!!this.controllers.getSelected(t.notebook);e.postMessage({command:"ipywidget-renderer-init",version:i,widgetState:void 0,kernelSelected:o},t).then(y,y)}};NE=E([(0,rP.injectable)(),b(0,(0,rP.inject)($e)),b(1,(0,rP.inject)(Ht))],NE);function vre(r){r.addSingleton(He,kE),r.addSingleton(He,_E),r.add(SO,Lv),r.addSingleton(bE,Km),r.addSingleton(IE,xE),r.add(RO,DE),r.addSingleton(NO,PE),r.addSingleton(KO,TE),r.addSingleton(bp,bp),r.addSingleton(vO,EE),r.addSingleton(He,vE),r.addSingleton(He,NE),r.addSingleton(yO,yE),r.add(_O,vp),r.addSingleton(EO,SE)}d();var j9=V9();function WO(r,e,...t){let i=[...t].length===0?j9(e):j9(e,...t);return r?`${r} ${pP()}: ${i}`:i}var VO=class{constructor(e){this.prefix=e}traceLog(e,...t){console.log(j9(`${this.prefix||""} ${e}`,...t))}traceError(e,...t){console.error(WO("error",`${this.prefix||""} ${e}`,...t))}traceWarn(e,...t){console.warn(WO("warn",`${this.prefix||""} ${e}`,...t))}traceInfo(e,...t){console.info(WO("info",`${this.prefix||""} ${e}`,...t))}traceVerbose(e,...t){console.log(WO("verbose",`${this.prefix||""} ${e}`,...t))}};d();var xre=z(FL());d();var bre=z(re());var Fv=class{constructor(e){this.container=e}getContainer(){return this.container}add(e,t,n,i){n?this.container.bind(e).to(t).whenTargetNamed(n):this.container.bind(e).to(t),i&&i.forEach(o=>{this.addBinding(e,o)})}addFactory(e,t){this.container.bind(e).toFactory(t)}addBinding(e,t){this.container.bind(t).toService(e)}addSingleton(e,t,n,i){n?this.container.bind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.bind(e).to(t).inSingletonScope(),i&&i.forEach(o=>{this.addBinding(e,o)})}addSingletonInstance(e,t,n){n?this.container.bind(e).toConstantValue(t).whenTargetNamed(n):this.container.bind(e).toConstantValue(t)}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}rebind(e,t,n){n?this.container.rebind(e).to(t).whenTargetNamed(n):this.container.rebind(e).to(t)}rebindSingleton(e,t,n){n?this.container.rebind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.rebind(e).to(t).inSingletonScope()}rebindInstance(e,t,n){n?this.container.rebind(e).toConstantValue(t).whenTargetNamed(n):this.container.rebind(e).toConstantValue(t)}dispose(){this.container.unbindAll(),this.container.unload()}};E([Jv()],Fv.prototype,"getContainer",1),Fv=E([(0,bre.injectable)()],Fv);var Wn=require("vscode");d();var Ire=V9(),jO=class{constructor(e,t,n){this.channel=e;this.homeReplaceRegEx=t,this.userNameReplaceRegEx=n}format(e,t,...n){let i=e?`${pP()} [${e}] ${Ire(t,...n)}`:Ire(t,...n);return this.homeReplaceRegEx&&(i=i.replace(this.homeReplaceRegEx,"~")),this.userNameReplaceRegEx&&(i=i.replace(this.userNameReplaceRegEx,"<username>")),i}traceLog(e,...t){this.channel.appendLine(this.format("",e,...t))}traceError(e,...t){this.channel.appendLine(this.format("error",e,...t))}traceWarn(e,...t){this.channel.appendLine(this.format("warn",e,...t))}traceInfo(e,...t){this.channel.appendLine(this.format("info",e,...t))}traceVerbose(e,...t){this.channel.appendLine(this.format("debug",e,...t))}};d();var _re=require("vscode");function Ere(r){let e=_re.window.createOutputChannel(_.jupyterServerConsoleOutputChannel,"log");r.push(e);let t={get(n,i){let o=n[i];if(typeof o=="function"){if(i==="append")return(...s)=>{e.append(...s),Sre(...s)};if(i==="appendLine")return(...s)=>{e.appendLine(...s),Sre(...s)}}return o}};return new Proxy(e,t)}function Sre(...r){r.length===1?q(dt(r[0]).map((e,t)=>t===0?e:`    ${e}`).join(`
`)):q(...r)}d();var Cre=require("vscode");function wre(){let r=Cre.workspace.getConfiguration("python"),e=r==null?void 0:r.get("languageServer");return!(e!=="Pylance"&&e!=="Default")}function Dre(r,e,t){let n=Wn.window.createOutputChannel(dT.jupyter,"log");xP(new jO(n,t==null?void 0:t.userNameRegEx,t==null?void 0:t.homePathRegEx)),e.addSingletonInstance(jm,n,Vv),e.addSingletonInstance(jm,Ere(r.subscriptions),nB),n.appendLine(`${Wn.env.appName} (${Wn.version}, ${Wn.env.remoteName}, ${Wn.env.appHost})`),n.appendLine(`Jupyter Extension Version: ${r.extension.packageJSON.version}.`);let i=Wn.extensions.getExtension(sa);i?n.appendLine(`Python Extension Version: ${i.packageJSON.version}.`):n.appendLine("Python Extension not installed.");let o=Wn.extensions.getExtension(iB);o?n.appendLine(`Pylance Extension Version${wre()?"":" (Not Used) "}: ${o.packageJSON.version}.`):n.appendLine("Pylance Extension not installed."),t!=null&&t.platform&&n.appendLine(`Platform: ${t.platform} (${t.arch}).`),!Wn.workspace.workspaceFolders||Wn.workspace.workspaceFolders.length===0?n.appendLine("No workspace folder opened."):Wn.workspace.workspaceFolders.length===1?n.appendLine(`Workspace folder ${Se(Wn.workspace.workspaceFolders[0].uri)}, Home = ${t==null?void 0:t.homePath}`):n.appendLine(`Multiple Workspace folders opened ${Wn.workspace.workspaceFolders.map(s=>Se(s.uri)).join(", ")}`)}function Pre(r){let e=new xre.Container({skipBaseClassChecks:!0}),t=new Fv(e),n=new at(e);return t.addSingletonInstance(jr,n),t.addSingletonInstance(pZ,t),t.addSingletonInstance(oe,r.subscriptions),t.addSingletonInstance(wt,r.globalState,ur),t.addSingletonInstance(wt,r.workspaceState,Ts),t.addSingletonInstance(ut,r),[t,n]}function Tre(){let r=Me(),e={location:Wn.ProgressLocation.Window,title:Be.loadingExtension};return Wn.window.withProgress(e,()=>r.promise).then(y,y),{dispose:()=>r.resolve()}}function kre(r,e,t){swe(Be.handleExtensionActivationError),console.error("extension activation failed",r),O("extension activation failed",r),Hz(r,e,t)}function swe(r){try{Wn.window.showErrorMessage(r).then(y,y)}catch(e){O("failed to notify user",e)}}var BO=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}},RE=new BO,nP={totalActivateTime:0,codeLoadingTime:0,startActivateTime:0,endActivateTime:0,workspaceFolderCount:0};typeof requestAnimationFrame=="undefined"&&typeof setImmediate=="undefined"&&(self.setImmediate=r=>setTimeout(r),self.clearImmediate=r=>clearTimeout(r));nP.codeLoadingTime=RE.elapsedTime;var B9;async function awe(r){nP.startActivateTime=RE.elapsedTime,zG(RE),WG(r.subscriptions),Q9(Qa.env.uiKind==Qa.UIKind.Web),eB(!0),r.subscriptions.push({dispose:()=>ME.isExiting=!0});try{let[e,t]=cwe(r);return await t,Bz(nP,RE),e}catch(e){return nP.endActivateTime=RE.elapsedTime,kre(e,nP,RE),O("Failed to active the Jupyter Extension",e),{ready:Promise.resolve(),registerPythonApi:y,registerRemoteServerProvider:()=>({dispose:y}),getKernelService:()=>Promise.resolve(void 0),addRemoteJupyterServer:()=>Promise.resolve(void 0),openNotebook:()=>Promise.reject(),createJupyterServerCollection:()=>{throw new Error("Not Implemented")},kernels:{getKernel:()=>Promise.resolve(void 0)}}}}function lwe(){if(ME.isExiting=!0,B9){let r=B9.get(_o);if(r)return r.dispose()}return Promise.resolve()}function cwe(r){let e=Tre();try{let[t,n]=Pre(r);B9=n,qG(()=>Promise.resolve(new Map));let i=uwe(r,t,n);return[Wz(i,t,n,r),i,n]}finally{e.dispose()}}async function uwe(r,e,t){return pwe(r,e,t)}function dwe(){if(Sn()){let r;Ni||(r="Jupyter Extension:"),xP(new VO(r))}}async function pwe(r,e,t){let n=r.extensionMode===Qa.ExtensionMode.Development||Qa.workspace.getConfiguration("jupyter").get("development",!1);e.addSingletonInstance(WB,n),n&&Qa.commands.executeCommand("setContext","jupyter.development",!0).then(y,y),Qa.commands.executeCommand("setContext","jupyter.webExtension",!0).then(y,y),Dre(r,e),dwe(),CX(e),Iee(e,n),dZ(e,n),Cte(e),xte(e),nre(r,e,n),vre(e);let i=t.get(Np),o=new BO;await i.activate();let s=o.elapsedTime;J("DS_INTERNAL.EXPERIMENT_LOAD",{duration:s});let l=e.get(Ke).getSettings();cL(l.logging.level),l.onDidChange(()=>{cL(l.logging.level)}),Qa.commands.executeCommand("setContext","jupyter.vscode.channel",$d()).then(y,y),t.get(G1).activate();let c=t.get(PP);c.initialize(),r.subscriptions.push(c)}
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

@microsoft/dynamicproto-js/lib/dist/esm/dynamicproto-js.js:
  (*!
   * Microsoft Dynamic Proto Utility, 1.1.8
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

@lumino/polling/dist/index.js:
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

@lumino/disposable/dist/index.js:
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

strip-comments/index.js:
  (*!
   * strip-comments <https://github.com/jonschlinkert/strip-comments>
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Released under the MIT License.
   *)
*/
